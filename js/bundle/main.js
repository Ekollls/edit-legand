(globalThis.webpackChunktravian_legends_webpack_bundle=globalThis.webpackChunktravian_legends_webpack_bundle||[]).push([[179],{1053:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 50 50"},e),s||(s=i.createElement("path",{d:"M45.21 14.28h-7.67V4.9c0-2.7-2.2-4.9-4.9-4.9H4.9C2.2 0 0 2.2 0 4.9v27.74c0 2.7 2.2 4.9 4.9 4.9h9.38v7.67c0 2.64 2.15 4.79 4.79 4.79h26.14c2.64 0 4.79-2.15 4.79-4.79V19.07c0-2.64-2.15-4.79-4.79-4.79ZM6 31.54V6h25.53v8.27H19.06c-2.64 0-4.79 2.15-4.79 4.79v12.47H6Z"})))},5429:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 12.8 18.8"},e),s||(s=i.createElement("path",{d:"M5.5 16.6.8 18.8 0 13.6c0-.1.1-.1.1-.1l5.4 2.9c.1.1.1.2 0 .2zm6.7-14.4L8.4.1C7.9-.1 7.3 0 7 .5L1.2 11.2c-.3.5-.1 1.1.3 1.4h.1l3.9 2.1c.5.3 1.1.1 1.4-.4l5.8-10.7c.3-.4.1-1.1-.5-1.4.1 0 .1 0 0 0z"})))},4984:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var s,i,n,r=a(7294);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},l.apply(this,arguments)}const o=e=>r.createElement("svg",l({viewBox:"0 0 18 18"},e),s||(s=r.createElement("path",{className:"box",d:"M16 0H2a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V2a2 2 0 00-2-2z"})),i||(i=r.createElement("rect",{className:"indeterminate",width:10,height:2,x:4,y:8})),n||(n=r.createElement("path",{className:"checkmark",d:"M15.28 4.28l-8.27 8.27-4.3-4.26h0"})))},3991:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var s,i,n,r=a(7294);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},l.apply(this,arguments)}const o=e=>r.createElement("svg",l({viewBox:"0 0 20 20"},e),s||(s=r.createElement("path",{d:"M10,0A10,10,0,1,0,20,10,10,10,0,0,0,10,0Z"})),i||(i=r.createElement("rect",{className:"indeterminate",width:10,height:5,x:5,y:7.5})),n||(n=r.createElement("circle",{className:"checked",cx:10,cy:10,r:5})))},7640:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 10 5"},e),s||(s=i.createElement("path",{d:"M0 5l5-5 5 5z"})))},3265:(e,t,a)=>{"use strict";a.d(t,{Z:()=>g});var s,i,n,r,l,o,c,d,h,u,m=a(7294);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},p.apply(this,arguments)}const g=e=>m.createElement("svg",p({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 51 51"},e),s||(s=m.createElement("defs",null,m.createElement("linearGradient",{id:"a",x1:25.5,x2:25.5,y1:2,y2:49,gradientTransform:"rotate(13.28 25.519 25.5)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:0,stopColor:"#d8c383"}),m.createElement("stop",{offset:.47,stopColor:"#bb904d"}),m.createElement("stop",{offset:.8,stopColor:"#b78548"}),m.createElement("stop",{offset:1,stopColor:"#c09957"})),m.createElement("linearGradient",{id:"b",x1:25.5,x2:25.5,y1:7.89,y2:43.19,gradientTransform:"rotate(67.5 25.502 25.498)",gradientUnits:"userSpaceOnUse"},m.createElement("stop",{offset:.06,stopColor:"#81481b"}),m.createElement("stop",{offset:1,stopColor:"#fef6a9"})))),i||(i=m.createElement("circle",{cx:25.5,cy:25.5,r:25.5,fill:"#522d1c"})),n||(n=m.createElement("circle",{cx:25.5,cy:25.5,r:23.5,fill:"url(#a)",transform:"rotate(-13.28 25.5 25.519)"})),r||(r=m.createElement("circle",{cx:25.5,cy:25.5,r:17.52,fill:"url(#b)",transform:"rotate(-67.5 25.498 25.502)"})),l||(l=m.createElement("path",{fill:"#b47b34",d:"M42.3 25.5c-.39-22.38-33.21-22.38-33.6 0 .39 22.38 33.21 22.38 33.6 0z"})),o||(o=m.createElement("path",{fill:"#c48d3a",d:"M24.64 22.64c-5.05.09-11-3.16-13.78-5.59a16.12 16.12 0 011.44-2.15c12.35 10 13.61 10.06 26 .13a16.07 16.07 0 011.4 2.14c-2.9 2.43-8.7 5.55-13.65 5.47.51.09-1.93.09-1.41 0zm-9.39 1.58a65.65 65.65 0 00-6.05 5.24c.1.38.21.76.33 1.13a33.75 33.75 0 0110.34-6.37zm-3.71 0H8.78c0 .32 0 .64-.06 1v.45c0 .45 0 .88.08 1.31v.36zm2.9-1.22c-.39-.21-2.61-2.34-4.45-4.14-.17.41-.32.83-.46 1.25v.12c2.61 1.77 3.59 2.98 4.91 2.77zm9.14-2.34v-2.27L16.69 11c-.39.23-.77.48-1.14.74s-.6.44-.88.68zm-.41 5.18c-.69-.07-5.26 1.43-11.9 8.39v.1a15.94 15.94 0 001.32 1.82 58.92 58.92 0 0110.58-10.33zm.91 6.79l-.23-1.52a48 48 0 00-9.12 7.19 16 16 0 002.75 1.85c1.62-2.47 4.25-6.08 6.6-7.54zM21.75 9.12c-.42.09-.84.19-1.26.31 1.14 1.7 4.31 5.57 4.85 6.39zm9.07 15.1A33.5 33.5 0 0141 30.44c.12-.38.23-.77.32-1.17a67.28 67.28 0 00-5.87-5.05zm10.91 0h-2.59l2.54 2.88a18.45 18.45 0 00.05-2.88zM37.18 23s2.09-1.29 3.84-2.64c-.14-.46-.3-.9-.48-1.34-1.81 1.76-3.92 3.77-4.29 4a4.77 4.77 0 00.93-.02zm-3.24-11.91l-6.83 7.3v2.25l8.8-8.1a16.37 16.37 0 00-1.97-1.45zM28 25.82h-.49A58.72 58.72 0 0138 36a17.83 17.83 0 001.33-1.89C33.16 27.5 28 25.82 28 25.82zm-1.4 6.79c2.32 1.44 4.92 5 6.54 7.44a17.06 17.06 0 002.7-1.87 47.92 47.92 0 00-9-7.09zm-.32 2.67l.28-.24a7.74 7.74 0 01-2.45 0l.28.24h-.32l-4.21 4.45c1.64.6 3-1.95 5.47-3.68 2.45 1.73 3.83 4.28 5.48 3.68l-4.21-4.45zm1.18-22.21c.77-.92 2-2.56 2.77-3.71l-.44-.12c-.28-.07-.55-.13-.83-.18l-3.63 6.76s.87-1.23 2.14-2.75zm-.62-4.3a18.78 18.78 0 00-3 0l1.49 1.9z"})),c||(c=m.createElement("path",{fill:"#703e19",d:"M35.43 15.17h-1.76l-.38.55H18.43l-.37-.55h-1.77l-1 5.78L16 22l2.14-3.13h4.77v14.59c0 1.69-2.57 2.1-2.57 2.1v2.27h11v-2.27s-2.57-.41-2.57-2.1V18.88h4.77L35.7 22l.71-1z"})),d||(d=m.createElement("path",{fill:"#dbb561",d:"M33.56 17.88L35.7 21l.71-1.07-1-5.78h-1.74l-.38.55H18.43l-.37-.55h-1.77l-1 5.78L16 21l2.14-3.13h5.26v14.59c0 1.68-3.06 2.1-3.06 2.1V36l.81.82h9.45l.74-.75v-1.51s-3.05-.42-3.05-2.1V17.88z"})),h||(h=m.createElement("path",{fill:"#faf28a",d:"M15.4 20.07l-.09-.13 1-5.78h1.77l.37.55h14.84l.38-.55h1.76l1 5.78-.08.13-.9-5.27h-1.78l-.38.55H18.43l-.37-.55h-1.77zm5 15.13c.25.07 3.67-.77 3.06-2.74 0 1.68-3.06 2.1-3.06 2.1zm8-2.74c-.62 2 2.82 2.82 3.05 2.74v-.64s-3.14-.42-3.14-2.1z"})),u||(u=m.createElement("path",{fill:"#a87134",d:"M25.56 4a1.14 1.14 0 010 2.27 1.14 1.14 0 010-2.27zm-3.31 2.58a1.13 1.13 0 00-.4-2.23 1.13 1.13 0 00.4 2.23zM19 7.44a1.13 1.13 0 00-.78-2.13A1.13 1.13 0 0019 7.44zm-3 1.4a1.13 1.13 0 00-1.14-2 1.13 1.13 0 001.14 2zm-2.72 1.91C14.45 9.82 13 8 11.85 9a1.14 1.14 0 001.46 1.75zM11 13.09a1.13 1.13 0 00-1.73-1.46A1.13 1.13 0 0011 13.09zm-1.9 2.73a1.14 1.14 0 00-2-1.14 1.14 1.14 0 001.95 1.14zm-1.41 3a1.13 1.13 0 00-2.13-.78 1.13 1.13 0 002.08.79zM6.78 22a1.14 1.14 0 00-2.24-.4 1.14 1.14 0 002.24.4zm-.29 3.31a1.14 1.14 0 00-2.27 0 1.14 1.14 0 002.27.04zm.28 3.31a1.13 1.13 0 00-2.23.39 1.13 1.13 0 002.23-.35zm.86 3.21a1.13 1.13 0 00-2.13.77 1.13 1.13 0 002.13-.73zm1.4 3a1.14 1.14 0 00-2 1.14A1.14 1.14 0 009 34.88zm1.9 2.73a1.14 1.14 0 00-1.74 1.46c.93 1.19 2.71-.3 1.74-1.41zM13.28 40c-1.11-1-2.6.81-1.46 1.74A1.14 1.14 0 0013.28 40zM16 41.87a1.13 1.13 0 00-1.14 2 1.13 1.13 0 001.14-2zm3 1.4a1.14 1.14 0 00-.78 2.14 1.14 1.14 0 00.78-2.14zm3.21.87a1.13 1.13 0 00-.4 2.23 1.13 1.13 0 00.41-2.23zm3.3.29a1.14 1.14 0 000 2.27 1.14 1.14 0 00.01-2.27zm3.31-.29a1.14 1.14 0 00.4 2.24 1.14 1.14 0 00-.39-2.24zm3.18-.85a1.13 1.13 0 00.78 2.13 1.13 1.13 0 00-.78-2.13zm3-1.41a1.14 1.14 0 001.14 2 1.14 1.14 0 00-1.09-2zM37.78 40a1.14 1.14 0 001.46 1.74A1.14 1.14 0 0037.78 40zm2.35-2.35a1.14 1.14 0 001.74 1.46 1.14 1.14 0 00-1.74-1.48zM42 34.91a1.13 1.13 0 002 1.14 1.13 1.13 0 00-2-1.14zm1.4-3a1.13 1.13 0 002.13.78 1.13 1.13 0 00-2.09-.79zm.86-3.21a1.14 1.14 0 002.24.39 1.14 1.14 0 00-2.2-.4zm.3-3.31a1.14 1.14 0 002.27 0 1.14 1.14 0 00-2.23-.01zm-.29-3.31a1.14 1.14 0 002.24-.4 1.14 1.14 0 00-2.2.39zm-.86-3.21a1.14 1.14 0 002.14-.78 1.14 1.14 0 00-2.1.77zm-1.4-3a1.14 1.14 0 002-1.13 1.14 1.14 0 00-1.96 1.1zm-1.9-2.72a1.14 1.14 0 001.74-1.46 1.14 1.14 0 00-1.7 1.43zm-2.31-2.38A1.14 1.14 0 0039.26 9c-1.11-.94-2.6.84-1.46 1.77zm-2.72-1.91a1.14 1.14 0 001.14-2 1.14 1.14 0 00-1.14 2zm-3-1.41a1.13 1.13 0 00.78-2.13 1.13 1.13 0 00-.79 2.13zm-3.2-.86a1.14 1.14 0 00.39-2.24 1.14 1.14 0 00-.4 2.24z"})))},2637:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 18 18"},e),s||(s=i.createElement("path",{d:"M16 10h-6v6H8v-6H2V8h6V2h2v6h6z"})))},7757:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 20 20"},e),s||(s=i.createElement("path",{d:"M14.59 5.58L8 12.17 4.41 8.59 3 10l5 5 8-8zM10 0a10 10 0 1010 10A10 10 0 0010 0zm0 18a8 8 0 118-8 8 8 0 01-8 8z"})))},2011:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 20 20"},e),s||(s=i.createElement("path",{d:"M0 17.01L7.01 10 .14 3.13 3.13.14 10 7.01 17.01 0 20 2.99 12.99 10l6.87 6.87-2.99 2.99L10 12.99 2.99 20 0 17.01z"})))},9394:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var s,i,n=a(7294);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},r.apply(this,arguments)}const l=e=>n.createElement("svg",r({viewBox:"0 0 86.29 100"},e),s||(s=n.createElement("path",{d:"M75 100H11.32C8.9 93.78 7 89.76 6.89 82.9Q6.73 73 6.72 63c0-13.43.05-26.86.05-40.29H79.5c0 14-.22 28-.13 42C79.46 77.58 80.5 88.09 75 100zM25.8 86V32h-9v54zm22 0V32h-9v54zm13-54v54h9V32z"})),i||(i=n.createElement("path",{d:"M0 4.66C10.8 4 21.12 7 29.64 0h27c8.51 7 18.87 4 29.66 4.66L85.76 18H.53z"})))},7175:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 100 75"},e),s||(s=i.createElement("path",{d:"M96.96 15H3.04C1.36 15 0 13.64 0 11.96V3.04C0 1.36 1.36 0 3.04 0h93.93c1.68 0 3.04 1.36 3.04 3.04v8.93c0 1.68-1.36 3.04-3.04 3.04ZM100 41.96v-8.93c0-1.68-1.36-3.04-3.04-3.04H3.04A3.054 3.054 0 0 0 0 33.04v8.93C0 43.64 1.36 45 3.04 45h93.93c1.68 0 3.04-1.36 3.04-3.04Zm0 30v-8.93c0-1.68-1.36-3.04-3.04-3.04H3.04C1.36 59.99 0 61.35 0 63.03v8.93C0 73.64 1.36 75 3.04 75h93.93c1.68 0 3.04-1.36 3.04-3.04Z"})))},6407:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 12 7.41"},e),s||(s=i.createElement("path",{d:"M1.41 0L6 4.58 10.59 0 12 1.41l-6 6-6-6z"})))},6346:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s,i=a(7294);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n.apply(this,arguments)}const r=e=>i.createElement("svg",n({viewBox:"0 0 82 100"},e),s||(s=i.createElement("path",{d:"M82 23V0H0v17l28 33L0 83v17h82V76H65v7H22l27-33-27-33h43v6h17z"})))},2623:(e,t,a)=>{"use strict";a.d(t,{z:()=>c});a(7294);var s=a(3265),i=a(925),n=a(5697),r=a.n(n),l=a(5893);const o=e=>{const{children:t,className:a,goldValue:i,forwardRef:n,appearance:r,disabledClass:o,disabledAttribute:c,activeNotClickable:d,roundButton:h,iconButton:u,toggleButton:m,active:p,type:g,textWithIcon:v,withLoadingIndicator:x,isLoading:b}=e,j=["key","download","id","title","href","onClick","onSubmit","tabIndex","target"];let f="textButtonV2";"buttonSecondary"!==r&&(f+=" buttonFramed"),f+=a?" "+a:"",f+=o?" disabled":"",f+=v?" withTextAndIcon":"",f+=h?" round":" rectangle",f+=u?" withIcon":" withText",m&&(f+=" toggle",f+=d?" activeNotClickable":""),x&&(f+=" withLoadingIndicator",b&&(f+=" loading")),f+=i?" gold":m?p?" orange":" grey":r?" "+r:" green";let y={};const T=new RegExp("^data-w*");return Object.keys(e).map((t=>{(T.test(t)||j.includes(t))&&(y[t]=e[t])})),(0,l.jsx)(l.Fragment,{children:e.href?(0,l.jsx)("a",{className:f,ref:n,...y,children:u?(0,l.jsx)(l.Fragment,{children:t}):(0,l.jsxs)("div",{children:[(0,l.jsx)(l.Fragment,{children:t}),i&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Z,{className:"goldCoin"})," ",(0,l.jsx)("span",{className:"goldValue",children:i})]})]})}):(0,l.jsx)("button",{className:f,type:g||"button",disabled:c?"disabled":"",ref:n,...y,children:u?(0,l.jsx)(l.Fragment,{children:t}):(0,l.jsxs)("div",{children:[(0,l.jsx)(l.Fragment,{children:t}),i&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Z,{className:"goldCoin"})," ",(0,l.jsx)("span",{className:"goldValue",children:i})]})]})})})};o.propTypes={className:r().string,goldValue:r().oneOfType([r().number,r().string]),forwardRef:r().oneOfType([r().func,r().shape({current:r().any})]),appearance:r().string,disabledClass:r().bool,disabledAttribute:r().bool,roundButton:r().bool,iconButton:r().bool,textWithIcon:r().bool,type:r().string,key:r().string,download:r().string,id:r().string,title:r().string,href:r().string,onClick:r().func,onSubmit:r().func,tabIndex:r().number,withLoadingIndicator:r().bool,isLoading:r().bool};const c=(0,i.T)(o)},7581:(e,t,a)=>{"use strict";a.d(t,{tk:()=>u,tl:()=>o,WM:()=>d});var s=a(7294),i=a(5697),n=a.n(i),r=a(1809),l=a(5893);const o=e=>{const{pageCount:t,switchPage:a}=e,i=e.currentPage+1,n=e.currentPage;let o=Math.max(3,Math.min(t-1-5,i-2)),c=Math.min(t-2,Math.max(7,i+2));const d=[];if(t>=1&&d.push(1),t>=3&&d.push(o>3?null:2),t>=5)for(let e=o;e<=c;e++)d.push(e);return t>=4&&d.push(c<t-2?null:t-1),t>=2&&d.push(t),(0,l.jsxs)("div",{className:"pagination",children:[(0,l.jsx)("button",{type:"button",className:"back "+(i>1?"":"disabled"),title:(0,r.Jh)("allgemein.pageBack"),onClick:()=>i>1?a(n-1):()=>!1}),d.map(((e,t)=>{let n=e-1;return e?(0,l.jsxs)(s.Fragment,{children:[(0,l.jsx)("button",{type:"button",className:"page "+(i===e?"selected":""),title:`${(0,r.Jh)("allgemein.page")} ${e}`,onClick:()=>a(n)}),(0,l.jsx)("div",{className:"pageIndex",children:e})]},t):(0,l.jsx)("div",{className:"emptyPage",children:".."},"empty_"+t)})),(0,l.jsx)("button",{type:"button",className:"forward "+(i<t?"":"disabled"),title:(0,r.Jh)("allgemein.pageForward"),onClick:()=>i<t?a(n+1):()=>!1})]})};o.propTypes={currentPage:n().number.isRequired,pageCount:n().number.isRequired,switchPage:n().func.isRequired};var c=a(7999);const d=e=>{const[t,a]=(0,s.useState)(null),[i,n]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),[h,u]=(0,s.useState)({x:null,y:null}),[m,p]=(0,s.useState)({x:null,y:null}),[g,v]=(0,s.useState)(null),[x,b]=(0,s.useState)(!1),j=(0,s.useRef)(),f=(0,s.useRef)(),y=t=>{a({uid:t.uid,name:t.playerName}),n({id:t.aid,name:t.allianceName}),v(t.name),u({x:t.x,y:t.y}),p({x:t.x,y:t.y}),d(null),e.context&&e.sourceVillageId?T(t):N(t),E()},T=(t={})=>{Travian.api("validate-destination",{data:{sourceVillageId:e.sourceVillageId,destinationCoordinates:{x:t.x,y:t.y},context:e.context},success:e=>{Object.keys(t).length>0&&N(t)},error:e=>{e&&d(e.message)}})},N=t=>{Travian.Game.VillageList.update({x:t.x,y:t.y}),"function"==typeof e.onSelect&&e.onSelect(t)},C=e=>{null===h.x||null===h.y||h.x===m.x&&h.y===m.y||(k(),d(null),p(h),Travian.api("village/target/"+h.x+"/"+h.y,{success:e=>{e.name=(0,r.r4)(e.name??""),e.playerName=(0,r.r4)(e.playerName??""),y(e)},error:e=>{e&&(d(e.message),k(!1,!0))}},"GET"))},S=e=>{(0,r.rz)(e,j.current,f.current,h,u,E)},k=(t,s)=>{a(null),n(null),t&&u({x:null,y:null}),s&&v(null),"function"==typeof e.onSelect&&e.onSelect({})};(0,s.useEffect)((()=>{d(e.customError)}),[e.customError]),(0,s.useEffect)((()=>{x&&(C(),E(),b(!1))}),[x]);const w=(e,t,a,s)=>{v(null),u({x:t,y:a}),b(!0)};(0,s.useEffect)((()=>(e.disabled||(Travian.Game.Village.enableVillageListShortcuts(),jQuery(window).on("travian.villageList.coordinatesShortcut",w)),()=>{Travian.Game.Village.disableVillageListShortcuts(),jQuery(window).off("travian.villageList.coordinatesShortcut",w),Travian.Game.VillageList.update({x:null,y:null})})),[]),(0,s.useEffect)((()=>{e.coordinates&&null!==e.coordinates.x&&null!==e.coordinates.y&&(e.context&&!e.sourceVillageId||(u(e.coordinates),b(!0)))}),[e.context,e.sourceVillageId,e.coordinates]);const E=()=>{setTimeout((()=>{j.current.dispatchEvent(new Event("change")),f.current.dispatchEvent(new Event("change")),e.formHandler.current.validate(j.current),e.formHandler.current.validate(f.current)}),5)};return(0,l.jsxs)("div",{className:"targetSelection",children:[(0,l.jsxs)("div",{className:"inputWrapper",children:[(0,l.jsx)(c.M,{type:Travian.Constants.AUTO_COMPLETE.villageName,minLength:2,rows:20,disabled:e.disabled,resultsWrapperRef:e.resultsWrapperRef,context:e.context,resultCallback:y,prefill:g,tabIndex:e.tabIndexStart??null,onChangeCallback:e=>{k(!0,!1)}}),(0,l.jsxs)("label",{className:"input coordinateX",children:[(0,l.jsx)("input",{type:"text",inputMode:"numeric",maxLength:"4",disabled:e.disabled??!1,tabIndex:e.tabIndexStart?e.tabIndexStart+1:"",onBlur:C,onPaste:S,onChange:e=>u({...h,x:e.target.value}),value:h.x??"",ref:j}),(0,l.jsx)("div",{className:"label",children:(0,r.Jh)("allgemein.coordinateX")}),(0,l.jsx)("div",{className:"validation","data-rule":r.w3.NOT_EMPTY,"data-render-into":".targetSelectionValidation",children:(0,r.Jh)("a2b.koordinaten_eingeben")})]}),(0,l.jsxs)("label",{className:"input coordinateY",children:[(0,l.jsx)("input",{type:"text",inputMode:"numeric",maxLength:"4",disabled:e.disabled??!1,tabIndex:e.tabIndexStart?e.tabIndexStart+2:"",onBlur:C,onPaste:S,onChange:e=>u({...h,y:e.target.value}),value:h.y??"",ref:f}),(0,l.jsx)("div",{className:"label",children:(0,r.Jh)("allgemein.coordinateY")}),(0,l.jsx)("div",{className:"validation","data-rule":r.w3.NOT_EMPTY,"data-render-into":".targetSelectionValidation",children:(0,r.Jh)("a2b.koordinaten_eingeben")})]})]}),(0,l.jsxs)("div",{className:"targetSelectionResultWrapper "+(o?"hasError":""),children:[(0,l.jsx)("div",{className:"customValidationRenderElement targetSelectionValidation "+(o?"show":""),dangerouslySetInnerHTML:{__html:o}}),(0,l.jsxs)("div",{className:"targetWrapper",children:[(0,l.jsxs)("div",{className:"player",children:[(0,r.Jh)("spieler.spieler"),": ",t&&t.uid?(0,l.jsx)("a",{href:`/profile/${t.uid}`,title:"",children:t.name}):(0,l.jsx)("span",{className:"value",children:"-"})]}),(0,l.jsxs)("div",{className:"duration",children:[(0,r.Jh)("a2b.dauer"),": ",(0,l.jsx)("span",{className:"value",children:e.duration?e.duration:"-"})]}),(0,l.jsxs)("div",{className:"alliance",children:[(0,r.Jh)("allgemein.alliance"),": ",i&&i.id?(0,l.jsx)("a",{href:`/alliance/${i.id}`,title:"",children:i.name}):(0,l.jsx)("span",{className:"value",children:"-"})]}),(0,l.jsx)("div",{className:"arrival",children:e.distance?(0,l.jsxs)(l.Fragment,{children:[(0,r.Jh)("a2b.distance"),": ",(0,l.jsx)("span",{className:"value",children:e.distance})]}):(0,l.jsxs)(l.Fragment,{children:[(0,r.Jh)("a2b.ankunft"),": ",(0,l.jsx)("span",{className:"value",children:e.arrival?e.arrival:"-"})]})})]})]})]})};d.propTypes={context:n().string,sourceVillageId:n().number,formHandler:n().object,onSelect:n().func,customError:n().string,duration:n().object,arrival:n().object,distance:n().number,coordinates:n().shape({x:n().number,y:n().number}),tabIndexStart:n().number,disabled:n().bool};var h=a(6613);const u=({x:e,y:t,type:a,mapId:s,name:i,detailView:n})=>(n=void 0===n,(0,l.jsx)("a",{href:n?`/position_details.php?mapId=${s}`:`karte.php?x=${e}&y=${t}`,children:Object.values(Travian.Constants.VILLAGE_TYPE_VILLAGES).includes(a)?(0,l.jsx)("span",{children:i}):(0,l.jsx)(h.r,{x:e,y:t,configInput:{withMarkup:!0,text:(0,r.Jh)(a===Travian.Constants.VILLAGE_TYPE_OASIS_FREE?"karte.freie_oase":"karte.besetztes_tal")}})}));u.propTypes={x:n().number.isRequired,y:n().number.isRequired,name:n().string.isRequired,type:n().number.isRequired,mapId:n().number.isRequired,detailView:n().bool}},8497:(e,t,a)=>{"use strict";a.d(t,{Y:()=>p,Z:()=>g});var s,i,n,r,l=a(7294),o=a(5697),c=a.n(o);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},d.apply(this,arguments)}const h=e=>l.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 62 62"},e),s||(s=l.createElement("path",{className:"top",d:"M31 4l2-4h-4l2 4z"})),i||(i=l.createElement("path",{className:"bottom",d:"M29 62h4l-2-4-2 4z"})),n||(n=l.createElement("path",{className:"from",d:"M0 33l4-2-4-2v4z"})),r||(r=l.createElement("path",{className:"to",d:"M58 31l4 2v-4l-4 2z"})));var u=a(1809),m=a(5893);class p extends l.Component{static propTypes={item:c().string,tier:c().string,slot:c().string,count:c().number,empty:c().bool};static tierConsumable="consumable";static tier1="tier1";static tier2="tier2";static tier3="tier3";static consumableTypes=["bag","inventory"];render(){const{id:e,placeId:t,typeId:a,tier:s,slot:i,count:n,empty:r,onClick:l,onMouseDown:o,onMouseOver:c,onMouseOut:d,dragged:p,isDropTarget:g,disabled:v,replaced:x,forwardedRef:b}=this.props;let j=r&&i&&(0,u.Jh)("hero.heroItemSlot_"+i),f=this.props.notClickable??!1;return(0,m.jsxs)("div",{className:["heroItem",r?"empty":s,i??"",p?"dragged":"",g?"dropTarget":"",v?"disabled":"",x?"replaced":"",0===n?"none":"",f?"notClickable":""].join(" "),ref:b,title:j||"","data-id":e,"data-placeid":t,"data-slot":i,"data-tier":s,onClick:l,onMouseDown:o,onTouchStart:o,onMouseOver:c,onMouseOut:d,children:[(0,m.jsx)(h,{}),(0,m.jsx)("div",{className:"item "+(a?"item"+a:"")}),null!=n&&(0,m.jsx)("div",{className:"count",children:n})]})}}const g=(0,l.forwardRef)(((e,t)=>(0,m.jsx)(p,{forwardedRef:t,...e})))},4284:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>ProductionBoostSpeechBubble});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7294),___WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7015),_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1809),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5893);class ProductionBoostSpeechBubble extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(e){super(e),this.wrapperDiv=react__WEBPACK_IMPORTED_MODULE_0__.createRef()}componentDidMount(){eval(this.wrapperDiv.current.getElementsByTagName("script")[0].innerText)}componentDidUpdate(){eval(this.wrapperDiv.current.getElementsByTagName("script")[0].innerText)}render(){const{hasPlayerBoost:e,interimBalanceSheet:t,productionBoost:a,button:s}=this.props,i=new Travian.Formatter({forceDecimal:!1});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"productionBoostSpeechBubble",ref:this.wrapperDiv,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(___WEBPACK_IMPORTED_MODULE_1__.hX,{wrapperClass:"productionBoostResourceSpeechBubble",bubbleClass:"fluidSpeechBubble",directionClass:"speechArrowBack",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("form",{id:"fluidSpeechBubble",method:"post",action:"",children:[!e&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("p",{children:[(0,_utils__WEBPACK_IMPORTED_MODULE_2__.Jh)("premiumFeatures.productionBoostInfoMitBonus")," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("span",{className:"bold",children:i.getFormattedNumber(t+a)})]}),e&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("p",{children:[(0,_utils__WEBPACK_IMPORTED_MODULE_2__.Jh)("premiumFeatures.productionBoostInfoOhneBonus")," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("span",{className:"bold",children:i.getFormattedNumber(t)})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{dangerouslySetInnerHTML:{__html:s}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"productionBoostSpeechBubbleFurtherInfo",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("p",{children:(0,_utils__WEBPACK_IMPORTED_MODULE_2__.Jh)("premiumFeatures.productionBoostZusatzInfo",{U:'<span class="underlined">',"/U":"</span>"},!0)})})]})})})}}},7999:(e,t,a)=>{"use strict";a.d(t,{M:()=>c});var s=a(5697),i=a.n(s),n=a(6613),r=a(1809),l=a(7294),o=a(5893);const c=e=>{const[t,a]=(0,l.useState)(""),[s,i]=(0,l.useState)(""),[n,c]=(0,l.useState)([]),[u,m]=(0,l.useState)({}),[p,g]=(0,l.useState)(null),[v,x]=(0,l.useState)(null),b=(0,l.useRef)(),j=(0,l.useRef)(),f=(0,l.useRef)();(0,l.useEffect)((()=>(window.addEventListener("click",k),()=>{window.removeEventListener("click",k)})),[]),(0,l.useEffect)((()=>{j.current.value=e.prefill??"",j.current.dispatchEvent(new Event("change")),j.current.dispatchEvent(new Event("blur")),i(e.prefill??"")}),[e.prefill]);let y=null;const T=(t=!1)=>{x(null),c([]),clearTimeout(y),y=setTimeout((()=>{const a=j.current.value.substring(0,j.current.selectionStart),n=(e.multiple?a.split(e.multipleSeparator).pop():a).trimStart(),l=0===n.length&&t;(!t&&n.length>=e.minLength&&n!==s||l)&&(i(n),Travian.api("autocomplete/"+e.type,{data:{search:n,limit:e.rows,context:e.context,showDefaults:l},success:e=>{0===e.length?g((0,r.Jh)("spieler.noResults")):(e.map((e=>(e.name=(0,r.r4)(e.name),e.playerName=(0,r.r4)(e.playerName),e))),c(e))},error:e=>{e&&g(e.message)}}))}),333)};(0,l.useEffect)((()=>{if(x(null),f.current){const t=f.current.getBoundingClientRect();let a=window.innerHeight-t.top;if(e.resultsWrapperRef&&e.resultsWrapperRef.current){const s=e.resultsWrapperRef.current.getBoundingClientRect();a=s.top+s.height-t.top}m({...u,maxHeight:a})}}),[n]),(0,l.useEffect)((()=>{if(n.length>0){if(v<0)x(n.length-1);else if(v===n.length)x(0);else if(null!==v){const t=n[v].name,a=j.current.value.substring(0,j.current.selectionStart);let s="";if(e.multiple){const t=j.current.value.split(e.multipleSeparator);t.pop(),s=t.reduce((function(t,a){return t+a+e.multipleSeparator}),s)}let i=(0,r.r4)(t);j.current.value=s+i,j.current.selectionStart=s.length+a.length,j.current.selectionEnd=s.length+a.length+i.length}}else x(null)}),[v]);const N=e=>{switch(e.key){case"ArrowUp":e.preventDefault(),x(v-1);break;case"ArrowDown":e.preventDefault(),x(null===v?0:v+1);break;case"Escape":S();break;case"Enter":e.preventDefault(),C();break;case"Tab":c([]);break;default:T()}},C=()=>{null!==v&&(j.current.focus(),e.multiple&&(j.current.value=j.current.value+e.multipleSeparator),j.current.selectionStart=j.current.selectionEnd=j.current.value.length,"function"==typeof e.resultCallback&&e.resultCallback(n[v]),x(null),c([]))},S=e=>{null!==v&&(j.current.value=j.current.value.substring(0,j.current.selectionStart),x(null)),c([]),i(""),j.current.dispatchEvent(new Event("change")),j.current.dispatchEvent(new Event("blur"))},k=e=>{b.current.contains(e.target)||S()};return(0,o.jsxs)("label",{className:"input search "+(p?"invalid":""),ref:b,defaultValue:e.prefill,children:[(0,o.jsx)("input",{type:"text",disabled:e.disabled??!1,tabIndex:e.tabIndex??"",onKeyDown:N,onFocus:e=>{N(e),T(!0)},ref:j,onChange:t=>{e.onChangeCallback&&e.onChangeCallback(t)}}),(0,o.jsxs)("div",{className:"label",children:[e.type===Travian.Constants.AUTO_COMPLETE.villageName&&(0,r.Jh)("spieler.dorfname"),e.type===Travian.Constants.AUTO_COMPLETE.playerName&&(0,r.Jh)("spieler.spieler")]}),n.length>0&&(0,o.jsx)("div",{className:"results",ref:f,style:u,children:n.map(((t,a)=>e.type===Travian.Constants.AUTO_COMPLETE.villageName?(0,l.createElement)(d,{...t,focused:a===v,key:a,confirm:C,onHover:e=>x(a)}):e.type===Travian.Constants.AUTO_COMPLETE.playerName?(0,l.createElement)(h,{...t,focused:a===v,key:a,confirm:C,onHover:e=>x(a)}):""))}),p&&(0,o.jsx)("div",{className:"validation show",children:p})]})};c.propTypes={type:i().oneOf(Object.values(Travian.Constants.AUTO_COMPLETE)),minLength:i().number.isRequired,context:i().string,multiple:i().bool,multipleSeparator:i().string,rows:i().number,resultCallback:i().func,onChangeCallback:i().func,prefill:i().string,tabIndex:i().number};const d=e=>(0,o.jsxs)("div",{className:"autoCompleteResult typeVillage "+(e.focused?"focused":""),onTouchStart:e.onHover,onClick:e.confirm,onMouseOver:e.onHover,children:[(0,o.jsx)("div",{className:"villageName",children:e.name}),(0,o.jsx)("div",{className:"coordinatesWrapper",children:(0,o.jsx)(n.r,{x:e.x,y:e.y,configInput:{withMarkup:!0,aligned:"coordinatesAligned",linked:!1}},`x${e.x}_y${e.y}`)}),(0,o.jsx)("div",{className:"player",children:e.playerName})]});d.propTypes={name:i().string.isRequired,x:i().number.isRequired,y:i().number.isRequired,playerName:i().string.isRequired,focused:i().bool,confirm:i().func,onHover:i().func};const h=e=>(0,o.jsx)("div",{className:"autoCompleteResult typePlayer "+(e.focused?"focused":""),onTouchStart:e.onHover,onClick:e.confirm,onMouseOver:e.onHover,children:(0,o.jsx)("div",{className:"player",children:e.name})});h.propTypes={name:i().string.isRequired,focused:i().bool,confirm:i().func,onHover:i().func}},5615:(e,t,a)=>{"use strict";a.d(t,{b:()=>n});a(7294);var s=a(7015),i=a(5893);const n=e=>{const t=(e,t)=>{switch(e){case"normal":default:window.Travian.React.Dialog({content:(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"titleInHeader",children:"I'm a normal dialog (V2)"}),"Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet."]}),buttonOk:!1,cssClass:"testDialog"});break;case"relative":window.Travian.React.Dialog({content:(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Sticky"}),(0,i.jsxs)("div",{style:{width:"200px"},children:["I'm a sticky dialog, positioned: ",(0,i.jsx)("strong",{children:t})]})]}),preventFormSubmit:!0,buttonCloseOnClickOk:!0,enableBackground:!1,relativeTo:{element:"#stickyDialogTest",position:t}});break;case"scrollable":const e=e=>(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:"Scrollable"}),(0,i.jsxs)("div",{className:"scrollableContent",children:["I'm a basic dialog but this time with an even darker background!",(0,i.jsx)("br",{}),"Check out this very long text that makes you scroll: Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.",(0,i.jsxs)("p",{className:"centeredText",children:[(0,i.jsx)(s.zx,{onClick:e.closeDialogCallback,children:"Close"}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)("i",{children:"close dialog from within child component callback"})]})]})]});window.Travian.React.Dialog({id:"verySpecialDialog",content:(0,i.jsx)(e,{}),cssClass:"styleguideBasicDialog basic scrollable",buttonOk:!1,darkOverlay:!0,overlayCancel:!1,useEscKey:!1});break;case"plain":window.Travian.React.Dialog({content:(0,i.jsx)("div",{children:"Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet."}),darkOverlay:!0,buttonOk:!1,buttonCancel:!1,cssClass:"plain"});break;case"confirmation":(0,s.Is)({message:"You like this confirmation dialog?",cancelText:"No",confirmText:"Yes",onConfirm:e=>{}})}};return(0,i.jsxs)("section",{className:"dialogs",children:[(0,i.jsx)(s.zx,{onClick:()=>t("normal"),children:(0,i.jsx)("div",{children:"Normal Dialog"})}),(0,i.jsx)(s.zx,{onClick:()=>t("scrollable"),children:(0,i.jsx)("div",{children:"Scrollable content"})}),(0,i.jsx)(s.zx,{onClick:()=>t("plain"),children:(0,i.jsx)("div",{children:"Plain Dialog"})}),(0,i.jsx)(s.zx,{onClick:()=>t("confirmation"),children:(0,i.jsx)("div",{children:"Confirmation"})}),["center","above","below","before","after"].map(((e,a)=>(0,i.jsx)(s.zx,{onClick:()=>t("relative",e),children:(0,i.jsxs)("div",{children:["Sticky - ",e]})},a))),(0,i.jsx)("div",{id:"stickyDialogTest",children:"Sticky Dialogs anchor here"})]})}},7015:(e,t,a)=>{"use strict";a.d(t,{um:()=>ki,zj:()=>oi,$z:()=>Kt,zx:()=>F.z,yp:()=>fs,ls:()=>G,xV:()=>$s,g6:()=>us,Xo:()=>Gt,A7:()=>kn,WV:()=>Ii,C3:()=>js,DY:()=>sa,ri:()=>vs,h4:()=>na,Vk:()=>hn,Jd:()=>un,F8:()=>ni,U0:()=>Xn,Ip:()=>Rt,j9:()=>rn,t6:()=>Cn,eX:()=>Ct,TK:()=>bs,X6:()=>Yt,ok:()=>aa,tl:()=>is.tl,yC:()=>cn,XC:()=>tn,F2:()=>jt,u5:()=>ia.u,ko:()=>Ra,QF:()=>gn,B6:()=>ss,Pl:()=>ls,EA:()=>Sn,bg:()=>Mt,u9:()=>Le,Qp:()=>ca,RX:()=>ha,uU:()=>ce,gu:()=>Rn,v3:()=>Ue,A9:()=>Qt,hX:()=>ea,ey:()=>Tn,J4:()=>Nn,qm:()=>fn,vj:()=>qa,Su:()=>_a,K0:()=>Ma,I5:()=>ta,mQ:()=>la,iQ:()=>oa,a$:()=>Oa,ss:()=>da,_I:()=>Ia,Ay:()=>Dn,dg:()=>A,Is:()=>pn});var s,i,n,r,l,o=a(7294),c=a(5697),d=a.n(c);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},h.apply(this,arguments)}const u=e=>o.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 90.32 100"},e),s||(s=o.createElement("path",{fill:"#fff",d:"M45.1 100h-.51c-6.65-.43-14.31-4-21.59-10.17a59.4 59.4 0 0 1-10.16-11 33.8 33.8 0 0 1-4.8-9.35 180.48 180.48 0 0 1-4.45-21.93C2.14 38 .93 27.26.42 19.46L0 13.06l6.42-.18c8.47-.24 13.91-.91 18.77-2.33 5.11-1.49 10.06-4 16.55-8.26L45.2 0l3.43 2.32A57.18 57.18 0 0 0 64.09 10a72.79 72.79 0 0 0 19.81 2.88l6.42.18-.42 6.4c-.25 3.91-.69 8.65-1.27 13.72-.55 4.82-1.21 9.82-1.9 14.37a180.28 180.28 0 0 1-4.47 21.92c-1.93 6.46-7.52 14.07-15 20.35a48 48 0 0 1-13.88 8.45 26.63 26.63 0 0 1-7.56 1.7h-.69z"})),i||(i=o.createElement("path",{fill:"#494949",d:"M44.84 95.64c-5.71-.35-12.46-3.6-19-9.13a55 55 0 0 1-9.41-10.18 29.49 29.49 0 0 1-4.19-8.1A176.42 176.42 0 0 1 7.9 46.89c-1.43-9.42-2.63-20-3.13-27.72l-.12-1.89 1.9-.05c8.87-.25 14.63-1 19.87-2.5 5.58-1.62 10.86-4.25 17.73-8.81l1-.68 1 .69a61.32 61.32 0 0 0 16.65 8.26 77 77 0 0 0 21 3l1.9.05-.12 1.89c-.25 3.83-.68 8.5-1.25 13.51-.54 4.77-1.19 9.68-1.88 14.2a176.33 176.33 0 0 1-4.34 21.33c-1.67 5.6-6.88 12.6-13.6 18.28A43.7 43.7 0 0 1 51.9 94.2a22.33 22.33 0 0 1-6.32 1.44h-.74z"})),n||(n=o.createElement("path",{fill:"#bcbec0",d:"M45.16 7.72h.07v85.86s-6.77.42-16.91-7.7a50 50 0 0 1-11.66-13L44.72 8z"})),r||(r=o.createElement("path",{fill:"#d3d3d3",d:"M6.84 19.29c.51 7.6 1.69 18 3.1 27.3a167.65 167.65 0 0 0 4.27 21 23.57 23.57 0 0 0 2.45 5.28L44.72 8C37.94 12.45 32.6 15.08 27 16.71 21.61 18.28 15.76 19 6.84 19.29z"})),l||(l=o.createElement("path",{fill:"#87898e",d:"M62.19 16.16a63.06 63.06 0 0 1-17-8.39v85.81h.28A25.26 25.26 0 0 0 56 90a47.91 47.91 0 0 0 7.16-5c6.33-5.35 11.41-12.14 13-17.3a167.79 167.79 0 0 0 4.27-21c.16-1 .31-2.07.46-3.12C82 35 83 26.05 83.49 19.29a78.71 78.71 0 0 1-21.3-3.13z"})));var m,p,g,v,x,b,j,f;function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},y.apply(this,arguments)}const T=e=>o.createElement("svg",y({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 94.78 107.86"},e),m||(m=o.createElement("path",{fill:"#fff",stroke:"#fff",strokeMiterlimit:10,strokeWidth:7,d:"M90.77 4.63L76.41 8.26l-50.1 57.55-3.9-3.37a3.24 3.24 0 0 0-4.41.16l-3.57 2.8-.15.12-.13.15a3.24 3.24 0 0 0 .34 4.57l5.67 4.89L4.21 93.91a3 3 0 0 0 .35 4.23l6.48 5.5a3 3 0 0 0 4.23-.35L31.14 84.6l5 4.29a3.24 3.24 0 0 0 4.57-.34l.13-.15.1-.17 2.24-3.94a3.25 3.25 0 0 0-.49-4.38l-3.22-2.78 49.75-57.77z"})),p||(p=o.createElement("path",{fill:"none",stroke:"#494949",strokeMiterlimit:10,strokeWidth:4,d:"M88.48 7.27l-1.19 11.26-50.86 59.03-10.09-8.74L77.5 10.05l10.98-2.78z"})),g||(g=o.createElement("path",{fill:"#bebdbd",d:"M87.3 18.53l1.19-11.27-57.14 65.92 5.08 4.38L87.3 18.53z"})),v||(v=o.createElement("path",{fill:"#83807e",d:"M77.5 10.05l10.99-2.79L31.4 73.22l-5.06-4.41L77.5 10.05z"})),x||(x=o.createElement("path",{fill:"#6d2e0f",fillRule:"evenodd",d:"M13 103.36a2 2 0 0 1-1.29-.47L5.2 97.38a2 2 0 0 1-.2-2.82l19.82-23.38 9.53 8.09-19.84 23.38a2 2 0 0 1-1.53.71z"})),b||(b=o.createElement("path",{fill:"#230e06",d:"M24.93 72.59l8 6.8L13.75 102a1 1 0 0 1-1.41.12l-6.48-5.5a1 1 0 0 1-.12-1.41l19.2-22.62m-.23-2.82l-1.29 1.52L4.21 93.91a3 3 0 0 0 .35 4.23l6.48 5.5a3 3 0 0 0 4.23-.35l19.2-22.62 1.29-1.52-1.52-1.29-8-6.8-1.54-1.29z"})),j||(j=o.createElement("path",{fill:"#eac40a",d:"M38.4 88.62a2.25 2.25 0 0 1-1.46-.54L15.23 69.53a2.24 2.24 0 0 1-.23-3.16l.06-.08 3.69-2.91a2.24 2.24 0 0 1 3.09-.16l20.31 17.37a2.25 2.25 0 0 1 .32 3.07l-2.3 4.09-.06.07a2.24 2.24 0 0 1-1.71.79z"})),f||(f=o.createElement("path",{fill:"#937809",d:"M20.37 63.68a1.24 1.24 0 0 1 .81.3L41.5 81.35a1.24 1.24 0 0 1 .14 1.75l-2.3 4.08a1.24 1.24 0 0 1-1.75.14L15.88 68.77a1.24 1.24 0 0 1-.14-1.77l3.68-2.9a1.24 1.24 0 0 1 .94-.43m0-2a3.24 3.24 0 0 0-2.3 1l-3.56 2.77-.15.12-.13.15a3.24 3.24 0 0 0 .36 4.57l21.71 18.56a3.24 3.24 0 0 0 4.57-.36l.13-.15.1-.17 2.22-4a3.25 3.25 0 0 0-.51-4.38L22.47 62.46a3.24 3.24 0 0 0-2.11-.78z"})));var N;function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},C.apply(this,arguments)}const S=e=>o.createElement("svg",C({viewBox:"0 0 100.7 88.86"},e),N||(N=o.createElement("path",{fill:"#fff",d:"M52.32.06v7.59C70.46 9.49 87.18 21.21 87.09 41 87 70.87 49.74 76.16 37.66 50.52l16.14-4.18-31.88-30.82L0 57l16-3.09c9.33 29.64 44 47.85 70 24C118.13 48.55 93.31-2 52.32.06z"})));var k;function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},w.apply(this,arguments)}const E=e=>o.createElement("svg",w({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 81.41"},e),k||(k=o.createElement("g",{fill:"#fff"},o.createElement("path",{d:"M42.77 81.28h54.85v-5.21H55.35L100 31.41 68.64.05 61.22 0l31.41 31.41-49.86 49.87z"}),o.createElement("path",{d:"M5.89 54.15l25.79 27.26h8.55l49.95-49.9L59.36.69zm5.47.39l29.86-29.85 24.55 24.56L35.92 79.1zM0 81.28h17.37l-5.12-5.21H0"}))));var R=a(9394),I=a(9208),O=a(1809),_=a(5893);class A extends o.Component{static displayName="TribeSelection";constructor(e){super(e);const t=Travian.Constants.TRIBE_ID;let a=[t.roman,t.teuton,t.gaul,t.natar],s=[t.roman,t.teuton,t.gaul,t.nature,t.natar],i=[t.roman,t.teuton,t.gaul,t.nature],n=t.gaul;[t.egyptian,t.hun,t.spartan].filter((e=>Object.values(Travian.Variables.tribeIds).includes(e))).forEach((e=>{[a,s,i].forEach((t=>t.splice(n,0,e))),n++})),this.tribeSets={attack:a,defence:s,reinforcement:i}}render(){const{role:e,memberId:t,active:a,tribeSwitchCallback:s,defenderTribeId:i}=this.props;return"reinforcement"===e&&i===Travian.Constants.TRIBE_ID.nature?null:(0,_.jsx)("div",{className:`tribeSelection ${e}`,children:(0,_.jsx)("div",{className:"tribeWrapper",children:this.tribeSets[e].filter((e=>!(i===Travian.Constants.TRIBE_ID.nature&&e===Travian.Constants.TRIBE_ID.nature))).map(((i,n)=>(0,_.jsxs)("div",{className:i!==a?"inactive":"active",onClick:()=>s(e,t,i),children:[(0,_.jsx)("i",{className:["tribeIcon",`${"reinforcement"!==e?"big":"small"}Tribe${i}`,i!==a?"inactive":"active"].join(" "),title:(0,O.Jh)(`allgemein.v${i}`)}),"reinforcement"===e&&(0,_.jsxs)("svg",{viewBox:"0 0 8 8",children:[(0,_.jsx)("circle",{cx:"4",cy:"4",r:"4"}),(0,_.jsx)("line",{x1:"2",y1:"4",x2:"6",y2:"4"}),(0,_.jsx)("line",{x1:"4",y1:"2",x2:"4",y2:"6"})]})]},n)))})})}}var D=a(4229);const L=e=>{const{gameData:t}=(0,o.useContext)(D._),{active:a,tribe:s,movementSwitchCallback:i}=e,n=Object.keys(t.attackTypes).reduce(((e,a)=>(e.push(t.attackTypes[a]),e)),[]);return(0,_.jsx)("div",{className:"movement",children:n.map((e=>(0,_.jsxs)("label",{children:[(0,_.jsx)("input",{type:"radio",name:"movement",value:e,disabled:s===Travian.Constants.TRIBE_ID.natar,checked:a===e,onChange:e=>i(e.target.value)}),(0,O.Jh)("combatSimulator."+e)]},e)))})};L.propTypes={active:d().string,movementSwitchCallback:d().func.isRequired};var P=a(3810),B=a.n(P),M=a(6358),J=a(6546),Z=a.n(J),F=a(2623);const V=["t1","t2","t3","t4","t5","t6","t7","t8","t9","t10"],H=["t1","t2","t3","t4","t5","t6","t7","t8","t9","t10","t11"],q=["t1","t2","t3","t4","t5","t6","t7","t8","celebration"],U=e=>{const{gameData:t}=(0,o.useContext)(D._),{tribe:a,callbackTroopUnitUpdate:s,callbackHeroUpdate:i}=e,{troopIDs:n}=t,r=n["v"+a];return(0,_.jsxs)("tr",{className:"troopIcons",children:[(0,_.jsx)("th",{}),V.map((e=>(0,_.jsx)("td",{children:(0,_.jsx)("i",{className:`unit u${r[e]}`,title:(0,O.Jh)(`truppen.tid${r[e]}`),onClick:s.bind(null,e)})},e))),(0,_.jsx)("td",{children:a!==Travian.Constants.TRIBE_ID.nature&&a!==Travian.Constants.TRIBE_ID.natar&&(0,_.jsx)("i",{className:["unit","uhero"].join(" "),title:(0,O.Jh)("truppen.hero"),onClick:i})})]})};U.propTypes={tribe:d().number.isRequired,callbackTroopUnitUpdate:d().func,callbackHeroUpdate:d().func},U.defaultProps={callbackTroopUnitUpdate:()=>{},callbackHeroUpdate:()=>{}};class z extends o.Component{constructor(e){super(e),this.callbackTroopUnitUpdate=(e,t)=>this.props.callbacks.troopUnitUpdate(this.props.roleId,this.props.role,this.props.memberId,t,(0,O.iA)(e.target.value,0)),this.callbackHeroUpdate=e=>this.props.callbacks.heroUpdate(this.props.roleId,this.props.role,this.props.memberId,e.target.checked)}render(){const{data:e,heroIsEnabled:t,tribe:a}=this.props;return(0,_.jsxs)("tr",{className:"troopUnits",children:[(0,_.jsx)("th",{children:(0,_.jsx)("i",{className:"troopCount_small",title:(0,O.Jh)("combatSimulator.troopUnits")})}),V.map((t=>{const a=e&&e[t]||"";return(0,_.jsx)("td",{children:(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:`uni${t}`,className:`uni${t}`,value:a,maxLength:"11",onChange:e=>this.callbackTroopUnitUpdate(e,t)})},t)})),(0,_.jsx)("td",{children:(0,_.jsx)("input",{type:"checkbox",name:"hero",className:["hero",a===Travian.Constants.TRIBE_ID.nature||a===Travian.Constants.TRIBE_ID.natar?"hidden":"shown"].join(" "),checked:t,onChange:this.callbackHeroUpdate})})]})}}class $ extends o.Component{static MAX_LEVEL_BLACKSMITH=20;static contextType=D._;constructor(e){super(e),this.callbackTroopLevelUpdate=(e,t)=>this.props.callbacks.troopLevelUpdate(this.props.roleId,this.props.role,this.props.memberId,t,(0,O.iA)(e.target.value,0,$.MAX_LEVEL_BLACKSMITH)),this.callbackBonusUpdate=e=>this.props.callbacks.bonusUpdate(this.props.roleId,this.props.role,"celebration",e.target.checked),this.callbackCatapultTargetUpdate=(e,t)=>this.props.callbacks.catapultTargetUpdate(this.props.roleId,this.props.role,this.props.memberId,t,(0,O.iA)(e.target.value,0))}render(){const{role:e,data:t,celebration:a,cataUnits:s,cataLevels:i,movement:n,tribe:r}=this.props,{secondCataTargetThreshold:l}=this.context.gameData,o=!s||s<l;return(0,_.jsxs)("tr",{className:"troopLevels",children:[(0,_.jsx)("th",{children:(0,_.jsx)("i",{className:"troopLevel_small",title:(0,O.Jh)("combatSimulator.troopLevels")})}),q.map((c=>(0,_.jsxs)("td",{className:c,colSpan:"celebration"===c?3:"",children:["celebration"!==c&&(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:`uni${c}`,className:`uni${c}`,value:t&&t[c]||"",onChange:e=>this.callbackTroopLevelUpdate(e,c)}),"celebration"===c&&r!==Travian.Constants.TRIBE_ID.nature&&r!==Travian.Constants.TRIBE_ID.natar&&0===this.props.memberId&&(0,_.jsxs)("div",{children:[(0,_.jsx)("i",{className:"celebration_small",title:(0,O.Jh)("gid24.fest")}),(0,_.jsx)("input",{type:"checkbox",name:"celebration",className:"celebration_small",checked:a,onChange:this.callbackBonusUpdate})]}),c===Travian.Constants.TROOP_NUMBER_TYPES.catapult&&e===G.roles.ATTACK&&r!==Travian.Constants.TRIBE_ID.natar&&s>0&&(0,_.jsxs)("div",{className:["cataLevels","attack"===n?"shown":"hidden"].join(" "),children:[(0,_.jsxs)("div",{className:"cata1",children:[(0,_.jsx)("i",{className:"target",title:(0,O.Jh)("combatSimulator.cataTarget1")}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"cata1",value:i[0]||"",onChange:e=>this.callbackCatapultTargetUpdate(e,0)})]}),(0,_.jsxs)("div",{className:"cata2",children:[(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"cata2",value:i[1]||"",className:o?"disabled":"",disabled:o,title:o?(0,O.Jh)("combatSimulator.cataDisabled",{NUM:l}):null,onChange:e=>this.callbackCatapultTargetUpdate(e,1)}),(0,_.jsx)("i",{className:"target",title:(0,O.Jh)("combatSimulator.cataTarget2")})]})]})]},c)))]})}}const W=e=>{const{rowClass:t,troops:a,extendedView:s,tribe:i}=e,n=i!==Travian.Constants.TRIBE_ID.nature&&i!==Travian.Constants.TRIBE_ID.natar?H:V;return(0,_.jsxs)("tr",{className:t,children:[(0,_.jsxs)("th",{children:["troopsInitial"===t&&(0,_.jsx)("i",{className:"troopCount_small",title:(0,O.Jh)("combatSimulator.initial")}),"troopsLoss"===t&&(0,_.jsx)("i",{className:"troopDead_small",title:(0,O.Jh)("combatSimulator.loss")}),"troopsCaptured"===t&&(0,_.jsx)("i",{className:"unit_small gaul trap",title:(0,O.Jh)("combatSimulator.captured")}),"troopsRevived"===t&&(0,_.jsx)("i",{className:"bandage",title:(0,O.Jh)("combatSimulator.revived")}),"troopsWounded"===t&&(0,_.jsx)("i",{className:"troopWounded_small",title:(0,O.Jh)("combatSimulator.wounded")})]}),("troopsInitial"===t||"troopsResult"===t||"troopsRevived"===t)&&n.map((e=>(0,_.jsx)("td",{className:`uni${e}`,children:(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:""+(a[e]>99999&&!s?(0,O.kT)(a[e]):void 0!==a[e]?(0,O.eJ)(a[e],{grouping:!0}):0)}})},e))),("troopsLoss"===t||"troopsWounded"===t)&&n.map((e=>(0,_.jsx)("td",{className:`uni${e}`,children:(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:a[e]<-99999&&!s?(0,O.kT)(a[e]):void 0!==a[e]?(0,O.eJ)(a[e],{grouping:!0}):0}})},e))),"troopsCaptured"===t&&n.map((e=>(0,_.jsx)("td",{className:`uni${e}`,children:(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:a[e]>99999&&!s?(0,O.kT)(a[e]):void 0!==a[e]?(0,O.eJ)(-1*a[e],{grouping:!0}):0}})},e)))]})};M.ZP.registerPlugin(Z());class G extends o.Component{static displayName="CombatSimulator";static propTypes={gameData:d().shape({itemTypes:d().object.isRequired,attackTypes:d().shape({ATTACK:d().string.isRequired,RAID:d().string.isRequired}),bonus:d().shape({power:d().object.isRequired}).isRequired}),playerData:d().shape({tribe:d().number.isRequired,heroEquipment:d().object,villages:d().array,currentVillage:d().shape({did:d().number,name:d().string,wall:d().number,watchTowers:d().number,brewery:d().number,palace:d().number,stonemason:d().number,celebration:d().bool,spyArtefact:d().number,buildingMasterArtefact:d().number}),troops:d().object,allianceBonus:d().number}).isRequired,inputData:d().shape({type:d().string,myRole:d().string,attack:d().object,defence:d().object})};static roles={ATTACK:"attack",DEFENCE:"defence"};static DEFAULT_HERO={enabled:!1,health:100,strength:0,power:100,defPoints:0,offPoints:0,horse:!1,equipment:{}};static HERO_HEALTH_WARNING_THRESHOLD=2;static DEFAULT_TARGET_LEVEL=20;static defaultProps={};static getSettingsDestination(e,t,a=0){const s=e[t];return null!==a?s.forces[a]:s}static attack=(e,t=0)=>G.getSettingsDestination(e,G.roles.ATTACK,t);static defence=(e,t=0)=>G.getSettingsDestination(e,G.roles.DEFENCE,t);static formatCombatMemberData=(e,t,a=0,s=null)=>{let i=Object.assign({},e[t]);return i.combatMember=s?Object.assign({},s):i.forces[a],i.type=e.type,delete i.forces,i};static makeDefaultTroops=()=>{const e={amounts:{},levels:{}};return V.forEach((t=>{e.amounts[t]=0,e.levels[t]=0})),e};static makeEquipmentSelectedObject=e=>e.hero.equipment&&e.hero.equipment.selected&&Object.keys(e.hero.equipment.selected).length?e.hero.equipment.selected:{};static reinforcementIsImpossible=e=>{const t=G.getSettingsDestination(e,G.roles.DEFENCE);return t.tribe===Travian.Constants.TRIBE_ID.natar||t.tribe===Travian.Constants.TRIBE_ID.nature};static assignTroops=e=>Object.assign({},e,{amounts:Object.assign({},e.amounts),levels:Object.assign({},e.levels)});static sanitizeHeroEquipment(e,t=!1){const a=Object.keys(e.selected||{});Object.keys(e).forEach((s=>{if(!isNaN(s)){if(s=parseInt(s),!t)for(let t=0;t<a.length;t++)if(e.selected[a[t]]===s)return;delete e[s]}}))}static isReinforcementAddedManually(e){return!e.predefined}static flushArtifacts(e){e.spyArtefact=0,e.buildingMasterArtefact=0,e.allyBonus=0}static flushHero(e){e.hero=Object.assign({},e.hero||{},{enabled:!1}),e.troops.amounts=Object.assign({},e.troops.amounts,{t11:0})}static prepareHeroEquipment(e){const t=e.equipment.selected||{};let a={};Object.keys(t).forEach((s=>{let i=t[s];""!==i&&(a[s]={itemTypeId:i,amount:+e.equipment[i]})})),e.selectedItems=a}static areArraysEqual(e,t){if(e.length!==t.length)return!1;const a="NOT_EQUAL";try{e.forEach(((e,s)=>{if(void 0===t[s]||e!==t[s])throw new Error(a)}))}catch(e){if(e.message===a)return!1;throw e}}shouldArtifactsBeFlushed(e){return[Travian.Constants.TRIBE_ID.natar,Travian.Constants.TRIBE_ID.nature].indexOf(e)>=0}shouldHeroBeFlushed(e){return[Travian.Constants.TRIBE_ID.natar,Travian.Constants.TRIBE_ID.nature].indexOf(e)>=0}sanitizeBeforeSend(e){const t=Object.assign({},e),a=G.attack(t);let s=Object.assign({},a,{troops:G.assignTroops(a.troops)});t.attack=Object.assign({},t.attack,{forces:[s]});const i=G.defence(t);return t.defence=Object.assign({},t.defence),(!Travian.Variables.keepVidOnConquer&&s.tribe!==Travian.Constants.TRIBE_ID.teuton||Travian.Variables.keepVidOnConquer&&s.tribe===Travian.Constants.TRIBE_ID.natar)&&(t.attack.brewery=0),t.type!==this.props.gameData.attackTypes.RAID&&(s.troops.amounts.t8?(s.catapultTargets&&s.catapultTargets.length?2===s.catapultTargets.length&&!s.catapultTargets[0]&&s.catapultTargets[1]&&(a.catapultTargets=[s.catapultTargets[1]],s.catapultTargets=[s.catapultTargets[1]]):(s.catapultTargets=[G.DEFAULT_TARGET_LEVEL],a.catapultTargets=[G.DEFAULT_TARGET_LEVEL]),2===s.catapultTargets.length&&0===s.catapultTargets[1]&&(a.catapultTargets=[s.catapultTargets[0]],s.catapultTargets=[s.catapultTargets[0]]),G.attack(t).catapultTargets=s.catapultTargets.slice()):(s=Object.assign({},s,{catapultTargets:[]}),a.catapultTargets=[])),t.type===this.props.gameData.attackTypes.RAID&&(s=Object.assign({},s,{catapultTargets:[],troops:Object.assign({},s.troops)}),t.defence.buildingMasterArtefact&&(t.defence.buildingMasterArtefact=0)),t.attack.forces=[s],i.tribe!==Travian.Constants.TRIBE_ID.gaul&&(t.defence.traps=0),i.tribe===Travian.Constants.TRIBE_ID.nature&&(t.defence.forces=[t.defence.forces[0]]),t.defence.forces=t.defence.forces.filter((e=>!e.inactive)),this.shouldArtifactsBeFlushed(s.tribe)&&G.flushArtifacts(t.attack),this.shouldArtifactsBeFlushed(i.tribe)&&G.flushArtifacts(t.defence),t.attack.forces.forEach((e=>{this.shouldHeroBeFlushed(e.tribe)&&G.flushHero(e),G.prepareHeroEquipment(e.hero)})),t.defence.forces.forEach((e=>{this.shouldHeroBeFlushed(e.tribe)&&G.flushHero(e),G.prepareHeroEquipment(e.hero)})),t}constructor(e){super(e),this.scrollTrigger=null,this.simulateWrapper=null;const t=this.props.playerData.currentVillage,a=Object.assign({},this.props.playerData.troops);this._makeHero=()=>{const{hero:e,heroEquipment:t}=this.props.playerData;return Object.assign({},e,{enabled:e&&e.enabled||!1,equipment:Object.assign({},t)})};let s=Object.assign({},a[t.did]);s.own=G.assignTroops(s.own),this.simulationSettings={myRole:G.roles.ATTACK,type:this.props.gameData.attackTypes.RAID,[G.roles.ATTACK]:{brewery:t.brewery||0,allyBonus:this.props.playerData.allianceBonus||0,spyArtefact:t.spyArtefact||0,celebration:void 0!==t.celebration&&!!t.celebration,forces:[{tribe:this.props.playerData.currentVillage.vid,troops:Object.assign(G.makeDefaultTroops(),Object.assign({},s.own)),hero:this._makeHero(),catapultTargets:[]}],buildingMasterArtefact:t.buildingMasterArtefact||0,wall:t.wall||0,watchTowers:t.watchTowers||0,palace:t.palace||0,stonemason:t.stonemason||0,traps:t.traps||0},[G.roles.DEFENCE]:{brewery:0,allyBonus:0,spyArtefact:0,celebration:!1,forces:[this._makeDefender(Object.assign({},G.DEFAULT_HERO,{power:this.calculatePowerBonus(0,Travian.Constants.TRIBE_ID.roman),catapultTargets:[]}))],buildingMasterArtefact:0,wall:0,watchTowers:0,palace:0,stonemason:0,traps:0}};let i=!0,n=[!0];if(this.hasReportInput=()=>this.props.inputData&&Object.keys(this.props.inputData).length>0,this.hasReportInput()){i=!1;const e=this.props.inputData;if(void 0!==e.myRole&&(this.simulationSettings.myRole=e.myRole),void 0!==e.type&&(this.simulationSettings.type=e.type),void 0!==e[G.roles.ATTACK]){const t=e[G.roles.ATTACK];e.myRole!==G.roles.ATTACK&&this.props.playerData.allianceBonus&&(this.simulationSettings[G.roles.ATTACK].allyBonus=0,this.simulationSettings[G.roles.DEFENCE].allyBonus=this.props.playerData.allianceBonus),void 0!==t.forces&&t.forces instanceof Array&&t.forces.length?(void 0!==t.forces[0].tribe&&(this.simulationSettings[G.roles.ATTACK].forces[0].tribe=parseInt(t.forces[0].tribe)),this.simulationSettings[G.roles.ATTACK].forces[0].hero=Object.assign({},this.simulationSettings[G.roles.ATTACK].forces[0].hero,t.forces[0].hero),void 0!==t.forces[0].troops&&(void 0!==t.forces[0].troops.amounts&&(this.simulationSettings[G.roles.ATTACK].forces[0].troops.amounts=t.forces[0].troops.amounts),void 0!==t.forces[0].troops.levels&&(this.simulationSettings[G.roles.ATTACK].forces[0].troops.levels=t.forces[0].troops.levels))):this.simulationSettings[G.roles.ATTACK].forces=[this._makeDefender(G.DEFAULT_HERO)]}if(void 0!==e[G.roles.DEFENCE]){n=[];let t=e[G.roles.DEFENCE];void 0!==t.wall&&(this.simulationSettings[G.roles.DEFENCE].wall=t.wall),void 0!==t.watchTowers&&(this.simulationSettings[G.roles.DEFENCE].watchTowers=t.watchTowers),void 0!==t.palace&&(this.simulationSettings[G.roles.DEFENCE].palace=t.palace),void 0!==t.stonemason&&(this.simulationSettings[G.roles.DEFENCE].stonemason=t.stonemason),void 0!==t.forces&&t.forces instanceof Array&&(this.simulationSettings[G.roles.DEFENCE].forces=[],t.forces.map((e=>{let t=Object.assign({},e.troops);Object.keys(t.amounts).length||delete t.amounts,this.simulationSettings[G.roles.DEFENCE].forces.push({tribe:parseInt(e.tribe),troops:Object.assign({},G.makeDefaultTroops(),t),hero:Object.assign({},G.DEFAULT_HERO,{enabled:e.troops.amounts&&e.troops.amounts.t11>0})}),n.push(!0)})),this.simulationSettings[G.roles.DEFENCE].forces.length||(this.simulationSettings[G.roles.DEFENCE].forces=[this._makeDefender(G.DEFAULT_HERO)]),this.simulationSettings[G.roles.DEFENCE].forces[0].hero=Object.assign({},this.simulationSettings[G.roles.DEFENCE].forces[0].hero,t.forces[0].hero))}this.simulationSettings.myRole===G.roles.DEFENCE&&(this.simulationSettings[G.roles.DEFENCE].forces[0].troops.levels=Object.assign({},this.simulationSettings[G.roles.ATTACK].forces[0].troops.levels),this.simulationSettings[G.roles.ATTACK].forces[0].troops.levels={}),this.simulationSettings.myRole===G.roles.DEFENCE&&(this.simulationSettings[G.roles.DEFENCE].brewery=this.simulationSettings[G.roles.ATTACK].brewery,this.simulationSettings[G.roles.ATTACK].brewery=0)}const r=this._makeDefendersByVillage(a,i);this.getSimulationSettings=()=>this.sanitizeBeforeSend(Object.assign({},this.state.simulationSettings)),this._makeVillagesById(),this.state={roleId:null,simulationSettings:this.simulationSettings,lastSimulationSettings:null,calculating:!1,simulationAllowed:!1,simulationButtonTooltip:"",response:null,responseTimeStamp:0,lastReloadData:G.getReloadSignature(this.simulationSettings,this.simulationSettings.myRole),reloadAllowed:!1,lastClearData:null,clearAllowedByRole:{[G.roles.ATTACK]:this.isAttackerClearable(this.simulationSettings),[G.roles.DEFENCE]:n},currentVillage:t},this.state=Object.assign(this.state,this.makeSimulationAllowedObject()),this.simulate=this.simulate.bind(this),this.onFormSubmit=this.onFormSubmit.bind(this),this.simulationAllowedCheck=this.simulationAllowedCheck.bind(this),this.switchRole=this.switchRole.bind(this),this.callbacks={switchMovement:this.switchMovement.bind(this),switchTribe:this.switchTribe.bind(this),buildingValuesUpdate:this.buildingValuesUpdate.bind(this),bonusUpdate:this.bonusUpdate.bind(this),troopUnitSet:this.troopUnitSet.bind(this),troopUnitUpdate:this.troopUnitUpdate.bind(this),troopLevelUpdate:this.troopLevelUpdate.bind(this),heroUpdate:this.heroUpdate.bind(this),catapultTargetUpdate:this.catapultTargetUpdate.bind(this),heroDataUpdate:this.heroDataUpdate.bind(this),heroEquipmentUpdate:this.heroEquipmentUpdate.bind(this),clearData:this.clearData.bind(this),addReinforcement:this.addReinforcement.bind(this),removeReinforcement:this.removeReinforcement.bind(this),setCurrentVillage:this.setCurrentVillage.bind(this),reload:this.reload.bind(this),calculatePowerBonus:this.calculatePowerBonus.bind(this),applyLosses:this.applyLosses.bind(this)},this._prepareDefenders=(e,t,a,s=!1)=>{let i=[Object.assign({},e,{troops:Object.assign({},e.troops)})];t&&r[t]&&!this.hasReportInput()&&(i=i.concat(r[t].slice(1).map((e=>Object.assign({},e,{troops:G.assignTroops(e.troops)})))));const n=G.defence(this.simulationSettings,null).forces;return i=i.concat(n.slice(i.length)),s&&(i=i.filter(((e,t)=>!(t>0)||e.predefined))),i.map(((e,s)=>(s>0&&(e.addedBy&&(e.inactive=a!==e.addedBy||e.villageId&&e.villageId!==t),e.hero=Object.assign(G.DEFAULT_HERO,e.hero)),e))),i}}render(){const{playerData:e}=this.props,{simulationSettings:t,response:a,simulationButtonTooltip:s,currentVillage:i,reloadAllowed:n,clearAllowedByRole:r,roleId:l}=this.state,o=G.formatCombatMemberData(t,G.roles.ATTACK),c=this._formatPlayerData(G.roles.ATTACK,e,o.combatMember.hero.equipment),d=(0,O.Jh)("combatSimulator.playAs"+(t.myRole===G.roles.ATTACK?"Defender":"Attacker"));return(0,_.jsxs)("div",{id:"combatSimulator",children:[(0,_.jsx)("p",{className:"description",children:(0,O.Jh)("combatSimulator.introductionText")}),(0,_.jsxs)("form",{id:"combatSimulatorForm",onKeyPress:this.onFormSubmit,autoComplete:"off",children:[(0,_.jsx)("div",{id:"switchRoleWrapper",className:"switchRoleWrapper",children:(0,_.jsx)("button",{onClick:this.switchRole,className:"switch textButtonV1 "+(t.myRole===G.roles.DEFENCE?"attacker":"defender"),children:d})}),(0,_.jsx)(ce,{activeRoleId:l,type:G.roles.ATTACK,selectedByPlayer:c.selectedByPlayer,villages:c.villages,currentVillage:i,heroEquipment:c.heroEquipment,roles:G.roles,simulationSettings:o,reloadAllowed:n,clearAllowed:!!r[G.roles.ATTACK],callbacks:this.callbacks}),t[G.roles.DEFENCE].forces.map(((a,s)=>{if(s>0&&(G.reinforcementIsImpossible(t)||!0===a.inactive))return null;const o=G.formatCombatMemberData(t,G.roles.DEFENCE,s,a),c=this._formatPlayerData(G.roles.DEFENCE,e,o.combatMember.hero.equipment);return(0,_.jsx)(ce,{activeRoleId:l,type:G.roles.DEFENCE,memberId:s,selectedByPlayer:0===s&&c.selectedByPlayer,villages:c.villages,currentVillage:i,heroEquipment:c.heroEquipment||{selected:{}},roles:G.roles,simulationSettings:o,reloadAllowed:n,clearAllowed:!!r[G.roles.DEFENCE][s],callbacks:this.callbacks},s)})),t[G.roles.DEFENCE].forces[0].tribe!==Travian.Constants.TRIBE_ID.natar&&(0,_.jsx)(A,{role:"reinforcement",defenderTribeId:t[G.roles.DEFENCE].forces[0].tribe,tribeSwitchCallback:(e,a,s)=>this.callbacks.addReinforcement(s,t.myRole===G.roles.DEFENCE&&i?i.did:null)})]}),(0,_.jsx)("div",{id:"simulatePin",children:(0,_.jsx)("div",{id:"simulateWrapper",className:"simulateWrapper",ref:e=>this.simulateWrapper=e,children:(0,_.jsx)(F.z,{id:"simulate",className:"simulate",disabledAttribute:!this.state.simulationAllowed,onClick:this.simulate,title:(0,O.Jh)(s),children:(0,O.Jh)("combatSimulator.simulate")})})}),null!==a&&(0,_.jsx)(Le,{simulationSettings:t,data:a,playerRole:t.myRole,roles:G.roles,responseTimeStamp:this.state.responseTimeStamp,applyLosses:this.callbacks.applyLosses,currentVillage:this.state.currentVillage,playerData:this.props.playerData,inputData:this.props.inputData})]})}componentDidUpdate(){Travian.Tip.refresh(),null!==this.scrollTrigger&&this.scrollTrigger.refresh()}componentDidMount(){{let e=this;e.scrollTrigger=Z().create({trigger:"#simulatePin",start:"top bottom",endTrigger:"#contentOuterContainer",end:"bottom up",toggleClass:{targets:this.simulateWrapper,className:"pinned"}}),document.getElementsByClassName("contentContainer")[0].addEventListener("scroll",(function(){e.scrollTrigger.refresh()}))}}_makeDefender(e=this.props.playerData.hero){return{tribe:Travian.Constants.TRIBE_ID.roman,troops:G.makeDefaultTroops(),hero:Object.assign({},e,{enabled:!1,equipment:{}}),catapultTargets:[]}}_makeDefendersByVillage(e,t=!0){const a={};return this.props.playerData.villages.forEach((s=>{a[s.did]||(a[s.did]=[]),e[s.did].own&&a[s.did].push(Object.assign({},this._makeDefender(),{troops:Object.assign({},e[s.did].own)})),e[s.did].reinforcements&&e[s.did].reinforcements.length&&e[s.did].reinforcements.map((e=>{const i=Object.assign({},this._makeDefender(),{troops:Object.assign({},e),tribe:e.tribe,hero:Object.assign({},e.hero||{},{enabled:e.heroEnabled,equipment:e.hero&&e.hero.equipment||{}}),villageId:s.did,predefined:!0});t&&(i.addedBy=G.roles.DEFENCE),a[s.did].push(i)}))})),a}_makeVillagesById(){this.villagesById={},this.props.playerData.villages.forEach((e=>{this.villagesById[e.did]=e}))}_formatPlayerData(e,t,a=null){const s=this.state.simulationSettings.myRole===e;return{selectedByPlayer:s,villages:s?t.villages:[],heroEquipment:a}}onFormSubmit(e){13===e.which&&(e.preventDefault(),this.simulate())}switchMovement(e,t){this.setState((a=>{let s=Object.assign({},a.simulationSettings);return s.type=t,{simulationSettings:s,roleId:e}}),(()=>{this.clearAllowedCheck(),this.simulationAllowedCheck()}))}switchTribe(e,t,a,s){this.setState((i=>{const n=Object.assign({},i.simulationSettings);return G.getSettingsDestination(n,t,a).tribe=s,s===Travian.Constants.TRIBE_ID.natar&&t===G.roles.ATTACK&&(n.type=G.roles.ATTACK),{simulationSettings:n,roleId:e}}),(()=>{this.reloadAllowedCheck(t),this.simulationAllowedCheck()}))}bonusUpdate(e,t,a,s){this.setState((i=>{let n;"boolean"==typeof s?n=s:(n=parseFloat(s),isNaN(n)&&(n=0));const r=Object.assign({},i.simulationSettings);return r[t][a]=n,{simulationSettings:r,roleId:e}}),(()=>{this.fullButtonStatusCheck(t)}))}buildingValuesUpdate(e,t,a,s){s=parseInt(s),isNaN(s)&&(s=0),this.bonusUpdate(e,t,a,s)}troopUnitSet(e,t,a,s){const i=Object.assign({},this.state.simulationSettings),n=G.getSettingsDestination(i,t,a).troops.amounts[s];let r=0;if(this.state.currentVillage&&this.state.currentVillage.did){const e=this.state.currentVillage.did,t=this.props.playerData.troops[e].own.amounts;r=n>0?0:t[s]}this.troopUnitUpdate(e,t,a,s,r)}troopUnitUpdate(e,t,a,s,i){this.setState((n=>{const r=Object.assign({},n.simulationSettings);let l=i;return isNaN(l)&&(l=0),G.getSettingsDestination(r,t,a).troops.amounts[s]=l,{simulationSettings:r,roleId:e}}),(()=>{this.fullButtonStatusCheck(t,a)}))}troopLevelUpdate(e,t,a,s,i){const n=Object.assign({},this.state.simulationSettings);let r=i;isNaN(r)&&(r=0),G.getSettingsDestination(n,t,a).troops.levels[s]=r,this.setState({simulationSettings:n,roleId:e},(()=>{this.fullButtonStatusCheck(t,a)}))}heroUpdate(e,t,a,s){const i=Object.assign({},this.state.simulationSettings),n=G.getSettingsDestination(i,t,a);n.hero.enabled=!!s,n.hero.enabled?n.troops.amounts.t11=1:delete n.troops.amounts.t11,this.setState({simulationSettings:i,roleId:e},(()=>{this.fullButtonStatusCheck(t,a)}))}catapultTargetUpdate(e,t,a,s,i){this.setState((n=>{const r=Object.assign({},n.simulationSettings);let l=i;return isNaN(l)&&(l=0),G.getSettingsDestination(r,t,a).catapultTargets[s]=l,{simulationSettings:r,roleId:e,clearAllowedByRole:this.getClearAllowedByRole(Object.assign({},n,{simulationSettings:r}),t,a)}}),(()=>{this.simulationAllowedCheck()}))}heroDataUpdate(e,t,a,s,i){const n=Object.assign({},this.state.simulationSettings);G.getSettingsDestination(n,t,a).hero[s]=i,this.setState({simulationSettings:n,roleId:e},(()=>{this.fullButtonStatusCheck(t,a)}))}simulate(){if(this.state.simulationAllowed){let e=Object.assign({},this.state);const t=this.state.simulationSettings.attack.forces[0].catapultTargets,a=Object.assign({},e.simulationSettings),s={data:this.sanitizeBeforeSend(a),success:e=>{this.setState({response:e,responseTimeStamp:(new Date).getTime(),calculating:!1},(()=>{this.simulationAllowedCheck(),jQuery("html, body, .contentContainer").animate({scrollTop:jQuery("#combatSimulator").find(".results").offset().top},1e3)}))},error:e=>{Travian.defaultErrorFunction(e),this.setState({response:null,calculating:!1,simulationAllowed:!0})}};let i={calculating:!0,simulationAllowed:!1,lastSimulationSettings:B()(JSON.stringify(a))};const n=a.attack.forces[0].catapultTargets;G.areArraysEqual(t,n)||(i=Object.assign(i,{simulationSettings:a,roleId:`${G.roles.ATTACK}_0`})),this.setState(i),Travian.api("combatSimulator",s)}}makeSimulationAllowedObject(e=null){let t={simulationAllowed:!0,simulationButtonTooltip:"combatSimulator.simulate",roleId:null};if((e=e||this.state).calculating)return t.simulationAllowed=!1,t;const a=B()(JSON.stringify(e.simulationSettings));if(e.lastSimulationSettings===a)return t.simulationAllowed=!1,t.simulationButtonTooltip="combatSimulator.nothingChanged",t;let s=!0;(!e.simulationSettings[G.roles.ATTACK].forces[0].hero.enabled||e.simulationSettings[G.roles.ATTACK].forces[0].hero.health<=0)&&(s=!1);let i=e.simulationSettings[G.roles.ATTACK].forces[0].troops.amounts;const n=Object.keys(i).reduce(((e,t)=>e||i[t]>0),!1);return s||n||(t.simulationAllowed=!1,t.simulationButtonTooltip="combatSimulator.attackerNotSufficientData"),t}simulationAllowedCheck(){this.setState(this.makeSimulationAllowedObject())}heroEquipmentUpdate(e,t,a,s,i=!0,n=!1){if("bag"===a&&!i){const a=G.getSettingsDestination(this.state.simulationSettings,e,t);if(!(a&&a.hero&&a.hero.equipment&&a.hero.equipment.selected&&void 0!==a.hero.equipment.selected.bag))return void this.setState((a=>{const s=Object.assign({},a.simulationSettings),i=s[e].forces[t].hero.equipment;if(a.simulationSettings.attack.forces[0].hero.equipment&&void 0!==a.simulationSettings.attack.forces[0].hero.equipment.bag){delete i[a.simulationSettings.attack.forces[0].hero.equipment.selected.bag]}return i.selected&&void 0!==i.selected.bag&&delete i.selected.bag,{simulationSettings:s}}))}this.setState((r=>{const l=Object.assign({},r),o=G.getSettingsDestination(l.simulationSettings,e,t);return o.hero.equipment[s]=i,o.hero.equipment.selected=G.makeEquipmentSelectedObject(o),o.hero.equipment.selected[a]=i||n?s:"",G.sanitizeHeroEquipment(o.hero.equipment),l}),(()=>{this.fullButtonStatusCheck(e,t)}))}clearData(e,t,a){this.setState((s=>{const i=Object.assign({},s.simulationSettings);i[t].forces[a]=Object.assign({},i[t].forces[a],{troops:G.makeDefaultTroops(),hero:Object.assign({},this._makeHero(),{enabled:!1,health:100,strength:0,power:this.calculatePowerBonus(0,i[t].forces[a].tribe),offPoints:0,defPoints:0,horse:!1,equipment:{}})}),i[t].forces[a].hero.equipment&&G.sanitizeHeroEquipment(i[t].forces[a].hero.equipment,!0),0===a&&(i[t].wall=0,i[t].watchTowers=0,i[t].palace=0,i[t].brewery=0,i[t].stonemason=0,i[t].traps=0,i[t].allyBonus=0,i[t].spyArtefact=0,i[t].buildingMasterArtefact=0,i[t].celebration=!1,t===G.roles.ATTACK&&(i[t].forces[a].catapultTargets=[]));const n={clearAllowedByRole:this.getClearAllowedByRole(Object.assign({},s,{simulationSettings:i}),t,a),simulationSettings:i,roleId:e};return 0===a&&t===i.myRole&&(n.currentVillage=null,n.reloadAllowed=!1),n}),(()=>{this.simulationAllowedCheck()}))}addReinforcement(e,t=null){const a=Object.assign({},this.state.simulationSettings);a[G.roles.DEFENCE].forces.push({tribe:e,troops:G.makeDefaultTroops(),hero:{enabled:!1,health:100,strength:0,power:this.calculatePowerBonus(0,e),defPoints:0,offPoints:0,horse:!1,equipment:{}},addedBy:a.myRole,villageId:t,predefined:!1}),this.setState({simulationSettings:a})}removeReinforcement(e,t){this.setState((a=>{let s=Object.assign({},a.simulationSettings),i=s[G.roles.DEFENCE].forces.slice();G.isReinforcementAddedManually(i[t])?i.splice(t,1):i[t].inactive=!0,s[G.roles.DEFENCE].forces=i;let n={simulationSettings:s,roleId:e};return n=Object.assign(n,this.makeSimulationAllowedObject(n)),n}),(()=>{this.reloadAllowedCheck(G.roles.DEFENCE)}))}setCurrentVillage(e,t,a,s=!1){!a||this.state.currentVillage&&this.state.currentVillage.did===a&&!s||this.setState((s=>this.makeCurrentVillageObject(s,e,t,a)),(()=>{this.setState(this.makeRearrangedDefendersObject(this.state.simulationSettings,a,t))}))}switchRole(e){e.preventDefault(),this.setState((e=>{let t=Object.assign({},e.simulationSettings);t.myRole=e.simulationSettings.myRole===G.roles.ATTACK?G.roles.DEFENCE:G.roles.ATTACK;const a=Object.assign({},G.attack(t,null)),s=Object.assign({},G.defence(t,null));s.forces[0].tribe===Travian.Constants.TRIBE_ID.nature&&(s.forces[0].tribe=Travian.Constants.TRIBE_ID.roman),s.forces[0].tribe===Travian.Constants.TRIBE_ID.natar&&(t.type=G.roles.ATTACK);let i=null;return t.myRole===G.roles.DEFENCE&&(a.wall||(a.wall=this.props.playerData.currentVillage.wall||0,a.watchTowers=this.props.playerData.currentVillage.watchTowers||0),e.currentVillage&&(i=e.currentVillage.did)),a.forces=this._prepareDefenders(a.forces[0],i,t.myRole),Object.assign(G.defence(t,null),a),Object.assign(G.attack(t,null),s),{simulationSettings:t,roleId:"ALL"}}),(()=>{this.fullButtonStatusCheck(null,0,this.state.simulationSettings.myRole===G.roles.ATTACK?null:{reloadAllowed:this.state.reloadAllowed})}))}makeCurrentVillageObject(e,t,a,s){const i=this.villagesById[s],n=Object.assign({},e,{currentVillage:i}),r=G.getSettingsDestination(n.simulationSettings,a,null);r.wall=i.wall||0,r.watchTowers=i.watchTowers||0,r.brewery=i.brewery||0,r.palace=i.palace||0,r.stonemason=i.stonemason||0,r.traps=i.traps||0;const l=G.getSettingsDestination(n.simulationSettings,a);return l.troops=G.assignTroops(this.props.playerData.troops[s].own),l.hero=Object.assign({},this._makeHero(),{enabled:!!this.props.playerData.troops[s].own.amounts.t11}),l.tribe=i.vid,n.roleId=t,n.clearAllowedByRole=this.getClearAllowedByRole(n,a),n.reloadAllowed=!1,n}makeRearrangedDefendersObject(e,t,a){let s=this.makeSimulationAllowedObject();if(a===G.roles.DEFENCE){const i=this._prepareDefenders(G.getSettingsDestination(e,a),t,a,!0);Object.assign(G.defence(e,null),{defenders:i}),s.simulationSettings=e,s.roleId="ALL"}return s}reload(e,t,a){t.preventDefault(),this.setState((t=>{const s=t.currentVillage.did;let i=this.makeCurrentVillageObject(t,e,a,s),n=Object.assign({},i.simulationSettings);G.getSettingsDestination(n,n.myRole).hero=this._makeHero();const r=G.getSettingsDestination(n,n.myRole,null);r.allyBonus=this.props.playerData.allianceBonus,r.spyArtefact=this.props.playerData.spyArtefact||0,r.buildingMasterArtefact=this.props.playerData.buildingMasterArtefact||0,r.celebration=!!this.props.playerData.celebration,i=Object.assign(i,this.makeRearrangedDefendersObject(n,s,a));const l=this.getClearAllowedByRole(i,a);return i=Object.assign(i,{roleId:"ALL",reloadAllowed:!1,clearAllowedByRole:l}),i}))}static getReloadSignature(e,t){const a=e[t];let s={tribe:a.forces[0].tribe,allyBonus:a.allyBonus,spyArtefact:a.spyArtefact,buildingMasterArtefact:a.buildingMasterArtefact,troops:a.forces[0].troops,hero:a.forces[0].hero,celebration:a.celebration,brewery:a.brewery,wall:a.wall,watchTowers:a.watchTowers,palace:a.palace,stonemason:a.stonemason,traps:a.traps,reinforcementsLength:Math.max(0,a.forces.length-1)};return s=JSON.stringify(s),s}getReloadAllowedCheck(e,t=null,a=0){const s=t||this.state.simulationSettings.myRole,i=G.getReloadSignature(e,s);let n={reloadAllowed:!1};return this.state.currentVillage&&(null===this.state.lastReloadData?(n.lastReloadData=i,n.reloadAllowed=!0):this.state.lastReloadData!==i&&(n.reloadAllowed=!0)),null!==t&&(n.roleId=`${t}_${a}`,t===G.roles.DEFENCE&&a>0&&(n.roleId=[n.roleId,`${t}_0`])),n}reloadAllowedCheck(e=null){const t=this.getReloadAllowedCheck(this.state.simulationSettings,e,0);this.setState(t)}areTroopsClearable(e){return Object.keys(e.amounts).reduce(((t,a)=>t||e.amounts[a]>0||e.levels[a]>0),!1)}isAttackerClearable(e){const t=G.attack(e,null);if(e.type!==this.props.gameData.attackTypes.RAID||t.allyBonus>0||t.spyArtefact>0||t.celebration||t.brewery>0)return!0;const a=G.attack(e);return!!(a.catapultTargets[0]>0||a.catapultTargets[1]>0||100!==a.hero.health||a.hero.strength>0||100!==a.hero.power||a.hero.offPoints>0||a.hero.horse)||this.areTroopsClearable(a.troops)}isDefenderClearable(e,t){if(0===t){const t=G.defence(e.simulationSettings,null);if(t.allyBonus>0||t.spyArtefact>0||t.buildingMasterArtefact>0||t.celebration||t.wall>0||t.watchTowers>0||t.palace>0||t.stonemason>0||t.traps>0)return!0}const a=G.defence(e.simulationSettings,t);return!!(100!==a.hero.health||a.hero.strength>0||100!==a.hero.power||a.hero.defPoints>0||a.hero.horse)||this.areTroopsClearable(a.troops)}getClearAllowedByRole(e,t=null,a=0){const s=Object.assign({},e.clearAllowedByRole,{[G.roles.DEFENCE]:Object.assign({},e.clearAllowedByRole[G.roles.DEFENCE])});return null!==t?t===G.roles.ATTACK?s[t]=this.isAttackerClearable(e.simulationSettings):s[t][a]=this.isDefenderClearable(e,a):(s[G.roles.ATTACK]=this.isAttackerClearable(e.simulationSettings),G.defence(e.simulationSettings,null).forces.map(((t,a)=>{s[G.roles.DEFENCE][a]=this.isDefenderClearable(e,a)}))),s}clearAllowedCheck(e=null,t=0){this.setState((a=>({clearAllowedByRole:this.getClearAllowedByRole(a,e,t),roleId:e?`${e}_0`:"ALL"})))}calculatePowerBonus(e,t){return 100+(e||0)*(this.props.gameData.bonus.power[t]||this.props.gameData.bonus.power.default)}fullButtonStatusCheck(e=null,t=0,a={}){this.setState((s=>{let i=this.makeSimulationAllowedObject(s);return i=Object.assign(i,this.getReloadAllowedCheck(s.simulationSettings,e,t)),i=Object.assign(i,{clearAllowedByRole:this.getClearAllowedByRole(s,e,t)}),i.roleId||(i.roleId="ALL"),a&&Object.keys(a).length&&(i=Object.assign(i,a)),i}))}applyLosses(e={attackers:[],defenders:[]}){this.setState((t=>{let a=Object.assign({},t.simulationSettings);return Object.keys(G.roles).forEach((t=>{const s=G.roles[t],i=s===G.roles.ATTACK?"attackers":"defenders";e[i]&&e[i].forEach(((e,t)=>{const i=G.getSettingsDestination(a,s,t);let n,r=Object.assign({},i.troops.amounts);a[s].forces[t]=Object.assign({},a[s].forces[t]),e.hero&&(n=Object.assign({},i.hero,{health:Math.max(0,Math.round(a[s].forces[t].hero.health-e.hero.healthLoss))}),e.hero.isAlive||(r.t11=0,n.enabled=!1)),e.casualties&&Object.keys(e.casualties).forEach((t=>{r[t]=Math.max(0,(e.troops[t]||0)+e.casualties[t])})),e.troopsWounded&&Object.keys(e.troopsWounded).forEach((t=>{r[t]=Math.max(0,(r[t]||0)+e.troopsWounded[t])})),a[s].forces[t].troops=Object.assign({},a[s].forces[t].troops,{amounts:r}),void 0!==n&&(a[s].forces[t].hero=n)}))})),{simulationSettings:a,roleId:"ALL",simulationAllowed:!0}}),(()=>{jQuery("html, body, .contentContainer").animate({scrollTop:jQuery("#combatSimulator").offset().top},1e3)}))}}class Y extends o.Component{static contextType=D._;static makePalaceHint(){const e=[(0,O.Jh)("allgemein.gid26"),(0,O.Jh)("allgemein.gid25")];return Object.values(Travian.Variables.tribeIds).length>5&&e.push((0,O.Jh)("allgemein.gid44")),e.join(" / ")}bonusUpdate=(e,t)=>this.props.callbacks.bonusUpdate(this.props.roleId,this.props.role,t,e.target.value);callbackBonusUpdateAlly=e=>this.bonusUpdate(e,"allyBonus");callbackBonusUpdateBuildingMasterArtifact=e=>this.bonusUpdate(e,"buildingMasterArtefact");callbackBonusUpdateSpyArtifact=e=>this.bonusUpdate(e,"spyArtefact");buildingUpdate=(e,t)=>this.props.callbacks.buildingValuesUpdate(this.props.roleId,this.props.role,t,e);callbackBuildingUpdateWall=e=>this.buildingUpdate((0,O.iA)(e.target.value,0,this.context.gameData.MAX_BUILDING_LEVEL),"wall");callbackBuildingUpdateWatchTowers=e=>this.buildingUpdate((0,O.iA)(e.target.value,0,this.context.gameData.MAX_BUILDING_LEVEL),"watchTowers");callbackBuildingUpdatePalace=e=>this.buildingUpdate((0,O.iA)(e.target.value,0,this.context.gameData.MAX_BUILDING_LEVEL),"palace");callbackBuildingUpdateStonemason=e=>this.buildingUpdate((0,O.iA)(e.target.value,0,this.context.gameData.MAX_BUILDING_LEVEL),"stonemason");callbackBuildingUpdateTraps=e=>this.buildingUpdate((0,O.iA)(e.target.value,0),"traps");callbackBuildingUpdateBrewery=e=>this.buildingUpdate((0,O.iA)(e.target.value,0,this.context.gameData.MAX_BREWERY_LEVEL),"brewery");render(){const{tribe:e,role:t,simulationSettingsBonus:a,simulationSettingsBuildingLevels:s,simulationSettingsTraps:i}=this.props,{walls:n}=this.context.gameData,r=this.context.gameData.bonus,l=t===G.roles.ATTACK&&(Travian.Variables.keepVidOnConquer&&e!==Travian.Constants.TRIBE_ID.natar||!Travian.Variables.keepVidOnConquer&&e===Travian.Constants.TRIBE_ID.teuton);return(0,_.jsxs)("div",{className:["bonus",e===Travian.Constants.TRIBE_ID.nature?"hidden":"shown"].join(" "),children:[e!==Travian.Constants.TRIBE_ID.natar&&(0,_.jsxs)("div",{className:"artefacts",children:[(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"allyBonus",title:(0,O.Jh)("combatSimulator.allianceBonus")+" "+(0,O.Jh)("allianz.allianceBonusName_SmithyPower")}),(0,_.jsx)("select",{name:"allyBonus",value:a.allyBonus,onChange:this.callbackBonusUpdateAlly,children:r.alliance.map(((e,t)=>(0,_.jsx)("option",{value:e,dangerouslySetInnerHTML:{__html:(0,O.eJ)(Math.round(100*(e-1)),{unit:O.uo.PERCENT})}},t)))})]}),t===G.roles.DEFENCE&&(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"artefact_buildingMaster",title:(0,O.Jh)("gid27.arte_dorf_2")}),(0,_.jsx)("select",{name:"buildingMasterBonus",value:a.buildingMasterArtefact,onChange:this.callbackBonusUpdateBuildingMasterArtifact,children:r.buildingMasterArtefact.map(((e,t)=>(0,_.jsx)("option",{value:e,dangerouslySetInnerHTML:{__html:(0,O.eJ)(e,{unit:O.uo.TIMES,fraction:e>0&&e<1?2:0})}},t)))})]}),(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"artefact_spy",title:(0,O.Jh)("gid27.arte_dorf_5")}),(0,_.jsx)("select",{name:"artefact_spy",value:a.spyArtefact,onChange:this.callbackBonusUpdateSpyArtifact,children:r.spyArtefact.map(((e,t)=>(0,_.jsx)("option",{value:e,dangerouslySetInnerHTML:{__html:(0,O.eJ)(e,{unit:O.uo.TIMES,fraction:e>0&&e<1?2:0})}},t)))})]})]}),(0,_.jsxs)("div",{className:["buildings",e===Travian.Constants.TRIBE_ID.nature?"hidden":"shown"].join(" "),children:[t===G.roles.DEFENCE&&(0,_.jsxs)("span",{children:[(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:`wall gebIcon g${n[e]}Icon`,title:(0,O.Jh)(`allgemein.gid${n[e]}`)}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"wall",value:s.wall||"",onChange:this.callbackBuildingUpdateWall})]}),Travian.Variables.feature_flags.cities&&(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"gebIcon watchTowersIcon",title:(0,O.Jh)("buildingExtensions.watchTowers")}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"watchtowers",value:s.watchTowers||"",onChange:this.callbackBuildingUpdateWatchTowers})]}),(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"palace gebIcon g26Icon",title:Y.makePalaceHint()}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"palace",value:s.palace||"",onChange:this.callbackBuildingUpdatePalace})]}),(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"stonemason gebIcon g34Icon",title:(0,O.Jh)("allgemein.gid34")}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"stonemason",value:s.stonemason||"",onChange:this.callbackBuildingUpdateStonemason})]}),e===Travian.Constants.TRIBE_ID.gaul&&(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"unit_small gaul trap",title:(0,O.Jh)("gid36.fallen")}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"traps",value:i||"",onChange:this.callbackBuildingUpdateTraps})]})]}),l?(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"brewery gebIcon g35Icon",title:(0,O.Jh)("allgemein.gid35")}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"brewery",value:s.brewery||"",onChange:this.callbackBuildingUpdateBrewery})]}):null]})]})}}class K extends o.Component{constructor(e){super(e),this.callbackTroopUnitUpdate=e=>{this.props.iconsAreClickable&&this.props.callbacks.troopUnitSet(this.props.roleId,this.props.role,this.props.memberId,e)},this.callbackHeroUpdate=()=>{this.props.iconsAreClickable&&this.props.callbacks.heroUpdate(this.props.roleId,this.props.role,this.props.memberId,!this.props.heroIsEnabled)}}render(){const{troopData:e,catapultTargets:t,celebration:a,heroIsEnabled:s,movement:i,role:n,memberId:r,roleId:l,tribe:o,callbacks:c}=this.props;return(0,_.jsx)("div",{className:`troops ${n}`,children:(0,_.jsx)("table",{className:"transparent",children:(0,_.jsxs)("tbody",{children:[(0,_.jsx)(U,{tribe:o,callbackTroopUnitUpdate:this.callbackTroopUnitUpdate,callbackHeroUpdate:this.callbackHeroUpdate}),(0,_.jsx)(z,{roleId:l,data:e.amounts,heroIsEnabled:s,tribe:o,role:n,memberId:r,callbacks:c}),o!==Travian.Constants.TRIBE_ID.nature&&(0,_.jsx)($,{role:n,memberId:r,roleId:l,data:e.levels,celebration:a,cataUnits:e.amounts&&e.amounts.t8,cataLevels:t,tribe:o,movement:i,callbacks:c})]})})})}}var X;function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Q.apply(this,arguments)}K.propTypes={tribe:d().number.isRequired};const ee=e=>o.createElement("svg",Q({xmlns:"http://www.w3.org/2000/svg",viewBox:"-1 -1 20 20"},e),X||(X=o.createElement("path",{d:"M.3 8.5s5 4.4 6.3 8.1C8.5 7.8 14.3.3 14.3.3"}))),te=(e,t,a,s,i)=>{let n=["entry"];e&&(e[s]||"all"===e)&&n.push("owned");let r=t[a]===s;void 0!==i&&(r=i),r&&n.push("selected"),n=n.join(" ");let l=["checkmark"];return r&&l.push("checked"),l=l.join(" "),{className:n,svgClassName:l,checked:r}},ae=(e,t)=>{if(void 0!==t&&""!=t){const a=Object.keys(e);for(let s=0;s<a.length;s++)for(let i=0;i<e[a[s]].length;i++)if(e[a[s]][i]===t)return a[s]}return 0},se=e=>{const{slot:t,itemId:a}=e,{className:s,svgClassName:i,checked:n}=te(e.equipmentOwned,e.equipmentSelected,t,a);return(0,_.jsxs)("div",{className:s,onClick:()=>e.heroEquipmentUpdate(e.role,e.memberId,t,a,!n),children:[(0,_.jsx)(ee,{className:i}),(0,I.Wb)(`items.item${a}`)]})};se.propTypes={equipmentOwned:d().oneOfType([d().object,d().string]),equipmentSelected:d().shape({rightHand:d().oneOfType([d().number,d().string]),leftHand:d().oneOfType([d().number,d().string]),body:d().oneOfType([d().number,d().string]),bag:d().any}),slot:d().oneOf(["rightHand","leftHand","body","bag"]),itemId:d().number,role:d().oneOf(["attack","defence"]).isRequired,memberId:d().number.isRequired,heroEquipmentUpdate:d().func.isRequired};const ie=e=>{const{gameData:t}=(0,o.useContext)(D._),{equipmentSelected:a,role:s,memberId:i,equipmentOwned:n,dropdown:r,toggleCallback:l,callbacks:c,tribe:d}=e,{troopIDs:h}=t,u=t.itemTypes.rightHand,m="rightHand",p=ae(u[d],a[m]);return(0,_.jsxs)("div",{className:"equipContainer",children:[(0,_.jsx)("div",{className:"slot",onClick:e=>l(m),children:void 0===a[m]||""===a[m]?(0,_.jsx)("i",{className:"hero_handR",title:(0,I.Wb)(`hero.itemType_${m}Capital`)}):(0,_.jsx)("i",{className:`unit u${h["v"+d][p]}`,title:(0,I.Wb)(`items.item${a[m]}`)})}),r===m&&(0,_.jsx)("div",{className:"overlay",onClick:e=>l(m)}),r===m&&(0,_.jsx)("div",{className:["dropdown",m,r===m?"opened":"closed"].join(" "),children:u[d]&&Object.keys(u[d]).sort().map((e=>{const t=h["v"+d][e],r=(0,I.Wb)(`truppen.tid${t}`);return(0,_.jsxs)("div",{className:"group",children:[(0,_.jsxs)("div",{className:"title",children:[(0,_.jsx)("i",{className:`unit u${t}`,title:r}),(0,_.jsx)("span",{children:r})]}),u[d][e].map((t=>(0,_.jsx)(se,{equipmentOwned:n,equipmentSelected:a,slot:m,itemId:t,role:s,memberId:i,heroEquipmentUpdate:c.heroEquipmentUpdate},`${e}-${t}`)))]},e)}))})]})},ne=e=>{const{gameData:t}=(0,o.useContext)(D._),{equipmentSelected:a,role:s,memberId:i,equipmentOwned:n,dropdown:r,toggleCallback:l,callbacks:c}=e,d=t.itemTypes.leftHand,h="leftHand",u={1:"shield",2:"horn"};let m=ae(d,a[h]);return(0,_.jsxs)("div",{className:"equipContainer",children:[(0,_.jsx)("div",{className:"slot",onClick:e=>l(h),children:void 0!==a[h]&&""!==a[h]&&m?(0,_.jsx)("i",{className:u[m],title:(0,I.Wb)(`items.item${a[h]}`)}):(0,_.jsx)("i",{className:"hero_handL",title:(0,I.Wb)(`hero.itemType_${h}Capital`)})}),r===h&&(0,_.jsx)("div",{className:"overlay",onClick:e=>l(h)}),(0,_.jsx)("div",{className:["dropdown",h,r===h?"opened":"closed"].join(" "),children:Object.keys(d).sort().map((e=>{const t=(0,I.Wb)(`items.item${d[e][1]}`);return(0,_.jsxs)("div",{className:"group",children:[(0,_.jsxs)("div",{className:"title",children:[(0,_.jsx)("i",{className:u[e],title:t}),(0,_.jsx)("span",{children:t})]}),d[e].map((t=>(0,_.jsx)(se,{equipmentOwned:n,equipmentSelected:a,slot:h,itemId:t,role:s,memberId:i,heroEquipmentUpdate:c.heroEquipmentUpdate},`${e}-${t}`)))]},e)}))})]})},re=e=>{const{gameData:t}=(0,o.useContext)(D._),{equipmentSelected:a,role:s,memberId:i,equipmentOwned:n,dropdown:r,toggleCallback:l,callbacks:c}=e,d=t.itemTypes.body,h="body",u={1:"scaleArmour",2:"breastPlate",3:"segmentedArmour",4:"armourOfHealth"};let m=ae(d,a[h]);return(0,_.jsxs)("div",{className:"equipContainer",children:[(0,_.jsx)("div",{className:"slot",onClick:e=>l(h),children:void 0===a[h]||""===a[h]?(0,_.jsx)("i",{className:"hero_torso",title:(0,I.Wb)(`hero.itemType_${h}Capital`)}):(0,_.jsx)("i",{className:u[m],title:(0,I.Wb)(`items.item${a[h]}`)})}),r===h&&(0,_.jsx)("div",{className:"overlay",onClick:e=>l(h)}),(0,_.jsx)("div",{className:["dropdown",h,r===h?"opened":"closed"].join(" "),children:Object.keys(d).sort().map((e=>{const t=(0,I.Wb)(`items.item${d[e][1]}`);return(0,_.jsxs)("div",{className:"group",children:[(0,_.jsxs)("div",{className:"title",children:[(0,_.jsx)("i",{className:u[e],title:t}),(0,_.jsx)("span",{children:t})]}),d[e].map((t=>(0,_.jsx)(se,{equipmentOwned:n,equipmentSelected:a,slot:h,itemId:t,role:s,memberId:i,heroEquipmentUpdate:c.heroEquipmentUpdate},`${e}-${t}`)))]},e)}))})]})};class le extends o.Component{static propTypes={data:d().object,equipmentSelected:d().object};static SLOT="bag";static contextType=D._;constructor(e){super(e),this.state={checkedItemType:null,checkedItemId:e.data&&e.data.selected&&e.data.selected[le.SLOT]?e.data.selected[le.SLOT]:null}}getValuesByItemId=(e=this.props)=>{const{data:t,equipmentSelected:a}=e;return this.context.gameData.itemTypes.bag.reduce(((e,s)=>(e[s]=(void 0!==t[s]?""+t[s]:a&&a[le.SLOT]&&a[le.SLOT]===s)||"",e)),{})};toggleCheckedItem=e=>{let t=0;this.setState((a=>{t=a.checkedItemId;let s=null;return null!==a.checkedItemId&&a.checkedItemId===e||(s=e),{checkedItemId:s}}),(()=>{const{checkedItemId:e}=this.state;if(e){const t=this.fieldsByItemId[e];t.focus(),this.props.callbacks.heroEquipmentUpdate(this.props.role,this.props.memberId,le.SLOT,e,t.value)}else t&&this.props.callbacks.heroEquipmentUpdate(this.props.role,this.props.memberId,le.SLOT,t,"")}))};fieldsByItemId={};componentWillReceiveProps(e){const t=this.getValuesByItemId(),a=this.getValuesByItemId(e);Object.keys(a).forEach((e=>{this.fieldsByItemId[e]&&!a[e]&&t[e]&&(this.fieldsByItemId[e].value="",this.setState({checkedItemType:null,checkedItemId:null}))}))}render(){const{role:e,memberId:t,equipmentOwned:a,equipmentSelected:s,dropdown:i,toggleCallback:n,callbacks:r}=this.props,l=this.context.gameData.itemTypes.bag,o=le.SLOT,c={0:"smallBandage",1:"bandage"};let d="";for(let e=0;e<l.length;e++)if(l[e]===s[o]){d=e;break}const h=this.getValuesByItemId();return(0,_.jsxs)("div",{className:"equipContainer",children:[(0,_.jsx)("div",{className:"slot",onClick:()=>n(o),children:void 0!==s[o]&&""!==s[o]&&c[d]&&h[s[o]]&&this.state.checkedItemId==s[o]?(0,_.jsx)("i",{className:c[d],title:(0,I.Wb)(`items.item${s[o]}`)}):(0,_.jsx)("i",{className:"hero_bag",title:(0,I.Wb)(`hero.itemType_${o}Capital`)})}),i===o&&(0,_.jsx)("div",{className:"overlay",onClick:e=>n("bag")}),(0,_.jsx)("div",{className:["dropdown",o,i===o?"opened":"closed"].join(" "),children:l.map(((i,n)=>{const l=(0,I.Wb)(`items.item${i}`),{className:d}=te(a,s,o,i,this.state.checkedItemId===i),u=h[i];return(0,_.jsx)("div",{className:"group",children:(0,_.jsxs)("div",{className:d,onClick:e=>this.toggleCheckedItem(i),children:[(0,_.jsx)(ee,{className:"checkmark"}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",defaultValue:u,onChange:a=>{const s=parseInt((0,O.iA)(a.target.value,0));r.heroEquipmentUpdate(e,t,o,i,!isNaN(s)&&s)},ref:e=>{this.fieldsByItemId[i]||(this.fieldsByItemId[i]=e)}}),(0,_.jsx)("i",{className:c[n],title:l}),l]})},i)}))})]})}}class oe extends o.Component{static getEquipmentOwned=(e,t,a,s)=>"reinforcement"!==e&&t&&a.owned?a.owned[s]:"all";static MAX_HEALTH=100;static MAX_STRENGTH=100;static MAX_BONUS=100;static contextType=D._;constructor(e){super(e),this.state={equip:"",smallBandages:"",bandages:""},this.toggleDropdown=this.toggleDropdown.bind(this),this.calculatePowerBonus=e=>this.props.callbacks.calculatePowerBonus(e,this.props.tribe);const t=(e,t)=>this.props.callbacks.heroDataUpdate(this.props.roleId,this.props.role,this.props.memberId,e,t);this.callbackHeroDataUpdateHealth=e=>t("health",(0,O.iA)(e.target.value,0,oe.MAX_HEALTH)),this.callbackHeroDataUpdateStrength=e=>{const a=(0,O.iA)(e.target.value,0,oe.MAX_STRENGTH);t("strength",a),t("power",this.calculatePowerBonus(a))},this.callbackHeroDataUpdateBonus=e=>t(this.props.role===this.props.roles.ATTACK?"offPoints":"defPoints",(0,O.iA)(e.target.value,0,oe.MAX_BONUS)),this.callbackHeroDataUpdateHorse=e=>t("horse",e.target.checked)}toggleDropdown(e){this.setState((t=>({equip:t.equip===e?"":e})))}componentDidUpdate(){if("undefined"!=typeof jQuery){let e=jQuery("body").height()-20;jQuery(".heroAttributes .dropdown").each((function(){let t=jQuery(this);t.removeClass("dropUp"),t.offset().top+t.height()>e&&t.addClass("dropUp")}))}}render(){const{thisIsMyHero:e,role:t,memberId:a,tribe:s,data:i,equipment:n,callbacks:r,roles:l,heroIsEnabled:o}=this.props,c=t===l.ATTACK?"off":"def",d=`${c}Bonus`,h=`${c}Points`,u=n&&n.selected&&Object.keys(n.selected).length?n.selected:{};return(0,_.jsx)("div",{className:["heroAttributes",i.enabled?"shown":"hidden"].join(" "),children:o?[(0,_.jsxs)("div",{className:"stats",children:[(0,_.jsx)("span",{children:(0,O.Jh)("truppen.hero")}),(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"hero_health",title:(0,O.Jh)("hero.health")}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"health",maxLength:3,value:i.health||"",onChange:this.callbackHeroDataUpdateHealth})]}),(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"hero_strength",title:(0,O.Jh)("hero.fightingPower")}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:"strength",maxLength:5,value:i.strength||"",onChange:this.callbackHeroDataUpdateStrength}),(0,_.jsx)("span",{className:"calculated",children:this.calculatePowerBonus(i.strength)})]}),(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:`hero_${d}`,title:(0,O.Jh)(`hero.${c}_bonus`)}),(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:h,maxLength:3,value:i[h]||"",onChange:this.callbackHeroDataUpdateBonus}),(0,_.jsx)("span",{className:"calculated",dangerouslySetInnerHTML:{__html:(0,O.eJ)((i[h]?parseInt(i[h],10):0)/5,{unit:O.uo.PERCENT,fraction:1})}})]}),(0,_.jsxs)("label",{children:[(0,_.jsx)("i",{className:"hero_horse",title:(0,O.Jh)("hero.horse")}),(0,_.jsx)("input",{type:"checkbox",name:"horse",checked:i.horse,onChange:this.callbackHeroDataUpdateHorse})]})]},"stats"),(0,_.jsxs)("div",{className:"equipment",children:[(0,_.jsx)("span",{className:"title",children:(0,O.Jh)("combatSimulator.equipment")}),(0,_.jsx)(ie,{tribe:s,role:t,memberId:a,dropdown:this.state.equip,equipmentOwned:oe.getEquipmentOwned(t,e,n,"rightHand"),equipmentSelected:u,toggleCallback:this.toggleDropdown,callbacks:r}),(0,_.jsx)(ne,{tribe:s,role:t,memberId:a,dropdown:this.state.equip,equipmentOwned:oe.getEquipmentOwned(t,e,n,"leftHand"),equipmentSelected:u,toggleCallback:this.toggleDropdown,callbacks:r}),(0,_.jsx)(re,{tribe:s,role:t,memberId:a,dropdown:this.state.equip,equipmentOwned:oe.getEquipmentOwned(t,e,n,"body"),equipmentSelected:u,toggleCallback:this.toggleDropdown,callbacks:r}),(0,_.jsx)(le,{tribe:s,data:i.equipment,role:t,memberId:a,dropdown:this.state.equip,equipmentOwned:oe.getEquipmentOwned(t,e,n,"bag"),equipmentSelected:u,toggleCallback:this.toggleDropdown,callbacks:r})]},"equipment")]:null})}}class ce extends o.Component{static propTypes={activeRoleId:d().oneOfType([d().string,d().array,d().exact(null)]),type:d().oneOf(["attack","defence"]),memberId:d().number,selectedByPlayer:d().bool,villages:d().array,currentVillage:d().object,simulationSettings:d().object,heroEquipment:d().object,roles:d().object,reloadAllowed:d().bool,clearAllowed:d().bool,callbacks:d().object};static defaultProps={memberId:0};static displayName="Role";static shouldDisplayHero(e){return e!==Travian.Constants.TRIBE_ID.nature&&e!==Travian.Constants.TRIBE_ID.natar}static makeIcon(e,t,a,s){let i=a?(0,_.jsx)("i",{className:["tribeIcon",`smallTribe${s}`].join(" "),title:(0,I.Wb)(`anmelden.volk${s}`)}):null;if(!i)switch(t){case e.ATTACK:i=(0,_.jsx)(T,{className:"svgAttack roleIcon"});break;case e.DEFENCE:i=(0,_.jsx)(u,{className:"svgDefend roleIcon"})}return i}constructor(e){super(e);const t=`${e.type}_${e.memberId}`;this.getId=()=>t,this.callbackSwitchMovement=e=>this.props.callbacks.switchMovement(t,e),this.callbackRemoveReinforcement=()=>this.props.callbacks.removeReinforcement(t,this.props.memberId),this.callbackReload=e=>this.props.callbacks.reload(t,e,this.props.type),this.callbackClearData=()=>this.props.callbacks.clearData(t,this.props.type,this.props.memberId),this.callbackSwitchTribe=(e,a,s)=>this.props.callbacks.switchTribe(t,this.props.type,this.props.memberId,s),this.callbackSetVillage=e=>this.props.callbacks.setCurrentVillage(t,this.props.type,parseInt(e.target.value))}shouldComponentUpdate(e){const t=this.getId();return e.activeRoleId instanceof Array?e.activeRoleId.indexOf(t)>=0:t===e.activeRoleId||"ALL"===e.activeRoleId}render(){const{type:e,memberId:t,selectedByPlayer:a,villages:s,currentVillage:i,simulationSettings:n,heroEquipment:r,roles:l,reloadAllowed:o,clearAllowed:c,callbacks:d}=this.props;let h=[];i||h.push({id:0,name:(0,I.Wb)("combatSimulator.noVillageSelected")}),h=h.concat(s);let u="";u=e===l.ATTACK?"attacker":t>0?"reinforcement":"defender";const m="reinforcement"===u,p=n.combatMember.tribe,g=ce.makeIcon(l,e,m,p),v=ce.shouldDisplayHero(p)&&n.combatMember.hero.enabled,x=o?"":"disabled",b=c?"":"disabled",j=this.getId();return(0,_.jsxs)("div",{className:["role",u].join(" "),children:[(0,_.jsxs)("div",{className:["header",a?"you":""].join(" "),children:[g,(0,_.jsx)("h2",{children:(0,I.Wb)(`combatSimulator.${a?"you":u}`)}),m&&(0,_.jsx)("a",{className:["iconButton","delete"].join(" "),title:(0,I.Wb)("combatSimulator.delete"),onClick:this.callbackRemoveReinforcement,children:(0,_.jsx)(R.Z,{})}),a?(0,_.jsxs)("div",{className:"villageSelection",children:[(0,_.jsx)("select",{name:"village",value:i?i.did:0,onChange:this.callbackSetVillage,children:h.map(((e,t)=>(0,_.jsx)("option",{value:e.did,children:(0,O.r4)(e.name)},t)))}),(0,_.jsx)("a",{className:["iconButton","reload",x].join(" "),title:(0,I.Wb)("combatSimulator.reload"),onClick:this.callbackReload,children:(0,_.jsx)(S,{})})]}):null,(0,_.jsx)("a",{className:["iconButton","clear",b].join(" "),title:(0,I.Wb)("combatSimulator.clear"),onClick:this.callbackClearData,children:(0,_.jsx)(E,{})})]}),!m&&(0,_.jsx)(A,{role:e,memberId:t,active:p,tribeSwitchCallback:this.callbackSwitchTribe}),(0,_.jsxs)("div",{className:"content",children:[e===l.ATTACK&&(0,_.jsx)(L,{active:n.type,tribe:p,movementSwitchCallback:this.callbackSwitchMovement}),!m&&p!==Travian.Constants.TRIBE_ID.nature&&(0,_.jsx)(Y,{role:e,roleId:j,tribe:p,simulationSettingsBonus:n,simulationSettingsBuildingLevels:n,simulationSettingsTraps:n.traps,callbacks:d}),(0,_.jsx)(K,{role:e,memberId:t,roleId:j,movement:n.type,troopData:n.combatMember.troops,catapultTargets:e===l.ATTACK?n.combatMember.catapultTargets:[],celebration:n.celebration,heroIsEnabled:v,iconsAreClickable:a,tribe:p,callbacks:d}),(0,_.jsx)(oe,{heroIsEnabled:v,thisIsMyHero:a,role:e,memberId:t,roleId:j,tribe:p,roles:l,data:n.combatMember.hero,callbacks:d,equipment:r})]})]})}}var de,he,ue,me,pe;function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ge.apply(this,arguments)}const ve=e=>o.createElement("svg",ge({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 86.91 108.22"},e),de||(de=o.createElement("path",{fill:"#fff",d:"M41.61 56.6l26.94 38.3a61 61 0 0 1-3.79 3.53 46.23 46.23 0 0 1-13.36 8.13 25.62 25.62 0 0 1-7.28 1.64h-1.21c-6.4-.4-13.77-3.87-20.75-9.77a57.15 57.15 0 0 1-9.77-10.59 32.52 32.52 0 0 1-4.62-9 173.65 173.65 0 0 1-4.3-21.09C2.06 48.58.89 38.23.4 30.72L0 24.57l6.18-.17c1.92-.05 3.66-.13 5.29-.24L33.1 65.5zm20.05-47a55 55 0 0 1-14.87-7.37L43.49 0l-3.32 2.2c-6.24 4.14-11 6.52-15.92 8a45.14 45.14 0 0 1-4.92 1.12l14.61 35.54L44 36.92 70.11 81.3c4.43-4.79 7.68-9.92 9-14.46a173.46 173.46 0 0 0 4.3-21.09c.67-4.4 1.3-9.18 1.83-13.82.56-4.88 1-9.44 1.22-13.2l.4-6.16-6.18-.17a70 70 0 0 1-19.02-2.75z"})),he||(he=o.createElement("path",{fill:"#494949",d:"M4.46 28.63l1.83-.05c1.36 0 2.64-.09 3.86-.15l22.19 42.4 8.9-9.3 22.59 32.12c-.58.53-1.17 1.06-1.78 1.58a42 42 0 0 1-12.11 7.4 21.48 21.48 0 0 1-6.08 1.37h-.71c-5.49-.34-12-3.46-18.29-8.79a52.93 52.93 0 0 1-9-9.8 28.38 28.38 0 0 1-4-7.79 169.74 169.74 0 0 1-4.26-20.5c-1.38-9.06-2.53-19.28-3-26.67zm56-15a59 59 0 0 1-16-7.95l-1-.66-1 .65c-6.61 4.38-11.71 6.92-17.07 8.48l-1.35.37 11 26.79 9.69-9.56L70 75a30.47 30.47 0 0 0 5.15-9.32 169.67 169.67 0 0 0 4.17-20.52c.68-4.39 1.28-9.16 1.8-13.7.55-4.82 1-9.32 1.21-13l.12-1.82-1.83-.05a74.05 74.05 0 0 1-20.2-2.94z"})),ue||(ue=o.createElement("path",{fill:"#a7a9ac",d:"M43.52 68.42V102h-.35c-4.94-.31-11.15-3.34-17-8.32A49.19 49.19 0 0 1 16 82.15l9-20.8 6.82 13L41 64.82zM33 30.85l2.79 6.8L43.52 30V7.47h-.07L43 7.7z"})),me||(me=o.createElement("path",{fill:"#d3d3d3",d:"M25 61.35l-9 20.8a22.68 22.68 0 0 1-2.36-5.08 161.31 161.31 0 0 1-4.08-20.25c-1.36-8.91-2.49-18.95-3-26.26l2.29-.08zM43 7.7a63.59 63.59 0 0 1-16.18 8.1l6.18 15z"})),pe||(pe=o.createElement("path",{fill:"#87898e",d:"M43.52 68.42l17.58 25-.34.3a46.1 46.1 0 0 1-6.88 4.86A24.3 24.3 0 0 1 43.8 102h-.27zm16.31-52.87a60.68 60.68 0 0 1-16.31-8.08V30l1.73-1.7 25 42.86a24.47 24.47 0 0 0 3-6.13 161.46 161.46 0 0 0 4.11-20.25c.15-1 .3-2 .44-3 1.16-8.1 2.11-16.75 2.54-23.26a75.74 75.74 0 0 1-20.51-2.97z"})));var xe,be,je,fe,ye,Te,Ne,Ce;function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Se.apply(this,arguments)}const ke=e=>o.createElement("svg",Se({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 110.59 132.51"},e),xe||(xe=o.createElement("path",{fill:"none",stroke:"#fff",strokeMiterlimit:10,strokeWidth:7,d:"M75.76 84.51L43 108.39l2.55 3.48a3.25 3.25 0 0 1-.51 4.38l-3.07 3.34-.13.14-.16.12a3.24 3.24 0 0 1-4.53-.7l-4-5.38-19.81 14.66a3 3 0 0 1-4.2-.63L4.09 121a3 3 0 0 1 .63-4.2l19.86-14.69-4.37-5.95a3.24 3.24 0 0 1 .69-4.53l.16-.12.18-.08 4.11-1.92a3.24 3.24 0 0 1 4.33.83l3 4.11 22.9-16.5.74.07c1.37.12 2.72.22 4 .31l2.36.15L61 85.65c2.39-.32 5-.56 7.93-.74zm28.18-78.89l-12.58 7.84-21.45 49.7 4.84-2.34 1.58-.82L79 68.32l2.29-2A91.42 91.42 0 0 1 89.64 60l.48-.33 16.82-39.53z"})),be||(be=o.createElement("path",{fill:"none",stroke:"#494949",strokeMiterlimit:10,strokeWidth:4,d:"M58.4 88.08a93.66 93.66 0 0 1 10.67-1.17L39.82 108.2 32 97.38 56.16 80c1.38.12 2.75.22 4.06.31zm44.16-79.24l-9.61 6L73.88 59c1.25-.6 2.47-1.22 3.64-1.82L80 64.82a93.67 93.67 0 0 1 8.55-6.48l16.34-38.42z"})),je||(je=o.createElement("path",{fill:"#bebdbd",d:"M58.4 88.08a93.65 93.65 0 0 1 10.67-1.17l-29.25 21.28-3.95-5.42 23-16.62zm44.17-79.25L79.36 62.94l.6 1.88a93.65 93.65 0 0 1 8.55-6.48l16.35-38.41z"})),fe||(fe=o.createElement("path",{fill:"#83807e",d:"M60.22 80.29l-1.39 5.92-22.92 16.61L32 97.38 56.16 80c1.38.1 2.75.2 4.06.29zM93 14.83L73.88 59c1.25-.6 2.47-1.22 3.65-1.82L79.37 63l23.2-54.17z"})),ye||(ye=o.createElement("path",{fill:"#6d2e0f",fillRule:"evenodd",d:"M11.56 128a2 2 0 0 1-1.61-.81l-5.06-6.84a2 2 0 0 1 .42-2.8L30 99.33l7.44 10.05-24.69 18.24a2 2 0 0 1-1.19.38z"})),Te||(Te=o.createElement("path",{fill:"#230e06",d:"M29.76 100.73l6.24 8.45-23.85 17.64a1 1 0 0 1-1.4-.21l-5.05-6.84a1 1 0 0 1 .21-1.4l23.85-17.64m.42-2.8l-1.61 1.19-23.85 17.64a3 3 0 0 0-.63 4.2l5.06 6.84a3 3 0 0 0 2.41 1.2 3 3 0 0 0 1.78-.59l23.85-17.64 1.61-1.19-1.19-1.58-6.25-8.45-1.19-1.61z"})),Ne||(Ne=o.createElement("path",{fill:"#eac40a",d:"M39.73 119.48a2.25 2.25 0 0 1-1.81-.92L21 95.54a2.24 2.24 0 0 1 .48-3.13l.08-.06 4.26-2a2.23 2.23 0 0 1 1.24-.35 2.25 2.25 0 0 1 1.81.92l15.83 21.54a2.25 2.25 0 0 1-.39 3.07L41.13 119l-.08.06a2.22 2.22 0 0 1-1.32.43z"})),Ce||(Ce=o.createElement("path",{fill:"#937809",d:"M27.06 91a1.24 1.24 0 0 1 1 .51l15.83 21.56a1.24 1.24 0 0 1-.27 1.74l-3.17 3.45a1.24 1.24 0 0 1-1.74-.27l-16.9-23a1.24 1.24 0 0 1 .27-1.74l4.24-2a1.24 1.24 0 0 1 .73-.24m0-2a3.22 3.22 0 0 0-1.72.49l-4.09 1.9-.18.08-.16.12a3.24 3.24 0 0 0-.69 4.53l16.9 23a3.26 3.26 0 0 0 2.61 1.32 3.22 3.22 0 0 0 1.92-.63l.16-.12.13-.14 3.07-3.31a3.25 3.25 0 0 0 .51-4.38L29.68 90.31A3.25 3.25 0 0 0 27.06 89z"})));var we,Ee;function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Re.apply(this,arguments)}const Ie=e=>o.createElement("svg",Re({className:"svgSkull",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50.06 61.87"},e),we||(we=o.createElement("path",{fill:"#fff",d:"M24.48 61.87l-.71-.11a7.28 7.28 0 0 1-2.89-1.06l-.42-.27a6 6 0 0 0-1.66-.75c-.22-.06-.44-.14-.66-.22l-1.87-.71a6 6 0 0 0-1.27-.32l-.62-.11a5.65 5.65 0 0 1-4.24-3.87 9.37 9.37 0 0 1-.44-2.62v-2.02a6 6 0 0 0-.22-1.6A14.59 14.59 0 0 1 9 45.48h-.12a9.87 9.87 0 0 1-1.67-.16 5.13 5.13 0 0 1-3.73-2.73 6.4 6.4 0 0 1-.56-1.44 11.72 11.72 0 0 1-.24-1.3A8.5 8.5 0 0 1 3 35.94l.21-.63a6 6 0 0 0-.88-5.44 5.11 5.11 0 0 1-.8-1.63v-.17A31.72 31.72 0 0 1 .11 21c0-.15 0-.3-.05-.45L0 20.17v-2.41a5.91 5.91 0 0 0 .09-.6v-.26a11.79 11.79 0 0 1 .77-3.11 20.86 20.86 0 0 1 4.31-6.53 22.27 22.27 0 0 1 7.67-5.15A29.08 29.08 0 0 1 23 0h1.07a34.39 34.39 0 0 1 5.78.5A33.28 33.28 0 0 1 37 2.57a25.91 25.91 0 0 1 7 4.21 18.83 18.83 0 0 1 4.07 4.82 11.85 11.85 0 0 1 1.56 4.25 33.05 33.05 0 0 1 .37 3.49 21.47 21.47 0 0 1-.25 5 11.86 11.86 0 0 1-1.16 3.47A8.37 8.37 0 0 1 47 30a6 6 0 0 0-1.61 6c.2.67.41 1.33.63 2a4.8 4.8 0 0 1-1.5 5.28 6.57 6.57 0 0 1-1.29.84c-.44.21-.88.41-1.33.61a4.92 4.92 0 0 1-1.48.39h-.35v3.28a6 6 0 0 0 .18 1.42 5.94 5.94 0 0 1 .17 1.18 5.06 5.06 0 0 1-1.88 4.23 7.67 7.67 0 0 1-.75.53l-.77.48a5.19 5.19 0 0 1-.48.24 6 6 0 0 0-2.27 1.74 7.11 7.11 0 0 1-4 2.46 6 6 0 0 0-1.23.42 8.1 8.1 0 0 1-2.45.7l-.44.07h-.1z"})),Ee||(Ee=o.createElement("path",{fill:"#565f77",stroke:"#1c1f26",strokeMiterlimit:10,d:"M24.78 57.87c-1.82-.28-3.48-1.5-5.21-2.14-1.23-.45-4.49-.92-5.34-2-1.15-1.41-.6-4.9-.9-6.61-.22-1.22-.57-6.2 1.17-2.92.7 1.32.14 3.36 2 4 .26.09 1-.56 1.62-.22s.31 1.1.72 1.37c1 .68.8-.53 1.17-.62.89-.21.7.41 1.4.47 1.12.1.6-.83 1.5-.84s1 .8 1.78.88.44-.69 1-.6c.31 0 .48.73.5.73 1 0 .81-.7 1.42-.81 1-.17 1 .74 1.76.75 1.39 0 .23-.93 1.24-1.54s1.61.72 2.33.56c1.7-.38 1-5 2.55-4.8 1.1.12.55 5.38.66 6.21.32 2.58-.34 2.25-2.39 3.31-1.86 1-2.47 2.93-4.49 3.68a13.17 13.17 0 0 1-4.49 1.14zm21.05-34.26a6.78 6.78 0 0 1-1.15 2.94c-.62.79-1.56 1.14-2.11 2A11.68 11.68 0 0 0 41 34.17c0 1.67 1.84 4.69 1 6.05-1.25 1.93-3.82 0-5.35.14a4.71 4.71 0 0 0-2.31.93c-1.13.93-.58 1.3-.8 2.46-.13.7-.3 1.72-1.31 1.73-1.41 0-.71-1-1.16-1.73-1.65-2.72-.68 1.33-1.43 2.12-1.21 1.23-1.58-1.12-2.64-.87.37 1.28-1.26 1.88-2 1-.47-.53-.52-2-1-2.72-.45.62 0 4-1.92 3-.78-.39-.44-3.47-1.4-1.5-.2.41.21 1.38-.3 1.6a4.17 4.17 0 0 1-1.94-.75c-.65-.75-.19-.51-.22-1.61 0-.63.1-2-.84-1.3-.39.27-1 3.67-1.61.84-.22-1 .58-1-.32-2a4.77 4.77 0 0 0-3-.89c-1.44 0-3 1.27-4.47.65C6 40.6 6.58 38 7 36.48s1.27-3.29.84-5-1.72-2.86-2.52-4.38A17.49 17.49 0 0 1 4.4 16C7.11 6.53 18.49 3.25 27.16 4.16 37.58 5.26 48 11.82 45.83 23.61zm-24 6.13c2.45-3.56-9.47-8.23-11.46-2.78C7.78 34 18.86 34 21.81 29.74zm6.47 6.8c-.13-1.22-2.1-5.17-3.52-5.06-.94.07-3.39 4.16-3.2 5.09.47 2.41 2.59-1 3.47-1 .16.01 3.5 3.37 3.24.97zM39.17 28c-.27-3-2.83-3.57-5.34-3.43-2 .12-6.93 1.43-6.75 4.19s4.28 4.11 6.44 4.13c2.98.02 5.95-1.48 5.65-4.89z"})));var Oe,_e;function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ae.apply(this,arguments)}const De=e=>o.createElement("svg",Ae({viewBox:"0 0 10 7.75"},e),Oe||(Oe=o.createElement("path",{d:"M0 0h3l3 3.88-3 3.87H0l3-3.87"})),_e||(_e=o.createElement("path",{d:"M4 0h3l3 3.88-3 3.87H4l3-3.87"})));class Le extends o.Component{static displayName="Results";static propTypes={applyLosses:d().func};static contextType=D._;static roles=["attackers","defenders"];static areLossesApplicable(e){if(!e.attackers||!e.attackers.length)return!1;let t=Object.keys(e.attackers[0].troops).reduce(((t,a)=>t+=e.attackers[0].troops[a]),0);return t=Object.keys(e.attackers[0].casualties).reduce(((t,a)=>t+=e.attackers[0].casualties[a]),t),t>0}constructor(e){super(e),this.state={extendedView:!1,responseTimeStamp:0},this.fillDataSource(e.simulationSettings)}dataSource=null;fillDataSource=e=>{this.dataSource={attack:{forces:e.attack.forces.slice().map((e=>Object.assign({},e)))},defence:{forces:e.defence.forces.slice().filter((e=>!0!==e.inactive)).map((e=>Object.assign({},e)))}}};shouldComponentUpdate(e,t){return this.state.extendedView!==t.extendedView||!(!e.responseTimeStamp||e.responseTimeStamp===this.state.responseTimeStamp)&&(this.fillDataSource(e.simulationSettings),t.responseTimeStamp=e.responseTimeStamp,!0)}isExtendAvailable(e){const{troopsKeys:t}=this.context.gameData;for(let a=0;a<Le.roles.length;a++)if(e[Le.roles[a]])for(let s=0;s<e[Le.roles[a]].length;s++)for(let i=0;i<t.length;i++)if(e[Le.roles[a]][s].troops[`t${t[i]}`]>1e5)return!0;return!1}render(){const{data:e,playerRole:t,roles:a,currentVillage:s,playerData:i,inputData:n}=this.props,r=this.dataSource,l=this.isExtendAvailable(e),o=(0,O.Jh)("combatSimulator.applyLosses"),c=!Le.areLossesApplicable(e);return(0,_.jsxs)("div",{className:"results",children:[(0,_.jsxs)("div",{className:["separator",l?"short":"long"].join(" "),children:[(0,_.jsx)("span",{className:"title",children:(0,O.Jh)("combatSimulator.results")}),l&&(0,_.jsx)("a",{className:["iconButton","extendView"].join(" "),title:(0,O.Jh)("combatSimulator.extend"),onClick:()=>this.setState({extendedView:!this.state.extendedView}),children:(0,_.jsx)(De,{className:this.state.extendedView?"collapse":"expand"})})]}),e.attackers&&e.attackers.map(((e,s)=>(0,_.jsx)(Me,{selectedByPlayer:t===a.ATTACK&&0===s,role:a.ATTACK,roleIndividuals:"forces",data:e,dataIndex:s,extendedView:this.state.extendedView,simulationSettings:r,roles:a},s))),e.defenders&&e.defenders.map(((e,s)=>(0,_.jsx)(Me,{selectedByPlayer:t===a.DEFENCE&&0===s,role:a.DEFENCE,roleIndividuals:"forces",data:e,dataIndex:s,extendedView:this.state.extendedView,simulationSettings:r,roles:a},s))),(0,_.jsx)(Pe,{attacker:e.statistics[1],defender:e.statistics[2],additionalRewards:e.additionalRewards}),(0,_.jsxs)("div",{className:"resultActionWrapper",children:[t===a.ATTACK&&null!==s&&r.attack.forces[0].tribe===i.villages.find((e=>e.did===s.did)).vid&&(0,_.jsxs)("form",{method:"post",action:`build.php?id=${Travian.Constants.BUILDING_SLOT_RALLY_POINT}&tt=2&newdid=${s.did}`,children:[(0,_.jsx)("input",{type:"hidden",name:"eventType",value:Travian.Constants.EVENT_TYPES[this.props.simulationSettings.type]}),H.map((e=>(0,_.jsx)("input",{type:"hidden",name:`troop[${e}]`,value:r.attack.forces[0].troops.amounts[e]??0},e))),n&&n.target&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("input",{type:"hidden",name:"x",value:n.target.x},"x"),(0,_.jsx)("input",{type:"hidden",name:"y",value:n.target.y},"y")]}),(0,_.jsx)(F.z,{type:"submit",id:"sendTroops",title:(0,O.Jh)("combatSimulator.sendTroops"),children:(0,O.Jh)("combatSimulator.sendTroops")})]}),(0,_.jsx)(F.z,{id:"applyLosses",title:o,onClick:()=>this.props.applyLosses(e),disabled:c,children:o})]})]})}}const Pe=e=>{const{attacker:t,defender:a,additionalRewards:s}=e;return(0,_.jsxs)("div",{className:"combatStatistics",children:[(0,_.jsx)("div",{className:"header",children:(0,_.jsx)("h2",{children:(0,O.Jh)("berichte.statistics")})}),(0,_.jsxs)("table",{className:"transparent",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{}),(0,_.jsx)("th",{children:(0,O.Jh)("berichte.angreifer")}),(0,_.jsx)("th",{children:(0,O.Jh)("berichte.verteidiger")})]})}),(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("berichte.combatStrength")}),(0,_.jsx)("td",{children:(0,O.Wb)("offence_medium",(0,O.eJ)(t.combat_strength,{grouping:!0}))}),(0,_.jsx)("td",{children:(0,O.Wb)("defence_medium",(0,O.eJ)(a.combat_strength,{grouping:!0}))})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("berichte.supplyBefore")}),(0,_.jsx)("td",{children:(0,O.Wb)("r5Big",(0,O.eJ)(t.supply_before,{grouping:!0}))}),(0,_.jsx)("td",{children:(0,O.Wb)("r5Big",(0,O.eJ)(a.supply_before,{grouping:!0}))})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("berichte.supplyLost")}),(0,_.jsx)("td",{children:(0,O.Wb)("r5Big",(0,O.eJ)(t.supply_lost,{grouping:!0}))}),(0,_.jsx)("td",{children:(0,O.Wb)("r5Big",(0,O.eJ)(a.supply_lost,{grouping:!0}))})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("berichte.resourcesLost")}),(0,_.jsx)("td",{children:(0,O.Wb)("resources_medium",(0,O.eJ)(t.resources_lost,{grouping:!0}))}),(0,_.jsx)("td",{children:(0,O.Wb)("resources_medium",(0,O.eJ)(a.resources_lost,{grouping:!0}))})]})]})]}),s&&(0,_.jsxs)("div",{className:"additionalRewards",children:[(0,_.jsx)("span",{children:(0,O.Jh)("berichte.additionalResourcesAdded")}),(0,_.jsx)("div",{className:"resourceWrapper",children:Object.keys(s).map((e=>(0,O.Wb)(e,s[e],"resources")))})]})]})};Pe.propTypes={attacker:d().object.isRequired,defender:d().object.isRequired,additionalRewards:d().object};const Be=e=>{const t={attack:{0:(0,_.jsx)(T,{className:"svgAttack"}),1:(0,_.jsx)(ke,{className:"svgAttackLost"})},defence:{0:(0,_.jsx)(u,{className:"svgDefend"}),1:(0,_.jsx)(ve,{className:"svgDefendLost"})}},a=Be.reduce(e.troops),s=Be.reduce(e.casualties),i=Be.reduce(e.balance);return(0,_.jsxs)("div",{className:"outcomeIcons",children:[t[e.role][parseInt(0+!!s)],0===i&&a?(0,_.jsx)(Ie,{}):null]})};Be.propTypes={role:d().string.isRequired,troops:d().object.isRequired,casualties:d().object.isRequired,balance:d().object.isRequired},Be.reduce=e=>Object.keys(e).reduce(((t,a)=>t+=e[a]),0);const Me=e=>{const{selectedByPlayer:t,data:a,dataIndex:s,extendedView:i,role:n,roleIndividuals:r,simulationSettings:l,roles:o}=e;let c,d,h={};for(let e=1;e<=11;e++)d=void 0!==a.troopsWounded&&void 0!==a.troopsWounded["t"+e]?a.troopsWounded["t"+e]:0,c=void 0!==a.troopsCaptured&&void 0!==a.troopsCaptured["t"+e]?a.troopsCaptured["t"+e]:0,h["t"+e]=a.troops["t"+e]+a.casualties["t"+e]-c;const m=l[n][r][s],p=n===o.DEFENCE&&s>0;let g=n===o.ATTACK?"attacker":"defender";g=p?"reinforcement":g;let v=a.reportLines?a.reportLines:[];return a.hero&&a.hero.isAlive&&m.hero.health-a.hero.healthLoss<=G.HERO_HEALTH_WARNING_THRESHOLD&&(v=[{iconCssClass:`unit uhero tribe${m.tribe}`,text:(0,O.Jh)("combatSimulator.warningHeroHealthLow"),cssClass:"negative warningHeroHealthLow"},...v]),(0,_.jsxs)("div",{className:`result ${n} ${s>0?"reinforcement":""} tribe${m.tribe}`,children:[(0,_.jsxs)("div",{className:"header",children:["reinforcement"!==g&&(0,_.jsxs)("div",{className:"avatar",children:[(0,_.jsx)("i",{className:`tribeIcon bigTribe${m.tribe}`}),n===o.ATTACK?(0,_.jsx)(T,{className:"svgAttack roleIcon"}):(0,_.jsx)(u,{className:"svgDefend roleIcon"})]}),"reinforcement"===g&&(0,_.jsx)("div",{className:"avatar",children:(0,_.jsx)("i",{className:`tribeIcon smallTribe${m.tribe}`})}),(0,_.jsx)("h2",{children:(0,O.Jh)(`combatSimulator.${t?"you":g}`)}),"reinforcement"!==g&&(0,_.jsxs)("div",{className:"outcome",children:[(0,_.jsx)("div",{className:"arrowWrapper",children:(0,_.jsx)("svg",{className:"outcomeArrow",viewBox:"0 0 20 20",preserveAspectRatio:"none",children:(0,_.jsx)("path",{d:"M0 0L20 10L0 20z"})})}),(0,_.jsx)(Be,{role:n,troops:a.troops,casualties:a.casualties,balance:h})]})]}),(0,_.jsx)("div",{className:"content preventMobileSwipeNavigation "+(i?"extended":""),children:(0,_.jsx)("table",{className:"transparent",children:(0,_.jsxs)("tbody",{children:[(0,_.jsx)(U,{tribe:m.tribe}),(0,_.jsx)(W,{extendedView:i,rowClass:"troopsInitial",troops:a.troops,tribe:m.tribe}),a.troopsCaptured&&(0,_.jsx)(W,{extendedView:i,rowClass:"troopsCaptured",troops:a.troopsCaptured,tribe:m.tribe}),(0,_.jsx)(W,{extendedView:i,rowClass:"troopsLoss",troops:a.casualties,tribe:m.tribe}),a.troopsWounded&&(0,_.jsx)(W,{extendedView:i,rowClass:"troopsWounded",troops:a.troopsWounded,tribe:m.tribe}),(0,_.jsx)(W,{extendedView:i,rowClass:"troopsResult",troops:h,tribe:m.tribe}),a.revives&&(0,_.jsx)(W,{extendedView:i,rowClass:"troopsRevived",troops:a.revives,tribe:m.tribe})]})})}),v.length>0?(0,_.jsx)("div",{className:"content",children:(0,_.jsx)("table",{className:"transparent",children:(0,_.jsx)("tbody",{children:v.map(((e,t)=>(0,_.jsx)("tr",{className:"combatReportLine",children:(0,_.jsxs)("td",{children:[void 0!==e.buildingID?(0,_.jsx)("i",{className:`${e.iconCssClass} manual`,onClick:()=>Travian.Game.Manual.open("building",e.buildingID)}):(0,_.jsx)("i",{className:e.iconCssClass}),(0,_.jsx)("span",{className:e.cssClass?e.cssClass:"",dangerouslySetInnerHTML:{__html:e.text}})]})},t)))})})}):null]},n)},Je=e=>{const{name:t,status:a,description:s,title:i,tribeId:n,details:r}=e;return(0,_.jsxs)("div",{className:["step",t,a].join(" "),children:[(0,_.jsx)("i",{className:[t,"tribe"+n,r.bannerHash?"withBanner":""].join(" "),title:i}),(0,_.jsx)("div",{className:"description",dangerouslySetInnerHTML:{__html:s}}),r.bannerHash&&(0,_.jsx)("img",{src:`/alliance/banner/${r.aid}/${r.bannerHash}.svg`,className:"allianceBanner"})]})};Je.propTypes={name:d().string.isRequired,status:d().string.isRequired,description:d().string.isRequired,title:d().string,tribeId:d().number,details:d().object},Je.defaultProps={title:null};class Ze extends o.Component{constructor(e){super(e),this.state={unlocked:1}}componentDidMount(){const{worldProgress:e}=this.props.data;let t=this.state.unlocked;e.map(((a,s)=>{const i=s+1;void 0!==e[i]&&"locked"!==e[i].state&&(t+=1)})),this.setState({unlocked:t})}render(){const{activatedPlayers:e,ageInDays:t,worldProgress:a}=this.props.data;return(0,_.jsx)("div",{id:"serverProgressionTimeLine",children:(0,_.jsxs)("div",{id:"timeLine",children:[(0,_.jsxs)("div",{className:"serverNumbers",children:[(0,_.jsxs)("div",{className:"counter serverTime",title:(0,O.Jh)("statistiken.daysSinceServerStart"),children:[(0,_.jsx)("i",{className:"serverTime"}),(0,_.jsx)("span",{children:t})]}),(0,_.jsxs)("div",{className:"counter activatedPlayers",title:(0,O.Jh)("statistiken.activatedPlayers"),children:[(0,_.jsx)("i",{className:"player_large"}),(0,_.jsx)("span",{children:e})]})]}),(0,_.jsx)("div",{className:`timeLine itemCount${a.length} unlocked${this.state.unlocked}`,children:a.map(((e,t)=>{null===e.value&&(e.value="-"),void 0===e.tribeId&&(e.tribeId=0);const a=e.details||{};return(0,_.jsx)(Je,{name:e.id,status:e.state,description:e.value,tribeId:e.tribeId,details:a,title:(0,O.Jh)(`statistiken.progressionStepTitle_${e.id}_${e.state}`,Object.assign({},a,{VALUE:e.value}))},t)}))})]})})}}var Fe=a(2931),Ve=a(6208),He=a(3815);class qe extends o.Component{constructor(e){super(e),this.state={language:"com",showAnimation:!1}}componentDidMount(){document.body.classList;this.setState({language:Travian.Game.language,showAnimation:!0})}render(){const{tribeDistribution:e}=this.props.data,{language:t,showAnimation:a}=this.state,s=O.ag.isLtr(t);let i=[];const n={v1:"#96323d",v2:"#428291",v3:"#de7e1b",v6:"#3e559a",v7:"#674876",v8:"#4E4545",v9:"#6895b0"};Object.keys(e).map((t=>{i.push({tribe:t,value:e[t].value,html:e[t].html,color:n[t]})}));return(0,_.jsx)("div",{id:"serverProgressionTribeDistribution",children:(0,_.jsxs)("div",{className:"chartWithLegend",children:[(0,_.jsx)("div",{className:"legendContainer",children:(0,_.jsx)("div",{className:"simpleLegend",children:(0,_.jsxs)("table",{className:"transparent",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,_.jsx)("i",{className:"distribution"})}),(0,_.jsx)("td",{colSpan:2,children:(0,O.Jh)("statistiken.currentTribeDistribution")})]})}),(0,_.jsx)("tbody",{children:Object.keys(e).map((t=>(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{children:[(0,_.jsx)("i",{className:`tribe${t.replace("v","")}_medium`})," "]}),(0,_.jsx)("td",{children:(0,O.Jh)("allgemein."+t)}),(0,_.jsx)("td",{children:(0,_.jsx)("span",{className:t,dangerouslySetInnerHTML:{__html:(0,O.eJ)(e[t].value,{unit:O.uo.PERCENT,fraction:1})}})})]},t)))})]})})}),(0,_.jsx)("div",{className:"chartContainer",children:(0,_.jsx)(Fe.u,{width:320,height:270,children:(0,_.jsx)(Ve.b,{data:i,dataKey:"value",label:({cx:e,cy:t,midAngle:a,innerRadius:n,outerRadius:r,percent:l,index:o})=>{if(l<.05)return;const c=1.25*r;let d=e+c*Math.cos(-a*Math.PI/180),h=t+c*Math.sin(-a*Math.PI/180);let u=d,m=h,p=s?"start":"end";a>-95&&(u=d+16,p=s?"start":"end"),a<-95&&(u=d,m=h+25,p="middle"),a<-150&&(u=d-16,m=h,p=s?"end":"start"),a<-240&&(u=d,m=h-25,p="middle");const g={["v"+Travian.Constants.TRIBE_ID.roman]:"roman_medium",["v"+Travian.Constants.TRIBE_ID.teuton]:"teuton_medium",["v"+Travian.Constants.TRIBE_ID.gaul]:"gaul_medium",["v"+Travian.Constants.TRIBE_ID.egyptian]:"egyptian_medium",["v"+Travian.Constants.TRIBE_ID.hun]:"hun_medium",["v"+Travian.Constants.TRIBE_ID.spartan]:"spartan_medium"};return(0,_.jsxs)("g",{children:[(0,_.jsx)("image",{xlinkHref:Travian.Game.getImageDirectoryPath()+"global/tribes/"+g[i[o].tribe]+".png",x:Math.round(d)-13,y:Math.round(h)-13,width:26,height:26}),s&&(0,_.jsx)("text",{x:u,y:m,width:150,fill:"black",textAnchor:p,dominantBaseline:"central",dangerouslySetInnerHTML:{__html:(0,O.eJ)(i[o].value,{unit:O.uo.PERCENT,fraction:1})},className:["nation","nation"+i[o].tribe.replace("v","")].join(" ")})]})},labelLine:!1,outerRadius:"60%",startAngle:90,endAngle:-270,isAnimationActive:a,children:i.map(((e,t)=>(0,_.jsx)(He.b,{fill:e.color,color:e.color},t)))})})})]})})}}class Ue extends o.Component{constructor(e){super(e)}render(){const{timeLine:e,tribeDistribution:t}=this.props.data;return(0,_.jsxs)("div",{id:"serverProgression",children:[(0,_.jsxs)("h4",{children:[(0,_.jsx)("i",{className:"serverProgression"})," ",(0,O.Jh)("statistiken.serverProgression")]}),(0,_.jsx)(Ze,{data:e}),(0,_.jsx)(qe,{data:t})]})}}const ze="server",$e="alliance",We={activeTab:d().oneOf([ze,$e]).isRequired,tabs:d().shape({TAB_SERVER:d().oneOf([ze]).isRequired,TAB_ALLIANCE:d().oneOf([$e]).isRequired}).isRequired,toggleTab:d().func.isRequired},Ge={tabs:{TAB_SERVER:ze,TAB_ALLIANCE:$e}},Ye=e=>class extends o.Component{constructor(e){super(e),this.state={active:ze},this.tabs={TAB_SERVER:ze,TAB_ALLIANCE:$e},this.setActiveTab=this.setActiveTab.bind(this)}setActiveTab(e){this.setState({active:e})}render(){return(0,_.jsx)(e,{...this.props,activeTab:this.state.active,tabs:this.tabs,toggleTab:this.setActiveTab})}};var Ke=a(6619);const Xe="Population",Qe="Resource",et="Production",tt="Offensive",at="Defensive",st="CPperDay",it="CPsoFar";class nt extends o.Component{static propTypes=Object.assign({rankData:d().shape({server:d().oneOfType([d().number,e=>null===e]),alliance:d().oneOfType([d().number,e=>null===e])}).isRequired,switchable:d().bool,active:d().bool,onToggle:d().func,rankType:d().oneOf([Xe,Qe,et,tt,at,st,it]).isRequired,village:d().shape({name:d().string})},We);static defaultProps=Object.assign({},Ge);constructor(e){super(e);const{TAB_SERVER:t,TAB_ALLIANCE:a}=this.props.tabs;this.toggleServer=e=>this.toggle(e,t),this.toggleAlliance=e=>this.toggle(e,a)}componentDidUpdate(){"undefined"!=typeof Travian&&Travian.Tip.refresh()}toggle(e,t){e.preventDefault(),this.props.toggleTab(t),this.props.onToggle&&this.props.onToggle(t)}render(){const{rankData:e,tabs:{TAB_SERVER:t,TAB_ALLIANCE:a},switchable:s,rankType:i}=this.props,n=this.props.village||{},r=this.props.activeTab,l=null===e.alliance,o=["iconButton","round",r===t?"active":""].join(" "),c=["iconButton","round",r===a?"active":"",l?"disabled":""].join(" ");return(0,_.jsxs)("div",{className:"ServerAllianceRank",children:[(0,_.jsxs)("div",{className:"typeWrapper",children:[(0,_.jsxs)("div",{className:"buttonWrapper",children:[(0,_.jsx)("div",{children:(0,O.Jh)("statistiken.server")}),s?(0,_.jsx)("a",{href:"#",className:o,onClick:this.toggleServer,children:(0,_.jsx)("i",{className:"gameworld_large"})}):(0,_.jsx)("i",{className:"gameworld_large"})]}),void 0!==e&&(0,_.jsx)("div",{className:["rankDisplay",i].join(" "),dangerouslySetInnerHTML:{__html:null===e.server?"-":(0,Ke.k)(e.server,0)},title:null===e.server?(0,O.Jh)("statistiken.noRankYet"):(0,O.Jh)(`statistiken.your${i}Rank`,{RANK:(0,O.eJ)(e.server),VILLAGE:n.name})})]}),(0,_.jsxs)("div",{className:"typeWrapper",children:[(0,_.jsxs)("div",{className:["buttonWrapper",l?"disabled":""].join(" "),children:[(0,_.jsx)("div",{children:(0,O.Jh)("allianz.allianz")}),s?(0,_.jsx)("a",{href:"#",className:c,onClick:this.toggleAlliance,children:(0,_.jsx)("i",{className:"alliance_large"})}):(0,_.jsx)("i",{className:"alliance_large"})]}),void 0!==e&&(0,_.jsx)("div",{className:["rankDisplay",i,l?"disabled":""].join(" "),dangerouslySetInnerHTML:{__html:null===e.alliance?"-":(0,Ke.k)(e.alliance,0)},title:null===e.alliance?(0,O.Jh)("statistiken.youAreNotInAlly"):(0,O.Jh)(`statistiken.your${i}RankInAlly`,{RANK:(0,O.eJ)(e.alliance),VILLAGE:n.name})})]})]})}}const rt=Ye(nt);rt.typePopulation=Xe,rt.typeResource=Qe,rt.typeProduction=et,rt.typeOffensive=tt,rt.typeDefensive=at,rt.typeCP="CP",rt.typeCPperDay=st,rt.typeCPsoFar=it;var lt=a(6888),ot=a(4195),ct=a(5358),dt=a(3023),ht=a(6108);const ut=e=>{const{data:t}=e;return(0,_.jsxs)(lt.T,{width:342,height:228,data:t,baseValue:"dataMax",children:[(0,_.jsx)(ot.q,{strokeDasharray:"3 3"}),(0,_.jsx)(ct.B,{reversed:!0,interval:"preserveStartEnd",tick:{textAnchor:O.ag.isLtr(Travian.Game.language)?"end":"start"},domain:[1,"dataMax"],allowDecimals:!1}),(0,_.jsx)(dt.K,{dataKey:"day",type:"number",interval:"preserveStartEnd",tickCount:Math.min(t.length,5)}),(0,_.jsx)(ht.u,{type:"linear",dataKey:"rank",stroke:"#bf6060",fill:"#EA866E",fillOpacity:1})]})},mt="expanded",pt="collapsed",gt="statisticsSection",vt={sectionStatus:d().oneOf([mt,pt]).isRequired,sectionToggle:d().func.isRequired,initFromPreference:d().func.isRequired},xt=e=>class extends o.Component{constructor(e){super(e),this.state={sectionStatus:mt},this.toggleStatus=this.toggleStatus.bind(this),this.initFromPreference=this.initFromPreference.bind(this)}toggleStatus(e,t){e.preventDefault();let a=this.state.sectionStatus===mt?pt:mt;this.setState({sectionStatus:a}),void 0!==Travian.Game.Preferences&&Travian.Game.Preferences.set(gt+t,a)}initFromPreference(e){if(void 0!==Travian.Game.Preferences){let t=Travian.Game.Preferences.get(gt+e);null!==t&&this.setState({sectionStatus:t})}}componentDidUpdate(){"undefined"!=typeof Travian&&Travian.Tip.refresh()}render(){return(0,_.jsx)(e,{...this.props,sectionStatus:this.state.sectionStatus,sectionToggle:this.toggleStatus,initFromPreference:this.initFromPreference})}};class bt extends o.Component{static propTypes=Object.assign({data:d().shape({serverAge:d().shape({ageInDays:d().number.isRequired}).isRequired,hasAlliance:d().bool.isRequired,serverRank:d().array.isRequired,allianceRank:d().oneOfType([d().array,e=>null===e])}).isRequired},We,vt);componentDidMount(){this.props.initFromPreference("PopulationRank")}render(){const{hasAlliance:e,serverRank:t,allianceRank:a}=this.props.data,s=this.props.activeTab,i=e?a:[],n={server:void 0!==t[t.length-1]?t[t.length-1].rank:null,alliance:void 0!==i[i.length-1]?i[i.length-1].rank:null};return(0,_.jsxs)("div",{id:"populationRank",className:this.props.sectionStatus,children:[(0,_.jsx)("div",{className:["openedClosedSwitch",this.props.sectionStatus===mt?"switchOpened":"switchClosed"].join(" "),onClick:e=>this.props.sectionToggle(e,"PopulationRank")}),(0,_.jsxs)("h4",{children:[(0,_.jsx)("i",{className:"populationRank"})," ",(0,O.Jh)("statistiken.populationRank")]}),this.props.sectionStatus===mt&&(0,_.jsxs)("div",{className:"chartWithLegend",children:[(0,_.jsx)("div",{className:"legendContainer",children:(0,_.jsx)("div",{className:"simpleLegend",children:(0,_.jsx)(rt,{switchable:!1,rankData:n,rankType:rt.typePopulation})})}),(0,_.jsxs)("div",{className:"chartContainer",children:["server"===s&&(0,_.jsx)(ut,{data:t}),"alliance"===s&&i.length>0&&(0,_.jsx)(ut,{data:i})]})]})]})}}const jt=xt(Ye(bt));var ft=a(9307);class yt extends o.Component{static propTypes={type:d().string.isRequired,villageName:d().string};static defaultProps={villageName:""};constructor(e){super(e),this.state={showAnimation:!1,displayLabels:!1}}componentDidMount(){this.setState({showAnimation:!0,displayLabels:!1});let e=this;setTimeout((function(){e.setState({displayLabels:!0})}),2e3)}render(){const{type:e,villageName:t}=this.props;let{data:a}=this.props;const{displayLabels:s}=this.state;let{showAnimation:i}=this.state,n={},r={};a.map(((e,t)=>{"worse"===e.description&&(r.percent=Math.round(10*e.value)/10,r.totalSum=e.totalSum),"better"===e.description&&(n.percent=Math.round(10*e.value)/10,n.totalSum=e.totalSum)}));let l=null,o=!0;const c="offenceStrength"===e?"village_medium":"player_medium";n.totalSum||r.totalSum||(o=!1,i=!1,l="disabled",a=[{value:100,color:"#F2F2F2"}]);let d="statistiken.numOfVillagesBetter",h="statistiken.numOfVillagesWorse";if(t){const e="ThanVillage";d+=e,h+=e}return(0,_.jsxs)("div",{className:"strengthRankChart",children:[(0,_.jsx)("div",{className:"chartTitle",children:(0,O.Jh)("offenceStrength"===e?"statistiken.offensiveCompare":"statistiken.defensiveCompare")}),s&&(0,_.jsxs)("div",{className:l,children:[(0,_.jsxs)("div",{className:"worse centeredText",title:(0,O.Jh)(h,{VILLAGE:t}),children:[(0,_.jsxs)("p",{className:"inlineIcon",children:[(0,_.jsx)("i",{className:c}),(0,_.jsx)("span",{children:r.totalSum})]}),(0,_.jsx)("p",{children:(0,O.Jh)("statistiken.worse")})]}),(0,_.jsxs)("div",{className:"better centeredText",title:(0,O.Jh)(d,{VILLAGE:t}),children:[(0,_.jsxs)("p",{className:"inlineIcon",children:[(0,_.jsx)("i",{className:c}),(0,_.jsx)("span",{children:n.totalSum})]}),(0,_.jsx)("p",{children:(0,O.Jh)("statistiken.better")})]})]}),(0,_.jsxs)(Fe.u,{width:320,height:270,children:[(0,_.jsx)(Ve.b,{data:a,dataKey:"value",labelLine:!1,innerRadius:"23%",outerRadius:"60%",startAngle:90,endAngle:-270,isAnimationActive:i,children:a.map(((e,t)=>(0,_.jsx)(He.b,{fill:e.color,color:e.color},t)))}),o&&(0,_.jsx)(ft.u,{formatter:function(e,t,a){return"better"===a.payload.description?(0,O.eJ)(n.percent,{unit:O.uo.PERCENT}):(0,O.eJ)(r.percent,{unit:O.uo.PERCENT})},labelFormatter:()=>""})]})]})}}var Tt=a(4822);class Nt extends o.Component{static propTypes=Object.assign({data:d().shape({totalPlayers:d().number.isRequired,totalVillages:d().number.isRequired,defenceRanks:d().shape({server:d().oneOfType([d().number,e=>null===e]),alliance:d().oneOfType([d().number,e=>null===e])}).isRequired,offenceStrength:d().arrayOf(d().shape({villageId:d().number.isRequired,strength:d().number.isRequired}).isRequired).isRequired,defenceStrength:d().arrayOf(d().shape({villageId:d().number.isRequired,strength:d().number.isRequired}).isRequired).isRequired,villages:d().objectOf(d().shape({name:d().string.isRequired,offenceRanks:d().shape({server:d().oneOfType([d().number,e=>null===e]),alliance:d().oneOfType([d().number,e=>null===e])}).isRequired}).isRequired),defenceData:d().shape({total:d().number.isRequired,infantry:d().number.isRequired,cavalry:d().number.isRequired})}).isRequired},vt);static flushPieChartData(e){return e.map((e=>(e.value=0,e.totalSum=0,e.color="#F2F2F2",e))),e}static makeRankChartData(e,t){let a=[{description:"worse",value:Math.round(100*(e-t.server)/(e-1)),totalSum:e-t.server,color:"#608cbc"},{description:"better",value:Math.round(100*(t.server-1)/(e-1)),totalSum:t.server-1,color:"#ea866e"}];return null===t.server&&(a=Nt.flushPieChartData(a)),a}constructor(e){super(e),this.state={language:"",type:"offenceStrength",activeVillage:this.props.data.offenceStrength[0]},this.toggleType=this.toggleType.bind(this),this.changeVillage=this.changeVillage.bind(this)}componentDidMount(){this.props.initFromPreference("MilitaryStrengthRank");let e=this.state;e.language=Travian.Game.language,this.setState(e)}componentDidUpdate(){Travian.Tip.refresh()}toggleType(e){e.preventDefault(),this.setState({type:"offenceStrength"===this.state.type?"defenceStrength":"offenceStrength"})}changeVillage(e,t){e.preventDefault(),this.setState({activeVillage:t})}render(){const{totalPlayers:e,totalVillages:t,defenceRanks:a,offenceStrength:s,defenceStrength:i,defenceData:n,villages:r}=this.props.data,{type:l,activeVillage:o,language:c}=this.state,d="offenceStrength"===l?s:i,h="offenceStrength"===l?t:e,u="offenceStrength"===l?r[o.villageId].offenceRanks:a,m=Nt.makeRankChartData(h,u),p="offenceStrength"===l?rt.typeOffensive:rt.typeDefensive,g=p===rt.typeOffensive?{name:r[o.villageId].name}:{},v={className:"rankDisplay",dangerouslySetInnerHTML:{__html:u.server?(0,O.kT)(u.server,0):"-"},title:u.server?(0,O.Jh)(`statistiken.your${p}Rank`,{RANK:(0,O.eJ)(u.server),VILLAGE:g.name}):"-"},x=Tt.Z.isLtr(c);return(0,_.jsxs)("div",{id:"militaryStrengthRank",children:[(0,_.jsx)("div",{className:["openedClosedSwitch",this.props.sectionStatus===mt?"switchOpened":"switchClosed"].join(" "),onClick:e=>this.props.sectionToggle(e,"MilitaryStrengthRank")}),(0,_.jsxs)("h4",{children:[(0,_.jsx)("i",{className:"militaryStrengthRank"})," ",(0,O.Jh)("statistiken.militaryStrengthRank")]}),this.props.sectionStatus===mt&&(0,_.jsx)("div",{children:(0,_.jsxs)("div",{className:"chartWithLegend",children:[(0,_.jsxs)("div",{className:"legendContainer",children:[(0,_.jsxs)("div",{className:"legendTabs",children:[(0,_.jsxs)("div",{className:["tab","inlineIcon","offenceStrength"===l?"active":""].join(" "),onClick:e=>"defenceStrength"===l?this.toggleType(e):null,children:[(0,_.jsx)("i",{className:"offence_medium",title:(0,O.Jh)("statistiken.offensive")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.offensive")})]}),(0,_.jsxs)("div",{className:["tab","inlineIcon","defenceStrength"===l?"active":""].join(" "),onClick:e=>"offenceStrength"===l?this.toggleType(e):null,children:[(0,_.jsx)("i",{className:"defence_medium",title:(0,O.Jh)("statistiken.defensive")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.defensive")})]})]}),(0,_.jsxs)("div",{className:"simpleLegend",children:[(0,_.jsx)(rt,{rankData:u,rankType:p,village:g}),d.length>0&&(0,_.jsxs)("table",{className:"villageList transparent",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{}),(0,_.jsx)("th",{children:(0,_.jsx)("i",{className:"village_medium",title:(0,O.Jh)("statistiken.dorf")})}),(0,_.jsx)("th",{children:"offenceStrength"===l?(0,_.jsx)("i",{className:"offence_medium",title:(0,O.Jh)("statistiken.offensive")}):(0,_.jsx)("i",{className:"defence_medium",title:(0,O.Jh)("statistiken.defensive")})})]})}),(0,_.jsx)("tbody",{children:d.map(((e,t)=>{let{villageId:a,strength:s}=e;return(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{className:"rank",children:["offenceStrength"===l&&(0,_.jsx)("a",{className:["iconButton",o.villageId===a?"active":""].join(" "),href:"",onClick:t=>this.changeVillage(t,e),children:(0,_.jsx)("span",{children:t+1})}),"defenceStrength"===l&&(0,_.jsx)("span",{children:t+1})]}),(0,_.jsx)("td",{className:"name",children:r[a].name}),(0,_.jsx)("td",{className:"strength",children:(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,O.eJ)(s,{grouping:!0,fraction:0})}})})]},a)}))})]})]})]}),(0,_.jsxs)("div",{className:"chartContainer",children:[(0,_.jsx)(yt,{data:m,type:l,villageName:g.name}),(0,_.jsxs)("div",{className:"chartDetails",children:["offenceStrength"===l&&(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:"strength",title:(0,O.Jh)("statistiken.offensiveStrengthVillage",{VILLAGE:g.name}),children:(0,_.jsxs)("div",{className:"inlineIcon",children:[(0,_.jsx)("i",{className:"offence_medium"}),(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,O.eJ)(o.strength,{grouping:!0,fraction:0})}})]})}),(0,_.jsx)("div",{className:"name",children:(0,_.jsxs)("div",{className:"inlineIcon",children:[(0,_.jsx)("i",{className:"village_medium",title:(0,O.Jh)("statistiken.dorf")}),(0,_.jsxs)("span",{children:[r[o.villageId].name,"   ",o.name]})]})}),(0,O.Jh)("statistiken.offensiveCompareDescription"),(0,_.jsx)("div",{...v})]}),"defenceStrength"===l&&(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:"strength",title:`\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p>${(0,O.Jh)("statistiken.defenceAgainstCavalry")}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p><img src="${Travian.Variables.gpackUrl}img_${x?"ltr":"rtl"}/views/General/combat/defenceCavalry_small.png"/> <span class="valignTop">${(0,O.eJ)(n.cavalry,{grouping:!0,fraction:0})}</span></p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p>${(0,O.Jh)("statistiken.defenceAgainstInfantry")}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p><img src="${Travian.Variables.gpackUrl}img_${x?"ltr":"rtl"}/views/General/combat/defenceInfantry_small.png"/> <span class="valignTop">${(0,O.eJ)(n.infantry,{grouping:!0,fraction:0})}</span></p>\n\t\t\t\t\t\t\t\t\t\t\t`,children:(0,_.jsxs)("div",{className:"inlineIcon",children:[(0,_.jsx)("i",{className:"defence_medium"}),(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,O.eJ)(n.total,{grouping:!0,fraction:0})}})]})}),(0,O.Jh)("statistiken.defensiveCompareDescription"),(0,_.jsx)("div",{...v})]})]})]})]})})]})}}const Ct=xt(Nt);var St,kt=a(3012);function wt(){return wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},wt.apply(this,arguments)}const Et=e=>o.createElement("svg",wt({viewBox:"0 0 22 22",preserveAspectRatio:"none"},e),St||(St=o.createElement("path",{d:"M6 0L6 12L0 12L11 22L22 12L16 12L16 0Z"})));class Rt extends o.Component{static propTypes={data:d().array.isRequired,dataKeyWon:d().string.isRequired,dataKeyLost:d().string.isRequired,containerClassName:d().string,chartTitle:d().string,textLost:d().string,textWon:d().string,iconClassName:d().string,labelsInsideTooltips:d().bool};constructor(e){super(e),this.state={showAnimation:!1,displayLabels:!1},this.animationTimeout=null}componentDidMount(){this.setState({showAnimation:!0,displayLabels:!1}),this.animationTimeout=setTimeout((()=>this.setState({displayLabels:!0})),2e3),"undefined"!=typeof Travian&&Travian.Tip.refresh()}componentWillUnmount(){this.animationTimeout&&clearTimeout(this.animationTimeout)}componentDidUpdate(){"undefined"!=typeof Travian&&Travian.Tip.refresh()}render(){const{data:e,dataKeyWon:t,dataKeyLost:a,containerClassName:s,chartTitle:i,textLost:n,textWon:r,iconClassName:l,labelsInsideTooltips:o}=this.props,{displayLabels:c}=this.state;let d=this.state.showAnimation,h={},u={},m=new kt.Z(0),p="#F2F2F2",g="#F2F2F2";e.map((e=>{e.description===t&&(h.percent=parseFloat(new kt.Z(e.value).mul(100).toFixed()),h.totalSum=e.totalSum,m=m.plus(new kt.Z(e.value).abs()),p=e.color),e.description===a&&(u.percent=parseFloat(new kt.Z(e.value).mul(100).toFixed()),u.totalSum=e.totalSum,m=m.plus(new kt.Z(e.value).abs()),g=e.color)}));let v=e;const x=m.gt(0);x||(v=[{value:1,color:"#F2F2F2"}],d=!1,p="#F2F2F2",g="#F2F2F2");const b=x?null:"disabled",j=b;return(0,_.jsxs)("div",{className:s,children:[(0,_.jsx)("div",{className:"chartTitle",children:i}),(c||!x)&&(0,_.jsxs)("div",{className:b,children:[(0,_.jsxs)("div",{className:"lost centeredText",children:[(0,_.jsxs)("p",{title:o?n:"",children:[(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,O.eJ)(u.percent,{unit:O.uo.PERCENT})}}),(0,_.jsx)(Et,{className:`svgArrow ${j}`})]}),(0,_.jsxs)("p",{title:o?n:"",className:"inlineIcon",children:[(0,_.jsx)("i",{className:l})," ",(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:u.totalSum}})]}),!o&&(0,_.jsx)("p",{children:n})]}),(0,_.jsxs)("div",{className:"won centeredText",children:[(0,_.jsxs)("p",{title:o?r:"",children:[(0,_.jsx)(Et,{className:`svgArrow ${j}`}),(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,O.eJ)(h.percent,{unit:O.uo.PERCENT})}})]}),(0,_.jsxs)("p",{title:o?r:"",className:"inlineIcon",children:[(0,_.jsx)("i",{className:l})," ",(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:h.totalSum}})]}),!o&&(0,_.jsx)("p",{children:r})]})]}),(0,_.jsxs)(Fe.u,{width:320,height:270,children:[(0,_.jsx)(Ve.b,{data:v,dataKey:"value",labelLine:!1,outerRadius:"60%",startAngle:90,endAngle:-270,isAnimationActive:d,children:v.map(((e,t)=>(0,_.jsx)(He.b,{fill:e.color,color:e.color},t)))}),x&&(0,_.jsx)(ft.u,{formatter:function(e,a,s){if(!0===o){return(s.payload.description===t?r:n)+": "+(0,O.eJ)(Math.round(100*e),{unit:O.uo.PERCENT})}return(0,O.eJ)(Math.round(100*e),{unit:O.uo.PERCENT})},labelFormatter:()=>""})]})]})}}class It extends o.Component{render(){return(0,_.jsx)(Rt,{data:this.props.data,dataKeyLost:"bountyLost",dataKeyWon:"bountyWon",containerClassName:"raidChart",chartTitle:(0,O.Jh)("berichte.beute"),textLost:(0,O.Jh)("statistiken.bountyLost"),textWon:(0,O.Jh)("statistiken.bountyWon"),iconClassName:"bounty_medium",labelsInsideTooltips:!0})}}class Ot extends o.Component{render(){return(0,_.jsx)(Rt,{data:this.props.data,dataKeyLost:"outgoingTradingVolume",dataKeyWon:"incomingTradingVolume",containerClassName:"tradeChart",chartTitle:(0,O.Jh)("statistiken.tradingVolume"),textLost:(0,O.Jh)("statistiken.outgoingTradingVolume"),textWon:(0,O.Jh)("statistiken.incomingTradingVolume"),iconClassName:"trade_medium",labelsInsideTooltips:!0})}}class _t extends o.Component{constructor(e){super(e),this.state={language:"com",showAnimation:!1}}componentDidMount(){document.body.classList;this.setState({language:Travian.Game.language,showAnimation:!1})}render(){const{data:e}=this.props,{showAnimation:t}=this.state;return(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:"chartTitle",children:(0,O.Jh)("production.production")}),(0,_.jsxs)(Fe.u,{width:320,height:270,children:[(0,_.jsx)(Ve.b,{data:e,dataKey:"value",label:({cx:t,cy:a,midAngle:s,innerRadius:i,outerRadius:n,percent:r,index:l})=>{if(r<.1)return;const o=1.25*n;let c=18;switch(e[l].resource){case"r1":c=19;break;case"r4":c=24;break;default:c=18}let d=Math.round(t+o*Math.cos(-s*Math.PI/180)),h=Math.round(a+o*Math.sin(-s*Math.PI/180));let u,m=d;u=-s>0&&-s<180?h+26:h-26;const p={["r"+Travian.Constants.RES_LUMBER]:Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_LUMBER],["r"+Travian.Constants.RES_CLAY]:Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_CLAY],["r"+Travian.Constants.RES_IRON]:Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_IRON],["r"+Travian.Constants.RES_CROP]:Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_CROP]};return(0,_.jsxs)("g",{children:[(0,_.jsx)("image",{xlinkHref:Travian.Game.getImageDirectoryPath()+"global/resources/"+p[e[l].resource]+"_small.png",x:d-13,y:h-c/2,width:26,height:c}),(0,_.jsx)("text",{x:m,y:u,width:150,fill:"black",textAnchor:"middle",dominantBaseline:"central",dangerouslySetInnerHTML:{__html:e[l].totalSum}})]})},labelLine:!1,outerRadius:"60%",startAngle:90,endAngle:-270,isAnimationActive:t,children:e.map(((e,t)=>(0,_.jsx)(He.b,{fill:e.color,color:e.color},t)))}),(0,_.jsx)(ft.u,{formatter:function(e,t,a){const s=a.payload.payload;return`${(0,O.Jh)("allgemein."+s.resource)}: ${(0,O.eJ)(Math.round(10*e)/10,{unit:O.uo.PERCENT,fraction:1})} - ${s.preciseValue}`},labelFormatter:()=>""})]})]})}}const At="perDay",Dt="soFar",Lt={type:d().oneOf([At,Dt]).isRequired,toggleType:d().func.isRequired},Pt=e=>class extends o.Component{constructor(e){super(e),this.state={type:At},this.toggleType=this.toggleType.bind(this)}toggleType(e){e.preventDefault(),this.setState({type:this.state.type===At?Dt:At})}render(){return(0,_.jsx)(e,{...this.props,type:this.state.type,toggleType:this.toggleType})}};class Bt extends o.Component{static propTypes=Object.assign({data:d().shape({positive:d().shape({raid:d().object.isRequired,trade:d().object.isRequired,production:d().object.isRequired}).isRequired,negative:d().shape({raid:d().object.isRequired,trade:d().object.isRequired}).isRequired,balance:d().number.isRequired,production:d().shape({soFar:d().shape({r1:d().object.isRequired,r2:d().object.isRequired,r3:d().object.isRequired,r4:d().object.isRequired}),perDay:d().shape({r1:d().object.isRequired,r2:d().object.isRequired,r3:d().object.isRequired,r4:d().object.isRequired})}).isRequired,rank:d().shape({server:d().oneOfType([d().number,e=>null===e]),alliance:d().oneOfType([d().number,e=>null===e])}).isRequired,rankDaily:d().shape({server:d().oneOfType([d().number,e=>null===e]),alliance:d().oneOfType([d().number,e=>null===e])}).isRequired}).isRequired},vt,Lt);static divideBig(e,t,a=!1){let s;return s=typeof e===kt.Z&&typeof t===kt.Z?e.div(t):new kt.Z(e).div(new kt.Z(t)),a?parseFloat(s.mul(100).toFixed()):s.toFixed()}constructor(e){super(e),this.state={barsAnimated:!1,pieChartSelected:"production"}}componentDidMount(){const e=this;this.props.initFromPreference("ResourceRank"),setTimeout((function(){e.setState({barsAnimated:!0})}),2e3)}componentDidUpdate(){if("perDay"===this.props.type&&"production"!==this.state.pieChartSelected){let e=this.state;e.pieChartSelected="production",this.setState(e)}}switchChart(e,t){e.preventDefault(),this.setState({pieChartSelected:t})}render(){const{positive:e,negative:t,balance:a,rank:s,rankDaily:i}=this.props.data,{toggleType:n,type:r}=this.props,{barsAnimated:l,pieChartSelected:o}=this.state,c=this.props.data.production[r],d="perDay"===r,h=e.sum.eq(0)?0:Bt.divideBig(e.raid,e.sum,!0),u=e.sum.eq(0)?0:Bt.divideBig(e.trade,e.sum,!0),m=e.sum.eq(0)?0:Bt.divideBig(e.production,e.sum,!0);let p={raid:e.sum.eq(0)?0:Bt.divideBig(t.raid,e.sum,!0),trade:e.sum.eq(0)?0:Bt.divideBig(t.trade,e.sum,!0)};const g=p.raid+p.trade;g>100&&(p.raid=p.raid/g*100,p.trade=p.trade/g*100);const v=e.raid.abs().plus(t.raid).abs(),x=e.trade.abs().plus(t.trade).abs(),b=[{description:"bountyWon",value:v.gt(0)?parseFloat(Bt.divideBig(e.raid,v)):0,totalSum:(0,Ke.k)(e.raid,1),color:"#eda932"},{description:"bountyLost",value:v.gt(0)?parseFloat(Bt.divideBig(t.raid,v)):0,totalSum:(0,Ke.k)(-t.raid,1),color:"#c35742"}],j=[{description:"incomingTradingVolume",value:x.gt(0)?parseFloat(Bt.divideBig(e.trade,x)):0,totalSum:(0,Ke.k)(e.trade,1),color:"#f4c97e"},{description:"outgoingTradingVolume",value:x.gt(0)?parseFloat(Bt.divideBig(t.trade,x)):0,totalSum:(0,Ke.k)(-t.trade,1),color:"#d48879"}],f="perDay"===r?c.r1.plus(c.r2).plus(c.r3).plus(c.r4):e.production,y=[{resource:"r1",value:f.eq(0)?0:Bt.divideBig(c.r1,f,!0),preciseValue:(0,O.eJ)(c.r1,{grouping:!0,fraction:0}),totalSum:(0,Ke.k)(c.r1,1),color:"#f37800"},{resource:"r2",value:f.eq(0)?0:Bt.divideBig(c.r2,f,!0),preciseValue:(0,O.eJ)(c.r2,{grouping:!0,fraction:0}),totalSum:(0,Ke.k)(c.r2,1),color:"#f09e32"},{resource:"r3",value:f.eq(0)?0:Bt.divideBig(c.r3,f,!0),preciseValue:(0,O.eJ)(c.r3,{grouping:!0,fraction:0}),totalSum:(0,Ke.k)(c.r3,1),color:"#b1cacf"},{resource:"r4",value:f.eq(0)?0:Bt.divideBig(c.r4,f,!0),preciseValue:(0,O.eJ)(c.r4,{grouping:!0,fraction:0}),totalSum:(0,Ke.k)(c.r4,1),color:"#ffde00"}];return(0,_.jsxs)("div",{id:"resourceRank",children:[(0,_.jsx)("div",{className:["openedClosedSwitch",this.props.sectionStatus===mt?"switchOpened":"switchClosed"].join(" "),onClick:e=>this.props.sectionToggle(e,"ResourceRank")}),(0,_.jsxs)("h4",{children:[(0,_.jsx)("i",{className:"resourceRank"})," ",(0,O.Jh)("statistiken.resourceRank")]}),this.props.sectionStatus===mt&&(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"resourceBarChartContainer",children:[(0,_.jsxs)("div",{className:["resourceBarChart",l?"animated":""].join(" "),children:[(0,_.jsxs)("div",{className:"barContainer",children:[(0,_.jsxs)("div",{className:["positive",l?"animated":""].join(" "),children:[" ",(0,_.jsx)("span",{className:"raid",style:{width:h+"%"}}),(0,_.jsx)("span",{className:"trade",style:{width:u+"%"}}),(0,_.jsx)("span",{className:"production",style:{width:m+"%"}})]}),(0,_.jsxs)("div",{className:"negative",children:[(0,_.jsx)("span",{className:"trade",style:{width:Math.abs(0+p.trade)+"%"}}),(0,_.jsx)("span",{className:"raid",style:{width:Math.abs(0+p.raid)+"%"}})]})]}),(0,_.jsxs)("div",{className:"balance",children:[(0,_.jsx)("div",{className:"positive",title:(0,O.eJ)(e.sum,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,Ke.k)(e.sum,1)}}),(0,_.jsx)("div",{className:["negative",0==-t.sum?"isZero":""].join(" "),title:(0,O.eJ)(-t.sum,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,Ke.k)(-t.sum,1,{signWrapper:0!==t.sum?"<span>SIGN</span>":null})}}),(0,_.jsx)("div",{className:["total",a>=0?"positive":"negative"].join(" "),title:(0,O.eJ)(a,{grouping:!0})+" "+(0,O.Jh)("statistiken.inAccount"),children:(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,Ke.k)(a,1)}})})]})]}),(0,_.jsx)("table",{className:"resourceBarChartLegend transparent",children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{className:"positive raid",children:[(0,_.jsxs)("td",{children:[(0,O.Jh)("statistiken.bountyWon"),":"]}),(0,_.jsx)("td",{className:"value",title:(0,O.eJ)(e.raid,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,Ke.k)(e.raid,1)}}),(0,_.jsxs)("td",{className:"indicators",children:[(0,_.jsx)("span",{className:"resourceIndicator"}),(0,_.jsx)(ee,{className:["checkmark","raid"!==o||"perDay"===r?"invisible":""].join(" ")})]})]}),(0,_.jsxs)("tr",{className:"positive trade",children:[(0,_.jsxs)("td",{children:[(0,O.Jh)("statistiken.incomingTradingVolume"),":"]}),(0,_.jsx)("td",{className:"value",title:(0,O.eJ)(e.trade,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,Ke.k)(e.trade,1)}}),(0,_.jsxs)("td",{className:"indicators",children:[(0,_.jsx)("span",{className:"resourceIndicator"}),(0,_.jsx)(ee,{className:["checkmark","trade"!==o||"perDay"===r?"invisible":""].join(" ")})]})]}),(0,_.jsxs)("tr",{className:"positive production",children:[(0,_.jsxs)("td",{children:[(0,O.Jh)("production.production"),":"]}),(0,_.jsx)("td",{className:"value",title:(0,O.eJ)(e.production,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,Ke.k)(e.production,1)}}),(0,_.jsxs)("td",{className:"indicators",children:[(0,_.jsx)("span",{className:"resourceIndicator"}),(0,_.jsx)(ee,{className:["checkmark","production"!==o||"perDay"===r?"invisible":""].join(" ")})]})]}),(0,_.jsxs)("tr",{className:"negative raid",children:[(0,_.jsxs)("td",{children:[(0,O.Jh)("statistiken.bountyLost"),":"]}),(0,_.jsx)("td",{className:"value",title:(0,O.eJ)(-t.raid,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,Ke.k)(-t.raid,1)}}),(0,_.jsxs)("td",{className:"indicators",children:[(0,_.jsx)("span",{className:"resourceIndicator"}),(0,_.jsx)(ee,{className:["checkmark","raid"!==o||"perDay"===r?"invisible":""].join(" ")})]})]}),(0,_.jsxs)("tr",{className:"negative trade",children:[(0,_.jsxs)("td",{children:[(0,O.Jh)("statistiken.outgoingTradingVolume"),":"]}),(0,_.jsx)("td",{className:"value",title:(0,O.eJ)(-t.trade,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,Ke.k)(-t.trade,1)}}),(0,_.jsxs)("td",{className:"indicators",children:[(0,_.jsx)("span",{className:"resourceIndicator"}),(0,_.jsx)(ee,{className:["checkmark","trade"!==o||"perDay"===r?"invisible":""].join(" ")})]})]})]})})]}),(0,_.jsxs)("div",{className:"chartWithLegend",children:[(0,_.jsxs)("div",{className:"legendContainer",children:[(0,_.jsxs)("div",{className:"legendTabs",children:[(0,_.jsxs)("div",{className:["tab","inlineIcon","perDay"===r?"active":""].join(" "),onClick:e=>"soFar"===r?n(e):null,children:[(0,_.jsx)("i",{className:"clock_medium",title:(0,O.Jh)("statistiken.perDay")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.perDay")})]}),(0,_.jsxs)("div",{className:["tab","inlineIcon","soFar"===r?"active":""].join(" "),onClick:e=>"perDay"===r?n(e):null,children:[(0,_.jsx)("i",{className:"resources_medium",title:(0,O.Jh)("statistiken.soFar")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.soFar")})]})]}),(0,_.jsx)("div",{className:"simpleLegend",children:(0,_.jsx)(rt,{rankData:"perDay"===r?i:s,rankType:"perDay"===r?rt.typeProduction:rt.typeResource})})]}),(0,_.jsxs)("div",{className:"chartContainer",children:[(0,_.jsxs)("div",{className:"dataSwitchButtons",children:[(0,_.jsx)("a",{href:"#",className:["iconButton","raid"===o?"active":"",d?"disabled":""].join(" "),onClick:e=>this.switchChart(e,"raid"),title:(0,O.Jh)("statistiken.bounty"),children:(0,_.jsx)("i",{className:"bounty_small"})}),(0,_.jsx)("a",{href:"#",className:["iconButton","trade"===o?"active":"",d?"disabled":""].join(" "),onClick:e=>this.switchChart(e,"trade"),title:(0,O.Jh)("statistiken.trading"),children:(0,_.jsx)("i",{className:"trade_small"})}),(0,_.jsx)("a",{href:"#",className:["iconButton","production"===o||d?"active":""].join(" "),onClick:e=>this.switchChart(e,"production"),title:(0,O.Jh)("statistiken.production"),children:(0,_.jsx)("i",{className:"resources_small"})})]}),"raid"===o&&(0,_.jsx)(It,{data:b}),"trade"===o&&(0,_.jsx)(Ot,{data:j}),"production"===o&&(0,_.jsx)(_t,{data:y})]})]})]})]})}}const Mt=Pt(xt(Bt));class Jt extends o.Component{static propTypes={rank:d().number.isRequired,total:d().number.isRequired};constructor(e){super(e),this.state={showAnimation:!1,displayLabels:!1}}componentDidMount(){this.setState({showAnimation:!0,displayLabels:!1});let e=this;setTimeout((function(){e.setState({displayLabels:!0})}),2e3)}componentDidUpdate(){"undefined"!=typeof Travian&&Travian.Tip.refresh()}render(){const{rank:e,total:t}=this.props;let{showAnimation:a,displayLabels:s}=this.state,i={},n={};const r=[{description:"worse",value:Math.round(100*(t-e)/(t-1)),totalSum:t-e,color:"#608cbc"},{description:"better",value:Math.round(100*(e-1)/(t-1)),totalSum:e-1,color:"#ea866e"}];let l=!0;return r.map(((e,s)=>{"worse"===e.description&&(n.percent=Math.round(10*e.value)/10,n.totalSum=e.totalSum,t<=1&&(e.value=100,e.color="#F2F2F2",e.totalSum=0,n.totalSum=0,n.percent=0,a=!1,l=!1)),"better"===e.description&&(i.percent=Math.round(10*e.value)/10,i.totalSum=e.totalSum,t<=1&&(e.value=0,e.totalSum=0,i.percent=0,i.totalSum=0))})),(0,_.jsxs)("div",{className:"culturePointsRankChart",children:[(0,_.jsx)("div",{className:"chartTitle",children:(0,O.Jh)("statistiken.cpRankComparison")}),s&&(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"worse centeredText",children:[(0,_.jsxs)("p",{title:(0,O.Jh)("statistiken.spieler"),className:"inlineIcon",children:[(0,_.jsx)("i",{className:"player_medium"}),(0,_.jsx)("span",{children:n.totalSum})]}),(0,_.jsx)("p",{title:(0,O.Jh)("statistiken.spieler"),children:(0,O.Jh)("statistiken.worse")})]}),(0,_.jsxs)("div",{className:"better centeredText",children:[(0,_.jsxs)("p",{title:(0,O.Jh)("statistiken.spieler"),className:"inlineIcon",children:[(0,_.jsx)("i",{className:"player_medium"}),(0,_.jsx)("span",{children:i.totalSum})]}),(0,_.jsx)("p",{title:(0,O.Jh)("statistiken.spieler"),children:(0,O.Jh)("statistiken.better")})]})]}),(0,_.jsxs)(Fe.u,{width:320,height:270,children:[(0,_.jsx)(Ve.b,{data:r,dataKey:"value",labelLine:!1,innerRadius:"23%",outerRadius:"60%",startAngle:90,endAngle:-270,isAnimationActive:a,children:r.map(((e,t)=>(0,_.jsx)(He.b,{fill:e.color,color:e.color},t)))}),l&&(0,_.jsx)(ft.u,{formatter:function(e,t,a){return"better"===a.payload.description?(0,O.eJ)(i.percent,{unit:O.uo.PERCENT}):(0,O.eJ)(n.percent,{unit:O.uo.PERCENT})},labelFormatter:()=>""})]})]})}}class Zt extends o.Component{static propTypes=Object.assign({data:d().shape({hasAlliance:d().bool.isRequired,totalPlayers:d().number.isRequired,totalPlayersInAlliance:d().number.isRequired,data:d().shape({perDay:d().shape({serverRank:d().number.isRequired,allianceRank:d().number.isRequired,cpProduction:d().number.isRequired}).isRequired,soFar:d().shape({serverRank:d().number.isRequired,allianceRank:d().number.isRequired,cpProduction:d().number.isRequired}).isRequired}).isRequired}).isRequired},We,Lt);constructor(e){super(e)}componentDidUpdate(){"undefined"!=typeof Travian&&Travian.Tip.refresh()}render(){const{hasAlliance:e,totalPlayers:t,totalPlayersInAlliance:a}=this.props.data,{toggleType:s,type:i}=this.props,n=this.props.activeTab,r=this.props.data.data[i],l={server:r.serverRank,alliance:e?r.allianceRank:null};return(0,_.jsxs)("div",{className:"chartWithLegend",id:"cpRankComparison",children:[(0,_.jsxs)("div",{className:"legendContainer",children:[(0,_.jsxs)("div",{className:"legendTabs",children:[(0,_.jsxs)("div",{className:["tab","inlineIcon","perDay"===i?"active":""].join(" "),onClick:e=>"soFar"===i?s(e):null,children:[(0,_.jsx)("i",{className:"clock_medium",title:(0,O.Jh)("statistiken.perDay")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.perDay")})]}),(0,_.jsxs)("div",{className:["tab","inlineIcon","soFar"===i?"active":""].join(" "),onClick:e=>"perDay"===i?s(e):null,children:[(0,_.jsx)("i",{className:"culturePoints_medium",title:(0,O.Jh)("statistiken.soFar")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.soFar")})]})]}),(0,_.jsxs)("div",{className:"simpleLegend",children:[(0,_.jsx)(rt,{rankData:l,switchable:!1,rankType:`${rt.typeCP}${i}`}),(0,_.jsxs)("div",{className:"cpProduction",children:[(0,O.Jh)("statistiken.cpProduction"),": ",(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,O.eJ)(r.cpProduction,{grouping:!0,fraction:0})}})]})]})]}),(0,_.jsxs)("div",{className:"chartContainer",children:[(0,_.jsx)("div",{className:"rankDisplay",dangerouslySetInnerHTML:{__html:(0,Ke.k)("server"===n?l.server:l.alliance,0)},title:(0,O.eJ)("server"===n?l.server:l.alliance)}),"server"===n&&(0,_.jsx)(Jt,{rank:l.server,total:parseInt(t)}),"alliance"===n&&e&&(0,_.jsx)(Jt,{rank:l.alliance,total:parseInt(a)})]})]})}}const Ft=Pt(Ye(Zt));class Vt extends o.Component{static propTypes=Object.assign({data:d().shape({data:d().shape({perDay:d().shape({buildings:d().number.isRequired,helmet:d().number.isRequired,allianceBonus:d().number.isRequired}).isRequired,soFar:d().shape({buildings:d().number.isRequired,items:d().number.isRequired,celebrations:d().number.isRequired,rewards:d().number.isRequired,allianceBonus:d().number.isRequired}).isRequired}).isRequired}).isRequired},Lt);constructor(e){super(e),this.state={language:"com",showAnimation:!1}}componentDidMount(){document.body.classList;this.setState({language:Travian.Game.language,showAnimation:!0})}componentDidUpdate(){Travian.Tip.refresh()}render(){let{data:e}=this.props.data;const{type:t,toggleType:a}=this.props;let{language:s,showAnimation:i}=this.state;const n=Tt.Z.isLtr(s);let r=[];const l={buildings:"#ffd667",celebrations:"#dd2e45",helmet:"#31a1ed",items:"#31a1ed",rewards:"#a9d18e",allianceBonus:"#8ea3d1"},o={buildings:"village_medium",celebrations:"celebration_medium",helmet:"helmet_medium",items:"helmet_medium",rewards:"reward_medium",allianceBonus:"alliance_medium"},c={buildings:{file:"global/misc/village_medium.png",width:34,height:22},celebrations:{file:"views/General/misc/celebration_medium.png",width:20,height:24},helmet:{file:"views/Statistics/culturePointsRank/helmet_medium.png",width:22,height:24},items:{file:"views/Statistics/culturePointsRank/helmet_medium.png",width:22,height:24},rewards:{file:"views/Statistics/culturePointsRank/reward_medium.png",width:34,height:22},allianceBonus:{file:"views/Statistics/general/alliance_medium.png",width:20,height:24}},d={buildings:"manual.gebaeude",celebrations:"dorf3.feste",helmet:"hero.helmet",items:"hero.items",rewards:"questV2.rewards",allianceBonus:"allianz.ally_bonus"};let h=0;Object.keys(e[t]).map((a=>{h+=e[t][a]})),Object.keys(e[t]).map((a=>{r.push({type:a,value:e[t][a],html:(0,O.eJ)(e[t][a]/h*100,{unit:O.uo.PERCENT,fraction:2}),color:l[a],chartIcon:c[a],labelIcon:o[a],translation:(0,O.Jh)(d[a])})})),r.sort((function(e,t){return e.value>t.value?-1:e.value<t.value?1:0}));let u=({cx:e,cy:t,midAngle:a,innerRadius:s,outerRadius:i,percent:l,index:o})=>{if(l<.1)return;const c=1.25*i,d=r[o].chartIcon.width,h=r[o].chartIcon.height;let u=e+c*Math.cos(-a*Math.PI/180),m=t+c*Math.sin(-a*Math.PI/180);let p=u,g=m,v=n?"start":"end";return a>-95&&(p=u+16,v=n?"start":"end"),a<-95&&(p=u,g=m+25,v="middle"),a<-150&&(p=u-16,g=m,v=n?"end":"start"),a<-240&&(p=u,g=m-25,v="middle"),(0,_.jsxs)("g",{children:[(0,_.jsx)("image",{xlinkHref:`${Travian.Variables.gpackUrl}img_${n?"ltr":"rtl"}/${r[o].chartIcon.file}`,x:Math.round(u)-d/2,y:Math.round(m)-h/2,width:d,height:h}),(0,_.jsx)("text",{x:p,y:g,width:150,fill:"black",textAnchor:v,dominantBaseline:"central",dangerouslySetInnerHTML:{__html:r[o].html}})]})};return 0===h&&(r=[{type:"none",value:100,html:"",color:"#F2F2F2",translation:""}],i=!1,u=()=>{}),(0,_.jsxs)("div",{className:"chartWithLegend",id:"cpDistributionChart",children:[(0,_.jsxs)("div",{className:"legendContainer",children:[(0,_.jsxs)("div",{className:"legendTabs",children:[(0,_.jsxs)("div",{className:["tab","inlineIcon","perDay"===t?"active":""].join(" "),onClick:e=>"soFar"===t?a(e):null,children:[(0,_.jsx)("i",{className:"clock_medium",title:(0,O.Jh)("statistiken.perDay")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.perDay")})]}),(0,_.jsxs)("div",{className:["tab","inlineIcon","soFar"===t?"active":""].join(" "),onClick:e=>"perDay"===t?a(e):null,children:[(0,_.jsx)("i",{className:"culturePoints_medium",title:(0,O.Jh)("statistiken.soFar")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.soFar")})]})]}),(0,_.jsx)("div",{className:"simpleLegend",children:(0,_.jsxs)("table",{className:"transparent",children:[(0,_.jsx)("thead",{}),(0,_.jsxs)("tbody",{children:[h>0&&Object.keys(r).map((e=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,_.jsx)("i",{className:r[e].labelIcon})}),(0,_.jsx)("td",{children:(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:r[e].translation}})}),(0,_.jsx)("td",{children:(0,_.jsx)("span",{className:r[e].type,title:(0,O.eJ)(r[e].value,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,O.kT)(r[e].value,0)}})})]},e))),(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{colSpan:2,children:[(0,O.Jh)("statistiken.gesamt"),":"]}),(0,_.jsx)("td",{children:(0,_.jsx)("span",{title:(0,O.eJ)(h,{grouping:!0}),dangerouslySetInnerHTML:{__html:(0,O.kT)(h,0)}})})]})]})]})})]}),(0,_.jsx)("div",{className:"chartContainer",children:(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:"chartTitle",children:(0,O.Jh)("statistiken.cpRankDistribution")}),"perDay"===t&&(0,_.jsx)(Fe.u,{width:320,height:270,children:(0,_.jsx)(Ve.b,{data:r,dataKey:"value",label:u,labelLine:!1,outerRadius:"60%",startAngle:90,endAngle:-270,isAnimationActive:i,children:r.map(((e,t)=>(0,_.jsx)(He.b,{fill:e.color,color:e.color},t)))})}),"soFar"===t&&(0,_.jsx)(Fe.u,{width:320,height:270,children:(0,_.jsx)(Ve.b,{data:r,dataKey:"value",label:u,labelLine:!1,outerRadius:"60%",startAngle:90,endAngle:-270,isAnimationActive:i,children:r.map(((e,t)=>(0,_.jsx)(He.b,{fill:e.color,color:e.color},t)))})})]})})]})}}const Ht=Pt(Vt),qt=e=>e?(0,O.kT)(e,0):e,Ut=e=>{let{data:t}=e;return t.filter((e=>""!==e.date)),(0,_.jsxs)(lt.T,{width:535,height:220,data:t,baseValue:"dataMin",children:[(0,_.jsx)(ot.q,{strokeDasharray:"3 3"}),(0,_.jsx)(ct.B,{interval:"preserveStartEnd",tick:{textAnchor:O.ag.isLtr(Travian.Game.language)?"end":"start"},type:"number",domain:[0,"dataMax"],allowDecimals:!1,tickFormatter:qt}),(0,_.jsx)(dt.K,{dataKey:"day",type:"number",interval:"preserveStartEnd",tickCount:Math.min(t.length,5)}),(0,_.jsx)(ht.u,{type:"linear",dataKey:"culture_points",stroke:"#bf6060",fill:"#EA866E",fillOpacity:1})]})};class zt extends o.Component{static propTypes=Object.assign({data:d().shape({data:d().shape({perDay:d().arrayOf(d().shape({date:d().string.isRequired,culture_points:d().number.isRequired}).isRequired).isRequired,soFar:d().arrayOf(d().shape({date:d().string.isRequired,culture_points:d().number.isRequired}).isRequired).isRequired}).isRequired}).isRequired},Lt);constructor(e){super(e)}componentDidUpdate(){"undefined"!=typeof Travian&&Travian.Tip.refresh()}render(){const{type:e,toggleType:t}=this.props,{data:a}=this.props.data;return(0,_.jsxs)("div",{id:"cpProgressionChart",children:[(0,_.jsx)("div",{className:"chartTitle",children:(0,O.Jh)("statistiken.cpRankProgression")}),(0,_.jsx)("div",{className:"chartWithLegend chartIncluded",children:(0,_.jsxs)("div",{className:"legendContainer",children:[(0,_.jsxs)("div",{className:"legendTabs",children:[(0,_.jsxs)("div",{className:["tab","inlineIcon","perDay"===e?"active":""].join(" "),onClick:a=>"soFar"===e?t(a):null,children:[(0,_.jsx)("i",{className:"clock_medium",title:(0,O.Jh)("statistiken.perDay")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.perDay")})]}),(0,_.jsxs)("div",{className:["tab","inlineIcon","soFar"===e?"active":""].join(" "),onClick:a=>"perDay"===e?t(a):null,children:[(0,_.jsx)("i",{className:"culturePoints_medium",title:(0,O.Jh)("statistiken.soFar")}),(0,_.jsx)("span",{children:(0,O.Jh)("statistiken.soFar")})]})]}),(0,_.jsx)("div",{className:"simpleLegend",children:(0,_.jsx)(Ut,{data:a[e]})})]})})]})}}const $t=Pt(zt);class Wt extends o.Component{static propTypes=Object.assign({data:d().shape({hasAlliance:d().bool.isRequired,totalPlayers:d().number.isRequired,totalPlayersInAlliance:d().number.isRequired,rank:d().shape({perDay:d().shape({serverRank:d().number.isRequired,allianceRank:d().number.isRequired,cpProduction:d().number.isRequired}).isRequired,soFar:d().shape({serverRank:d().number.isRequired,allianceRank:d().number.isRequired,cpProduction:d().number.isRequired}).isRequired}).isRequired,distribution:d().shape({perDay:d().shape({buildings:d().number.isRequired,helmet:d().number.isRequired,allianceBonus:d().number.isRequired}).isRequired,soFar:d().shape({buildings:d().number.isRequired,items:d().number.isRequired,celebrations:d().number.isRequired,rewards:d().number.isRequired,allianceBonus:d().number.isRequired}).isRequired}).isRequired,progression:d().shape({perDay:d().arrayOf(d().shape({date:d().string.isRequired,culture_points:d().number.isRequired}).isRequired).isRequired,soFar:d().arrayOf(d().shape({date:d().string.isRequired,culture_points:d().number.isRequired}).isRequired).isRequired}).isRequired}).isRequired},vt);constructor(e){super(e),this.state={listingSelected:"rank"}}componentDidMount(){this.props.initFromPreference("CulturePointsRank")}switchListing(e,t){e.preventDefault(),this.setState({listingSelected:t})}render(){const{listingSelected:e}=this.state,{hasAlliance:t,totalPlayers:a,totalPlayersInAlliance:s,rank:i,distribution:n,progression:r}=this.props.data,l={hasAlliance:t,totalPlayers:a,totalPlayersInAlliance:s,data:i},o={data:n},c={data:r};return(0,_.jsxs)("div",{id:"culturePointsRank",children:[(0,_.jsxs)("div",{className:"culturePointsHeader",children:[(0,_.jsx)("div",{className:["openedClosedSwitch",this.props.sectionStatus===mt?"switchOpened":"switchClosed"].join(" "),onClick:e=>this.props.sectionToggle(e,"CulturePointsRank")}),(0,_.jsxs)("h4",{children:[(0,_.jsx)("i",{className:"culturePointsRank"})," ",(0,O.Jh)("statistiken.culturePointsRank")]}),this.props.sectionStatus===mt&&(0,_.jsxs)("div",{className:"dataSwitchButtons",children:[(0,_.jsx)("a",{href:"#",className:["iconButton","rank"===e?"active":""].join(" "),onClick:e=>this.switchListing(e,"rank"),title:(0,O.Jh)("statistiken.cpRank"),children:(0,_.jsx)("i",{className:"culturePoints_small"})}),(0,_.jsx)("a",{href:"#",className:["iconButton","distribution"===e?"active":""].join(" "),onClick:e=>this.switchListing(e,"distribution"),title:(0,O.Jh)("statistiken.cpDistribution"),children:(0,_.jsx)("i",{className:"distribution"})}),(0,_.jsx)("a",{href:"#",className:["iconButton","progression"===e?"active":""].join(" "),onClick:e=>this.switchListing(e,"progression"),title:(0,O.Jh)("statistiken.cpProgression"),children:(0,_.jsx)("i",{className:"progression"})})]})]}),this.props.sectionStatus===mt&&"rank"===e&&(0,_.jsx)(Ft,{data:l}),this.props.sectionStatus===mt&&"distribution"===e&&(0,_.jsx)(Ht,{data:o}),this.props.sectionStatus===mt&&"progression"===e&&(0,_.jsx)($t,{data:c})]})}}const Gt=xt(Wt);class Yt extends o.Component{constructor(e){super(e)}componentDidMount(){Travian.Tip.refresh()}componentDidUpdate(){Travian.Tip.refresh()}render(){const{resourceTypeId:e,productionPerHour:t,productionPerHourTotal:a,productionOfHero:s,interimBalanceSheet:i,balanceSheet:n,hasPlayerBoost:r,productionBoostFactor:l,productionBoost:o,hasCompensationBoost:c,compensationBoostFactor:d,compensationBoostValue:h,productionBonusOases:u,egyptians:m,productionBonusPercentage:p,waterworks:g,buildings:v,button:x}=this.props.currentProductionData,b=new Travian.Formatter({forceDecimal:!1});return(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"productionContainer",children:[(0,_.jsxs)("div",{className:"productionPerHour",children:[(0,_.jsx)("h4",{children:(0,O.Jh)("production.productionPerHour")}),(0,_.jsxs)("table",{cellSpacing:"1",cellPadding:"1",className:"row_table_data",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.resourceField")}),(0,_.jsx)("td",{children:(0,O.Jh)("production.production")}),(0,_.jsx)("td",{children:(0,O.Jh)("production.bonus")})]})}),(0,_.jsxs)("tbody",{children:[0===t.length&&(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:"3",className:"none",children:(0,O.Jh)("production.no_gid"+e)})}),t.map(((e,t)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("allgemein.gid"+e.gid)+" "+(0,O.Jh)("allgemein.stufe")+" "+e.stufe}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(e.production)}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(e.bonus)})]},t))),(0,_.jsxs)("tr",{className:"productionSum",children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.total")}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(a.production)}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(a.bonus)})]})]})]})]}),(0,_.jsxs)(ea,{wrapperClass:"productionBoostSpeechBubble",bubbleClass:"fluidSpeechBubble",directionClass:"speechArrowBack",children:[(0,_.jsx)("h5",{children:(0,O.Jh)("production.productionBonus")}),(0,_.jsx)("table",{cellSpacing:"0",cellPadding:"0",className:"row_table_data",children:(0,_.jsxs)("tbody",{children:[v.map(((e,t)=>(0,_.jsxs)("tr",{className:e.bonus>0?"":"inactive",children:[(0,_.jsxs)("td",{children:[e.title+" "+(0,O.Jh)("allgemein.stufe")+" "+e.stufe,":"]}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(100*e.bonus,{unit:"percent"})})]},t))),(0,_.jsxs)("tr",{className:u.bonus>0?"":"inactive",children:[(0,_.jsxs)("td",{children:[(0,O.Jh)("production.productionBonusLabelOasis")," (×",u.amount,")"]}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(100*u.bonus,{unit:"percent"})})]}),m&&(0,_.jsxs)("tr",{className:g.bonus>0?"":"inactive",children:[(0,_.jsxs)("td",{children:[(0,O.Jh)("gid45.name")+" "+(0,O.Jh)("allgemein.stufe")+" "+g.level,":"]}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(100*g.bonus,{unit:"percent"})})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.bonusTotal")}),(0,_.jsx)("td",{className:"bold numberCell",children:b.getFormattedNumber(Number((100*p).toFixed(2)),{unit:"percent"})})]})]})})]})]}),(0,_.jsxs)("div",{className:"total productionContainer",children:[(0,_.jsxs)("div",{className:"productionPerHourTotal",children:[(0,_.jsx)("h4",{children:(0,O.Jh)("production.totalProductionPerHour")}),(0,_.jsx)("table",{cellSpacing:"0",cellPadding:"0",className:"row_table_data",children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.production")}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(a.production)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.bonus")}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(a.bonus)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.productionOfHero")}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(s)})]}),(0,_.jsxs)("tr",{className:"subtotal",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.interimBalanceSheet")}),(0,_.jsx)("td",{className:"numberCell bold",children:b.getFormattedNumber(i)})]}),(0,_.jsxs)("tr",{className:!0===r?"active":"inactive",children:[r&&(0,_.jsx)("td",{children:(0,O.Jh)("production.productionBoostActive2",{BOOST:b.getFormattedNumber(l,{unit:"percent"})})}),!r&&(0,_.jsx)("td",{children:(0,O.Jh)("production.productionBoostInactive2",{BOOST:b.getFormattedNumber(l,{unit:"percent"})})}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(o)})]}),c&&(0,_.jsxs)("tr",{className:"bold",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.compensationBonus",{BONUS:b.getFormattedNumber(d,{unit:"percent"})})}),(0,_.jsx)("td",{className:"numberCell",children:b.getFormattedNumber(h)})]}),(0,_.jsxs)("tr",{className:"total bold",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.complete")}),(0,_.jsx)("td",{className:"numberCell bold",children:b.getFormattedNumber(n)})]})]})})]}),(0,_.jsx)(ia.u,{button:x,hasPlayerBoost:r,interimBalanceSheet:i,productionBoost:o})]})]})}}class Kt extends o.Component{constructor(e){super(e),this.wrapperDiv=o.createRef()}componentDidMount(){Travian.Tip.refresh()}componentDidUpdate(){Travian.Tip.refresh()}render(){const{productionOfHero:e,interimBalanceSheet:t,hasPlayerBoost:a,productionBoostFactor:s,productionBoost:i,button:n,productionOfBuildingsAndOasis:r,consumptionOfVillagersAndConstructions:l,freeCrop:o,notFinishedConstructionCommand:c,interimBalance:d,ownTroops:h,foreignTroops:u,totalSum:m,hasCompensationBoost:p,compensationBoostFactor:g,compensationBoostValue:v}=this.props.currentProductionData,x=new Travian.Formatter({forceDecimal:!1});return(0,_.jsxs)("div",{className:"cropBalanceContainer",children:[(0,_.jsx)(ia.u,{button:n,hasPlayerBoost:a,interimBalanceSheet:t,productionBoost:i}),(0,_.jsx)("div",{className:"balanceCropBalancePart",children:(0,_.jsx)("table",{cellSpacing:"0",cellPadding:"0",className:"row_table_data",children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.productionBuildingsAndOasis")}),(0,_.jsx)("td",{className:"numberCell",children:x.getFormattedNumber(r)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.villagersAndConstructions")}),(0,_.jsx)("td",{className:"numberCell",children:x.getFormattedNumber(l)})]}),(0,_.jsxs)("tr",{className:"subtotal",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.freeCrop")}),(0,_.jsx)("td",{className:"bold numberCell",children:x.getFormattedNumber(o)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.notFinishedConstructionCommand")}),(0,_.jsx)("td",{className:"numberCell",children:x.getFormattedNumber(c)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,O.Jh)("production.cropBalanceProductionOfHero")}),(0,_.jsx)("td",{className:"numberCell",children:x.getFormattedNumber(e)})]}),(0,_.jsxs)("tr",{className:!0===a?"active":"inactive",children:[!0===a&&(0,_.jsx)("td",{children:(0,O.Jh)("production.productionBoostActive2",{BOOST:x.getFormattedNumber(s,{unit:"percent"})})}),!0!==a&&(0,_.jsx)("td",{children:(0,O.Jh)("production.productionBoostInactive2",{BOOST:x.getFormattedNumber(s,{unit:"percent"})})}),(0,_.jsx)("td",{className:"numberCell",children:x.getFormattedNumber(i)})]}),p&&(0,_.jsxs)("tr",{className:"bold",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.compensationBonus",{BONUS:x.getFormattedNumber(g,{unit:"percent"})})}),(0,_.jsx)("td",{className:"numberCell",children:x.getFormattedNumber(v)})]}),(0,_.jsxs)("tr",{className:"subtotal",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.interimBalanceSheet")}),(0,_.jsx)("td",{className:"bold numberCell",children:x.getFormattedNumber(d)})]})]})})}),(0,_.jsx)("div",{className:"balanceCropBalancePart balanceTroops",children:(0,_.jsx)(ta,{id:"ownBalanceTroops",closedContent:"<span class='bold'>"+x.getFormattedNumber(-1*h.sum)+"</span>",headline:(0,O.Jh)("production.crobBalanceOwnTroopConsumption"),children:(0,_.jsx)(aa,{troops:h})})}),(0,_.jsx)("div",{className:"balanceCropBalancePart balanceTroops",children:(0,_.jsx)(ta,{id:"foreignBalanceTroops",closedContent:"<span class='bold'>"+x.getFormattedNumber(-1*u.sum)+"</span>",headline:(0,O.Jh)("production.crobBalanceForeignTroopConsumption"),children:(0,_.jsx)(sa,{troops:u})})}),(0,_.jsx)("div",{className:"balanceCropBalancePart",children:(0,_.jsx)("table",{cellSpacing:"0",cellPadding:"0",className:"row_table_data",children:(0,_.jsx)("tbody",{children:(0,_.jsxs)("tr",{className:"total",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.crobBalanceCropBalance")}),(0,_.jsx)("td",{className:"bold numberCell",children:x.getFormattedNumber(m)})]})})})})]})}}var Xt=a(2011);class Qt extends o.Component{constructor(e){super(e),this.state={shown:!1,positionStyles:{}},this.timeout=null,this.onCloseClick=this.onCloseClick.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.showSnackbar=this.showSnackbar.bind(this),this.stickyHandler=this.stickyHandler.bind(this)}componentDidMount(){window.addEventListener("scroll",this.stickyHandler),this.stickyHandler(),this.showSnackbar()}stickyHandler(){let e=this.props.stickyTo??document.getElementById("contentOuterContainer");const t=e.getBoundingClientRect();if(window.innerHeight-t.top>e.scrollHeight){const e={position:"absolute"};this.setState({positionStyles:e})}else{const e={left:t.left,right:"auto",width:t.width};this.setState({positionStyles:e})}}componentDidUpdate(e,t,a){e.id!==this.props.id&&(this.state.shown?this.setState({shown:!1},(()=>{clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.showSnackbar()}),150)})):this.showSnackbar())}onCloseClick(){clearTimeout(this.timeout),this.setState({shown:!1})}onMouseEnter(){clearTimeout(this.timeout),this.setState({shown:!0})}showSnackbar(){clearTimeout(this.timeout),this.setState({shown:!0},(()=>{this.timeout=setTimeout((()=>{this.setState({shown:!1})}),5e3)}))}render(){const{message:e,additionalClass:t=""}=this.props;return(0,_.jsx)("div",{className:["snackbar",t,this.state.shown?"shown":""].join(" "),style:this.state.positionStyles,children:(0,_.jsxs)("div",{className:"message",children:[(0,_.jsx)("div",{className:"text",onMouseEnter:this.onMouseEnter,onMouseOut:this.showSnackbar,children:e}),(0,_.jsx)(Xt.Z,{onClick:this.onCloseClick,onMouseEnter:this.onMouseEnter})]})})}}class ea extends o.Component{constructor(e){super(e)}render(){const{bubbleClass:e,wrapperClass:t,directionClass:a}=this.props;return(0,_.jsx)("div",{className:t,children:(0,_.jsx)("div",{className:e+"-container",children:(0,_.jsxs)("div",{className:e,children:[(0,_.jsx)("div",{className:e+"-tl"}),(0,_.jsx)("div",{className:e+"-tr"}),(0,_.jsx)("div",{className:e+"-tc"}),(0,_.jsx)("div",{className:e+"-ml"}),(0,_.jsx)("div",{className:e+"-mr"}),(0,_.jsx)("div",{className:e+"-mc"}),(0,_.jsx)("div",{className:e+"-bl"}),(0,_.jsx)("div",{className:e+"-br"}),(0,_.jsx)("div",{className:e+"-bc"}),(0,_.jsx)("div",{className:a}),(0,_.jsx)("div",{className:e+"-contents cf",children:this.props.children})]})})})}}class ta extends o.Component{constructor(e){super(e)}componentDidMount(){new Travian.Game.SwitchDown("#"+this.props.id)}render(){return(0,_.jsxs)("div",{className:"switchDown",id:this.props.id,children:[(0,_.jsxs)("div",{className:"switchDownOpenStateContainer hide",children:[(0,_.jsx)("div",{className:"switchOpened headline",children:this.props.headline}),(0,_.jsx)("div",{className:"switchDownContent",children:this.props.children})]}),(0,_.jsxs)("div",{className:"switchDownCloseStateContainer",children:[(0,_.jsx)("div",{className:"switchClosed headline",children:this.props.headline}),(0,_.jsx)("div",{className:"switchDownContent",dangerouslySetInnerHTML:{__html:this.props.closedContent}}),(0,_.jsx)("div",{className:"clear"})]})]})}}class aa extends o.Component{constructor(e){super(e)}render(){const{troops:e}=this.props,t=new Travian.Formatter({forceDecimal:!1}),a=new Travian.Formatter({showDecimalsIfThereAny:!0,forceDecimal:!1});return(0,_.jsx)("table",{children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionInVillage")}),(0,_.jsx)("td",{className:"numberCell",children:t.getFormattedNumber(-1*e.inVillage)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionOwnReinforcements")}),(0,_.jsx)("td",{className:"numberCell",children:t.getFormattedNumber(-1*e.reinforcements)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionJustInOasis")}),(0,_.jsx)("td",{className:"numberCell",children:t.getFormattedNumber(-1*e.inOasis)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionOnTheWay")}),(0,_.jsx)("td",{className:"numberCell",children:t.getFormattedNumber(-1*e.onTheWay)})]}),null!==e.forwarded&&(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionForwarded")}),(0,_.jsx)("td",{className:"numberCell",children:t.getFormattedNumber(-1*e.forwarded)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionCaught")}),(0,_.jsx)("td",{className:"numberCell",children:t.getFormattedNumber(-1*e.caught)})]}),null!==e.horseDrinkingTrough&&(0,_.jsxs)("tr",{className:0==e.horseDrinkingTrough?"inactive":"",children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionHorseTrough")}),(0,_.jsx)("td",{className:"numberCell",children:t.getFormattedNumber(e.horseDrinkingTrough)})]}),(0,_.jsxs)("tr",{className:0==e.artefacts?"inactive":"",children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionArtefact")}),(0,_.jsx)("td",{className:"numberCell",children:a.getFormattedNumber(e.artefacts)})]}),null!==e.worldWonderCropBonus&&(0,_.jsxs)("tr",{className:e.wwActiveClass,children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.cropBalanceTroopConsumptionWorldWonder")}),(0,_.jsx)("td",{className:"numberCell",children:a.getFormattedNumber(e.worldWonderCropBonus)})]}),(0,_.jsxs)("tr",{className:"subtotal",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.total")}),(0,_.jsx)("td",{className:"numberCell bold",children:t.getFormattedNumber(-1*e.sum)})]})]})})}}class sa extends o.Component{constructor(e){super(e)}render(){const{troops:e,own:t}=this.props,a=new Travian.Formatter({forceDecimal:!1}),s=new Travian.Formatter({showDecimalsIfThereAny:!0,forceDecimal:!1});return(0,_.jsx)("table",{children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionOtherReinforcements")}),(0,_.jsx)("td",{className:"numberCell",children:a.getFormattedNumber(-1*e.reinforcements)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionJustInOasis")}),(0,_.jsx)("td",{className:"numberCell",children:a.getFormattedNumber(-1*e.inOasis)})]}),null!==e.forwarded&&(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionForwarded")}),(0,_.jsx)("td",{className:"numberCell",children:a.getFormattedNumber(-1*e.forwarded)})]}),null!==e.horseDrinkingTrough&&(0,_.jsxs)("tr",{className:0==e.horseDrinkingTrough?"inactive":"",children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionHorseTrough")}),(0,_.jsx)("td",{className:"numberCell",children:a.getFormattedNumber(e.horseDrinkingTrough)})]}),(0,_.jsxs)("tr",{className:0==e.artefacts?"inactive":"",children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.crobBalanceTroopConsumptionArtefact")}),(0,_.jsx)("td",{className:"numberCell",children:s.getFormattedNumber(e.artefacts)})]}),null!==e.worldWonderCropBonus&&(0,_.jsxs)("tr",{className:e.wwActiveClass,children:[(0,_.jsx)("td",{className:"troopLabel",children:(0,O.Jh)("production.cropBalanceTroopConsumptionWorldWonder")}),(0,_.jsx)("td",{className:"numberCell",children:s.getFormattedNumber(e.worldWonderCropBonus)})]}),(0,_.jsxs)("tr",{className:"subtotal",children:[(0,_.jsx)("td",{className:"bold",children:(0,O.Jh)("production.total")}),(0,_.jsx)("td",{className:"numberCell bold",children:a.getFormattedNumber(-1*e.sum)})]})]})})}}var ia=a(4284);class na extends o.Component{constructor(e){super(e)}render(){const{title:e}=this.props;return(0,_.jsx)("h1",{className:"titleInHeader",children:e})}}function ra({currentTab:e,setFavouriteTabKey:t,name:a,currentTabName:s,additionalClass:i}){return(0,_.jsx)("a",{id:"tabFavorButton",className:`icon contentTitleButton buttonFramed green withIcon rectangle ${i}`,onClick:()=>{Travian.api("favourite-tab",{data:{name:a,key:e},success:()=>t(e)})},title:(0,O.Jh)("allgemein.markTabAsFavorit",{NAME:s},!1)})}class la extends o.Component{constructor(e){super(e),this.state={favouriteTabKey:e.favouriteTabKey},this.setFavouriteTabKey=this.setFavouriteTabKey.bind(this),this.backButtonClickWrapper=this.backButtonClickWrapper.bind(this)}setKnowledgeBaseLink(e){Travian.Game.Layout.setKnowledgeBaseButtonLink(e)}backButtonClickWrapper(e){this.props.onBackButtonClick(e,this.setKnowledgeBaseLink)}componentDidUpdate(){this.triggerTabChangeEventForCurrentTab()}componentDidMount(){this.triggerTabChangeEventForCurrentTab(),window.addEventListener("popstate",this.backButtonClickWrapper),Travian.Game.TabScrollNavigation()}componentWillUnmount(){window.removeEventListener("popstate",this.backButtonClickWrapper)}triggerTabChangeEventForCurrentTab(){const{contentBaseClass:e,items:t,activeTab:a}=this.props,s=t[a-1];if(void 0===s)return;const i=s.contentClass??s.class??null;if(i){const t=jQuery("#content"),a=`${e} ${e}${i.slice(0,1).toUpperCase()+i.slice(1)}`,n=Travian.Game.Layout.tabChangeEventTypeName,r=Travian.Game.Layout.tabChangeEventClassAttribute;t.trigger({type:n,[r]:a,knowledgeBaseLink:s.knowledgeBaseLink})}}setFavouriteTabKey(e){this.setState({favouriteTabKey:e})}render(){const{activeTab:e,items:t,withFavourite:a,name:s}=this.props,{favouriteTabKey:i}=this.state,n=t[e-1];return(0,_.jsxs)(_.Fragment,{children:[a&&(0,_.jsx)(ra,{currentTab:n&&n.key,currentTabName:n&&n.name,setFavouriteTabKey:this.setFavouriteTabKey,name:s}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"contentNavi subNavi tabFavorWrapper",children:[(0,_.jsx)("button",{type:"button",className:"scrollFrom",disabled:"disabled"}),(0,_.jsx)("div",{className:"scrollingContainer",children:t.map(((t,a)=>(0,_.jsx)("div",{className:"content "+(i===t.key?"favorActive":""),children:(0,_.jsx)("a",{"data-tab":a+1,onClick:this.props.onTabClick,className:["tabItem",e==a+1?"active":"",!1===t.enabled?"disabled":"",t.premium?"gold":"",t.class].join(" "),children:t.name})},a)))}),(0,_.jsx)("button",{type:"button",className:"scrollTo",disabled:"disabled"})]}),(0,_.jsx)("div",{className:"navigationSpacer"})]})]})}}la.propTypes={items:d().arrayOf(d().shape({name:d().string.isRequired,key:d().string.isRequired,class:d().string,contentClass:d().string,enabled:d().bool,premium:d().bool,knowledgeBaseLink:d().string})),activeTab:d().number.isRequired,onBackButtonClick:d().func.isRequired,onTabClick:d().func.isRequired,contentBaseClass:d().string.isRequired,favouriteTabKey:d().string,withFavourite:d().bool,name:d().string};class oa extends o.Component{collectAnimationTimeout=null;ajaxRequest=null;static preLabel={populationProgress:"population",populationProgressInVillage:"population",buildingProgress:"level"};static postLabel={resourceBuildingsFirstLevel:"toLevel",allResourceBuildingsHaveLevel:"toLevel",resourceBuildingsLevelOfOneOfTheBuildings:"toLevel",resourceBuildingsAllLevels:"toLevel"};constructor(e){super(e),this.state={progress:e.progress,isAnimationRunning:!1,animationCallbackOptions:null,isAjaxCallRunning:!1,hero:e.hero,tab:e.tab},this.showDetails=this.showDetails.bind(this),this.collectReward=this.collectReward.bind(this),this.collectAnimationCallback=this.collectAnimationCallback.bind(this)}componentDidMount(){Travian.Tip.refresh()}componentDidUpdate(){const{hero:e,progress:t}=this.props;e!==this.state.hero&&this.setState({hero:e}),t===this.state.progress||this.state.isAnimationRunning||this.setState({progress:t}),Travian.Tip.refresh()}componentWillUnmount(){null!==this.ajaxRequest&&(this.ajaxRequest.abort(),this.ajaxRequest=null),this.state.isAnimationRunning&&(null!==this.collectAnimationTimeout&&clearTimeout(this.collectAnimationTimeout),this.collectAnimationCallback())}collectAnimationCallback(){const{setTaskLevelCollectedCallback:e,showDetailviewCallback:t}=this.props,{animationCallbackOptions:a,hero:s,tab:i}=this.state;this.setState({isAnimationRunning:!1,progress:"collected"}),e(i,a.taskIndex,a.level,a.hero,a.rewardBonus,a.updatedTasks),a.hero.data.levelUp&&jQuery("#topBarHero .levelUp").addClass("show"),a.hero.bars.experience.paths.mask!==s.bars.experience.paths.mask&&Travian.Game.Hero.updateHeroExperienceBar(a.hero.bars.experience),a.hero.bars.health.paths.mask!==s.bars.health.paths.mask&&Travian.Game.Hero.updateHeroHealthBar(a.hero.bars.health)}showDetails(e,t){const{showDetailviewCallback:a}=this.props;"button"!==e.target.tagName.toLowerCase()&&"button"!==e.target.parentNode.tagName.toLowerCase()&&a(!0,t)}collectReward(){const{taskIndex:e,type:t,level:a,scope:s,metadata:i,reloadCallback:n}=this.props,{hero:r}=this.state;this.setState({isAjaxCallRunning:!0});let l={questType:t,scope:s,targetLevel:a,heroLevel:r.data.level};null!=i&&void 0!==i.buildingId&&(l.buildingId=i.buildingId);const o={data:l,success:t=>{const s=void 0!==t.tasks?t.tasks:null;this.setState({isAjaxCallRunning:!1,isAnimationRunning:!0,animationCallbackOptions:{taskIndex:e,level:a,hero:t.hero,rewardBonus:t.rewardBonus,updatedTasks:s},progress:"collected"}),this.collectAnimationTimeout=setTimeout(this.collectAnimationCallback,2e3),this.ajaxRequest=null},error:()=>{this.setState({isAjaxCallRunning:!1}),this.ajaxRequest=null,n()}};this.ajaxRequest=Travian.api("progressive-tasks/collectReward",o)}render(){const{type:e,taskIndex:t,metadata:a,title:s,progressTarget:i,context:n,reward:r,progressValue:l,levelValue:o,tribe:c}=this.props,{isAnimationRunning:d,isAjaxCallRunning:h}=this.state;let u="collected"===this.state.progress?"collected disabled":"";return d||(u+=" preventAnimation"),(0,_.jsxs)("div",{className:`task ${this.state.progress} ${n} ${e} `,onClick:e=>"group"===n?this.showDetails(e,t):"",children:[(0,_.jsx)(da,{type:e,metadata:a,tribe:c,context:n}),(0,_.jsx)("div",{className:"titleDecoration"}),(0,_.jsx)("div",{className:"title",dangerouslySetInnerHTML:{__html:s}}),void 0!==r&&null!==r.resources&&null!==r.experience&&(0,_.jsxs)("div",{className:"rewards",children:[(0,_.jsx)(ca,{type:"resources",value:r.resources,isAnimationRunning:d}),(0,_.jsx)(ca,{type:"experience",value:r.experience,isAnimationRunning:d})]}),(0,_.jsxs)("div",{className:"progress",children:["open"===this.state.progress&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Ra,{primary:{nominator:l,denominator:null===i?o:i},color:"green"}),(0,_.jsxs)("div",{className:"label",children:[oa.preLabel[e]&&(0,_.jsxs)("span",{children:[(0,O.Jh)("tasks."+oa.preLabel[e])," "]}),(0,_.jsx)("span",{children:(0,O.T_)(l,null===i?o:i)}),oa.postLabel[e]&&(0,_.jsxs)("span",{children:[" ",(0,O.Jh)("tasks."+oa.postLabel[e],{LEVEL_VALUE:o})]})]})]}),("achieved"===this.state.progress||"collected"===this.state.progress)&&(0,_.jsxs)(F.z,{className:`collect ${u}`,disabledClass:h,"data-text-collected":(0,O.Jh)("tasks.collected"),onClick:this.collectReward,children:[(0,O.Jh)("tasks.collect"),(0,_.jsx)("i",{className:"collectedCheckmark"})]})]})]})}}class ca extends o.Component{static typeClass={resources:"resources_large",experience:"reward_heroExperience"};constructor(e){super(e),this.state={animated:!1,animationFinished:!1},this.lumber=null,this.clay=null,this.iron=null,this.crop=null,this.xp=null}componentDidUpdate(){const{type:e,isAnimationRunning:t}=this.props,{animated:a,animationFinished:s}=this.state,i=jQuery("#heroImageButton");if(t!==a&&i.is(":visible")&&this.setState({animated:t,animationFinished:!1}),a&&!s){this.setState({animationFinished:!0});const t=jQuery("#heroImageButton");let a=t.offset();if("resources"===e){const e=[this.lumber,this.clay,this.iron,this.crop];M.ZP.timeline().add((()=>{M.ZP.fromTo(e[0],{css:{transform:"translateX(0) translateY(0) scale(0)"}},{duration:.15,delay:.15,css:{transform:"translateX(-100%) translateY(-150%) scale(1)"}}),M.ZP.fromTo(e[1],{css:{transform:"translateX(0) translateY(0) scale(0)"}},{duration:.15,delay:.2,css:{transform:"translateX(100%) translateY(-150%) scale(1)"}}),M.ZP.fromTo(e[2],{css:{transform:"translateX(0) translateY(0) scale(0)"}},{duration:.15,delay:.25,css:{transform:"translateX(-100%) translateY(150%) scale(1)"}}),M.ZP.fromTo(e[3],{css:{transform:"translateX(0) translateY(0) scale(0)"}},{duration:.15,delay:.3,css:{transform:"translateX(100%) translateY(150%) scale(1)"}})})).add((()=>{M.ZP.to(e[0],{duration:.25,delay:.25,css:{transform:"translateX(-200%) translateY(-250%)"}}),M.ZP.to(e[1],{duration:.25,delay:.25,css:{transform:"translateX(-100%) translateY(-150%)"}}),M.ZP.to(e[2],{duration:.25,delay:.25,css:{transform:"translateX(0) translateY(-50%)"}}),M.ZP.to(e[3],{duration:.25,delay:.25,css:{transform:"translateX(100%) translateY(50%)"}})}),"0.25").add((()=>{e.forEach(((e,s)=>{const i=jQuery(e),n=i.offset(),r=i.position(),l=a.left-n.left+t.width()/2+r.left,o=a.top-n.top+r.top,c=.15*s;M.ZP.to(e,{duration:.75,delay:c,css:{transform:"translateX("+l+"px) translateY("+o+"px)"}})}))}),"0.5").add((()=>{e.forEach(((e,s)=>{const i=jQuery(e),n=i.offset(),r=i.position(),l=a.left-n.left+r.left+10,o=a.top-n.top+t.height()/2+r.top-10,c=.15*s;M.ZP.to(e,{duration:.25,delay:c,css:{transform:"translateX("+l+"px) translateY("+o+"px) scale(0)"}})}))}),"1.25")}if("experience"===e){const e=this.xp,s=jQuery(e),i=s.offset(),n=s.position();let r=M.ZP.timeline();r.add((()=>{const s=a.left-i.left+t.width()/2+n.left,r=a.top-i.top+n.top;M.ZP.fromTo(e,{css:{transform:"translateX(0) translateY(0)"}},{duration:.75,css:{transform:"translateX("+s+"px) translateY("+r+"px)"}})}),"0.25"),r.add((()=>{const s=a.left-i.left+n.left,r=a.top-i.top+t.height()+n.top;M.ZP.to(e,{duration:.5,css:{transform:"translateX("+s+"px) translateY("+r+"px) scale(0)"}})}),"1")}}}render(){const{type:e,value:t}=this.props,{animated:a}=this.state;return(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:`reward ${e} ${a?"animated":""}`,title:t,children:[(0,_.jsx)("i",{className:ca.typeClass[e]}),(0,_.jsx)("span",{children:t})]}),"resources"===e&&(0,_.jsxs)("div",{className:"animationObject",children:[(0,_.jsxs)("div",{className:"reward resources lumber",ref:e=>this.lumber=e,children:[(0,_.jsx)("i",{className:"lumber_medium"}),(0,_.jsx)("span",{children:t})]}),(0,_.jsxs)("div",{className:"reward resources clay",ref:e=>this.clay=e,children:[(0,_.jsx)("i",{className:"clay_medium"}),(0,_.jsx)("span",{children:t})]}),(0,_.jsxs)("div",{className:"reward resources iron",ref:e=>this.iron=e,children:[(0,_.jsx)("i",{className:"iron_medium"}),(0,_.jsx)("span",{children:t})]}),(0,_.jsxs)("div",{className:"reward resources crop",ref:e=>this.crop=e,children:[(0,_.jsx)("i",{className:"crop_medium"}),(0,_.jsx)("span",{children:t})]})]}),"experience"===e&&(0,_.jsx)("div",{className:"animationObject",children:(0,_.jsxs)("div",{className:"reward experience",ref:e=>this.xp=e,children:[(0,_.jsx)("i",{className:ca.typeClass[e]}),(0,_.jsx)("span",{children:t})]})})]})}}const da=e=>{const{type:t,metadata:a,tribe:s,context:i}=e;let n="";switch(t){case"buildingProgress":case"resourceBuildingsFirstLevel":case"allResourceBuildingsHaveLevel":n=" building",null!=a&&void 0!==a.buildingId&&(n=[n,"g"+a.buildingId,s,("level"===i||"description"===i)&&"big"].join(" "));break;default:n=t}return(0,_.jsx)("div",{className:`taskImage ${i}`,children:(0,_.jsx)("img",{src:"img/x.gif",className:`summer ${n}`})})};class ha extends o.Component{constructor(e){super(e),this.state={rewardBonus:e.rewardBonus,animated:!1},this.currentLevel=null,this.nextLevel=null,this.nextLevelDescription=null,this.bonus=null}componentDidUpdate(){const{heroLevel:e}=this.props.rewardBonus,{animated:t}=this.state;if(t||e===this.state.rewardBonus.heroLevel||this.setState({animated:!0}),t){const e=this.currentLevel,t=this.nextLevel,a=this.bonus,s=this.nextLevelDescription;M.ZP.timeline().add((()=>{M.ZP.fromTo([e,t],{css:{transform:"scale(1)"}},{duration:.25,stagger:.15,css:{transform:"scale(0)"}}),M.ZP.to([a,s],{opacity:0,duration:.5,stagger:.25})})).add((()=>{this.setState({rewardBonus:this.props.rewardBonus,animated:!1}),M.ZP.to([e,t],{duration:.7,stagger:.5,css:{transform:"scale(1.2)"}})}),".35").add((()=>{M.ZP.to([e,t],{duration:.5,stagger:.5,css:{transform:"scale(1)"}}),M.ZP.to([a,s],{opacity:1,duration:.5,delay:.5,stagger:.5})}),"1.35")}}render(){const{heroLevel:e,heroRewardBonus:t,heroNextRewardBonus:a}=this.state.rewardBonus;return(0,_.jsxs)("div",{className:"rewardBonus",children:[(0,_.jsxs)("div",{className:"heroLevel",children:[(0,_.jsx)("div",{className:"level",ref:e=>this.currentLevel=e,children:e}),(0,_.jsx)("div",{className:"description",children:(0,O.Jh)("tasks.heroLevel")})]}),(0,_.jsxs)("div",{className:"rewardInfo",children:[(0,_.jsxs)("h4",{ref:e=>this.bonus=e,children:[(0,O.Jh)("tasks.bonusRewards")," = ",(0,O.eJ)(t,{unit:O.uo.PERCENT})]}),(0,_.jsx)("div",{children:(0,O.Jh)("tasks.bonusDescription")})]}),(0,_.jsxs)("div",{className:"nextLevel",children:[(0,_.jsx)("div",{className:"level",ref:e=>this.nextLevel=e,children:e+1}),(0,_.jsxs)("div",{className:"description",ref:e=>this.nextLevelDescription=e,children:[(0,O.Jh)("tasks.nextLevel")," = ",(0,O.eJ)(a,{unit:O.uo.PERCENT})]})]})]})}}var ua,ma=a(2637);function pa(){return pa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},pa.apply(this,arguments)}const ga=e=>o.createElement("svg",pa({viewBox:"0 0 18 6"},e),ua||(ua=o.createElement("path",{d:"M16 4H2V2h14z"})));var va,xa,ba,ja,fa,ya,Ta,Na,Ca,Sa,ka;function wa(){return wa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},wa.apply(this,arguments)}const Ea=e=>o.createElement("svg",wa({viewBox:"0 0 18 33"},e),va||(va=o.createElement("defs",null,o.createElement("linearGradient",{id:"sliderHandle",x1:.49,x2:.49,y1:26.51,y2:25.43,gradientTransform:"matrix(-15.9 0 0 13.5 16.8 -343.5)",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#bf9258"}),o.createElement("stop",{offset:0,stopColor:"#bf9258"}),o.createElement("stop",{offset:.2,stopColor:"#fff6ca"}),o.createElement("stop",{offset:.4,stopColor:"#ffca86"}),o.createElement("stop",{offset:.5,stopColor:"#a27349"}),o.createElement("stop",{offset:.7,stopColor:"#774b2a"}),o.createElement("stop",{offset:.9,stopColor:"#bb8b58"}),o.createElement("stop",{offset:1,stopColor:"#ffca86"})),o.createElement("linearGradient",{id:"sliderHandle-2",x1:.48,x2:.48,y1:25.13,y2:25.93,gradientTransform:"matrix(-8.4 0 0 7.5 13 -185.5)",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#546e39"}),o.createElement("stop",{offset:.6,stopColor:"#546e39"}),o.createElement("stop",{offset:1,stopColor:"#63a926"})),o.createElement("linearGradient",{id:"sliderHandle-3",x1:9,x2:9,y1:3,y2:9.6,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#fff",stopOpacity:.3}),o.createElement("stop",{offset:.17,stopColor:"#fff",stopOpacity:0}),o.createElement("stop",{offset:1,stopColor:"#fff",stopOpacity:0})),o.createElement("linearGradient",{id:"sliderHandle-4",x1:.49,x2:.49,y1:27.85,y2:26.76,gradientTransform:"matrix(15.9 0 0 -13.5 1.2 394.5)",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#bf9258"}),o.createElement("stop",{offset:0,stopColor:"#bf9258"}),o.createElement("stop",{offset:.2,stopColor:"#fff6ca"}),o.createElement("stop",{offset:.4,stopColor:"#ffca86"}),o.createElement("stop",{offset:.5,stopColor:"#a27349"}),o.createElement("stop",{offset:.7,stopColor:"#774b2a"}),o.createElement("stop",{offset:.9,stopColor:"#bb8b58"}),o.createElement("stop",{offset:1,stopColor:"#ffca86"})),o.createElement("linearGradient",{id:"sliderHandle-5",x1:.48,x2:.48,y1:27.53,y2:28.33,gradientTransform:"matrix(8.4 0 0 -7.5 5 236.5)",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#546e39"}),o.createElement("stop",{offset:.6,stopColor:"#546e39"}),o.createElement("stop",{offset:1,stopColor:"#63a926"})),o.createElement("linearGradient",{id:"sliderHandle-6",x1:9,x2:9,y1:21,y2:27.6,gradientTransform:"rotate(-180 9 25.5)",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#fff",stopOpacity:.3}),o.createElement("stop",{offset:.17,stopColor:"#fff",stopOpacity:0}),o.createElement("stop",{offset:1,stopColor:"#fff",stopOpacity:0})))),xa||(xa=o.createElement("path",{d:"M9 15 0 0h18L9 15z"})),ba||(ba=o.createElement("path",{fill:"url(#sliderHandle)",d:"M1.8 1h14.4L9 13.2 1.8 1Z"})),ja||(ja=o.createElement("path",{d:"M9 11.4 3.6 2h10.8L9 11.4z"})),fa||(fa=o.createElement("path",{fill:"url(#sliderHandle-2)",d:"M5.4 3h7.2L9 9.6 5.4 3Z"})),ya||(ya=o.createElement("path",{fill:"url(#sliderHandle-3)",d:"M5.4 3h7.2L9 9.6 5.4 3Z"})),Ta||(Ta=o.createElement("path",{d:"m9 18 9 15H0l9-15z"})),Na||(Na=o.createElement("path",{fill:"url(#sliderHandle-4)",d:"M16.2 32H1.8L9 19.8 16.2 32Z"})),Ca||(Ca=o.createElement("path",{d:"m9 21.6 5.4 9.4H3.6L9 21.6z"})),Sa||(Sa=o.createElement("path",{fill:"url(#sliderHandle-5)",d:"M12.6 30H5.4L9 23.4l3.6 6.6Z"})),ka||(ka=o.createElement("path",{fill:"url(#sliderHandle-6)",d:"M12.6 30H5.4L9 23.4l3.6 6.6Z"})));class Ra extends o.Component{constructor(e){super(e),this.state={plusButtonDown:!1,minusButtonDown:!1,sliderValue:0,sliding:!1,steps:this.props.steps??1},this.plusButton=null,this.minusButton=null,this.progressBar=null,this.slider=null,this.sliderHandle=null,this.buttonTimeout=null,this.handleWheel=this.handleWheel.bind(this),this.onSliderStart=this.onSliderStart.bind(this),this.onSliderMove=this.onSliderMove.bind(this),this.getBarPercentages=this.getBarPercentages.bind(this)}componentDidMount(){const{hasSlider:e}=this.props;let t=this;if(t.plusButton&&t.minusButton&&(t.plusButton.addEventListener("mousedown",(()=>{t.setState({plusButtonDown:!0})})),t.minusButton.addEventListener("mousedown",(()=>{t.setState({minusButtonDown:!0})})),window.addEventListener("mouseup",(()=>{t.setState({plusButtonDown:!1,minusButtonDown:!1,sliding:!1})})),t.progressBar.addEventListener("wheel",this.handleWheel,{passive:!1}),e)){t.sliderHandle.addEventListener("mousedown",this.onSliderStart),t.sliderHandle.addEventListener("touchstart",this.onSliderStart),window.addEventListener("mousemove",this.onSliderMove),window.addEventListener("touchmove",this.onSliderMove,{passive:!1}),t.slider.addEventListener("click",(e=>{this.onSliderMove(e,!0)})),window.addEventListener("touchend",(()=>{t.setState({sliding:!1})}));const e=t.getBarPercentages();t.setState({sliderValue:e.primaryPercent+e.secondaryPercent})}Travian.Tip.refresh()}componentDidUpdate(e,t,a){const{setValueCallback:s,primary:i,secondary:n}=this.props;if(clearTimeout(this.buttonTimeout),this.state.plusButtonDown&&(this.buttonTimeout=setTimeout((()=>{s(i.nominator+(n.nominator??0)+this.state.steps)}),350)),this.state.minusButtonDown&&(this.buttonTimeout=setTimeout((()=>{s(i.nominator+(n.nominator??0)-this.state.steps)}),350)),!this.state.sliding){const e=this.getBarPercentages(),t=e.primaryPercent+e.secondaryPercent;isNaN(t)||t===this.state.sliderValue||this.setState({sliderValue:t})}this.props.steps&&this.props.steps!==this.state.steps&&this.setState({steps:this.props.steps}),Travian.Tip.refresh()}handleWheel(e){const{setValueCallback:t,primary:a,secondary:s}=this.props;e.preventDefault();let i=e.deltaY>0?-1*this.state.steps:this.state.steps;t(a.nominator+s.nominator+i)}onSliderStart(){this.setState({sliding:!0})}onSliderMove(e,t){const{sliding:a}=this.state,{setValueCallback:s,sliderStopped:i,primary:n,secondary:r}=this.props;if(void 0===t&&(t=!1),a||t){e.preventDefault();const t=this.getBarPercentages();if(this.slider){const a=this.slider.getBoundingClientRect(),l=(0,O.Ny)(e);let o=0;if(o="ltr"===Travian.Game.getDirection()?(l.x-a.x)/a.width*100:(a.x-l.x+a.width)/a.width*100,o=Math.min(o,100),o=Math.max(o,r.denominator>0?t.primaryPercent:0),i&&o>this.state.sliderValue)return!1;this.setState({sliderValue:o},(()=>{s(Math.round(o/100*n.denominator))}))}}}getBarPercentages(){const{primary:e}=this.props;void 0===e.percent&&0===e.denominator&&(e.percent=0);let t={};return void 0!==this.props.secondary&&(t=this.props.secondary,void 0===t.percent&&0===t.denominator&&(t.percent=0)),{primaryPercent:void 0!==e.percent?e.percent:Math.min(100*e.nominator/e.denominator,100),secondaryPercent:void 0!==t.percent?t.percent:Math.min(100*t.nominator/t.denominator,100)}}render(){const{primary:e,color:t,hasPlusMinusButtons:a,hasSlider:s,setValueCallback:i,plusDisabled:n,minusDisabled:r,title:l,titleMinusButton:o,titlePlusButton:c}=this.props,{sliding:d}=this.state;let h={};void 0!==this.props.secondary&&(h=this.props.secondary);const u=a||s,m=this.getBarPercentages(),p=m.primaryPercent,g=m.secondaryPercent,v=d?"0ms":"250ms";let x={};return x["margin"+("rtl"===Travian.Game.getDirection()?"Right":"Left")]=this.state.sliderValue+"%",x.transitionDuration=v,(0,_.jsxs)("div",{className:"progressBar preventMobileSwipeNavigation",children:[(0,_.jsxs)("div",{className:"bar",ref:e=>this.progressBar=e,title:l??null,children:[(0,_.jsx)("div",{className:"decoration"}),(0,_.jsx)("div",{className:`filling primary ${t}`,style:{width:p+"%"}}),h&&(0,_.jsx)("div",{className:`filling secondary ${t}`,style:{width:g+"%",transitionDuration:v}})]}),u&&(0,_.jsxs)(_.Fragment,{children:[a&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(F.z,{forwardRef:e=>this.plusButton=e,className:"plus",iconButton:!0,onClick:()=>{i(e.nominator+h.nominator+this.state.steps)},disabledAttribute:n,title:c,children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(ma.Z,{className:"outline"}),(0,_.jsx)(ma.Z,{className:"icon"})]})}),(0,_.jsx)(F.z,{forwardRef:e=>this.minusButton=e,className:"minus",iconButton:!0,onClick:()=>{i(e.nominator+h.nominator-this.state.steps)},disabledAttribute:r,title:o,children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(ga,{className:"outline"}),(0,_.jsx)(ga,{className:"icon"})]})})]}),s&&(0,_.jsx)("div",{className:"slider",ref:e=>this.slider=e,children:(0,_.jsx)("div",{className:"handle",ref:e=>this.sliderHandle=e,style:x,children:(0,_.jsx)(Ea,{})})})]})]})}}Ra.propTypes={type:d().string,primary:d().shape({percent:d().number,nominator:d().number,denominator:d().number}),secondary:d().shape({percent:d().number,nominator:d().number,denominator:d().number}),steps:d().number,hasLabel:d().bool,color:d().oneOf(["green","blue","orange"]).isRequired,hasPlusMinusButtons:d().bool,hasSlider:d().bool,sliderStopped:d().bool,setValueCallback:d().func,plusDisabled:d().bool,minusDisabled:d().bool,title:d().string,titlePlusButton:d().string,titleMinusButton:d().string},Ra.defaultProps={secondary:{nominator:0,denominator:-1},titlePlusButton:"",titleMinusButton:""};class Ia extends o.Component{static tasksPerPage=7;constructor(e){super(e),this.state={currentPage:0,taskIndexToFind:e.taskIndexToFind,sortedTasks:[]},this.switchPage=this.switchPage.bind(this)}switchPage(e){this.setState({currentPage:e,taskIndexToFind:null})}compareTask(e,t){let a=e.overviewShownLevel.readyToBeCollected?1:e.overviewShownLevel.wasCollected?3:2,s=t.overviewShownLevel.readyToBeCollected?1:t.overviewShownLevel.wasCollected?3:2;if(a!==s)return a-s;{const s=function(e){switch(e){case"sr-RS":return"sr-Cyrl";case"bs-BA":return"bs-Latn";default:return e}}(Travian.Game.language);switch(a){case 1:default:return e.name.localeCompare(t.name,s);case 2:if(e.alwaysOnTop||t.alwaysOnTop)return e.alwaysOnTop&&t.alwaysOnTop?e.name.localeCompare(t.name,s):e.alwaysOnTop?-1:1;let a=(e.progressTarget?e.progressTarget:e.nextLevelValue)-e.progressValue,i=(t.progressTarget?t.progressTarget:t.nextLevelValue)-t.progressValue;return a!==i?a-i:e.name.localeCompare(t.name,s)}}}render(){const{tab:e,data:t,rewardBonus:a,tribe:s,hero:i,showDetailview:n,setTaskLevelCollected:r,reloadCallback:l}=this.props,{sortedTasks:o,currentPage:c,taskIndexToFind:d}=this.state;let h=t.slice();if(h.map(((e,t)=>{let a=e.levels.length-1;e.levels.some(((t,s)=>{if(t.readyToBeCollected||!t.readyToBeCollected&&!t.wasCollected||s===a&&t.wasCollected)return e.overviewShownLevel=t,!0})),void 0===e.overviewShownLevel&&(console.log(h[t].name+" could not be shown"),delete h[t])})),0===o.length){h.sort(this.compareTask);let e=[];h.map((t=>(e.push(t.taskIndex),!0))),this.setState({sortedTasks:e})}else h.sort(((e,t)=>o.indexOf(e.taskIndex)-o.indexOf(t.taskIndex)));h=h.filter((e=>!e.overviewShownLevel.wasTakenOver));let u=[[]];if(h.length>Ia.tasksPerPage){const e=[];let t=h.length,a=Ia.tasksPerPage;for(let s=0;s<t;s+=a){let t=h.slice(s,s+a);e.push(t)}u=e}else u[0]=h;if(null!==d){let e=0;h.some(((t,a)=>{if(t.taskIndex===d)return e=a,!0})),this.switchPage(Math.floor(e/Ia.tasksPerPage))}return(0,_.jsxs)("div",{className:"taskOverview",children:[Object.keys(u[c]).map((t=>{let a=u[c][t];return(0,_.jsx)(oa,{taskIndex:a.taskIndex,tab:e,progress:a.overviewShownLevel.readyToBeCollected?"achieved":a.overviewShownLevel.wasCollected?"collected":"open",context:"group",title:a.name,type:a.type,level:a.overviewShownLevel.level,reward:a.overviewShownLevel.rewardValues,progressValue:a.progressValue,progressTarget:a.progressTarget,levelValue:a.overviewShownLevel.levelValue,tribe:s,hero:i,scope:a.scope,metadata:a.overviewShownLevel.metadata,showDetailviewCallback:n,setTaskLevelCollectedCallback:r,reloadCallback:l},"overview_"+e+"_"+a.taskIndex)})),h.length>Ia.tasksPerPage&&(0,_.jsx)(is.tl,{currentPage:c,pageCount:u.length,switchPage:this.switchPage}),h.length<=Ia.tasksPerPage&&(0,_.jsx)("div",{className:"divider"}),(0,_.jsx)(ha,{rewardBonus:a})]})}}class Oa extends o.Component{static tasksPerPage=3;constructor(e){super(e),this.state={currentPage:0,sortedLevels:[]},this.compareLevel.bind(this),this.switchPage=this.switchPage.bind(this)}switchPage(e){this.setState({currentPage:e})}compareLevel(e,t){let a=e.readyToBeCollected?1:e.wasCollected?3:2,s=t.readyToBeCollected?1:t.wasCollected?3:2;return a!==s?a-s:3===a?t.level-e.level:e.level-t.level}render(){const{tab:e,data:t,rewardBonus:a,tribe:s,hero:i,showDetailview:n,setTaskLevelCollected:r,reloadCallback:l}=this.props,{sortedLevels:o,currentPage:c}=this.state;let d=t;d.detailviewShownLevels=[];let h=0;if(d.levels.forEach(((e,t)=>{d.currentLevel>e.level&&!e.readyToBeCollected&&!e.wasCollected?console.log(d.name+" Level "+e.level+" could not be shown"):e.readyToBeCollected||e.wasCollected?d.detailviewShownLevels.push(e):h<=0&&(d.detailviewShownLevels.push(e),h++)})),0===o.length){d.detailviewShownLevels.sort(this.compareLevel);let e=[];d.detailviewShownLevels.map((t=>(e.push(t.level),!0))),this.setState({sortedLevels:e})}else d.detailviewShownLevels.sort(((e,t)=>o.indexOf(e.level)-o.indexOf(t.level)));d.detailviewShownLevels=d.detailviewShownLevels.filter((e=>!e.wasTakenOver));let u=d.detailviewShownLevels,m=[[]];if(u.length>Oa.tasksPerPage){const e=[];let t=u.length,a=Oa.tasksPerPage;for(let s=0;s<t;s+=a){let t=u.slice(s,s+a);e.push(t)}m=e}else m[0]=u;return(0,_.jsxs)("div",{className:"taskDetailview",children:[(0,_.jsxs)("div",{className:"taskDescription",children:[(0,_.jsx)("div",{className:"imageFrame",children:(0,_.jsx)(da,{type:d.type,metadata:d.metadata,tribe:s,context:"description"})}),(0,_.jsxs)("div",{className:"description",children:[(0,_.jsx)("div",{className:"title",children:d.name}),(0,_.jsx)("div",{dangerouslySetInnerHTML:{__html:d.description}})]})]}),Object.keys(m[c]).map((t=>{let a=m[c][t];return(0,_.jsx)(oa,{taskIndex:d.taskIndex,tab:e,progress:a.readyToBeCollected?"achieved":a.wasCollected?"collected":"open",context:"level",title:a.title,type:d.type,level:a.level,reward:a.rewardValues,progressValue:d.progressValue,progressTarget:d.progressTarget,levelValue:a.levelValue,tribe:s,hero:i,scope:d.scope,metadata:a.metadata,showDetailviewCallback:n,setTaskLevelCollectedCallback:r,reloadCallback:l},"detailview_"+e+"_"+d.taskIndex+"_"+a.level)})),u.length>Oa.tasksPerPage&&(0,_.jsx)(is.tl,{currentPage:c,pageCount:m.length,switchPage:this.switchPage}),u.length<=Oa.tasksPerPage&&(0,_.jsx)("div",{className:"divider"}),(0,_.jsx)(ha,{rewardBonus:a}),(0,_.jsx)("div",{className:"buttonWrapper",children:(0,_.jsx)(F.z,{className:"backToOverview",onClick:()=>n(!1,d.taskIndex),children:(0,O.Jh)("tasks.backToOverview")})})]})}}function _a(e){const{items:t,favouriteTabIndex:a,isFavorite:s,onChangeTab:i,activeTabKey:n,onBackButtonPressed:r}=e,l=e=>{Travian.Game.Layout.setKnowledgeBaseButtonLink(e)},c=e=>r(e,l);return(0,o.useEffect)((()=>(window.addEventListener("popstate",c),()=>{window.removeEventListener("popstate",c)})),[]),(0,_.jsx)("div",{className:"contentNavi tabNavi tabSubWrapper",children:t.map(((e,t)=>(0,_.jsxs)("div",{className:"container "+(e.key===n?"active":"normal"),children:[(0,_.jsx)("div",{className:"background-start",children:" "}),(0,_.jsx)("div",{className:"background-end",children:" "}),(0,_.jsx)("div",{className:`content ${s?"favor ":""}${a===t?"favorActive ":""}${"favorKey"+t}`,children:!0===e.enabled?(0,_.jsx)("a",{id:!1!==e.id?e.id:"","data-key":e.key,onClick:t=>{e.knowledgeBaseLink&&l(e.knowledgeBaseLink),i(t)},className:"tabItem",href:"#",children:e.name}):(0,_.jsx)("span",{id:!1!==e.id?e.id:"","data-key":e.key,onClick:!1!==e.onclick?e.onclick:"",className:"tabItem",children:e.name})})]},t)))})}var Aa;function Da(){return Da=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Da.apply(this,arguments)}const La=e=>o.createElement("svg",Da({viewBox:"0 0 48 48"},e),Aa||(Aa=o.createElement("path",{d:"m11.7 44 4.6-15.2L4 20h15.2L24 4l4.8 16H44l-12.3 8.8L36.4 44 24 34.6Z"})));var Pa=a(925),Ba=a(4333);const Ma=(0,Pa.T)((function({items:e,name:t,client:a,favouriteSubTab:s,fetch:i,onFavouritize:n,initialTab:r}){const[l,c]=(0,o.useState)(s),[d,h]=(0,o.useState)(r??s??e[0].key),u=Ba.Ps`
        query($name: String!) {
            favouriteTab(name: $name) {
                key
            }
        }
    `;(0,o.useEffect)((()=>(window.addEventListener("popstate",p),history.replaceState({[t]:d,...history.state},"",location.pathname),i&&a.query({query:u,variables:{name:t}}).then((e=>{const t=e.data&&e.data.favouriteTab&&e.data.favouriteTab.key;null!==t&&(c(t),h(t))})),()=>{window.removeEventListener("popstate",p)})),[]),(0,o.useEffect)((()=>{Travian.Tip.refresh()}),[d]);const m=e=>()=>{history.pushState({...history.state,[t]:e.key},"",location.pathname),h(e.key),"function"==typeof e.onTabClick&&e.onTabClick()},p=e=>{e.state.hasOwnProperty(t)&&h(e.state[t])};return(0,_.jsxs)("div",{className:"subTabs",children:[(0,_.jsxs)("div",{className:"subTabs_tabs",children:[e.map((e=>(0,_.jsxs)("a",{onClick:e.disabled?()=>{}:m(e),title:e.title,className:`${d===e.key?"active":""} ${e.disabled?"disabled":""} ${l===e.key?"favourite":""}`,children:[e.title,l===e.key?(0,_.jsx)(La,{className:"star"}):""]},e.key))),(0,_.jsx)("a",{onClick:()=>{Travian.api("favourite-tab",{data:{name:t,key:d},success:()=>{c(d),n()}})},className:"favor",children:(0,_.jsx)(La,{})})]}),(0,_.jsx)("div",{className:"subTabs_content",children:e.map(((e,t)=>(0,_.jsx)(o.Fragment,{children:d===e.key?e.content:null},t)))})]})}));var Ja,Za,Fa;function Va(){return Va=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Va.apply(this,arguments)}const Ha=e=>o.createElement("svg",Va({viewBox:"0 0 141.7 9.4",preserveAspectRatio:"xMidYMid slice"},e),Ja||(Ja=o.createElement("path",{d:"M70.9,8.7L75,5h66.4",strokeLinecap:"square",className:"stroke"})),Za||(Za=o.createElement("path",{d:"M0.7,5H67l3.8,3.7",strokeLinecap:"square",className:"stroke"})),Fa||(Fa=o.createElement("path",{d:"M68.1,2.8L70.9,0l2.8,2.8l-2.8,2.9L68.1,2.8z",className:"square"})));function qa(e){const{items:t,onChange:a,activeKey:s,customClass:i}=e;return(0,_.jsx)("div",{className:`subNavigation ${i??""}`,children:t.map(((e,i)=>{let n=e.disabled??!1;return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsxs)("a",{className:`item${e.key===s?" active":""} ${n?" disabled":""}`,id:e.id??null,"data-key":e.key,onClick:n?null:a,href:e.href??"#",children:[e.text,(0,_.jsx)("div",{className:"tabIndicator",children:(0,_.jsx)(Ha,{})})]},`item${i}`),i+1<t.length&&(0,_.jsx)("div",{className:"divider"},`divider${i}`)]},`fragment${i}`)}))})}var Ua,za;function $a(){return $a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},$a.apply(this,arguments)}qa.propTypes={items:d().arrayOf(d().shape({key:d().string.isRequired,text:d().string.isRequired,id:d().string,href:d().string,disabled:d().bool})),activeKey:d().string.isRequired,customClass:d().string,onChange:d().func};const Wa=e=>o.createElement("svg",$a({viewBox:"0 0 560 400",xmlns:"http://www.w3.org/2000/svg"},e),Ua||(Ua=o.createElement("path",{d:"m410.096 200.048c0-71.818-58.23-130.048-130.048-130.048s-130.048 58.23-130.048 130.048c0 64.905 47.55 118.709 109.73 128.476v-90.875h-33.029v-37.601h33.029v-28.658c0-32.59 19.422-50.604 49.122-50.604 14.228 0 29.115 2.542 29.115 2.542v32.005h-16.405c-16.148 0-21.196 10.022-21.196 20.318v24.396h36.064l-5.761 37.601h-30.304v90.875c62.18-9.749 109.73-63.553 109.73-128.476z",fill:"#fefefe"})),za||(za=o.createElement("path",{d:"m330.67 237.648 5.761-37.601h-36.064v-24.396c0-10.278 5.029-20.318 21.196-20.318h16.405v-32.005s-14.886-2.542-29.115-2.542c-29.7 0-49.122 17.996-49.122 50.604v28.658h-33.029v37.601h33.029v90.875c6.62 1.041 13.405 1.572 20.318 1.572s13.698-.549 20.318-1.572v-90.875h30.304z",fill:"#1977f3"})));var Ga,Ya,Ka=a(3265),Xa=a(7757);function Qa(){return Qa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Qa.apply(this,arguments)}const es=e=>o.createElement("svg",Qa({viewBox:"0 0 22 19"},e),Ga||(Ga=o.createElement("path",{d:"M11 4l7.5 13h-15L11 4m0-4L0 19h22L11 0z"})),Ya||(Ya=o.createElement("path",{d:"M12 14h-2v2h2zM12 8h-2v5h2z"})));var ts=a(4984);const as=e=>{const{maximumMessageLength:t}=e,a=(0,o.useRef)(),[s,i]=(0,o.useState)(""),[n,r]=(0,o.useState)(""),[l,c]=(0,o.useState)((0,O.Jh)("referAFriend.defaultMessage")),[d,h]=(0,o.useState)(!1),[u,m]=(0,o.useState)(!1),[p,g]=(0,o.useState)(!1),[v,x]=(0,o.useState)(null);let b=(0,o.useRef)(new O.w3);(0,o.useEffect)((()=>{a.current&&b.current.attach(a.current.closest("form"))}),[a.current]),(0,o.useEffect)((()=>{v&&(b.current.onCustomErrorFocus=e=>{const t=Object.keys(v).filter((t=>t!==e.dataset.name)).reduce(((e,t)=>(e[t]=v[t],e)),{});x(t)})}),[v]);const j=e=>{e.preventDefault(),g(!1),b.current.validateForm(),b.current.formValid&&(m(!0),x(null),Travian.api("referAFriend/invite",{data:{name:s,email:n,message:l,copy:d},success:function(){m(!1),g(!0),i(""),r(""),c((0,O.Jh)("referAFriend.defaultMessage")),b.current.resetAllValidations()},error:function(e){m(!1),e.errors&&(x(e.errors),b.current.validateForm())}}))};return(0,_.jsxs)("div",{id:"inviteViaEmailDialog",children:[(0,_.jsx)("h1",{children:(0,O.Jh)("referAFriend.inviteAFriend")}),p&&(0,_.jsx)("div",{className:"infoBox successMessage",children:(0,O.Jh)("referAFriend.successfullySent")}),(0,_.jsxs)("div",{className:"formV2",ref:a,children:[(0,_.jsxs)("label",{className:"input",id:"name",children:[(0,_.jsx)("input",{type:"text",name:"name",onChange:e=>i(e.target.value),value:s}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("referAFriend.friendName")}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,children:(0,O.Jh)("referAFriend.enterName")}),v&&v.name&&(0,_.jsx)("div",{className:"validation custom","data-rule":O.w3.NO_CUSTOM_ERROR,"data-name":"name",children:v.name})]}),(0,_.jsxs)("label",{className:"input",id:"email",children:[(0,_.jsx)("input",{type:"text",name:"email",onChange:e=>r(e.target.value),value:n}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("referAFriend.friendEmailAddress")}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,children:(0,O.Jh)("referAFriend.enterEmail")}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.IS_EMAIL,children:(0,O.Jh)("referAFriend.invalidEmailAddress")}),v&&v.email&&(0,_.jsx)("div",{className:"validation custom","data-rule":O.w3.NO_CUSTOM_ERROR,"data-name":"email",children:v.email})]}),(0,_.jsxs)("label",{className:"textarea fixed",id:"message",children:[(0,_.jsx)("textarea",{name:"message",value:l,onChange:e=>c(e.target.value)}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("referAFriend.personalizeMessage")}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.SHORTER_THAN,"data-parameter":t,children:(0,O.Jh)("referAFriend.shortenMessage",{MAXIMUM_LENGTH:t,CURRENT_LENGTH:l.length})}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,children:(0,O.Jh)("referAFriend.enterText")}),v&&v.message&&(0,_.jsx)("div",{className:"validation custom","data-rule":O.w3.NO_CUSTOM_ERROR,"data-name":"message",children:v.message})]}),(0,_.jsxs)("label",{className:"checkbox",id:"copyCheckbox",children:[(0,_.jsx)("input",{name:"copy",type:"checkbox",onChange:e=>h(e.target.checked)}),(0,_.jsx)(ts.Z,{className:"checkbox"}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("referAFriend.wouldYouLikeToReceiveCopy")})]}),(0,_.jsx)(F.z,{type:"submit",id:"inviteButton",disabledClass:u,onSubmit:j,onClick:j,children:(0,O.Jh)("referAFriend.inviteFriend")})]})]})};class ss extends o.Component{constructor(e){super(e);const{viewData:t}=this.props;this.state={viewData:t},this.copyReferLink=this.copyReferLink.bind(this),this.showInviteViaEmailDialog=this.showInviteViaEmailDialog.bind(this),this.showFacebookShareDialog=this.showFacebookShareDialog.bind(this),this.shareLink=this.shareLink.bind(this)}copyReferLink(){let e=jQuery("#referralLinkInput"),t=jQuery("#referralLinkInput ~ button");t.removeClass("success"),e.select(),document.execCommand("copy"),t.removeClass("success").addClass("success")}showInviteViaEmailDialog(){window.Travian.React.Dialog({content:(0,_.jsx)(as,{maximumMessageLength:this.state.viewData.maximumMessageLength}),cssClass:"basic referAFriendInvite",version:2,buttonOk:!1,buttonCancel:!0,overlayCancel:!1,preventFormSubmit:!0},"tradeRouteDialog")}showFacebookShareDialog(){return window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(this.state.viewData.referAFriendLink),"facebook-share-dialog","width=526,height=436"),!1}shareLink(e){fetch(Travian.Game.getImageDirectoryPath()+"views/ReferAFriend/refer_a_friend.jpg").then((e=>e.blob())).then((t=>{const a=new File([t],"raf.jpg",{type:"image/jpeg"});navigator.canShare&&navigator.canShare({files:[a]})&&(e.files=[a]),navigator.share(e).catch((e=>{console.log("Something went wrong sharing the RAF link",e)}))}))}render(){const{viewData:e}=this.state,{openTabCallback:t,isMobile:a}=this.props,s={url:e.referAFriendLink,text:(0,O.Jh)("referAFriend.shareMessage")},i=Travian.Variables.feature_flags.boostedStart,n=i?"referAFriend.referAFriendDescriptionBoostedStart":"referAFriend.referAFriendDescription";return(0,_.jsxs)("div",{className:"referAFriendInfo",children:[(0,_.jsx)("div",{className:"header",children:(0,_.jsxs)("div",{className:"badgeBigDecoration",children:[(0,_.jsxs)("div",{className:"maxReward",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),e.maxReward]}),(0,_.jsx)("div",{className:"caption",children:(0,O.Jh)("referAFriend.perFriend")})]})}),(0,_.jsx)("div",{className:"descriptionHeader",children:(0,O.Jh)("referAFriend.referAFriendDescriptionHeader")}),(0,_.jsx)("div",{className:"description",children:(0,O.Jh)(n,{VILLAGE_REWARD:(0,_.jsxs)("span",{className:"inlineIcon",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("span",{children:e.villageReward})]}),MAX_VILLAGE_REWARD:(0,_.jsxs)("span",{className:"inlineIcon",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("span",{children:e.maxVillageReward})]})},!0)}),(0,_.jsxs)("div",{className:"infoGraphic",children:[(0,_.jsx)("div",{className:"badge badgeBig friendJoins",children:(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("referAFriend.friendJoins")})}),(0,_.jsxs)("div",{className:"badge badgeSmall "+(i?"fourthVillage":"secondVillage"),children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)(i?"referAFriend.fourthVillage":"referAFriend.secondVillage",{B:"<strong>","/B":"</strong>"},!0)}),(0,_.jsxs)("div",{className:"reward",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("div",{className:"content",children:e.villageReward})]})]}),(0,_.jsxs)("div",{className:"badge badgeSmall "+(i?"fifthVillage":"thirdVillage"),children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)(i?"referAFriend.fifthVillage":"referAFriend.thirdVillage",{B:"<strong>","/B":"</strong>"},!0)}),(0,_.jsxs)("div",{className:"reward",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("div",{className:"content",children:e.villageReward})]})]}),(0,_.jsx)("div",{className:"dot"}),(0,_.jsx)("div",{className:"dot"}),(0,_.jsx)("div",{className:"dot"}),(0,_.jsxs)("div",{className:"badge badgeSmall "+(i?"eleventhVillage":"ninthVillage"),children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)(i?"referAFriend.eleventhVillage":"referAFriend.ninthVillage",{B:"<strong>","/B":"</strong>"},!0)}),(0,_.jsxs)("div",{className:"reward",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("div",{className:"content",children:e.villageReward})]})]}),(0,_.jsxs)("div",{className:"badge badgeSmallDecoration "+(i?"twelfthVillage":"tenthVillage"),children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)(i?"referAFriend.twelfthVillage":"referAFriend.tenthVillage",{B:"<strong>","/B":"</strong>"},!0)}),(0,_.jsxs)("div",{className:"reward",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("div",{className:"content",children:e.maxVillageReward})]})]})]}),e.isRegistrationOpen?(0,_.jsxs)("div",{className:"registrationOpen",children:[(0,_.jsx)("div",{children:(0,O.Jh)("referAFriend.yourInviteLink")}),(0,_.jsxs)("div",{className:"copyLinkWrapper",children:[(0,_.jsx)("input",{type:"text",id:"referralLinkInput",className:"referralLink",value:e.referAFriendLink,readOnly:!0}),(0,_.jsxs)(F.z,{className:"copyLink",onClick:this.copyReferLink,children:[(0,_.jsx)("div",{className:"action",children:(0,O.Jh)("referAFriend.copyLink")}),(0,_.jsxs)("div",{className:"confirm",children:[(0,_.jsx)(ee,{})," ",(0,O.Jh)("referAFriend.copied")]})]})]}),(0,_.jsxs)("div",{className:"shareButtonsWrapper",children:[(0,_.jsx)(F.z,{className:"openEmailForm",onClick:this.showInviteViaEmailDialog,children:(0,O.Jh)("referAFriend.openEmailForm")}),a&&navigator.share&&(0,_.jsx)(F.z,{className:"shareLink",onClick:()=>this.shareLink(s),children:(0,O.Jh)("referAFriend.shareLink")}),!a&&(0,_.jsxs)("div",{className:"fb-share-button",onClick:this.showFacebookShareDialog,children:[(0,_.jsx)(Wa,{}),(0,O.Jh)("referAFriend.shareOnFacebook")]})]}),(0,_.jsxs)("div",{className:"infoBox",children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("referAFriend.tipsTitle")}),(0,_.jsxs)("ul",{children:[(0,_.jsx)("li",{className:"tip1",children:(0,O.Jh)("referAFriend.tip1")}),(0,_.jsx)("li",{className:"tip1",children:(0,O.Jh)("referAFriend.tip2",{GOLD:(0,_.jsxs)("span",{className:"inlineIcon",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("span",{children:e.maxReward})]})},!0)})]})]})]}):(0,_.jsxs)("div",{className:"registrationClosed",children:[(0,_.jsx)("div",{className:"infoBox",children:(0,O.Jh)("referAFriend.registrationClosed")}),(0,_.jsx)(F.z,{className:"goToReferralOverview",onClick:()=>t(2),children:(0,O.Jh)("referAFriend.referralOverviewTab")})]})]})}}var is=a(7581);const ns=e=>(0,_.jsxs)("svg",{className:`${e.className} icon svgVillageSlot`,viewBox:"0 0 86 86",overflow:"visible",children:[(0,_.jsx)("path",{className:`slot1 ${e.activeSlots>=1&&"active"}`,d:"M55.9 2.4C52.6 1.3 49.3.7 45.8.5L45.1 11c5.4.3 10.6 2.1 15.2 5L66 7.2c-3.2-2-6.5-3.6-10.1-4.8z"}),(0,_.jsx)("path",{className:`slot2 ${e.activeSlots>=2&&"active"}`,d:"M70.2 10.2l-6.7 8.1c4.2 3.5 7.4 8 9.4 13l9.7-3.8c-2.6-6.7-6.9-12.7-12.4-17.3z"}),(0,_.jsx)("path",{className:`slot3 ${e.activeSlots>=3&&"active"}`,d:"M84.2 32.5L74 35c1.3 5.2 1.3 10.9 0 16l10.1 2.6c1.1-4.3 1.6-9 1.3-13.5-.2-2.5-.6-5.1-1.2-7.6z"}),(0,_.jsx)("path",{className:`slot4 ${e.activeSlots>=4&&"active"}`,d:"M72.8 54.8c-2 5-5.3 9.5-9.4 13l6.7 8.1c5.5-4.6 9.9-10.5 12.5-17.2l-9.8-3.9z"}),(0,_.jsx)("path",{className:`slot5 ${e.activeSlots>=5&&"active"}`,d:"M60.2 70.1C55.6 73 50.4 74.7 45 75l.6 10.5h.1c7.1-.5 14.1-2.7 20-6.5l-5.5-8.9z"}),(0,_.jsx)("path",{className:`slot6 ${e.activeSlots>=6&&"active"}`,d:"M25.8 70.1l-5.6 8.8c5.9 3.8 13 6.1 20.2 6.6L41 75c-5.4-.3-10.6-2-15.2-4.9z"}),(0,_.jsx)("path",{className:`slot7 ${e.activeSlots>=7&&"active"}`,d:"M13.2 54.8l-9.7 3.9c2.6 6.7 7 12.7 12.5 17.2l6.7-8.1c-4.3-3.5-7.5-8-9.5-13z"}),(0,_.jsx)("path",{className:`slot8 ${e.activeSlots>=8&&"active"}`,d:"M1.8 32.4C.7 36.7.3 41.3.6 45.7c.2 2.7.6 5.3 1.3 7.9L12 51.1c-1.3-5.2-1.4-10.9 0-16L1.8 32.4z"}),(0,_.jsx)("path",{className:`slot9 ${e.activeSlots>=9&&"active"}`,d:"M15.9 10.2C10.4 14.8 6 20.8 3.4 27.4l9.7 3.8c2-5 5.2-9.5 9.4-13l-6.6-8z"}),(0,_.jsx)("path",{className:`slot10 ${e.activeSlots>=10&&"active"}`,d:"M40.3.5C33.1.9 26 3.3 20.1 7.1l5.6 8.8c4.5-2.9 9.8-4.6 15.2-5L40.3.5z"})]}),rs=e=>(0,_.jsxs)("svg",{className:`${e.className} icon svgDeletedPlayer`,viewBox:"0 0 42.13 42.13",children:[(0,_.jsx)("path",{d:"M27.76 18.82a7.2 7.2 0 00.67-3 7.36 7.36 0 00-7.37-7.36 7.23 7.23 0 00-3 .67z"}),(0,_.jsx)("path",{d:"M21.06 0a21.07 21.07 0 1021.07 21.06A21.08 21.08 0 0021.06 0zm0 27.38a20.91 20.91 0 00-12.93 4.47 16.78 16.78 0 01-.36-21.1l6 6a7.32 7.32 0 006.3 6.3l4.63 4.63a21.48 21.48 0 00-3.64-.3zm13.29 4L10.74 7.77a16.82 16.82 0 0123.61 23.61z"})]});class ls extends o.Component{static inviteesPerPage=8;collectAnimationTimeout=null;ajaxRequest=null;goldElementRefs={};constructor(e){super(e);const{viewData:t}=this.props;this.state={viewData:t,currentPage:0,animationUid:0,isAjaxCallRunning:!1,isAnimationRunning:!1,animationCallbackOptions:null,animationFinished:!1},this.collectReward=this.collectReward.bind(this),this.collectAnimationCallback=this.collectAnimationCallback.bind(this),this.skipAnimation=this.skipAnimation.bind(this),this.compareInvitee.bind(this),this.switchPage=this.switchPage.bind(this),this.updateTotalEarned=this.updateTotalEarned.bind(this),this.getSortedData=this.getSortedData.bind(this),this.removeNotifications=this.removeNotifications.bind(this)}componentDidMount(){this.removeNotifications()}componentDidUpdate(){const{viewData:e}=this.props,{isAnimationRunning:t,animationUid:a,animationFinished:s}=this.state,i=jQuery("#header .goldCoin_medium"),n=jQuery(".contentContainer");if(t&&!s){this.setState({animationFinished:!0});const e="auto"===n.css("overflow");let t=M.ZP.timeline();const s=jQuery("#referAFriend .totalCollected .content");if(!e){let e=i.offset();const s=this.goldElementRefs[a],n=jQuery(s),r=n.offset(),l=n.position(),o=e.left-r.left,c=e.top-r.top+l.top;t.add((()=>{M.ZP.to(s,{duration:.75,css:{transform:"translateX("+o+"px) translateY("+c+"px)"}})}),"0"),t.add((()=>{M.ZP.to(s,{duration:.5,css:{transform:"translateX("+o+"px) translateY("+c+"px) scale(0)"}})}),"1"),t.add((()=>{M.ZP.set(s,{clearProps:"all"})}),"2")}t.add((()=>{Travian.Game.Layout.updateGold()}),"1.1"),t.add((()=>{M.ZP.to(s,{duration:.3,css:{transform:"scaleX(0)"}})}),"0.1"),t.add((()=>{this.updateTotalEarned(a)}),"0.2"),t.add((()=>{M.ZP.to(s,{duration:.3,css:{transform:"scaleX(1)"}})}),"0.3")}e!==this.state.viewData&&this.setState({viewData:e}),this.removeNotifications()}componentWillUnmount(){null!==this.ajaxRequest&&(this.ajaxRequest.abort(),this.ajaxRequest=null),this.state.isAnimationRunning&&this.skipAnimation()}skipAnimation(){null!==this.collectAnimationTimeout&&clearTimeout(this.collectAnimationTimeout),this.collectAnimationCallback()}switchPage(e){this.setState({currentPage:e})}updateTotalEarned(e){this.setState((t=>{const a=t.viewData.invitees.find((t=>t.playerUid==e)),s=t.viewData.totalCollectedReward+a.collectible.reward,i=Object.assign({},t);return i.viewData.totalCollectedReward=s,i}))}collectReward(e){this.setState((t=>{const a=Object.assign({},t);a.isAjaxCallRunning=!0,a.animationUid=e.playerUid;const s=e.collectible.villageSlot;return a.viewData.villageSlots[s]=t.viewData.villageSlots[s]+1,a}));const t={data:{inviteeUid:e.playerUid},success:e=>{const t=void 0!==e.overview?e.overview:null;this.setState({isAjaxCallRunning:!1,isAnimationRunning:!0,animationCallbackOptions:{viewData:t}}),this.collectAnimationTimeout=setTimeout(this.collectAnimationCallback,2e3),this.ajaxRequest=null},error:e=>{this.setState({isAjaxCallRunning:!1,animationUid:0}),this.ajaxRequest=null,Travian.defaultErrorFunction(e)}};this.ajaxRequest=Travian.api("referAFriend/collectReward",t)}collectAnimationCallback(){const{animationCallbackOptions:e}=this.state;this.setState({isAnimationRunning:!1,animationFinished:!1,animationUid:0}),void 0!==e.viewData&&this.props.updateDataCallback(e.viewData)}compareInvitee(e,t){return typeof e.collectible!=typeof t.collectible?void 0!==e.collectible?-1:1:e.playerUid-t.playerUid}removeNotifications(){const e=this.getSortedData();let t=[];if(e[this.state.currentPage].map(((e,a)=>(void 0===e.notificationsCleared&&(e.notificationsCleared=!0,t.push(e.playerUid)),!0))),t.length>0){const e={data:{inviteeUidList:t},success:()=>{},error:()=>{}};this.ajaxRequest=Travian.api("referAFriend/removeNotifications",e)}}getSortedData(){const{invitees:e}=this.state.viewData;e.sort(this.compareInvitee);let t=[[]];if(e.length>ls.inviteesPerPage){const a=[];let s=e.length,i=ls.inviteesPerPage;for(let t=0;t<s;t+=i){let s=e.slice(t,t+i);a.push(s)}t=a}else t[0]=e;return t}render(){const{inviteeCount:e,totalCollectedReward:t,invitees:a,villageSlots:s}=this.state.viewData,{isAjaxCallRunning:i,isAnimationRunning:n,animationUid:r}=this.state,l=this.getSortedData();return(0,_.jsxs)("div",{className:"referralOverview",children:[(0,_.jsxs)("div",{className:"referralSummary",children:[(0,_.jsxs)("div",{className:"inviteeCount",children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("referAFriend.successfullyReferredFriends")}),(0,_.jsxs)("div",{className:"amount",children:[(0,_.jsx)("i",{className:"player"}),(0,_.jsx)("div",{className:"content",children:e})]})]}),(0,_.jsxs)("div",{className:"totalCollected",children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("referAFriend.totalGoldEarned")}),(0,_.jsxs)("div",{className:"amount",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("div",{className:"content",children:t})]})]})]}),0===e?(0,_.jsx)("div",{className:"noInvitees",children:(0,O.Jh)("referAFriend.noInvitees")}):(0,_.jsx)("div",{className:"invitees",children:l[this.state.currentPage].map(((e,t)=>{const a=0==e.heroImageHash;return(0,_.jsxs)("div",{className:"invitee",children:[a?(0,_.jsx)("div",{className:"playerName deleted",children:e.playerName}):(0,_.jsx)("a",{className:"playerName",title:e.playerName,href:`/profile/${e.playerUid}`,children:e.playerName}),(0,_.jsxs)("div",{className:"playerFrame",children:[(0,_.jsx)("div",{className:"avatar",children:a?(0,_.jsx)(rs,{}):(0,_.jsx)("img",{className:`heroImage ${e.heroGender} v2`,src:`/heroV2/head/${e.heroImageHash}.1.png`,alt:(0,O.Jh)("allgemein.hero")})}),(0,_.jsxs)("div",{className:"totalCollected",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"})," ",e.totalCollected]}),e.collectible&&(0,_.jsxs)("div",{className:"collectible",children:[(0,_.jsx)("div",{className:["reward",n&&r===e.playerUid?"animated":""].join(" "),ref:t=>this.goldElementRefs[e.playerUid]=t,children:(0,_.jsxs)("div",{className:"amount",children:[(0,_.jsx)(Ka.Z,{className:"svgGoldCoin"}),(0,_.jsx)("div",{className:"content",children:e.collectible.reward})]})}),(0,_.jsx)(F.z,{className:"collect",onClick:()=>this.collectReward(e),disabledAttribute:i||n,children:(0,O.Jh)("referAFriend.collect")})]})]})]},t)}))}),a.length>ls.inviteesPerPage&&(0,_.jsx)(is.tl,{currentPage:this.state.currentPage,pageCount:l.length,switchPage:this.switchPage}),(0,_.jsx)("div",{className:"collectedRewardsTitle",children:(0,O.Jh)("referAFriend.collectedRewards_title")}),(0,_.jsx)("div",{className:"collectedRewardsDescription",children:(0,O.Jh)("referAFriend.collectedRewards_description")}),(0,_.jsx)("div",{className:"villageSlots",children:Object.keys(s).map((e=>{const t=s[e];return(0,_.jsxs)("div",{className:"villageSlot "+(10==t?"completed":""),children:[(0,_.jsx)(ns,{activeSlots:t}),(0,_.jsx)("i",{className:"checkmark"}),(0,_.jsx)("div",{className:"content",children:e})]},e)}))})]})}}var os;function cs(){return cs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},cs.apply(this,arguments)}const ds=e=>o.createElement("svg",cs({viewBox:"0 0 20 19"},e),os||(os=o.createElement("path",{d:"M11.83 8.35A2.23 2.23 0 0 0 10.05 7l-4.6-.6a2.24 2.24 0 0 0-2 .8L.51 10.74A2.2 2.2 0 0 0 .16 13l1.59 4a2.25 2.25 0 0 0 1.79 1.39l4.59.61a2.24 2.24 0 0 0 2-.79l2.94-3.58a2.23 2.23 0 0 0 .35-2.23ZM5 8.67c.6-.28 1.22-.23 1.37.1s-.21.83-.82 1.11-1.21.23-1.36-.11S4.4 9 5 8.67Zm-3.37 5.21c-.31-.52-.3-1.1 0-1.28s.82.09 1.13.62.29 1.11 0 1.29-.82-.1-1.13-.63ZM4 17.54c-.32.18-.82-.1-1.13-.63s-.29-1.1 0-1.29.82.1 1.12.63.3 1.1 0 1.29Zm1-3.15c-.31-.53-.3-1.11 0-1.29s.82.1 1.12.63.3 1.1 0 1.28-.82-.09-1.12-.62Zm2.32 3.48c-.31.18-.82-.09-1.12-.62s-.3-1.11 0-1.29.82.09 1.13.62.29 1.11 0 1.29Zm1.75.59a.45.45 0 0 1-.58-.25l-2.1-5.3a.47.47 0 0 1-.17 0l-5.36-.7a.44.44 0 0 1-.39-.48.44.44 0 0 1 .45-.39H1l5.36.66.15.06 3.55-4.33a.44.44 0 0 1 .62-.06.43.43 0 0 1 .06.62l-3.5 4.31 2.09 5.29a.43.43 0 0 1-.24.57Zm1.29-1.91c-.36.07-.74-.41-.86-1.06s.08-1.23.44-1.3.75.42.87 1.07-.08 1.22-.44 1.29Zm.69-5.19c-.36.07-.75-.41-.86-1.06s.08-1.23.44-1.3.75.41.86 1.07-.08 1.22-.44 1.29Zm8.45-6.95L16.57.82a2.19 2.19 0 0 0-2-.8L10 .59A2.28 2.28 0 0 0 8.18 2L6.82 5.38l4 .52h.06A2.21 2.21 0 0 1 12.47 7l.3-.74a.47.47 0 0 1-.13-.11L9.22 1.93a.44.44 0 0 1 .64-.6l3.42 4.19a.55.55 0 0 1 .08.15L19 5a.44.44 0 0 1 .11.87l-5.51.7-.6 1.55 1.27 3.2a2.34 2.34 0 0 1 .15 1l2.02-.32a2.23 2.23 0 0 0 1.79-1.38l1.61-4a2.22 2.22 0 0 0-.34-2.21ZM9.3 3c.36.09.54.64.39 1.23s-.55 1-.9.92-.53-.63-.39-1.23.6-1.01.9-.92Zm3.91-.89c-.12.35-.72.45-1.34.24s-1-.67-.92-1 .72-.46 1.34-.24 1 .66.92 1Zm4.94 2.24c-.12.35-.72.46-1.34.24s-1-.66-.92-1 .72-.45 1.34-.24 1 .67.92 1Zm-2 4.8c-.42.51-1 .72-1.27.49s-.17-.84.26-1.35 1-.72 1.28-.49.16.84-.27 1.35Z"}))),hs=e=>(0,_.jsxs)("svg",{className:"allianceBanner",width:"300",height:"300",viewBox:"0 0 300 300",id:`allianceBanner_${e.id}`,children:[(0,_.jsx)("clipPath",{id:`allianceBanner_${e.id}_clipPath`,children:(0,_.jsx)("use",{href:`#allianceBanner_baseForm${e.baseForm}Path`})}),0!==e.backSymbol&&(0,_.jsx)("use",{href:`#allianceBanner_backSymbol${e.backSymbol}Path`,fill:e.backSymbolColor}),(0,_.jsxs)("svg",{x:"40",y:"40",width:"220",height:"220",viewBox:"0 0 300 300",overflow:"visible",children:[(0,_.jsx)("use",{href:`#allianceBanner_baseForm${e.baseForm}Path`,fill:e.baseColor}),(0,_.jsx)("use",{clipPath:`url(#allianceBanner_${e.id}_clipPath)`,href:`#allianceBanner_pattern${e.pattern}Primary`,fill:e.primaryColor}),(0,_.jsx)("use",{clipPath:`url(#allianceBanner_${e.id}_clipPath)`,href:`#allianceBanner_pattern${e.pattern}Secondary`,fill:e.secondaryColor}),(0,_.jsx)("use",{href:`#allianceBanner_baseForm${e.baseForm}Path`,strokeWidth:"5",stroke:e.borderColor,fill:"transparent"})]}),0!==e.frontSymbol&&(0,_.jsx)("use",{x:(300-e.frontSymbolSize.width)/2,y:(300-e.frontSymbolSize.height)/2,href:`#allianceBanner_frontSymbol${e.frontSymbol}`,fill:e.frontSymbolColor})]});hs.propTypes={baseForm:d().number.isRequired,baseColor:d().string.isRequired,borderColor:d().string.isRequired,pattern:d().number.isRequired,primaryColor:d().string.isRequired,secondaryColor:d().string.isRequired,backSymbol:d().number.isRequired,backSymbolColor:d().string.isRequired,frontSymbol:d().number.isRequired,frontSymbolColor:d().string.isRequired,frontSymbolSize:d().shape({width:d().number.isRequired,height:d().number.isRequired})};class us extends o.Component{static propTypes={bannerTemplateConfig:d().shape({baseForm:d().arrayOf(d().number.isRequired),pattern:d().arrayOf(d().number),backSymbol:d().arrayOf(d().number.isRequired),frontSymbol:d().arrayOf(d().number.isRequired)}),patternsWithSecondaryColors:d().arrayOf(d().number),symbolSizes:d().objectOf(d().shape({width:d().number.isRequired,height:d().number.isRequired})),colorPalette:d().arrayOf(d().string),currentBanner:d().object};static steps=[{step:"baseForm",colors:["baseColor","borderColor"]},{step:"pattern",colors:["primaryColor","secondaryColor"]},{step:"backSymbol",colors:["backSymbolColor"]},{step:"frontSymbol",colors:["frontSymbolColor"]}];constructor(e){super(e);const t=Object.assign({baseForm:4,pattern:0,backSymbol:0,frontSymbol:0,borderColor:e.colorPalette[22],baseColor:e.colorPalette[15],primaryColor:e.colorPalette[15],secondaryColor:e.colorPalette[15],frontSymbolColor:e.colorPalette[23],backSymbolColor:e.colorPalette[7]},null!==e.currentBanner?e.currentBanner:{});this.state=Object.assign({bannerCreatorActiveStep:us.steps[0].step,bannerCreatorActiveColor:us.steps[0].colors[0],disabledNavigationItems:[]},t),this.goToStep=this.goToStep.bind(this),this.goToNextStep=this.goToNextStep.bind(this),this.goToColor=this.goToColor.bind(this),this.createNavigationItems=this.createNavigationItems.bind(this),this.setSelection=this.setSelection.bind(this),this.setColor=this.setColor.bind(this),this.save=this.save.bind(this),this.randomize=this.randomize.bind(this)}goToStep(e){e.preventDefault(),this.setState({bannerCreatorActiveStep:e.target.dataset.key,bannerCreatorActiveColor:us.steps.find((t=>t.step===e.target.dataset.key)).colors[0]})}goToNextStep(){let e=us.steps.findIndex((e=>e.step===this.state.bannerCreatorActiveStep))+1;this.setState({bannerCreatorActiveStep:us.steps[e].step,bannerCreatorActiveColor:us.steps[e].colors[0]})}goToColor(e){e.preventDefault(),this.setState({bannerCreatorActiveColor:e.target.dataset.key})}setSelection(e){e.preventDefault();let t={};t[e.target.dataset.element]=parseInt(e.target.dataset.key),this.state.bannerCreatorActiveStep!==us.steps[1].step||this.state.bannerCreatorActiveColor!==us.steps[1].colors[1]||this.props.patternsWithSecondaryColors.includes(parseInt(e.target.dataset.key))||(t.bannerCreatorActiveColor=us.steps[1].colors[0]),this.setState(t)}setColor(e){e.preventDefault();let t={};t[e.target.dataset.element]=e.target.dataset.key,this.setState(t)}createNavigationItems(e){let t={steps:[]};return us.steps.forEach((a=>{t.steps.push({text:(0,O.Jh)("allianz.banner_"+a.step),key:a.step}),t[a.step]=[],a.colors.forEach((s=>{t[a.step].push({text:(0,O.Jh)("allianz.banner_"+s),key:s,disabled:e.includes(s)})}))})),t}save(){const{baseForm:e,pattern:t,backSymbol:a,frontSymbol:s,borderColor:i,baseColor:n,primaryColor:r,secondaryColor:l,frontSymbolColor:o,backSymbolColor:c}=this.state,{switchToScreen:d}=this.props,h={data:{type:"current",data:{baseForm:e,pattern:t,backSymbol:a,frontSymbol:s,borderColor:i,baseColor:n,primaryColor:r,secondaryColor:l,frontSymbolColor:o,backSymbolColor:c}},success:e=>{d("myBanner")}};Travian.api("alliance/banner/my",h,"POST")}randomize(){const{bannerTemplateConfig:e,colorPalette:t}=this.props;let a=this.getRandomValue(e.baseForm,[])??this.state.baseForm,s=this.getRandomValue(t,[])??this.state.baseColor,i=this.getRandomValue(t,[s])??this.state.borderColor,n=this.getRandomValue(e.pattern,[])??this.state.pattern,r=this.getRandomValue(t,[s])??this.state.primaryColor,l=this.getRandomValue(t,[s,r])??this.state.secondaryColor,o=this.getRandomValue(e.backSymbol,[])??this.state.backSymbol,c=this.getRandomValue(t,[])??this.state.backSymbolColor,d=this.getRandomValue(e.frontSymbol,[])??this.state.frontSymbol,h=this.getRandomValue(t,[s,r,l])??this.state.frontSymbolColor;this.setState({baseForm:a,pattern:n,backSymbol:o,frontSymbol:d,borderColor:i,baseColor:s,primaryColor:r,secondaryColor:l,frontSymbolColor:h,backSymbolColor:c,bannerCreatorActiveStep:"frontSymbol"})}getRandomValue(e,t){let a=e.filter((e=>!t.includes(e)));return a.length>0?a[Math.floor(Math.random()*a.length)]:null}render(){const{bannerTemplateConfig:e,symbolSizes:t,colorPalette:a,patternsWithSecondaryColors:s}=this.props,{bannerCreatorActiveStep:i,bannerCreatorActiveColor:n}=this.state;let r=[];0===this.state.backSymbol&&r.push(...us.steps.find((e=>"backSymbol"===e.step)).colors),0===this.state.frontSymbol&&r.push(...us.steps.find((e=>"frontSymbol"===e.step)).colors),s.includes(this.state.pattern)||r.push(us.steps.find((e=>"pattern"===e.step)).colors[1]);const l=this.createNavigationItems(r);return(0,_.jsxs)("div",{className:"creator",children:[(0,_.jsx)(qa,{items:l.steps,activeKey:i,onChange:this.goToStep,customClass:"stepsNavigation"}),(0,_.jsxs)("div",{className:`elementSelection ${i}`,children:[(0,_.jsx)("h5",{children:(0,O.Jh)("allianz.choose_"+i)}),(0,_.jsx)(js,{type:i,elements:e[i],selectedElement:this.state[i],setSelection:this.setSelection,steps:us.steps})]}),(0,_.jsxs)("div",{className:"colorSelection",children:[(0,_.jsx)(qa,{items:l[i],activeKey:n,onChange:this.goToColor,customClass:"colorsNavigation"}),(0,_.jsx)(fs,{type:n,colorPalette:a,selectedElement:this.state[n],setSelection:this.setColor,disabled:r.includes(n)})]}),(0,_.jsxs)("div",{className:"preview",children:[(0,_.jsx)("h5",{children:(0,O.Jh)("allianz.banner_preview")}),(0,_.jsx)("div",{className:"allianceBannerFrame",children:(0,_.jsx)(hs,{id:"creatorPreview",baseForm:this.state.baseForm,baseColor:this.state.baseColor,borderColor:this.state.borderColor,pattern:this.state.pattern,primaryColor:this.state.primaryColor,secondaryColor:this.state.secondaryColor,backSymbol:this.state.backSymbol,backSymbolColor:this.state.backSymbolColor,frontSymbol:this.state.frontSymbol,frontSymbolColor:this.state.frontSymbolColor,frontSymbolSize:0!==this.state.frontSymbol?t["frontSymbol"+this.state.frontSymbol]:{width:0,height:0}})})]}),(0,_.jsx)(F.z,{iconButton:!0,onClick:this.randomize,children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(ds,{className:"outline"}),(0,_.jsx)(ds,{className:"icon"})]})}),i===us.steps[us.steps.length-1].step?(0,_.jsx)(F.z,{onClick:this.save,children:(0,O.Jh)("allianz.banner_createBanner")}):(0,_.jsx)(F.z,{onClick:this.goToNextStep,children:(0,O.Jh)("allianz.banner_continue")})]})}}class ms extends o.Component{static bannersPerPage=12;static propTypes={banners:d().objectOf(d().objectOf(d().shape({player:d().shape({uid:d().number.isRequired,name:d().string}),data:d().object.isRequired,timestamp:d().number.isRequired}))),symbolSizes:d().oneOfType([d().objectOf(d().shape({width:d().number.isRequired,height:d().number.isRequired})),d().array]),currentPage:d().number.isRequired,selectBanner:d().func.isRequired,switchPage:d().func.isRequired};constructor(e){super(e),this.getBanners=this.getBanners.bind(this)}componentDidMount(){Travian.Tip.hide()}componentDidUpdate(){Travian.Tip.hide()}getBanners(){const{banners:e}=this.props;let t=Object.keys(e),a=[];t.map((t=>a.push(e[t]))),a.sort(((e,t)=>t.timestamp-e.timestamp));let s=[[]],i=t.length;if(i>ms.bannersPerPage){const e=[];let t=ms.bannersPerPage;for(let s=0;s<i;s+=t){let i=a.slice(s,s+t);e.push(i)}s=e}else s[0]=a;return s}render(){const{symbolSizes:e,selectBanner:t,currentPage:a,switchPage:s}=this.props,i=this.getBanners(),n=Array.from({length:ms.bannersPerPage-i[a].length},((e,t)=>t));return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsxs)("div",{className:"allianceBannerGalleryOverview",children:[i[a].map(((a,s)=>{let i=a.data,n=a.player;return(0,_.jsxs)("div",{className:"galleryBanner",children:[(0,_.jsx)("div",{className:"bannerBackground",onClick:()=>{t(n.uid)},children:(0,_.jsx)(hs,{id:`gallery${n.uid}`,baseForm:i.baseForm,baseColor:i.baseColor,borderColor:i.borderColor,pattern:i.pattern,primaryColor:i.primaryColor,secondaryColor:i.secondaryColor,backSymbol:i.backSymbol,backSymbolColor:i.backSymbolColor,frontSymbol:i.frontSymbol,frontSymbolColor:i.frontSymbolColor,frontSymbolSize:0!==i.frontSymbol?e["frontSymbol"+i.frontSymbol]:{width:0,height:0}})}),(0,_.jsx)("a",{href:`/profile/${n.uid}`,className:"playerLink",children:n.name})]},s)})),n.map((e=>(0,_.jsx)("div",{className:"bannerPlaceholder"},e)))]}),i.length>1&&(0,_.jsx)(is.tl,{currentPage:a,pageCount:i.length,switchPage:s})]})}}const ps=e=>(0,_.jsx)("div",{className:"noBanners",children:(0,O.Jh)("allianz.banner_galleryNoSubmits",{LINK:'<a href="/alliance/options/banner/create">',"/LINK":"</a>"},!0)});ps.propTypes={switchToScreen:d().func.isRequired};class gs extends o.Component{static propTypes={banner:d().object.isRequired,player:d().shape({player:d().shape({uid:d().number.isRequired,name:d().string})}),symbolSizes:d().oneOfType([d().objectOf(d().shape({width:d().number.isRequired,height:d().number.isRequired})),d().array]),hasRightToSetAllianceBanner:d().bool.isRequired,allianceBanner:d().object,selectBanner:d().func.isRequired};constructor(e){super(e),this.setAllianceBanner=this.setAllianceBanner.bind(this)}componentDidMount(){Travian.Tip.refresh()}componentDidUpdate(){Travian.Tip.refresh()}setAllianceBanner(){const e={data:this.props.banner,success:e=>{window.location.href="/alliance/profile"}};Travian.api("alliance/banner/edit",e,"POST")}render(){const{banner:e,player:t,symbolSizes:a,hasRightToSetAllianceBanner:s,selectBanner:i}=this.props,n=this.props.allianceBanner??null,r=JSON.stringify(e),l=JSON.stringify(n);let o={gallery:{id:"backToGallery",onClick:()=>i(null),text:(0,O.Jh)("allianz.banner_backToGallery"),title:(0,O.Jh)("allianz.banner_backToGallery"),disabled:!1},alliance:{id:"setAllianceBanner",onClick:this.setAllianceBanner,text:null!==n?(0,O.Jh)("allianz.banner_overwriteAllianceBanner"):(0,O.Jh)("allianz.banner_setAllianceBanner"),title:null!==n?(0,O.Jh)("allianz.banner_overwriteAllianceBanner"):(0,O.Jh)("allianz.banner_setAllianceBanner"),disabled:!0}};return r===l?(o.alliance.disabled=!0,o.alliance.title=(0,O.Jh)("allianz.banner_isCurrentAllianceBanner")):s?o.alliance.disabled=!1:(o.alliance.disabled=!0,o.alliance.title=(0,O.Jh)("allianz.banner_setAllianceBannerOnlyWithRights")),(0,_.jsxs)("div",{className:"galleryBannerDetailView",children:[(0,_.jsx)("svg",{width:"0",height:"0",viewBox:"0 0 540 257",className:"allianceBannerOrnament",children:(0,_.jsx)("defs",{children:(0,_.jsxs)("clipPath",{id:"allianceBannerOrnamentClipPath",children:[(0,_.jsx)("path",{d:"M245.4 1.9c-3.3 2-6.4 7.5-6.4 11.3.1 3.1 1.9 6.9 5.2 10.7l2.7 3.1h47.2l2.7-3.1c3.3-3.8 5.1-7.6 5.2-10.7 0-3.8-3.1-9.3-6.4-11.3-6.7-4.1-18-1-19.3 5.3-.7 3.5-1.3 3.5-3.8-.2l-2.1-2.9-1.9 3c-2.5 3.6-3.1 3.6-3.8.1-1.3-6.3-12.6-9.4-19.3-5.3zm7.5 5.8c.7 1.4.4 2.4-1.2 4.1-2.2 2.3-2.2 2.4-.3 3.8a7.3 7.3 0 003.3 1.4c1 0 1 .5.1 2.5-1.4 3.2-2.9 3.1-6.7-.1-2.3-1.9-3.1-3.4-3.1-5.8 0-6 5.5-10.1 7.9-5.9zm41.5.5a8 8 0 01-1.5 11.2c-3.8 3.2-5.3 3.3-6.7.1-.9-2-.9-2.5.1-2.5a7.3 7.3 0 003.3-1.4c1.9-1.4 1.9-1.5-.3-3.8-1.6-1.7-1.9-2.7-1.2-4.1 1.4-2.4 4.5-2.1 6.3.5zM233 25l-3.5 1.9h7.5l7.5.1-2.5-2c-3.1-2.4-4.6-2.4-9 0zM299 25l-2.5 2 7.5-.1h7.5L308 25c-4.4-2.4-5.9-2.4-9 0zM126.4 50.9c-.3 1.5-2.6 5-5.2 7.7-5.5 5.9-8.1 11.5-8.2 17 0 8 1.1 10.7 6.9 16.5l5.6 5.6-4.8-.5c-8.7-.8-15.7 4.2-15.7 11.3a7.4 7.4 0 002 4.5c2.2 2.2 7.9 2.7 9.8.8 1.5-1.5 1.6-6 .1-7.5-2.1-2.1 5.4-2.7 9.4-.8 6.3 3 7.5 8.6 3.2 14.8a10.2 10.2 0 00.1 10.5c1.6 2.4 5.3 2.9 8.5 1.2 1.8-1 1.9-2.5 1.9-34V65l-3.2-2a13.8 13.8 0 00-5-2c-1.3 0-1.6-.7-1.1-3.3a11.3 11.3 0 00-1.1-6.5c-2-3.9-2.5-4-3.2-.3zM410.5 51a11.3 11.3 0 00-1.2 6.7c.5 2.6.2 3.3-1.1 3.3a12.8 12.8 0 00-4.9 2l-3.3 2v33c0 31.5.1 33 1.9 34 3.2 1.7 6.9 1.2 8.5-1.2a10.2 10.2 0 00.1-10.5c-4.3-6.2-3.1-11.8 3.2-14.8 4-1.9 11.5-1.3 9.4.8-1.5 1.5-1.4 6 .1 7.5 1.9 1.9 7.6 1.4 9.8-.8a7.4 7.4 0 002-4.5c0-7.1-7-12.1-15.7-11.3l-4.8.5 5.6-5.6c5.8-5.8 6.9-8.5 6.9-16.5-.1-5.5-2.7-11.1-8.3-17.1A20 20 0 01414 52a6.5 6.5 0 00-.9-2.9c-.7-1.1-1.3-.6-2.6 1.9z"}),(0,_.jsx)("path",{d:"M86.4 114.4c-6 6-4.2 14.1 4.2 18.1l3.6 1.7-2.6 2.7c-1.4 1.5-2.6 3-2.6 3.4s2.1 1.9 4.7 3.4c4.3 2.5 5.8 2.8 14.9 2.9 11.6.2 13.4.6 18.6 4.3 5 3.5 4.8 4.4-.5 2.1a55 55 0 00-37.4-2.5c-6.2 1.9-13.3 7.9-20.9 18.1-6.8 9.1-11 11.9-16.6 11.1-7.8-1-12.6-8.9-11.2-18.3.9-6.4 6.4-12.7 6.4-7.4 0 1.1 1.1 2.7 2.5 3.6 2 1.3 3 1.4 5.9.4 3.7-1.2 4.6-2.6 4.6-7 0-7.9-10.2-11.1-17.6-5.5a22 22 0 00-7.7 17.3c0 4.5-.2 5.2-1.6 4.6a31.5 31.5 0 00-18.9.5 28.5 28.5 0 01-8.7 2.1c-5.7 0-2 4 5.9 6.5 1.5.4 1.7.8.8 1.7-1.9 1.9-1.4 6.6 1 8.8a9 9 0 005.7 2l3.6-.1-2.7-1.5c-2.3-1.2-2.8-2.1-2.8-5.3 0-5.5 2.7-7.6 9.7-7.6 4.9 0 5.8.3 8.3 3.2 2.4 2.6 2.7 3.8 2.3 7-.4 3-.1 4.4 1.3 5.7a10.4 10.4 0 012.1 5 7.3 7.3 0 007.1 6.6c6.4 0 15.2-6.9 20.5-16.2 2.4-4.1 3.7-4.8 3.7-1.9 0 2.6 6.3 10.5 10.5 13.1a21 21 0 0020.5-.5c3.8-2.4 4.8-2.6 7.2-1.7s2.8.8 2.8-.9a9.4 9.4 0 00-1-3.9l-2-4a15.6 15.6 0 01-1-5.3c0-6.7-9.5-11.2-16.2-7.8-3.8 1.9-7.8 7.4-7.8 10.7 0 3.1-1.5 3.8-4.4 1.9-7.7-5.1-4.7-16.4 6.8-24.6 4.5-3.4 5.6-3.6 5.6-1.2 0 3.1 3.8 8.2 6.5 8.9 2.2.5 3.4 0 6.3-2.9a22.4 22.4 0 016.5-4.6c2.9-1.1 9-1.5 9.9-.6.3.3-.6 2.7-1.9 5.4-3.5 6.9-3.4 15.9.1 21.2 3.1 4.6 3.1 4.5.6 5.2-1.1.3-2.8 2-3.9 3.9-1.6 2.6-3.1 3.7-6.6 4.6-5.2 1.4-5.8 2.7-1.6 3.5a19.2 19.2 0 016.3 3.5c4.7 4.1 9.1 6.2 13.3 6.2 3.6 0 9.4-2.3 10.7-4.4.9-1.3 1.1-11.6.2-11.6a12.6 12.6 0 00-3.1 2c-3.1 2.4-9.5 2.7-11.7.4-2.2-2.1-2-3.1.7-4.9 2.2-1.4 2.8-1.4 6.1 0 4.4 1.9 8.6 1.1 8.6-1.6 0-1.4-.7-1.9-2.6-1.9-1.6 0-3.9-1.3-6.1-3.5-3-3-3.5-4-2.9-6.7 1.1-5.8 5.8-8.7 8.5-5.4 1.7 2-.3 5.6-2.9 5.6-1.1 0-2 .4-2 .8 0 1.4 3.3 4 5.5 4.4 2 .3 2-.3 2.3-26 .1-14.4-.1-26.2-.5-26.2-1.3 0-2.8 1.3-4.5 3.8l-1.6 2.4-1.8-2.9c-7.7-12.7-11.3-16.5-16.8-17.9-2.1-.5-3.3-.1-5.4 1.9s-3.1 2.4-4.2 1.7c-.8-.5-3.6-1-6.1-1-7.1 0-10.8-5.9-5.9-9.3 1.8-1.3 1.9-1.5.5-2.1-2.8-1-3.6-.7-7.1 2.8zM446.2 111.7c-1 .4-.8.9.7 2a5 5 0 012.1 3.7c0 3.5-3 5.6-8.1 5.6a15.3 15.3 0 00-5.9 1c-1.1.7-2.2.2-4.2-1.7s-3.3-2.4-5.4-1.9c-5.5 1.4-9.1 5.2-16.8 17.9l-1.8 2.9-1.6-2.4c-1.7-2.5-3.2-3.8-4.5-3.8-.4 0-.6 11.8-.5 26.2.3 25.7.3 26.3 2.3 26 2.2-.4 5.5-3 5.5-4.4 0-.4-.9-.8-2-.8-2.6 0-4.6-3.6-2.9-5.6 2.7-3.3 7.4-.4 8.5 5.4.6 2.7.1 3.7-2.9 6.7-2.2 2.2-4.5 3.5-6.1 3.5-1.9 0-2.6.5-2.6 1.9 0 2.7 4.2 3.5 8.6 1.6 3.3-1.4 3.9-1.4 6.1 0 2.7 1.8 2.9 2.8.7 4.9-2.2 2.3-8.6 2-11.7-.4a12.6 12.6 0 00-3.1-2c-.9 0-.7 10.3.2 11.6 1.3 2.1 7.1 4.4 10.7 4.4 4.2 0 8.6-2.1 13.3-6.2a19.2 19.2 0 016.3-3.5c4.2-.8 3.6-2.1-1.6-3.5-3.5-.9-5-2-6.6-4.6-1.1-1.9-2.8-3.6-3.9-3.9-2.5-.7-2.5-.6.6-5.2 3.5-5.3 3.6-14.3.1-21.2-1.3-2.7-2.2-5.1-1.9-5.4.9-.9 7-.5 9.9.6a22.4 22.4 0 016.5 4.6c2.9 2.9 4.1 3.4 6.3 2.9 2.7-.7 6.5-5.8 6.5-8.9 0-2.4 1.1-2.2 5.6 1.2 11.5 8.2 14.5 19.5 6.8 24.6-2.9 1.9-4.4 1.2-4.4-1.9 0-3.3-4-8.8-7.8-10.7-6.7-3.4-16.2 1.1-16.2 7.8a13.5 13.5 0 01-1 5.3l-2 4a11.2 11.2 0 00-1 3.9c0 1.7.3 1.8 2.8.9s3.4-.7 7.2 1.7a21 21 0 0020.5.5c4.2-2.6 10.5-10.5 10.5-13.1 0-2.9 1.3-2.2 3.7 1.9 5.3 9.3 14.1 16.2 20.5 16.2a7.3 7.3 0 007.1-6.6 10.4 10.4 0 012.1-5c1.4-1.3 1.7-2.7 1.3-5.7-.4-3.2-.1-4.4 2.3-7 2.5-2.9 3.4-3.2 8.3-3.2 7 0 9.7 2.1 9.7 7.6 0 3.2-.5 4.1-2.7 5.3l-2.8 1.5 3.6.1a9 9 0 005.7-2c2.4-2.2 2.9-6.9 1-8.8-.9-.9-.7-1.3.8-1.7 7.9-2.5 11.6-6.5 5.9-6.5a28.5 28.5 0 01-8.7-2.1 31.5 31.5 0 00-18.9-.5c-1.4.6-1.6-.1-1.6-4.6 0-11.3-7.1-20.2-16.1-20-3.7 0-5.1.5-6.9 2.7-4.1 4.7-2.9 10.8 2.3 12.5 2.9 1 3.9.9 5.9-.4 1.4-.9 2.5-2.5 2.5-3.6 0-5.3 5.5 1 6.4 7.4 1.4 9.4-3.4 17.3-11.2 18.3-5.6.8-9.8-2-16.6-11.1-7.6-10.2-14.7-16.2-20.9-18.1a55 55 0 00-37.4 2.5c-5.3 2.3-5.5 1.4-.5-2.1 5.2-3.7 7-4.1 18.6-4.3 9.1-.1 10.6-.4 14.9-2.9 2.6-1.5 4.7-3.1 4.7-3.4s-1.2-1.9-2.6-3.4l-2.6-2.7 3.6-1.7c5.1-2.4 7.6-6 7.6-10.7 0-3.2-.7-4.7-3.4-7.4-3.3-3.3-4.7-3.8-7.4-2.7zM136.8 217.2c-6.5 8.6-6.4 15.2.3 19.2l2.9 1.7v-12c0-6.7-.2-12.1-.4-12.1a18.1 18.1 0 00-2.8 3.2zM400 226v12.1l2.9-1.7c5.9-3.5 6.6-9.8 2-16.7a37 37 0 00-4-5.3c-.5-.3-.9 4.6-.9 11.6zM128.9 239.7c-1.9.5-3.9 4.4-3.9 7.8a9.8 9.8 0 002.4 5.1c1.9 2.3 3.2 2.8 7.2 2.8 4.8.1 4.9.1 5.2-3.2a8.4 8.4 0 00-.7-4.6 3 3 0 01-.5-2.9c1.3-3.5-4.4-6.4-9.7-5zM402.9 241.1c-1.2 1.2-1.8 2.7-1.5 3.6a3 3 0 01-.5 2.9 8.4 8.4 0 00-.7 4.6c.3 3.3.4 3.3 5.2 3.2 4 0 5.3-.5 7.2-2.8 2.6-3 3-6.2 1.3-10-1.9-4-7.7-4.8-11-1.5z"})]})})}),(0,_.jsxs)("div",{className:"bannerPresentation",children:[(0,_.jsx)("div",{className:"bannerBackground",children:e&&(0,_.jsx)(hs,{id:"detailViewBanner",baseForm:e.baseForm,baseColor:e.baseColor,borderColor:e.borderColor,pattern:e.pattern,primaryColor:e.primaryColor,secondaryColor:e.secondaryColor,backSymbol:e.backSymbol,backSymbolColor:e.backSymbolColor,frontSymbol:e.frontSymbol,frontSymbolColor:e.frontSymbolColor,frontSymbolSize:0!==e.frontSymbol?a["frontSymbol"+e.frontSymbol]:{width:0,height:0}})}),e&&(0,_.jsx)("div",{className:"smallBanner",children:(0,_.jsx)("svg",{viewBox:"0 0 300 300",children:(0,_.jsx)("use",{href:"#allianceBanner_detailViewBanner"})})})]}),(0,_.jsx)("div",{className:"playerLink",children:(0,O.Jh)("allianz.banner_submittedBy",{PLAYER:(0,_.jsx)("a",{href:`/profile/${t.uid}`,children:t.name})},!0)}),(0,_.jsx)("div",{className:"bannerActions",children:Object.keys(o).map((e=>{let t=o[e];return(0,_.jsx)(F.z,{id:t.id,disabledClass:t.disabled,onClick:t.disabled?()=>{}:()=>t.onClick(),title:t.title,children:t.text},e)}))})]})}}class vs extends o.Component{static propTypes={allianceBanner:d().object,galleryBanners:d().objectOf(d().objectOf(d().shape({player:d().shape({uid:d().number.isRequired,name:d().string}),data:d().object}))),symbolSizes:d().oneOfType([d().objectOf(d().shape({width:d().number.isRequired,height:d().number.isRequired})),d().array]),hasRightToSetAllianceBanner:d().bool.isRequired,switchToScreen:d().func.isRequired};constructor(e){super(e),this.state={selectedBanner:null,currentPage:0},this.selectBanner=this.selectBanner.bind(this),this.setAllianceBanner=this.setAllianceBanner.bind(this),this.switchPage=this.switchPage.bind(this)}componentDidMount(){Travian.Tip.refresh()}componentDidUpdate(){Travian.Tip.refresh()}selectBanner(e){this.setState({selectedBanner:e})}switchPage(e){this.setState({currentPage:e})}setAllianceBanner(){const e={data:this.state.selectedBanner,success:e=>{window.location.href="/alliance/profile"}};Travian.api("alliance/banner/edit",e,"POST")}render(){const{galleryBanners:e,symbolSizes:t,hasRightToSetAllianceBanner:a,switchToScreen:s}=this.props;return(0,_.jsx)("div",{className:"gallery",children:0===e.length?(0,_.jsx)(ps,{switchToScreen:s}):null===this.state.selectedBanner?(0,_.jsx)(ms,{banners:e,symbolSizes:t,selectBanner:this.selectBanner,switchPage:this.switchPage,currentPage:this.state.currentPage}):(0,_.jsx)(gs,{banner:e[this.state.selectedBanner].data,player:e[this.state.selectedBanner].player,selectBanner:this.selectBanner,allianceBanner:this.props.allianceBanner,symbolSizes:t,hasRightToSetAllianceBanner:a})})}}var xs=a(5429);class bs extends o.Component{static propTypes={banners:d().shape({current:d().object,proposed:d().object}),symbolSizes:d().oneOfType([d().objectOf(d().shape({width:d().number.isRequired,height:d().number.isRequired})),d().array]),hasRightToSetAllianceBanner:d().bool.isRequired,allianceBanner:d().object,switchToScreen:d().func.isRequired};constructor(e){super(e),this.submitToGallery=this.submitToGallery.bind(this),this.setAllianceBanner=this.setAllianceBanner.bind(this)}componentDidMount(){Travian.Tip.refresh()}componentDidUpdate(){Travian.Tip.refresh()}submitToGallery(){const{switchToScreen:e}=this.props,t={data:{type:"proposed",data:this.props.banners.current},success:t=>{e("gallery")}};Travian.api("alliance/banner/my",t,"POST")}setAllianceBanner(){const e={data:this.props.banners.current,success:e=>{window.location.href="/alliance/profile"}};Travian.api("alliance/banner/edit",e,"POST")}render(){const{banners:e,symbolSizes:t,hasRightToSetAllianceBanner:a}=this.props,s=void 0!==e.current?e.current:null,i=void 0!==e.proposed?e.proposed:null,n=this.props.allianceBanner??null,r=JSON.stringify(s),l=JSON.stringify(i),o=JSON.stringify(n);let c,d={gallery:{id:"submitToGallery",onClick:this.submitToGallery,text:(0,O.Jh)("allianz.banner_submitToGallery"),title:(0,O.Jh)("allianz.banner_submitToGallery"),disabled:!0},alliance:{id:"setAllianceBanner",onClick:this.setAllianceBanner,text:null!==n?(0,O.Jh)("allianz.banner_overwriteAllianceBanner"):(0,O.Jh)("allianz.banner_setAllianceBanner"),title:null!==n?(0,O.Jh)("allianz.banner_overwriteAllianceBanner"):(0,O.Jh)("allianz.banner_setAllianceBanner"),disabled:!0}};switch(!0){case null===s:c="none",a||(d.alliance.title=(0,O.Jh)("allianz.banner_setAllianceBannerOnlyWithRights"));break;case null===i||r!==l:c="created",d.gallery.disabled=!1;break;case null!==i&&r===l:c="submitted",d.gallery.text=(0,O.Jh)("allianz.banner_overwriteYourGalleryBanner"),d.gallery.title=(0,O.Jh)("allianz.banner_alreadySubmitted"),d.gallery.disabled=!0;break;default:c="none"}if("none"!==c){r===o?(d.alliance.disabled=!0,d.alliance.title=(0,O.Jh)("allianz.banner_isCurrentAllianceBanner")):a?d.alliance.disabled=!1:(d.alliance.disabled=!0,d.alliance.title=(0,O.Jh)("allianz.banner_setAllianceBannerOnlyWithRights"))}return(0,_.jsxs)("div",{className:"myBanner",children:[(0,_.jsx)("svg",{width:"0",height:"0",viewBox:"0 0 540 257",className:"allianceBannerOrnament",children:(0,_.jsx)("defs",{children:(0,_.jsxs)("clipPath",{id:"allianceBannerOrnamentClipPath",children:[(0,_.jsx)("path",{d:"M245.4 1.9c-3.3 2-6.4 7.5-6.4 11.3.1 3.1 1.9 6.9 5.2 10.7l2.7 3.1h47.2l2.7-3.1c3.3-3.8 5.1-7.6 5.2-10.7 0-3.8-3.1-9.3-6.4-11.3-6.7-4.1-18-1-19.3 5.3-.7 3.5-1.3 3.5-3.8-.2l-2.1-2.9-1.9 3c-2.5 3.6-3.1 3.6-3.8.1-1.3-6.3-12.6-9.4-19.3-5.3zm7.5 5.8c.7 1.4.4 2.4-1.2 4.1-2.2 2.3-2.2 2.4-.3 3.8a7.3 7.3 0 003.3 1.4c1 0 1 .5.1 2.5-1.4 3.2-2.9 3.1-6.7-.1-2.3-1.9-3.1-3.4-3.1-5.8 0-6 5.5-10.1 7.9-5.9zm41.5.5a8 8 0 01-1.5 11.2c-3.8 3.2-5.3 3.3-6.7.1-.9-2-.9-2.5.1-2.5a7.3 7.3 0 003.3-1.4c1.9-1.4 1.9-1.5-.3-3.8-1.6-1.7-1.9-2.7-1.2-4.1 1.4-2.4 4.5-2.1 6.3.5zM233 25l-3.5 1.9h7.5l7.5.1-2.5-2c-3.1-2.4-4.6-2.4-9 0zM299 25l-2.5 2 7.5-.1h7.5L308 25c-4.4-2.4-5.9-2.4-9 0zM126.4 50.9c-.3 1.5-2.6 5-5.2 7.7-5.5 5.9-8.1 11.5-8.2 17 0 8 1.1 10.7 6.9 16.5l5.6 5.6-4.8-.5c-8.7-.8-15.7 4.2-15.7 11.3a7.4 7.4 0 002 4.5c2.2 2.2 7.9 2.7 9.8.8 1.5-1.5 1.6-6 .1-7.5-2.1-2.1 5.4-2.7 9.4-.8 6.3 3 7.5 8.6 3.2 14.8a10.2 10.2 0 00.1 10.5c1.6 2.4 5.3 2.9 8.5 1.2 1.8-1 1.9-2.5 1.9-34V65l-3.2-2a13.8 13.8 0 00-5-2c-1.3 0-1.6-.7-1.1-3.3a11.3 11.3 0 00-1.1-6.5c-2-3.9-2.5-4-3.2-.3zM410.5 51a11.3 11.3 0 00-1.2 6.7c.5 2.6.2 3.3-1.1 3.3a12.8 12.8 0 00-4.9 2l-3.3 2v33c0 31.5.1 33 1.9 34 3.2 1.7 6.9 1.2 8.5-1.2a10.2 10.2 0 00.1-10.5c-4.3-6.2-3.1-11.8 3.2-14.8 4-1.9 11.5-1.3 9.4.8-1.5 1.5-1.4 6 .1 7.5 1.9 1.9 7.6 1.4 9.8-.8a7.4 7.4 0 002-4.5c0-7.1-7-12.1-15.7-11.3l-4.8.5 5.6-5.6c5.8-5.8 6.9-8.5 6.9-16.5-.1-5.5-2.7-11.1-8.3-17.1A20 20 0 01414 52a6.5 6.5 0 00-.9-2.9c-.7-1.1-1.3-.6-2.6 1.9z"}),(0,_.jsx)("path",{d:"M86.4 114.4c-6 6-4.2 14.1 4.2 18.1l3.6 1.7-2.6 2.7c-1.4 1.5-2.6 3-2.6 3.4s2.1 1.9 4.7 3.4c4.3 2.5 5.8 2.8 14.9 2.9 11.6.2 13.4.6 18.6 4.3 5 3.5 4.8 4.4-.5 2.1a55 55 0 00-37.4-2.5c-6.2 1.9-13.3 7.9-20.9 18.1-6.8 9.1-11 11.9-16.6 11.1-7.8-1-12.6-8.9-11.2-18.3.9-6.4 6.4-12.7 6.4-7.4 0 1.1 1.1 2.7 2.5 3.6 2 1.3 3 1.4 5.9.4 3.7-1.2 4.6-2.6 4.6-7 0-7.9-10.2-11.1-17.6-5.5a22 22 0 00-7.7 17.3c0 4.5-.2 5.2-1.6 4.6a31.5 31.5 0 00-18.9.5 28.5 28.5 0 01-8.7 2.1c-5.7 0-2 4 5.9 6.5 1.5.4 1.7.8.8 1.7-1.9 1.9-1.4 6.6 1 8.8a9 9 0 005.7 2l3.6-.1-2.7-1.5c-2.3-1.2-2.8-2.1-2.8-5.3 0-5.5 2.7-7.6 9.7-7.6 4.9 0 5.8.3 8.3 3.2 2.4 2.6 2.7 3.8 2.3 7-.4 3-.1 4.4 1.3 5.7a10.4 10.4 0 012.1 5 7.3 7.3 0 007.1 6.6c6.4 0 15.2-6.9 20.5-16.2 2.4-4.1 3.7-4.8 3.7-1.9 0 2.6 6.3 10.5 10.5 13.1a21 21 0 0020.5-.5c3.8-2.4 4.8-2.6 7.2-1.7s2.8.8 2.8-.9a9.4 9.4 0 00-1-3.9l-2-4a15.6 15.6 0 01-1-5.3c0-6.7-9.5-11.2-16.2-7.8-3.8 1.9-7.8 7.4-7.8 10.7 0 3.1-1.5 3.8-4.4 1.9-7.7-5.1-4.7-16.4 6.8-24.6 4.5-3.4 5.6-3.6 5.6-1.2 0 3.1 3.8 8.2 6.5 8.9 2.2.5 3.4 0 6.3-2.9a22.4 22.4 0 016.5-4.6c2.9-1.1 9-1.5 9.9-.6.3.3-.6 2.7-1.9 5.4-3.5 6.9-3.4 15.9.1 21.2 3.1 4.6 3.1 4.5.6 5.2-1.1.3-2.8 2-3.9 3.9-1.6 2.6-3.1 3.7-6.6 4.6-5.2 1.4-5.8 2.7-1.6 3.5a19.2 19.2 0 016.3 3.5c4.7 4.1 9.1 6.2 13.3 6.2 3.6 0 9.4-2.3 10.7-4.4.9-1.3 1.1-11.6.2-11.6a12.6 12.6 0 00-3.1 2c-3.1 2.4-9.5 2.7-11.7.4-2.2-2.1-2-3.1.7-4.9 2.2-1.4 2.8-1.4 6.1 0 4.4 1.9 8.6 1.1 8.6-1.6 0-1.4-.7-1.9-2.6-1.9-1.6 0-3.9-1.3-6.1-3.5-3-3-3.5-4-2.9-6.7 1.1-5.8 5.8-8.7 8.5-5.4 1.7 2-.3 5.6-2.9 5.6-1.1 0-2 .4-2 .8 0 1.4 3.3 4 5.5 4.4 2 .3 2-.3 2.3-26 .1-14.4-.1-26.2-.5-26.2-1.3 0-2.8 1.3-4.5 3.8l-1.6 2.4-1.8-2.9c-7.7-12.7-11.3-16.5-16.8-17.9-2.1-.5-3.3-.1-5.4 1.9s-3.1 2.4-4.2 1.7c-.8-.5-3.6-1-6.1-1-7.1 0-10.8-5.9-5.9-9.3 1.8-1.3 1.9-1.5.5-2.1-2.8-1-3.6-.7-7.1 2.8zM446.2 111.7c-1 .4-.8.9.7 2a5 5 0 012.1 3.7c0 3.5-3 5.6-8.1 5.6a15.3 15.3 0 00-5.9 1c-1.1.7-2.2.2-4.2-1.7s-3.3-2.4-5.4-1.9c-5.5 1.4-9.1 5.2-16.8 17.9l-1.8 2.9-1.6-2.4c-1.7-2.5-3.2-3.8-4.5-3.8-.4 0-.6 11.8-.5 26.2.3 25.7.3 26.3 2.3 26 2.2-.4 5.5-3 5.5-4.4 0-.4-.9-.8-2-.8-2.6 0-4.6-3.6-2.9-5.6 2.7-3.3 7.4-.4 8.5 5.4.6 2.7.1 3.7-2.9 6.7-2.2 2.2-4.5 3.5-6.1 3.5-1.9 0-2.6.5-2.6 1.9 0 2.7 4.2 3.5 8.6 1.6 3.3-1.4 3.9-1.4 6.1 0 2.7 1.8 2.9 2.8.7 4.9-2.2 2.3-8.6 2-11.7-.4a12.6 12.6 0 00-3.1-2c-.9 0-.7 10.3.2 11.6 1.3 2.1 7.1 4.4 10.7 4.4 4.2 0 8.6-2.1 13.3-6.2a19.2 19.2 0 016.3-3.5c4.2-.8 3.6-2.1-1.6-3.5-3.5-.9-5-2-6.6-4.6-1.1-1.9-2.8-3.6-3.9-3.9-2.5-.7-2.5-.6.6-5.2 3.5-5.3 3.6-14.3.1-21.2-1.3-2.7-2.2-5.1-1.9-5.4.9-.9 7-.5 9.9.6a22.4 22.4 0 016.5 4.6c2.9 2.9 4.1 3.4 6.3 2.9 2.7-.7 6.5-5.8 6.5-8.9 0-2.4 1.1-2.2 5.6 1.2 11.5 8.2 14.5 19.5 6.8 24.6-2.9 1.9-4.4 1.2-4.4-1.9 0-3.3-4-8.8-7.8-10.7-6.7-3.4-16.2 1.1-16.2 7.8a13.5 13.5 0 01-1 5.3l-2 4a11.2 11.2 0 00-1 3.9c0 1.7.3 1.8 2.8.9s3.4-.7 7.2 1.7a21 21 0 0020.5.5c4.2-2.6 10.5-10.5 10.5-13.1 0-2.9 1.3-2.2 3.7 1.9 5.3 9.3 14.1 16.2 20.5 16.2a7.3 7.3 0 007.1-6.6 10.4 10.4 0 012.1-5c1.4-1.3 1.7-2.7 1.3-5.7-.4-3.2-.1-4.4 2.3-7 2.5-2.9 3.4-3.2 8.3-3.2 7 0 9.7 2.1 9.7 7.6 0 3.2-.5 4.1-2.7 5.3l-2.8 1.5 3.6.1a9 9 0 005.7-2c2.4-2.2 2.9-6.9 1-8.8-.9-.9-.7-1.3.8-1.7 7.9-2.5 11.6-6.5 5.9-6.5a28.5 28.5 0 01-8.7-2.1 31.5 31.5 0 00-18.9-.5c-1.4.6-1.6-.1-1.6-4.6 0-11.3-7.1-20.2-16.1-20-3.7 0-5.1.5-6.9 2.7-4.1 4.7-2.9 10.8 2.3 12.5 2.9 1 3.9.9 5.9-.4 1.4-.9 2.5-2.5 2.5-3.6 0-5.3 5.5 1 6.4 7.4 1.4 9.4-3.4 17.3-11.2 18.3-5.6.8-9.8-2-16.6-11.1-7.6-10.2-14.7-16.2-20.9-18.1a55 55 0 00-37.4 2.5c-5.3 2.3-5.5 1.4-.5-2.1 5.2-3.7 7-4.1 18.6-4.3 9.1-.1 10.6-.4 14.9-2.9 2.6-1.5 4.7-3.1 4.7-3.4s-1.2-1.9-2.6-3.4l-2.6-2.7 3.6-1.7c5.1-2.4 7.6-6 7.6-10.7 0-3.2-.7-4.7-3.4-7.4-3.3-3.3-4.7-3.8-7.4-2.7zM136.8 217.2c-6.5 8.6-6.4 15.2.3 19.2l2.9 1.7v-12c0-6.7-.2-12.1-.4-12.1a18.1 18.1 0 00-2.8 3.2zM400 226v12.1l2.9-1.7c5.9-3.5 6.6-9.8 2-16.7a37 37 0 00-4-5.3c-.5-.3-.9 4.6-.9 11.6zM128.9 239.7c-1.9.5-3.9 4.4-3.9 7.8a9.8 9.8 0 002.4 5.1c1.9 2.3 3.2 2.8 7.2 2.8 4.8.1 4.9.1 5.2-3.2a8.4 8.4 0 00-.7-4.6 3 3 0 01-.5-2.9c1.3-3.5-4.4-6.4-9.7-5zM402.9 241.1c-1.2 1.2-1.8 2.7-1.5 3.6a3 3 0 01-.5 2.9 8.4 8.4 0 00-.7 4.6c.3 3.3.4 3.3 5.2 3.2 4 0 5.3-.5 7.2-2.8 2.6-3 3-6.2 1.3-10-1.9-4-7.7-4.8-11-1.5z"})]})})}),(0,_.jsxs)("div",{className:["bannerPresentation","none"!==c?"animated":""].join(" "),children:[(0,_.jsx)("div",{className:"bannerBackground",onClick:()=>{this.props.switchToScreen("create")},children:s&&(0,_.jsx)(hs,{id:"myBanner",baseForm:s.baseForm,baseColor:s.baseColor,borderColor:s.borderColor,pattern:s.pattern,primaryColor:s.primaryColor,secondaryColor:s.secondaryColor,backSymbol:s.backSymbol,backSymbolColor:s.backSymbolColor,frontSymbol:s.frontSymbol,frontSymbolColor:s.frontSymbolColor,frontSymbolSize:0!==s.frontSymbol?t["frontSymbol"+s.frontSymbol]:{width:0,height:0}})}),s&&(0,_.jsx)("div",{className:"smallBanner",children:(0,_.jsx)("svg",{viewBox:"0 0 300 300",children:(0,_.jsx)("use",{href:"#allianceBanner_myBanner"})})})]}),(0,_.jsx)("div",{className:"bannerCreatorLink",children:(0,_.jsxs)("a",{onClick:()=>{this.props.switchToScreen("create")},children:[(0,_.jsx)(xs.Z,{}),(0,_.jsx)("span",{children:"none"===c?(0,O.Jh)("allianz.banner_createBanner"):(0,O.Jh)("allianz.banner_editBanner")})]})}),(0,_.jsxs)("div",{className:"bannerStateDescription",children:[(0,_.jsx)("strong",{children:(0,O.Jh)("allianz.banner_headline_"+c)}),"submitted"!==c&&(0,_.jsx)("p",{children:(0,O.Jh)("allianz.banner_description_"+c,{BREAK:(0,_.jsx)("br",{})},!0)}),a?(0,_.jsx)("p",{children:(0,O.Jh)("allianz.banner_withRights")}):(0,_.jsx)("p",{children:(0,O.Jh)("allianz.banner_noRights",{I:"<i>","/I":"</i>"},!0)})]}),(0,_.jsx)("div",{className:"bannerActions",children:Object.keys(d).map((e=>{let t=d[e];return(0,_.jsx)(F.z,{id:t.id,disabledClass:t.disabled,onClick:t.disabled?()=>{}:()=>t.onClick(),title:t.title,children:t.text},e)}))})]})}}class js extends o.Component{render(){const{type:e,elements:t,setSelection:a,selectedElement:s,steps:i}=this.props;return(0,_.jsxs)("div",{className:"elementsWrapper",children:[e!==i[0].step&&(0,_.jsx)("a",{className:"none selection elementFrame"+(0===s?" selected":""),href:"#","data-element":e,"data-key":0,onClick:a,children:(0,_.jsx)("svg",{width:"30",height:"30",viewBox:"0 0 30 30",children:(0,_.jsx)("path",{d:"M30 3l-3-3-12 12L3 0 0 3l12 12L0 27l3 3 12-12 12 12 3-3-12-12z"})})},0),t.map((t=>(0,_.jsx)("a",{className:"selection elementFrame"+(s===t?" selected":""),href:"","data-element":e,"data-key":t,onClick:a,children:(0,_.jsxs)("svg",{viewBox:"0 0 300 300",children:[e===i[0].step&&(0,_.jsx)("use",{href:`#allianceBanner_baseForm${t}Path`,fill:"#000000"}),e===i[1].step&&(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("use",{href:`#allianceBanner_pattern${t}Primary`,fill:"#000000"}),(0,_.jsx)("use",{href:`#allianceBanner_pattern${t}Secondary`,fill:"#757575"})]}),e===i[2].step&&(0,_.jsx)("use",{href:`#allianceBanner_backSymbol${t}Path`,fill:"#000000"}),e===i[3].step&&(0,_.jsx)("use",{href:`#allianceBanner_frontSymbol${t}Path`,fill:"#000000"})]})},t)))]})}}class fs extends o.Component{render(){const{type:e,setSelection:t,selectedElement:a,colorPalette:s,disabled:i}=this.props;return(0,_.jsx)("div",{className:"colorsWrapper"+(i?" disabled":""),children:s.map((s=>(0,_.jsx)("a",{className:"selection colorFrame"+(i||a!==s?"":" selected"),href:"#","data-element":e,"data-key":s,onClick:t,style:{backgroundColor:s}},s)))})}}var ys,Ts,Ns,Cs=a(8497);function Ss(){return Ss=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ss.apply(this,arguments)}const ks=e=>o.createElement("svg",Ss({viewBox:"0 0 20 20"},e),ys||(ys=o.createElement("defs",null,o.createElement("linearGradient",{id:"arrowColored_goldGradient",x1:26.81,y1:42.42,x2:26.81,y2:41.31,gradientTransform:"matrix(0 16.23 13.53 0 -556.56 -425.35)",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#cba467"}),o.createElement("stop",{offset:.05,stopColor:"#cba467"}),o.createElement("stop",{offset:.13,stopColor:"#f3e2ae"}),o.createElement("stop",{offset:.32,stopColor:"#efbf7b"}),o.createElement("stop",{offset:.48,stopColor:"#aa8050"}),o.createElement("stop",{offset:.72,stopColor:"#835e35"}),o.createElement("stop",{offset:.93,stopColor:"#ad8a54"}),o.createElement("stop",{offset:1,stopColor:"#d7b672"})),o.createElement("linearGradient",{id:"arrowColored_greenGradient",x1:50.52,y1:58.77,x2:51.23,y2:59.18,gradientTransform:"matrix(0 8.3 7.47 0 -433.41 -413.45)",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{offset:0,stopColor:"#bdff83"}),o.createElement("stop",{offset:.53,stopColor:"#60a124"}),o.createElement("stop",{offset:.84,stopColor:"#5c9722"}),o.createElement("stop",{offset:1,stopColor:"#496818"})))),Ts||(Ts=o.createElement("path",{className:"goldBorder",d:"M3 18V1.78L16.57 9.9Z",fill:"url(#arrowColored_goldGradient)",stroke:"#000000"})),Ns||(Ns=o.createElement("path",{className:"greenInner",d:"M5 14.05v-8.3l7.51 4.15Z",fill:"url(#arrowColored_greenGradient)",stroke:"#000000"})));var ws;function Es(){return Es=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Es.apply(this,arguments)}const Rs=e=>o.createElement("svg",Es({viewBox:"0 0 18 14"},e),ws||(ws=o.createElement("path",{d:"m4 6-4 4 4 4v-3h7V9H4V6zm14-2-4-4v3H7v2h7v3l4-4z"})));var Is;function Os(){return Os=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Os.apply(this,arguments)}const _s=e=>o.createElement("svg",Os({viewBox:"0 0 22 22"},e),Is||(Is=o.createElement("path",{d:"M9 8h4V5h3l-5-5-5 5h3v3zM8 9H5V6l-5 5 5 5v-3h3V9zm14 2-5-5v3h-3v4h3v3l5-5zm-9 3H9v3H6l5 5 5-5h-3v-3z"})));var As;function Ds(){return Ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ds.apply(this,arguments)}const Ls=e=>o.createElement("svg",Ds({viewBox:"0 0 20 20"},e),As||(As=o.createElement("path",{d:"M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zM2 10a8 8 0 0 1 12.9-6.3L3.7 14.9A7.5 7.5 0 0 1 2 10zm8 8c-1.9 0-3.6-.6-4.9-1.7L16.3 5.1A8 8 0 0 1 10 18z"})));var Ps,Bs;function Ms(){return Ms=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ms.apply(this,arguments)}const Js=e=>o.createElement("svg",Ms({viewBox:"0 0 24 24"},e),Ps||(Ps=o.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"})),Bs||(Bs=o.createElement("path",{d:"M7 15h7v2H7zm0-4h10v2H7zm0-4h10v2H7zm12-4h-4.2A3 3 0 0 0 12 1a3 3 0 0 0-2.8 2H4.6A2 2 0 0 0 3 5v14a2 2 0 0 0 .6 1.4c.3.3.6.5 1 .6H19a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm-7-.3c.4 0 .8.4.8.8s-.4.8-.8.8-.8-.4-.8-.8.4-.8.8-.8zM19 19H5V5h14v14z"})));var Zs;function Fs(){return Fs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Fs.apply(this,arguments)}const Vs=e=>o.createElement("svg",Fs({viewBox:"0 0 16 16"},e),Zs||(Zs=o.createElement("path",{d:"M14 11v3H2v-3H0v3c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2v-3h-2zm-1-4-1.4-1.4L9 8.2V0H7v8.2L4.4 5.6 3 7l5 5 5-5z"}))),Hs=e=>{const{description:t,value:a,from:s,to:i}=e;return(0,_.jsxs)("div",{className:"itemImpact",children:[(0,_.jsx)("div",{className:"impactDescription",children:t}),(0,_.jsx)("div",{className:"impactValue",children:void 0!==a?(0,_.jsx)("span",{className:"value",children:a}):(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("span",{className:"from",children:s}),(0,_.jsx)(Et,{}),(0,_.jsx)("span",{className:"to",children:i})]})})]})};class qs extends o.Component{static confirmButtonText={106:{fullHealth:"hero.itemEquip",healPossible:"hero.itemUse"},107:"hero.itemUse",108:"hero.itemConsume",109:"hero.itemUse",110:"hero.itemUse",111:"hero.itemUse",112:"hero.itemEquip",113:"hero.itemEquip",114:"hero.itemEquip",145:"hero.itemTransfer",146:"hero.itemTransfer",147:"hero.itemTransfer",148:"hero.itemTransfer"};static confirmButtonAction={106:{fullHealth:"move",healPossible:"use"},107:"use",108:"use",109:"use",110:"use",111:"use",112:"move",113:"move",114:"move",145:"use",146:"use",147:"use",148:"use"};static itemDataKey={106:"ointment",107:"scroll",108:"waterBucket",109:"tabletOfLaw",110:"bookOfWisdom",111:"artwork",112:"bandage25",113:"bandage33",114:"cage",145:"wood",146:"clay",147:"iron",148:"crop"};static propTypes={item:d().object.isRequired,commonData:d().object.isRequired,targetPlaceId:d().number,confirmCallback:d().func.isRequired};constructor(e){super(e);const{item:t,commonData:a}=e;this.state={commonData:a,value:t.defaultInput,loading:!1},this.confirmButtonRef=null,this.updateValue=this.updateValue.bind(this)}componentDidMount(){this.confirmButtonRef.focus()}updateValue(e){this.setState((t=>{if(t.value!==e)return{value:e||0}}))}render(){const{item:e,closeDialogCallback:t,confirmCallback:a,targetPlaceId:s}=this.props,{commonData:i,value:n,loading:r}=this.state;let l,c,d;e.isEquipped?(l="hero.moveItemToInventoryInputLabel",c="hero.moveDialogTitle",d="move"):(l="hero.item"+e.typeId+"_inputLabel",c=qs.confirmButtonText[e.typeId],d=qs.confirmButtonAction[e.typeId]);const h=!r&&e.canBeUsed&&0!==this.state.value,u=![108,110,111].includes(e.typeId)||111===e.typeId&&!i.useArtworksOneByOneOnly,m=109!==e.typeId;return 106===e.typeId&&(l=e.isEquipped?l:0===i.healthDelta?l+"_fullHealth":l+"_healPossible",c=e.isEquipped?c:0===i.healthDelta?c.fullHealth:c.healPossible,d=e.isEquipped?d:0===i.healthDelta?d.fullHealth:d.healPossible),(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("h3",{children:(0,O.Jh)("items.item"+e.typeId)}),(0,_.jsxs)("div",{className:"itemInformation",children:[(0,_.jsx)(Cs.Y,{typeId:e.typeId,tier:e.type===Cs.Y.tierConsumable?Cs.Y.tierConsumable:ni.tiers[e.tier],count:e.amount>0?e.amount:null}),(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:e.description}})]}),e.errorMessage&&(0,_.jsx)("div",{className:"error",children:e.errorMessage}),!e.errorMessage&&e.warningMessage&&(0,_.jsx)("div",{className:"warning",children:e.warningMessage}),u&&(0,_.jsx)("div",{className:"formV2",id:"consumableHeroItem",children:(0,_.jsxs)("label",{className:"input","data-spacer":(0,O.Jh)(l),children:[(0,_.jsx)("input",{type:"text",inputMode:"numeric",value:n,onChange:t=>{m?this.updateValue(Math.min(e.maxInput,Math.max(e.minInput,t.target.value))):this.updateValue(Math.max(e.minInput,t.target.value))},onKeyUp:e=>{"Enter"===e.key&&this.confirmButtonRef.click()}}),(0,_.jsx)("div",{className:"label pinned",children:(0,O.Jh)(l)})]})}),106===e.typeId&&!e.isEquipped&&(0,_.jsxs)(o.Fragment,{children:[i.healthDelta>0&&(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.healthAfterUsage"),from:(0,O.eJ)(i.currentHealth,{unit:O.uo.PERCENT}),to:(0,O.eJ)(Math.min(i.fullHealth,i.currentHealth+this.state.value),{unit:O.uo.PERCENT})}),e.amount>i.healthDelta&&(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.ointmentsEquipped"),from:e.alreadyEquipped,to:Math.max(0,e.alreadyEquipped+this.state.value-i.healthDelta)})]}),107===e.typeId&&!e.isEquipped&&(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.xpByScrolls"),value:i.experiencePerScroll}),(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.xpByBonus",{PERCENT:(0,O.eJ)(i.experienceBonus,{unit:O.uo.PERCENT})}),value:Math.round(i.experiencePerScroll*i.experienceBonus/100)}),(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.experienceAfterUseOfItem"),from:i.currentExperience,to:i.currentExperience+n*Math.round(i.experiencePerScroll*(1+i.experienceBonus/100))})]}),112===e.typeId&&!e.isEquipped&&(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.smallBandagesEquipped"),from:e.alreadyEquipped,to:e.alreadyEquipped+this.state.value}),113===e.typeId&&!e.isEquipped&&(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.bandagesEquipped"),from:e.alreadyEquipped,to:e.alreadyEquipped+this.state.value}),114===e.typeId&&!e.isEquipped&&(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.cagesEquipped"),from:e.alreadyEquipped,to:e.alreadyEquipped+this.state.value}),(145===e.typeId||146===e.typeId||147===e.typeId||148===e.typeId)&&!e.isEquipped&&(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.resourcesToVillage"),value:i.activeVillageName}),(0,_.jsx)(Hs,{description:(0,O.Jh)("hero.resourcesAfterTransfer"),from:e.alreadyEquipped,to:e.alreadyEquipped+this.state.value})]}),(0,_.jsxs)("div",{className:"buttonsWrapper",children:[(0,_.jsx)(F.z,{appearance:"grey",onClick:t,children:(0,O.Jh)("allgemein.cancel_with_capital_c")}),(0,_.jsx)(F.z,{forwardRef:e=>this.confirmButtonRef=e,disabledAttribute:!h&&m,disabledClass:!h&&m,"data-id":e.id,"data-placeid":e.placeId,"data-amount":n,onClick:e=>{this.setState({loading:!0},(()=>{a(e,s??null,d),t(e)}))},children:(0,O.Jh)(c)})]})]})}}class Us extends o.Component{static propTypes={tier:d().string.isRequired,title:d().string.isRequired,type:d().string.isRequired,stats:d().arrayOf(d().shape({title:d().string.isRequired,details:d().string})).isRequired,style:d().object};render(){const{tier:e,title:t,type:a,stats:s,style:i,forwardedRef:n,notClickable:r,warning:l,errorMessage:o}=this.props;let c=void 0!==i?i:{},d=-1===Cs.Y.consumableTypes.indexOf(a)&&(0,O.Jh)("hero.itemTypeV2_"+a);return(0,_.jsxs)("div",{className:`heroItemTooltip ${e}`,style:c,ref:n,children:[(0,_.jsx)("div",{className:"title",dangerouslySetInnerHTML:{__html:t}}),(0,_.jsxs)("div",{className:"subTitle",children:[(0,O.Jh)("hero.heroItemTier_"+e)," ",d]}),(0,_.jsx)("div",{className:"separator"}),r&&(0,_.jsx)("div",{className:"notClickable",children:(0,O.Jh)("hero."+l)}),o&&(0,_.jsx)("div",{className:"notClickable",children:o}),Object.keys(s).map((e=>{let t=s[e];return(0,_.jsxs)("div",{className:"stat",children:[(0,_.jsx)("div",{dangerouslySetInnerHTML:{__html:t.title}}),null!==t.details?(0,_.jsx)("div",{className:"details",dangerouslySetInnerHTML:{__html:t.details}}):""]},e)}))]})}}const zs=(0,o.forwardRef)(((e,t)=>(0,_.jsx)(Us,{forwardedRef:t,...e})));class $s extends o.Component{static appearances=["defaultAppearance","defaultButtons","sorting"];constructor(e){super(e),this.state={position:{x:0,y:0},menuOrigin:"from"},this.wrapper=null,this.menu=null,this.onWrapperClick=this.onWrapperClick.bind(this),this.updatePosition=this.updatePosition.bind(this)}componentDidMount(){this.updatePosition(),["resize","scroll"].forEach((e=>window.addEventListener(e,this.updatePosition,{passive:!1})))}componentWillUnmount(){["resize","scroll"].forEach((e=>window.removeEventListener(e,this.updatePosition)))}updatePosition(){const{contextParent:e}=this.props;let{menuOrigin:t}=this.state;if(e){const a={x:this.menu.clientWidth,y:this.menu.clientHeight},s={x:this.wrapper.clientWidth,y:this.wrapper.clientHeight},i=this.wrapper.getBoundingClientRect();let n={x:e.clientWidth,y:e.clientHeight},r=e.getBoundingClientRect(),l={x:r.left+window.scrollX,y:r.top+window.scrollY},o={x:l.x+n.x+2-window.scrollX,y:l.y-i.top-(a.y-n.y)/2-window.scrollY};o.y<0&&(o.y=l.y-i.top),o.y=Math.max(o.y,0),o.y+a.y>s.y&&(o.y=l.y-i.top+n.y-a.y),o.y=Math.min(o.y,s.y-a.y),t="from","ltr"===Travian.Game.getDirection()?o.x+a.x>i.x+s.x&&(o.x=l.x-a.x-2,t="to"):(o.x=l.x-a.x-2,o.x<0&&(o.x=l.x+n.x+2,t="to")),this.setState({position:o,menuOrigin:t})}}onWrapperClick(e){e.target.classList.contains("contextMenuWrapper")&&this.props.onClose()}render(){const{content:e,description:t}=this.props,{position:a,menuOrigin:s}=this.state,i=$s.appearances.includes(this.props.appearance)?this.props.appearance:"defaultAppearance";return(0,_.jsx)("div",{className:"contextMenuWrapper",ref:e=>this.wrapper=e,onClick:this.onWrapperClick,children:(0,_.jsxs)("div",{className:`contextMenu ${s} ${i}`,style:{left:a.x,top:a.y},ref:e=>this.menu=e,children:[t&&(0,_.jsx)("div",{className:"description",children:t}),e.map(((e,t)=>"defaultAppearance"===i&&(0,_.jsxs)("button",{type:"button",className:`entry ${e.additionalClass}`,title:e.title,onClick:e.onClick,disabled:e.disabled,...e.dataset,children:[e.icon,(0,_.jsx)("span",{className:"content",children:e.text})]},t)||"defaultButtons"===i&&(0,_.jsxs)(F.z,{className:`entry ${e.additionalClass}`,title:e.title,onClick:e.onClick,textWithIcon:!0,disabledAttribute:e.disabled,...e.dataset,children:[(0,_.jsxs)("svg",{children:[(0,_.jsx)("svg",{className:"outline",children:e.icon}),(0,_.jsx)("svg",{className:"icon",children:e.icon})]}),(0,_.jsx)("span",{children:e.text})]},t)||"sorting"===i&&(0,_.jsxs)("a",{className:e.additionalClass,onClick:e.onClick,children:[e.icon,(0,_.jsx)("span",{children:e.text}),e.sortingArrow]},t)))]})})}}var Ws;function Gs(){return Gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Gs.apply(this,arguments)}$s.propTypes={contextParent:d().object.isRequired,onClose:d().func.isRequired,description:d().string,appearance:d().string,content:d().arrayOf(d().shape({additionalClass:d().string,icon:d().object.isRequired,text:d().string.isRequired,disabled:d().bool,title:d().string,onClick:d().func.isRequired,dataset:d().object})).isRequired};const Ys=e=>o.createElement("svg",Gs({viewBox:"0 0 14 14"},e),Ws||(Ws=o.createElement("path",{d:"M14 1.4 12.6 0 7 5.6 1.4 0 0 1.4 5.6 7 0 12.6 1.4 14 7 8.4l5.6 5.6 1.4-1.4L8.4 7 14 1.4z"})));var Ks=a(9174),Xs=a(1822);class Qs extends o.Component{static propTypes={imageHash:d().string.isRequired,direction:d().string.isRequired};static BACKGROUNDS=["heroBackground","oasisCrop","volcano","none"];static BACKGROUND_NONE="none";static BACKGROUND_DEFAULT="heroBackground";static PREVIEW_WIDTH=400;static PREVIEW_HEIGHT=400;static IMAGE_PATH="scenes/HeroV2/download/";constructor(e){super(e),this.state={selected:Qs.BACKGROUND_DEFAULT,objectUrl:null,loading:!0},this.app=null,this.loader=null,this.backgroundImageSprite=null,this.onChange=this.onChange.bind(this),this.setObjectURL=this.setObjectURL.bind(this)}componentDidMount(){let e=this;const{direction:t,imageHash:a}=this.props;Ks.Xdb.SCALE_MODE=Ks.aH$.NEAREST,e.app=new Ks.MxU({backgroundAlpha:0,view:document.getElementById("downloadHeroImagePreview"),width:Qs.PREVIEW_WIDTH,height:Qs.PREVIEW_HEIGHT}),e.loader=new Xs.aN;const s=Travian.Variables.gpackUrl+"img_"+t.toLowerCase()+"/"+Qs.IMAGE_PATH,i="/heroV2/body/"+a+".2.png";!e.loader.resources.hero&&e.loader.add("hero",i),Qs.BACKGROUNDS.filter((e=>e!==Qs.BACKGROUND_NONE)).map((t=>!e.loader.resources[t]&&e.loader.add(t,s+t+".jpg"))),e.loader.load(((a,s)=>{const i=s[e.state.selected]?s[e.state.selected].texture:Ks.xEZ.EMPTY;e.backgroundImageSprite=new Ks.jyi(i),e.app.stage.addChild(e.backgroundImageSprite);const n=new Ks.jyi(s.hero.texture);"RTL"===t&&(n.anchor.x=1,n.scale.x*=-1),e.app.stage.addChild(n),e.setObjectURL(),e.setState({loading:!1})}))}componentWillUnmount(){this.app.destroy(!1,!0),Ks.P6Y.destroyTextureCache()}onChange(e){let t=this;e.target.value&&Qs.BACKGROUNDS.includes(e.target.value)&&t.setState({selected:e.target.value},(()=>{t.backgroundImageSprite&&(t.backgroundImageSprite.texture=t.loader.resources[this.state.selected]?t.loader.resources[this.state.selected].texture:Ks.xEZ.EMPTY,t.setObjectURL())}))}setObjectURL(){let e=this;e.app.renderer.plugins.extract.canvas(e.app.stage).toBlob((t=>{e.setState({objectURL:URL.createObjectURL(t)})}))}render(){const{selected:e,objectURL:t,loading:a}=this.state;return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("h3",{children:(0,O.Jh)("hero.downloadTitle")}),(0,_.jsx)("p",{children:(0,O.Jh)("hero.downloadDescription")}),(0,_.jsxs)("div",{className:"imageComposer",children:[(0,_.jsxs)("div",{className:"backgroundSelection",children:[(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("hero.chooseBackground")}),Qs.BACKGROUNDS.map(((t,a)=>(0,_.jsxs)("label",{className:`option ${t}`,"data-checked":t===e?"checked":"",children:[(0,_.jsx)("input",{type:"radio",name:"background",id:`background_${t}`,value:t,checked:t===e,onChange:this.onChange}),t===Qs.BACKGROUND_NONE&&(0,_.jsx)(Ys,{})]},a)))]}),(0,_.jsxs)("div",{className:"preview",children:[(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("hero.preview")}),(0,_.jsx)("div",{className:"heroImageWrapper "+(a?"loading":""),children:(0,_.jsx)("canvas",{id:"downloadHeroImagePreview"})})]})]}),(0,_.jsxs)("div",{className:"buttonsWrapper",children:[(0,_.jsx)(F.z,{appearance:"grey",onClick:this.props.closeDialogCallback,children:(0,O.Jh)("allgemein.cancel_with_capital_c")}),(0,_.jsx)(F.z,{href:t,className:"download",download:"hero.png",disabledClass:!t,children:(0,O.Jh)("hero.toDownload")})]})]})}}const ei=e=>{const[t,a]=(0,o.useState)({});return(0,o.useEffect)((()=>{function s(){const s=e.stickyTo.getBoundingClientRect();window.innerHeight-s.top>e.stickyTo.scrollHeight?void 0===t.position&&a({position:"absolute"}):void 0===t.width&&a({left:s.left,right:"auto",width:s.width})}if(!Travian.Game.Layout.MobileOptimizations.enabled)return window.addEventListener("scroll",s),s(),()=>window.removeEventListener("scroll",s)}),[e,t]),(0,_.jsx)("div",{className:"loadingIndicatorWrapper",style:t,children:(0,_.jsx)("div",{className:"loadingIndicator",children:(0,_.jsx)("i",{className:"spinner"})})})},ti={1:Cs.Y.tier1,2:Cs.Y.tier2,3:Cs.Y.tier3},ai=[0,3,4,1,2,5,6],si=["helmet","leftHand","rightHand","body","shoes","horse","bag","all"];class ii extends o.Component{static slotsIds={helmet:-1,leftHand:-2,rightHand:-3,body:-4,shoes:-5,horse:-7,bag:-6};static filterSlots=[7,1,2,0,3,4,6];static resourceItems=[145,146,147,148];static loyaltyItems=[109];static slotsPerRow=8;static loyaltyQuery=Ba.Ps`
        query {
			ownPlayer {
				village {
					loyalty
				}
			}
        }
    `;static getWarningTextKey(e,t){let a=e.status.status,s=e.isRegenerating,i=t===Cs.Y.tierConsumable;switch(a){case Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_ATTACK:case Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_RAID:case Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_SUPPLY:case Travian.Constants.HERO_STATUS_ON_THE_RETURN_PATH:case Travian.Constants.HERO_STATUS_ON_ESCAPE:case Travian.Constants.HERO_STATUS_ON_ADVENTURE:return i?"":"tooltip_heroUnderway_item";case Travian.Constants.HERO_STATUS_DEAD:return s?i?"tooltip_heroReviving_consumable":"tooltip_heroReviving_item":i?"tooltip_heroDead_consumable":"tooltip_heroDead_item";case Travian.Constants.HERO_STATUS_CAPTURED:return i?"":"tooltip_heroTrapped_item";case Travian.Constants.HERO_STATUS_ON_SUPPLY:return i?"":"tooltip_heroReinforcing_item";default:return""}}constructor(e){super(e);const{viewData:t}=this.props;this.state={checksum:this.props.checksum,imageHash:this.props.imageHash,itemsInventory:t.itemsInventory,itemsEquipped:t.itemsEquipped,commonData:t.commonData,heroState:t.heroState,filter:si[ii.filterSlots[0]],highlightedEquipmentSlot:null,consumeDialog:null,isMousedown:!1,lastCursorPosition:{x:0,y:0},mobileScrollPosition:{x:0,y:0},isDragging:!1,isTouchDragging:!1,isDropping:!1,dragObject:null,dragObjectShadowHTML:"",closestDropSlot:null,droppableEquipmentSlot:null,replacedPlaceId:null,tooltipData:null,contextMenu:{open:!1,item:null,content:null},mobileSortingEnabled:!1,snackbarMessage:"",snackbarId:0,loading:!1},this.contentContainer=document.querySelector("#contentOuterContainer .contentContainer"),this.pageWrapperRef=null,this.itemSlotRefs=[],this.itemSlotPositions={},this.heroEquipmentDropZoneRef=null,this.heroEquipmentDropZonePosition={},this.tooltipRef=null,this.inventoryWrapperRef=null,this.inventoryFilterRef=null,this.dropTimeout=null,this.onItemClick=this.onItemClick.bind(this),this.onConsumableClick=this.onConsumableClick.bind(this),this.openConsumableDialog=this.openConsumableDialog.bind(this),this.onFilterClick=this.onFilterClick.bind(this),this.onItemMouseDown=this.onItemMouseDown.bind(this),this.onItemMouseOver=this.onItemMouseOver.bind(this),this.onItemMouseOut=this.onItemMouseOut.bind(this),this.openContextMenu=this.openContextMenu.bind(this),this.closeContextMenu=this.closeContextMenu.bind(this),this.showNotClickableWarning=this.showNotClickableWarning.bind(this),this.openDownloadDialog=this.openDownloadDialog.bind(this),this.updateLoyalty=this.updateLoyalty.bind(this)}componentDidMount(){Travian.Game.ContextualHelp.check("/hero/inventory");let e=this;const t=t=>{if(e.state.isMousedown){let a=Travian.getCursorPosition(t);if((!Travian.Browser.isTouchInput||e.state.mobileSortingEnabled)&&(a.x!==e.state.lastCursorPosition.x||a.y!==e.state.lastCursorPosition.y)){let t=e.state.dragObject,s=null;Object.keys(e.itemSlotPositions).reduce(((i,n)=>{let r=e.itemSlotRefs[n],l=e.itemSlotPositions[n],o=a.y-r.offsetHeight/2+e.state.mobileScrollPosition.y,c=a.x-r.offsetWidth/2+e.state.mobileScrollPosition.x,d=Math.sqrt(Math.pow(l.left-c,2)+Math.pow(l.top-o,2));return(null===i||d<i)&&(i=d,t=n),-1!==n.indexOf("equipped")&&(s=n),i}),null),null!==s&&a.y>=this.heroEquipmentDropZonePosition.top&&a.y<=this.heroEquipmentDropZonePosition.top+this.heroEquipmentDropZoneRef.offsetHeight&&(t=s),a.x-=window.scrollX,a.y-=window.scrollY,e.setState({isDragging:!0,isTouchDragging:e.state.mobileSortingEnabled,lastCursorPosition:a,closestDropSlot:t})}}},a=()=>{e.setState({isMousedown:!1},(()=>{e.state.isDragging&&e.state.closestDropSlot&&e.setState({isDropping:!0},(()=>{clearTimeout(e.dropTimeout),e.dropTimeout=setTimeout((()=>{let t=e.itemSlotRefs[e.state.dragObject],a=e.itemSlotRefs[e.state.closestDropSlot],s=-1!==e.state.dragObject.indexOf("inventory_")?"itemsInventory":"itemsEquipped",i=-1!==e.state.closestDropSlot.indexOf("inventory_")?"itemsInventory":"itemsEquipped",n=Object.assign({},e.state),r=()=>{},l=null,o=parseInt(a.getAttribute("data-placeid")),c=null;if(t.getAttribute("data-tier")===Cs.Y.tierConsumable&&s!==i){let a="itemsInventory"===s?e.state.itemsInventory.find((e=>parseInt(e.id)===parseInt(t.getAttribute("data-id")))):e.state.itemsEquipped.find((e=>parseInt(e.id)===parseInt(t.getAttribute("data-id"))));e.openConsumableDialog(a,o)}else{let d=parseInt(t.getAttribute("data-id")),h=parseInt(a.getAttribute("data-id"));l=parseInt(t.getAttribute("data-placeid"));let u=n[s].find((e=>e.id===d));c=n[i].find((e=>e.id===h)),u&&(o&&(u.placeId=o),n[s]=n[s].filter((e=>e.id!==d)),n[i].push(u)),c&&(l&&(c.placeId=l),n[i]=n[i].filter((e=>e.id!==h)),n[s].push(c)),r=()=>{const t={data:{action:Travian.Constants.ACTION.inventory,amount:u&&u.amount,itemId:parseInt(a.dataset.id),targetPlaceId:o},success:()=>{e.props.reloadCallback(),e.setState({loading:!1,replacedPlaceId:null}),e.ajaxRequest=null},error:t=>{e.ajaxRequest=null,e.setState({loading:!1,replacedPlaceId:null}),Travian.defaultErrorFunction(t)}};e.setState({loading:!0},(()=>{e.ajaxRequest=Travian.api("hero/v2/inventory/move-item",t)}))}}e.setState({isMousedown:!1,isDragging:!1,isTouchDragging:!1,isDropping:!1,dragObject:null,dragObjectShadowHTML:"",closestDropSlot:null,itemsEquipped:n.itemsEquipped,itemsInventory:n.itemsInventory,replacedPlaceId:c&&l!==o?l:null,mobileSortingEnabled:!1},(()=>{c&&l!==o?setTimeout(r,150):r()}))}),300)}))}))};["mousemove","touchmove"].forEach((e=>window.addEventListener(e,t,{passive:!1}))),["mouseup","touchend"].forEach((e=>window.addEventListener(e,a,{passive:!1}))),window.addEventListener("touchmove",(t=>{(e.state.mobileSortingEnabled||e.state.contextMenu.open)&&t.preventDefault()}),{passive:!1});const s=()=>{e.setState({tooltipData:null})};["scroll","resize"].forEach((e=>window.addEventListener(e,s))),this.contentContainer.addEventListener("scroll",(()=>this.setState({mobileScrollPosition:{x:this.contentContainer.scrollLeft,y:this.contentContainer.scrollTop}})))}componentDidUpdate(e,t,a){let{tooltipData:s}=this.state,{imageHash:i,viewData:n}=this.props;if(null!==s&&this.tooltipRef){const e="rtl"===Travian.Game.getDirection(),t=Object.assign({},s.style);let a=this.pageWrapperRef.getBoundingClientRect(),i=this.tooltipRef.getBoundingClientRect(),n=this.inventoryFilterRef.getBoundingClientRect(),r=this.itemSlotRefs[s.itemSlotRefKey].getBoundingClientRect();const l=2;let o,c=r.top+l;(c+i.height>a.top+a.height||c<n.top&&c+i.height>n.top)&&(c=r.top+r.height-i.height-l),e?(o=r.left-l-i.width,o<0&&(o=r.left+l+r.width)):(o=r.left+l+r.width,o+i.width>window.innerWidth&&(o=r.left-l-i.width)),s.style={top:c,left:o},s.style.top===t.top&&s.style.left===t.left||this.setState({tooltipData:s})}jQuery.md5(JSON.stringify(e.viewData))!==jQuery.md5(JSON.stringify(this.props.viewData))&&this.setState({imageHash:i,itemsInventory:n.itemsInventory,itemsEquipped:n.itemsEquipped,commonData:n.commonData,heroState:n.heroState,loading:!1}),Travian.Tip.refresh()}onItemMouseDown(e,t,a){const{isDragging:s,isDropping:i,filter:n,mobileScrollPosition:r}=this.state;if(s||i)return!1;e.preventDefault();let l=t,o=this.itemSlotRefs[t].outerHTML,c=Travian.getCursorPosition(e),d=t,h=a.canBeClicked?this.itemSlotRefs[t].getAttribute("data-slot"):null;this.setState({isMousedown:!0,dragObject:l,closestDropSlot:d,lastCursorPosition:c,dragObjectShadowHTML:o,droppableEquipmentSlot:h}),this.itemSlotPositions={},Object.keys(this.itemSlotRefs).map((e=>{let t=this.itemSlotRefs[e];if(null===t)delete this.itemSlotRefs[e];else{let a=t.getBoundingClientRect(),s=-1!==l.indexOf("inventory_"),i=-1!==e.indexOf("inventory_"),o=this.itemSlotRefs[e].getAttribute("data-slot");const c=null===o||"all"===n||n===o,d=Travian.Browser.isTouchInput&&(!s||!i);!c||d||(!s||!i&&o!==h)&&(s||null!==o&&o!==h)||(this.itemSlotPositions[e]={top:a.top+r.y+window.scrollY,left:a.left+r.x+window.scrollX})}return!0}));const u=this.heroEquipmentDropZoneRef.getBoundingClientRect();this.heroEquipmentDropZonePosition={top:u.top+r.y+window.scrollY,left:u.left+r.x+window.scrollX}}getItemStats(e){let t=[];return null!==e.attributes&&e.attributes.map((e=>(t.push({title:e.effectDescription,details:e.descriptionDetails??null}),!0))),t}onItemMouseOver(e,t,a){let s=a.canBeClicked&&-1===t.indexOf("equipped_")?this.itemSlotRefs[t].getAttribute("data-slot"):null,i=this.getItemStats(a),n=this.itemSlotRefs[t].getBoundingClientRect();let r={top:n.top+2,left:n.left+2+n.width};this.setState({highlightedEquipmentSlot:s,tooltipData:{itemSlotRefKey:t,tier:ti[a.tier]??Cs.Y.tierConsumable,title:a.name,type:a.slot,stats:i,style:r,notClickable:!a.canBeClicked,warning:ii.getWarningTextKey(this.props.viewData.heroState,ti[a.tier]??Cs.Y.tierConsumable),errorMessage:a.tooltipErrorMessage}})}onItemMouseOut(){this.setState({highlightedEquipmentSlot:null,tooltipData:null})}onFilterClick(e){this.setState({filter:e.target.dataset.key})}updateLoyalty(){const{client:e}=this.props;e.query({query:ii.loyaltyQuery}).then((e=>{const t=e.data&&e.data.ownPlayer&&e.data.ownPlayer.village&&e.data.ownPlayer.village.loyalty;Travian.Game.Village.updateLoyalty(t)}))}onItemClick(e,t,a){const{reloadCallback:s}=this.props,{itemsInventory:i,itemsEquipped:n,commonData:r}=this.state,l=parseInt(e.target.dataset.id),o=i.find((e=>parseInt(e.id)===l)),c=n.find((e=>parseInt(e.id)===l)),d=void 0!==o?"inventory":"equipped",h="inventory"===d?o:c,u=-1!==ii.resourceItems.indexOf(h.typeId),m=-1!==ii.loyaltyItems.indexOf(h.typeId),p=h.type===Cs.Y.tierConsumable&&void 0!==a?a:"move",g=()=>{this.setState({highlightedEquipmentSlot:null,isMousedown:!1,isDragging:!1,isTouchDragging:!1,isDropping:!1,dragObject:null,dragObjectShadowHTML:"",closestDropSlot:null,droppableEquipmentSlot:null,tooltipData:null},(()=>{this.closeContextMenu(),Travian.Game.Hero.refreshInHUD(),u&&Travian.Game.Layout.updateResources(),m&&this.updateLoyalty(),s()})),this.ajaxRequest=null},v={data:{action:Travian.Constants.ACTION.inventory,itemId:l,amount:e.target.dataset.amount?parseInt(e.target.dataset.amount):1},success:g,error:e=>{this.ajaxRequest=null,Travian.defaultErrorFunction(e)}};if("move"===p&&(v.data.targetPlaceId=t||("inventory"===d?ii.slotsIds[h.slot]:0),this.setState({loading:!0},(()=>{this.ajaxRequest=Travian.api("hero/v2/inventory/move-item",v)}))),"use"===p){const e=this;v.data.villageId=r.activeVillageID,this.ajaxRequest=new Travian.Game.TwoStepAction("hero/v2/inventory/use-item",v.data),this.ajaxRequest.sign((function(){e.ajaxRequest.execute(g)}))}}onConsumableClick(e,t){const{id:a}=e.target.dataset,s="inventory"===t?this.state.itemsInventory.find((e=>parseInt(e.id)===parseInt(a))):this.state.itemsEquipped.find((e=>parseInt(e.id)===parseInt(a)));this.openConsumableDialog(s)}showNotClickableWarning(e){const{tier:t}=e.target.dataset;let a=(0,O.Jh)("hero."+ii.getWarningTextKey(this.props.viewData.heroState,t));this.setState({snackbarMessage:a,snackbarId:Math.random()})}openConsumableDialog(e,t){const{commonData:a}=this.state;window.Travian.React.Dialog({content:(0,_.jsx)(qs,{commonData:a,item:e,confirmCallback:this.onItemClick,targetPlaceId:t}),cssClass:"plain heroConsumablesPopup heroV2 contentV2",buttonOk:!1,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0,onOpen:()=>new Travian.FormV2("#consumableHeroItem")},"consumableDialog")}openContextMenu(e,t,a){let s,i=[];if("block"===t.clickShortDescription.icon)s=(0,_.jsx)(Ls,{className:"block"});else s=(0,_.jsx)(Rs,{className:"swap"});t.canBeClicked?i.push({icon:s,text:t.clickShortDescription.text,disabled:!1,onClick:a,dataset:{"data-id":t.id,"data-placeid":t.placeId}}):i.push({icon:s,text:t.clickShortDescription.text,disabled:!0,onClick:()=>{}});const n={tier:ti[t.tier]??Cs.Y.tierConsumable,title:t.name,type:t.slot,stats:this.getItemStats(t),style:{},notClickable:!t.canBeClicked,warning:ii.getWarningTextKey(this.props.viewData.heroState,ti[t.tier]??Cs.Y.tierConsumable)};i.push({icon:(0,_.jsx)(Js,{}),text:(0,O.Jh)("hero.info"),disabled:!1,onClick:()=>{window.Travian.React.Dialog({content:(0,_.jsx)(zs,{...n}),cssClass:"mobileHeroItemTooltip blankForMobile heroV2 contentV2",buttonOk:!1,buttonCancel:!0,enableBackground:!0,darkOverlay:!0,preventFormSubmit:!0,fullSize:!0},"mobileHeroItemTooltip")}}),t.isEquipped||i.push({icon:(0,_.jsx)(_s,{}),text:(0,O.Jh)("hero.sort"),disabled:!1,onClick:()=>{this.setState({mobileSortingEnabled:!0,isDragging:!0,isMousedown:!0,isTouchDragging:!1},this.closeContextMenu)}}),this.setState({contextMenu:{open:!0,item:e,content:i}})}closeContextMenu(){let{contextMenu:e}=this.state;e.open=!1,e.item=null,e.content=null,this.setState({contextMenu:e})}onItemClickDuringMobileSorting(e){this.setState({closestDropSlot:e},(()=>{window.dispatchEvent(new MouseEvent("mouseup"))}))}openDownloadDialog(){const{direction:e}=this.props,{imageHash:t}=this.state;window.Travian.React.Dialog({content:(0,_.jsx)(Qs,{imageHash:t,direction:e}),cssClass:"plain heroDownloadDialog heroV2 contentV2",buttonOk:!1,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0},"heroDownloadDialog")}render(){const{direction:e}=this.props,{itemsInventory:t,itemsEquipped:a,filter:s,highlightedEquipmentSlot:i,isDragging:n,isTouchDragging:r,dragObject:l,dragObjectShadowHTML:o,isDropping:c,lastCursorPosition:d,mobileScrollPosition:h,closestDropSlot:u,replacedPlaceId:m,tooltipData:p,contextMenu:g,mobileSortingEnabled:v,imageHash:x,loading:b,heroState:j}=this.state,f=a.find((e=>"horse"===e.place)),y=j.status.status===Travian.Constants.HERO_STATUS_DEAD;let T=0;if(t.length>0){let e=t.sort(((e,t)=>e.placeId-t.placeId)),a=e[e.length-1].placeId;T=a+(ii.slotsPerRow-a%ii.slotsPerRow)}T=Math.max(T,2*ii.slotsPerRow);let N={};if(n&&null!==l)if(v&&!r){if(this.itemSlotPositions[u]){let e=this.itemSlotPositions[u],t=this.itemSlotRefs[u];N.left=e.left+t.offsetWidth/2-h.x-window.scrollX,N.top=e.top+t.offsetHeight/2-h.y-window.scrollY}}else N.left=d.x,N.top=d.y;if(c&&l&&this.itemSlotPositions[u]){let e=this.itemSlotPositions[u];N.left=e.left-h.x-window.scrollX,N.top=e.top-h.y-window.scrollY,N.animation="dragObjectDropping 300ms ease-in-out forwards",N.transitionDuration="300ms"}const C=Travian.Browser.isTouchInput;return(0,_.jsxs)("div",{className:`inventoryPageWrapper ${v?"mobileSortingMode preventMobileSwipeNavigation":""} ${b?"loading":""}`,ref:e=>this.pageWrapperRef=e,children:[n&&null!==l&&(0,_.jsx)("div",{className:"dragObject",dangerouslySetInnerHTML:{__html:o},style:N}),!C&&null!==p&&(0,_.jsx)(zs,{ref:e=>this.tooltipRef=e,...p}),(0,_.jsxs)("div",{className:"currentHeroEquipment "+(y?"isDead":""),ref:e=>this.heroEquipmentDropZoneRef=e,children:[(0,_.jsx)("div",{className:"equipmentSlots",children:ai.map(((e,t)=>{let s=a.find((t=>t.slot===si[e])),r="equipped_"+(t+1);if(s){Travian.Tip.clearOnElement(this.itemSlotRefs[r]);let t=s.canBeClicked?s.type===Cs.Y.tierConsumable?e=>this.onConsumableClick(e,"equipped"):this.onItemClick:this.showNotClickableWarning,a=v?null:e=>{this.openContextMenu(this.itemSlotRefs[r],s,t)};return(0,_.jsx)(Cs.Z,{ref:e=>this.itemSlotRefs[r]=e,dragged:n&&l===r,isDropTarget:n&&u===r||!n&&i===si[e],disabled:v||n&&this.itemSlotRefs[l].getAttribute("data-slot")!==si[e],replaced:m===s.placeId,id:s.id,placeId:s.placeId,slot:si[e],typeId:s.typeId,tier:s.type===Cs.Y.tierConsumable?Cs.Y.tierConsumable:ti[s.tier],count:s.type===Cs.Y.tierConsumable&&s.amount>0?s.amount:null,onClick:C?a:t,onMouseDown:e=>{s.canBeClicked&&this.onItemMouseDown(e,r,s)},onMouseOver:e=>{this.onItemMouseOver(e,r,s)},onMouseOut:this.onItemMouseOut,notClickable:!s.canBeClicked},r)}{let t=si[e];return(0,_.jsx)(Cs.Z,{ref:e=>this.itemSlotRefs[r]=e,slot:t,isDropTarget:n&&u===r||!n&&i===t,disabled:v,empty:!0,placeId:ii.slotsIds[t]},r)}}))}),(0,_.jsx)("div",{className:["hero",this.props.gender,f?"horse "+f.type+f.typeId:""].join(" "),children:(0,_.jsx)("img",{src:`/heroV2/body/${x}.1.png`,className:`heroBodyImage heroBodyImage-${e}`,alt:(0,O.Jh)("hero.heroBody")})}),(0,_.jsx)(F.z,{className:"download",iconButton:!0,onClick:this.openDownloadDialog,title:(0,O.Jh)("hero.downloadTitle"),children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(Vs,{className:"outline"}),(0,_.jsx)(Vs,{className:"icon"})]})})]}),(0,_.jsxs)("div",{className:"inventoryWrapper",ref:e=>this.inventoryWrapperRef=e,children:[(0,_.jsx)("div",{className:"inventoryFilters",ref:e=>this.inventoryFilterRef=e,children:ii.filterSlots.map(((e,t)=>(e=si[e],(0,_.jsx)("div",{className:`filterSlot ${e} ${s===e?"active":""}`,"data-key":e,onClick:this.onFilterClick,title:(0,O.Jh)("hero.heroItemFilter_"+e),children:(0,_.jsx)("i",{})},t))))}),(0,_.jsxs)("a",{className:"tradeItems lightColor",href:"/hero/auction",children:[(0,_.jsx)(ks,{}),(0,O.Jh)("hero.tradeItems")]}),(0,_.jsx)("div",{className:`heroItems filter_${s}`,children:[...Array(T)].map(((e,a)=>{let s=t.find((e=>e.placeId===a+1)),i="inventory_"+(a+1);if(s&&s.amount>0){let e=s.canBeClicked?s.type===Cs.Y.tierConsumable?e=>this.onConsumableClick(e,"inventory"):this.onItemClick:this.showNotClickableWarning,t=v?null:t=>{this.openContextMenu(this.itemSlotRefs[i],s,e)};return(0,_.jsx)(Cs.Z,{ref:e=>this.itemSlotRefs[i]=e,dragged:n&&l===i,isDropTarget:n&&u===i,replaced:m===s.placeId,id:s.id,placeId:s.placeId,slot:s.slot,typeId:s.typeId,tier:s.type===Cs.Y.tierConsumable?Cs.Y.tierConsumable:ti[s.tier],count:s.type===Cs.Y.tierConsumable?s.amount:null,onClick:C?v?()=>{this.onItemClickDuringMobileSorting(i)}:t:e,onMouseDown:e=>{this.onItemMouseDown(e,i,s)},onMouseOver:e=>{this.onItemMouseOver(e,i,s)},onMouseOut:this.onItemMouseOut},i)}return(0,_.jsx)(Cs.Z,{ref:e=>this.itemSlotRefs[i]=e,isDropTarget:n&&u===i,onClick:v?()=>{this.onItemClickDuringMobileSorting(i)}:()=>{},empty:!0,placeId:a+1},i)}))})]}),g.open&&(0,_.jsx)($s,{contextParent:g.item,onClose:this.closeContextMenu,content:g.content}),this.state.snackbarMessage&&this.inventoryWrapperRef&&(0,_.jsx)(Qt,{message:this.state.snackbarMessage,id:this.state.snackbarId,stickyTo:this.inventoryWrapperRef,additionalClass:"warning"}),b&&(0,_.jsx)(ei,{stickyTo:this.inventoryWrapperRef})]})}}let ni=(0,Pa.T)(ii);var ri=a(3063);const li=e=>{const[t,a]=(0,o.useState)(e.heroState),{status:s,isRegenerating:i,regenerationTimeLeft:n,homeVillage:r}=t,l=(0,o.useRef)(null);return(0,o.useEffect)((()=>{a(e.heroState),Travian.TimersAndCounters.initTimersInContext(l.current)})),(0,_.jsxs)("div",{className:"heroState",ref:l,children:[s.status===Travian.Constants.HERO_STATUS_IN_VILLAGE&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusHome_medium"}),(0,_.jsx)("div",{children:(0,O.Jh)("hero.actionInVillage",{NAME:(0,_.jsx)("a",{href:`/karte.php?d=${r.mapId}`,children:r.name})},!0)})]}),s.status===Travian.Constants.HERO_STATUS_ON_THE_RETURN_PATH&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusRunning_medium"}),(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{children:(0,O.Jh)("hero.status9",{NAME:(0,_.jsx)("a",{href:`/karte.php?d=${s.onWayTo.village.mapId}`,children:s.onWayTo.village.name})},!0)})," ",(0,_.jsx)("span",{children:(0,O.Jh)("hero.heroArrival",{ARRIVAL:(0,_.jsx)("span",{className:"timer",counting:"down",value:s.arrivalIn,children:O.qp.durationFormat(s.arrivalIn)}),TIME:O.qp.timeFormat(s.arrivalAt,ri.zt.TIME_WITHOUT_SECONDS)},!0)})]})]}),s.status===Travian.Constants.HERO_STATUS_CAPTURED&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusCaptured_medium"}),(0,_.jsx)("div",{children:(0,O.Jh)("hero.actionCaptured",{NAME:(0,_.jsx)("a",{href:`/karte.php?d=${r.mapId}`,children:r.name}),NAMECAPTURED:(0,_.jsx)("a",{href:`/karte.php?d=${s.inVillage.mapId}`,children:s.inVillage.name})},!0)})]}),(s.status===Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_ATTACK||s.status===Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_RAID||s.status===Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_SUPPLY)&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusRunning_medium"}),(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{children:(0,O.Jh)("hero.homeVillageIs",{NAME:(0,_.jsx)("a",{href:`/karte.php?d=${r.mapId}`,children:r.name})},!0)})," ",(0,_.jsx)("span",{children:(0,O.Jh)(s.status===Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_ATTACK?"hero.stateOnTheWayToAttack":s.status===Travian.Constants.HERO_STATUS_ON_THE_WAY_TO_RAID?"hero.stateOnTheWayToRaid":"hero.stateOnTheWayToSupply",{TARGET:(0,_.jsx)(is.tk,{x:s.onWayTo.x,y:s.onWayTo.y,type:s.onWayTo.type,mapId:s.onWayTo.id,name:s.onWayTo.village?s.onWayTo.village.name:""})},!0)})," ",(0,_.jsx)("span",{children:(0,O.Jh)("hero.heroArrival",{ARRIVAL:(0,_.jsx)("span",{className:"timer",counting:"down",value:s.arrivalIn,children:O.qp.durationFormat(s.arrivalIn)}),TIME:O.qp.timeFormat(s.arrivalAt,ri.zt.TIME_WITHOUT_SECONDS)},!0)})]})]}),s.status===Travian.Constants.HERO_STATUS_ON_SUPPLY&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusSupport_medium"}),(0,_.jsxs)("div",{children:[s.inOasis&&(0,O.Jh)("hero.actionDefendOasis",{NAME:(0,_.jsx)("a",{href:`/karte.php?d=${r.mapId}`,children:r.name}),NAMETODEFEND:(0,_.jsx)("a",{href:`/karte.php?d=${s.inOasis.belongsTo.mapId}`,children:s.inOasis.belongsTo.name})},!0),s.inVillage&&(0,O.Jh)("hero.actionDefendVillage",{NAME:(0,_.jsx)("a",{href:`/karte.php?d=${r.mapId}`,children:r.name}),NAMETODEFEND:(0,_.jsx)("a",{href:`/karte.php?d=${s.inVillage.mapId}`,children:s.inVillage.name})},!0)]})]}),s.status===Travian.Constants.HERO_STATUS_DEAD&&!i&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusDead_medium"}),(0,_.jsx)("div",{children:(0,O.Jh)("hero.actionDead")})]}),s.status===Travian.Constants.HERO_STATUS_DEAD&&i&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusRevive_medium"}),(0,_.jsx)("div",{children:(0,O.Jh)("hero.onRegenerateTitle",{VILLAGE:(0,_.jsx)("a",{href:`/karte.php?d=${r.mapId}`,children:r.name}),COUNTDOWN:(0,_.jsx)("span",{className:"timer",counting:"down",value:n,children:O.qp.durationFormat(n)})},!0)})]}),s.status===Travian.Constants.HERO_STATUS_ON_ESCAPE&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusRunning_medium"}),(0,_.jsx)("div",{children:(0,O.Jh)("hero.actionEscape")})]}),s.status===Travian.Constants.HERO_STATUS_ON_ADVENTURE&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("i",{className:"statusRunning_medium"}),(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{children:(0,O.Jh)("hero.status50",{NAME:(0,_.jsx)("span",{children:(0,_.jsx)(O.rT,{x:s.onWayTo.x,y:s.onWayTo.y,configInput:{withMarkup:!0,linked:!0}})})},!0)})," ",(0,_.jsx)("span",{children:(0,O.Jh)("hero.heroArrival",{ARRIVAL:(0,_.jsx)("span",{className:"timer",counting:"down",value:s.arrivalIn,children:O.qp.durationFormat(s.arrivalIn)}),TIME:O.qp.timeFormat(s.arrivalAt,ri.zt.TIME_WITHOUT_SECONDS)},!0)})]})]})]})};class oi extends o.Component{static ATTR_FIGHTING_STRENGTH="fightingStrength";static ATTR_OFF_BONUS="offBonus";static ATTR_DEF_BONUS="defBonus";static ATTR_RESOURCE_PRODUCTION="resourceProduction";constructor(e){super(e);const t=e.hero.attributePoints;this.state={productionType:e.hero.productionType,production:{0:e.hero.productionTypes[0],1:e.hero.productionTypes[1],2:e.hero.productionTypes[2],3:e.hero.productionTypes[3],4:e.hero.productionTypes[4]},pointsAvailable:e.hero.freePoints,pointsBefore:t,pointsAfter:Object.assign({},t),pointsInputFields:Object.assign({},t),saveAttributes:!1,attackBehaviour:e.hero.attackBehaviour,revive:e.revive,checksum:e.checksum,hero:e.hero,heroState:e.heroState},this.typingTimeout=null,this.pointsInputRefs={},this.save=this.save.bind(this),this.saveAttributes=this.saveAttributes.bind(this),this.changeProductionType=this.changeProductionType.bind(this),this.setPoints=this.setPoints.bind(this),this.attributePointsInputHandler=this.attributePointsInputHandler.bind(this),this.calculateAttributeValue=this.calculateAttributeValue.bind(this),this.changeAttackBehaviour=this.changeAttackBehaviour.bind(this),this.openExchangeResourcesDialog=this.openExchangeResourcesDialog.bind(this),this.reviveWithResources=this.reviveWithResources.bind(this),this.reviveWithWaterBucket=this.reviveWithWaterBucket.bind(this),this.handleWheel=this.handleWheel.bind(this)}componentDidMount(){let e=this;Travian.TimersAndCounters.init(),Travian.Game.ContextualHelp.check("/hero/attributes"),Object.keys(e.pointsInputRefs).forEach((t=>{e.pointsInputRefs[t].addEventListener("wheel",this.handleWheel,{passive:!1})}))}componentDidUpdate(e,t,a){if(JSON.stringify(e.hero.attributePoints)!==JSON.stringify(this.props.hero.attributePoints)){const e=this.props.hero.attributePoints;this.setState({pointsAvailable:this.props.hero.freePoints,pointsBefore:e,pointsAfter:Object.assign({},e),pointsInputFields:Object.assign({pointsBefore:e}),saveAttributes:!1,hero:this.props.hero})}JSON.stringify(e.hero.productionTypes)!==JSON.stringify(this.props.hero.productionTypes)&&this.setState({production:{0:this.props.hero.productionTypes[0],1:this.props.hero.productionTypes[1],2:this.props.hero.productionTypes[2],3:this.props.hero.productionTypes[3],4:this.props.hero.productionTypes[4]},hero:this.props.hero})}save(){const{reloadCallback:e}=this.props,{productionType:t,pointsBefore:a,pointsAfter:s,saveAttributes:i,attackBehaviour:n}=this.state;let r={data:{resource:t,attackBehaviour:n},success:t=>{e(),Travian.Game.Hero.refreshInHUD(),Travian.Game.Layout.updateResources()},error:t=>{Travian.defaultErrorFunction(t),e()}};i&&(r.data.attributes={power:s[oi.ATTR_FIGHTING_STRENGTH]-a[oi.ATTR_FIGHTING_STRENGTH],offBonus:s[oi.ATTR_OFF_BONUS]-a[oi.ATTR_OFF_BONUS],defBonus:s[oi.ATTR_DEF_BONUS]-a[oi.ATTR_DEF_BONUS],productionPoints:s[oi.ATTR_RESOURCE_PRODUCTION]-a[oi.ATTR_RESOURCE_PRODUCTION]}),Travian.api("hero/v2/attributes",r,"POST")}handleWheel(e){e.preventDefault();let t=e.deltaY>0?-1:1;this.setPoints(e.target.name,parseInt(e.target.value)+t)}saveAttributes(){this.setState({saveAttributes:!0},this.save)}changeProductionType(e){this.setState({productionType:e},this.save)}changeAttackBehaviour(){let{attackBehaviour:e}=this.state;e="hide"===e?"stay":"hide",this.setState({attackBehaviour:e},this.save)}setPoints(e,t){const{pointsAvailable:a,pointsBefore:s,pointsAfter:i,pointsInputFields:n,production:r,hero:l}=this.state;t=Math.max(t,s[e]);let o=Math.min(l.maxPointsPerAttribute,i[e]+a);t=Math.min(t,o),i[e]=t,n[e]=t;const c=Object.keys(i).reduce(((e,t)=>e+i[t]-s[t]),0);let d=l.freePoints-c,h=r;if(e===oi.ATTR_RESOURCE_PRODUCTION){h[0]=t*l.attributes[e].pointWorth[0]*Travian.Variables.Speed;for(let a=1;a<=4;a++)h[a]=t*l.attributes[e].pointWorth[a]*Travian.Variables.Speed}this.setState({pointsAfter:i,pointsAvailable:d,pointsInputFields:n,production:h})}attributePointsInputHandler(e,t){let a=this,s=this.state.pointsInputFields;s[e]=t,this.setState({pointsInputFields:s},(()=>{clearTimeout(this.typingTimeout),t.trim().length>0&&!isNaN(t)?this.typingTimeout=setTimeout((()=>{a.setPoints(e,parseInt(t))}),250):this.typingTimeout=setTimeout((()=>{a.setPoints(e,this.state.pointsBefore[e])}),250)}))}calculateAttributeValue(e){const{pointsAfter:t,hero:a}=this.state;switch(e){case oi.ATTR_FIGHTING_STRENGTH:return 100+t[oi.ATTR_FIGHTING_STRENGTH]*a.attributes[oi.ATTR_FIGHTING_STRENGTH].valueBonus+a.attributes[oi.ATTR_FIGHTING_STRENGTH].valueOfItems;case oi.ATTR_OFF_BONUS:return(0,O.eJ)(Math.round(.2*t[oi.ATTR_OFF_BONUS]*10)/10,{unit:O.uo.PERCENT,fraction:1});case oi.ATTR_DEF_BONUS:return(0,O.eJ)(Math.round(.2*t[oi.ATTR_DEF_BONUS]*10)/10,{unit:O.uo.PERCENT,fraction:1});case oi.ATTR_RESOURCE_PRODUCTION:return t[oi.ATTR_RESOURCE_PRODUCTION];default:return null}}openExchangeResourcesDialog(e){const t={data:e.data,success:e=>{this.ajaxRequest=null;let t=new Travian.Dialog.Dialog({buttonOk:!1,draggable:!1,overlayCancel:!0,preventFormSubmit:!0,context:"exchangeResources"});t.setContent(e.html),t.show()},error:e=>{this.ajaxRequest=null,Travian.defaultErrorFunction(e)}};this.ajaxRequest=Travian.api("marketplace/exchange-resources",t)}reviveWithResources(){const e={data:{action:Travian.Constants.ACTION.heroRevive},success:e=>{const t=void 0!==e.heroState?e.heroState:null;this.setState({heroState:t},(()=>{Travian.Game.Hero.refreshInHUD(),Travian.Game.Layout.updateResources()})),this.ajaxRequest=null},error:e=>{this.ajaxRequest=null,Travian.defaultErrorFunction(e)}};this.ajaxRequest=Travian.api("hero/v2/revive",e)}reviveWithWaterBucket(e){const{checksum:t}=this.props,{waterBucket:a}=this.state.revive;if(!a.canBeUsed)return;const s={data:{action:Travian.Constants.ACTION.inventory,context:"attributes",id:a.id,amount:a.amount,checksum:t},success:e=>{const t=void 0!==e.heroState?e.heroState:null,a=void 0!==e.hero?e.hero:null;this.setState({hero:a,heroState:t},(()=>{Travian.Game.Hero.refreshInHUD()})),this.ajaxRequest=null},error:e=>{this.ajaxRequest=null,Travian.defaultErrorFunction(e)}};this.ajaxRequest=Travian.api("hero/v2/inventory/click",s)}render(){const{pointsAvailable:e,pointsBefore:t,pointsAfter:a,pointsInputFields:s,production:i,attackBehaviour:n,heroState:r,hero:l}=this.state,{charges:c,chargesDuration:d,chargesExchangeButtonConfig:h,chargesErrorMessage:u,waterBucket:m,activeVillage:p}=this.state.revive,g=Object.keys(h).length>0,v=Math.ceil(l.health),x={};x[oi.ATTR_FIGHTING_STRENGTH]="attributeStrength_medium",x[oi.ATTR_OFF_BONUS]="attributeOffBonus_medium",x[oi.ATTR_DEF_BONUS]="attributeDefBonus_medium",x[oi.ATTR_RESOURCE_PRODUCTION]="attributeRessourceBonus_medium";const b={0:"resources_medium",1:"lumber_small",2:"clay_small",3:"iron_small",4:"crop_small"};let j={};return Object.keys(l.attributes).map((e=>(j[e]=l.attributes[e],j[e].primary={nominator:t[e],denominator:l.maxPointsPerAttribute},j[e].secondary={nominator:a[e]-t[e],denominator:l.maxPointsPerAttribute},!0))),(0,_.jsxs)(o.Fragment,{children:[r.status.status===Travian.Constants.HERO_STATUS_DEAD&&!r.isRegenerating&&(0,_.jsxs)("div",{className:"attributeBox heroDead",children:[(0,_.jsxs)("div",{className:"status",children:[(0,_.jsx)("i",{className:"statusDead_medium"}),(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("hero.heroIsDead_withPunctuation")})]}),!p.hasRallyPoint&&(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{className:"description",children:(0,O.Jh)("hero.errorRegenerateMissingRallyPoint",{NAME:(0,_.jsx)("a",{href:`/karte.php?d=${p.kid}`,children:p.name})},!0)}),(0,_.jsx)("div",{className:"reviveNotPossible",children:(0,O.Jh)("hero.noRallyPointNoRevive")})]}),p.hasRallyPoint&&!p.enoughFreeCrop&&(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{className:"description",children:(0,O.Jh)("hero.warningHeroCantBeRevived")}),(0,_.jsx)("div",{className:"reviveNotPossible",children:(0,O.Jh)("hero.notEnoughCropProduction")})]}),p.hasRallyPoint&&p.enoughFreeCrop&&(0,_.jsxs)(o.Fragment,{children:[(0,_.jsxs)("div",{className:"description",children:[(0,_.jsx)("span",{children:(0,O.Jh)("hero.homeVillageWas",{VILLAGE:(0,_.jsx)("a",{href:`/karte.php?d=${r.homeVillage.mapId}`,children:r.homeVillage.name})},!0)}),(0,_.jsxs)("span",{children:[" ",(0,O.Jh)("hero.willBeRevivedIn",{VILLAGE:(0,_.jsx)("a",{href:`/karte.php?d=${p.kid}`,children:p.name})},!0)]})]}),p.negativeCrop&&(0,_.jsx)("div",{className:"reviveWarning",children:(0,O.Jh)("hero.warningNegativeCropProduction")}),(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("hero.reviveTitle")}),(0,_.jsxs)("div",{className:"reviveWrapper",children:[(0,_.jsx)("div",{className:"reviveWithResources description",children:(0,O.Jh)("hero.reviveWithResources")}),(0,_.jsxs)("div",{className:"reviveWithResources charges",children:[(0,_.jsx)("div",{dangerouslySetInnerHTML:{__html:c}}),(0,_.jsx)("div",{dangerouslySetInnerHTML:{__html:d}})]}),g?(0,_.jsx)(F.z,{className:`reviveWithResources ${h.class}`,appearance:"gold",onClick:()=>{this.openExchangeResourcesDialog(h.dialog)},children:(0,O.Jh)("build.exchangeResources")}):(0,_.jsx)(F.z,{className:"reviveWithResources",onClick:this.reviveWithResources,children:(0,O.Jh)("hero.reviveWithResourcesAction")}),u&&(0,_.jsx)("div",{className:"reviveWithResources chargesErrorMessage",dangerouslySetInnerHTML:{__html:u}}),(0,_.jsx)("div",{className:"reviveWithWaterBucket description",children:(0,O.Jh)("hero.reviveWithWaterBucket")}),(0,_.jsxs)("div",{className:"reviveWithWaterBucket waterBucketWrapper",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)(Cs.Y,{typeId:m.typeId,tier:Cs.Y.tierConsumable,count:m.amount,className:m.amount>0?"none":""}),(0,_.jsx)("div",{className:"reviveWithWaterBucket details",children:m.amount>0?m.description:(0,O.Jh)("hero.buyWaterBucketInAuctions")})]}),m.amount>0&&!m.canBeUsed&&(0,_.jsx)("div",{className:"reviveWithWaterBucket errorMessage",children:m.errorMessage})]}),m.amount>0?(0,_.jsx)(F.z,{className:"reviveWithWaterBucket",disabledClass:!m.canBeUsed,"data-id":m.id,"data-placeid":m.placeId,"data-amount":"1",onClick:this.reviveWithWaterBucket,children:(0,O.Jh)("hero.reviveWithWaterBucketAction")}):(0,_.jsx)(F.z,{className:"reviveWithWaterBucket",disabledClass:!0,children:(0,O.Jh)("hero.reviveWithWaterBucketAction")})]})]})]}),(0,_.jsxs)("div",{className:(r.status.status===Travian.Constants.HERO_STATUS_DEAD&&r.isRegenerating?"heroRevive":"")+" attributeBox",children:[r.status.status===Travian.Constants.HERO_STATUS_DEAD&&r.isRegenerating&&(0,_.jsxs)("div",{className:"status",children:[(0,_.jsx)("i",{className:"statusRevive_medium"}),(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("hero.actionRegenerating")}),(0,_.jsx)("div",{className:"details",children:(0,O.Jh)("hero.onRegenerateTitle",{VILLAGE:(0,_.jsx)("a",{href:`/karte.php?d=${r.homeVillage.mapId}`,children:r.homeVillage.name}),COUNTDOWN:(0,_.jsx)("span",{className:"timer",counting:"down",value:parseInt(r.regenerationTimeLeft),children:O.qp.durationFormat(parseInt(r.regenerationTimeLeft))})},!0)})]}),(0,_.jsxs)("div",{className:"stats",children:[(0,_.jsxs)("div",{className:"name",title:l.healthTitle,children:[(0,_.jsx)("i",{className:"attributeHealth_medium"}),(0,_.jsx)("span",{children:(0,O.Jh)("hero.health")})]}),(0,_.jsx)(Ra,{color:r.isRegenerating?"orange":"green",primary:{nominator:v,denominator:100},title:l.healthTitle}),(0,_.jsx)("div",{className:"value",title:l.healthTitle,children:(0,O.eJ)(v,{unit:O.uo.PERCENT})}),(0,_.jsxs)("div",{className:"name",title:l.experienceTitle,children:[(0,_.jsx)("i",{className:"attributeExperience_medium"}),(0,_.jsx)("span",{children:(0,O.Jh)("hero.erfahrung")})]}),(0,_.jsx)(Ra,{color:"blue",primary:{percent:l.experiencePercent},title:l.experienceTitle}),(0,_.jsx)("div",{className:"value",title:l.experienceTitle,children:l.experience}),(0,_.jsxs)("div",{className:"name",title:l.speedTitle,children:[(0,_.jsx)("i",{className:"attributeSpeed_medium"}),(0,_.jsx)("span",{children:(0,O.Jh)("hero.speed")})]}),(0,_.jsxs)("div",{className:"value speedValue",title:l.speedTitle,children:[(0,_.jsx)(De,{className:"arrowDouble"}),(0,_.jsxs)("span",{children:[(0,_.jsx)("strong",{children:l.speed})," ",(0,O.Jh)("hero.fieldsPerHour")]})]})]})]}),(0,_.jsx)("div",{className:"attributeBox",children:(0,_.jsxs)("div",{className:"heroProduction",children:[(0,_.jsxs)("div",{className:"productionTotal",title:l.productionTitle,children:[(0,_.jsx)("strong",{children:(0,O.Jh)("hero.heroProduction")}),(0,_.jsxs)("div",{className:"productionItem",children:[(0,_.jsxs)("span",{className:"value",children:["+ ",l.baseCropProduction]}),(0,_.jsx)("i",{className:"crop_tiny"})]}),(0,_.jsxs)("div",{className:"productionItem",children:[(0,_.jsxs)("span",{className:"value",children:["+ ",i[this.state.productionType]]}),(0,_.jsx)("i",{className:`${{0:"resources_small",1:"lumber_tiny",2:"clay_tiny",3:"iron_tiny",4:"crop_tiny"}[this.state.productionType]}`})]})]}),(0,_.jsx)("div",{className:"changeProduction",children:[0,1,2,3,4].map((e=>(0,_.jsxs)("div",{className:`resource ${b[e]}`,children:[(0,_.jsx)(F.z,{className:"pickProductionType",active:parseInt(this.state.productionType)===e,iconButton:!0,toggleButton:!0,activeNotClickable:!0,onClick:()=>{this.changeProductionType(e)},children:(0,_.jsx)("i",{className:`${b[e]}`})}),(0,_.jsx)("span",{className:"value",children:i[e]})]},e)))})]})}),(0,_.jsx)("div",{className:"attributeBox",children:(0,_.jsx)("div",{className:"heroAttributes",children:(0,_.jsxs)("div",{className:"attributes formV2",children:[(0,_.jsx)("div",{className:"title",children:(0,O.Jh)("hero.attributes")}),(0,_.jsx)("div",{className:"points_descr",children:(0,O.Jh)("hero.pointsAvailable")}),(0,_.jsx)("div",{className:"pointsAvailable",children:e}),Object.keys(j).map((i=>{const n=j[i];return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsxs)("div",{className:"name",title:n.title,children:[(0,_.jsx)("i",{className:`${x[i]}`}),(0,_.jsx)("span",{children:n.name})]}),(0,_.jsx)(Ra,{color:"blue",primary:n.primary,secondary:n.secondary,hasPlusMinusButtons:l.freePoints>0&&t[i]<l.maxPointsPerAttribute,plusDisabled:0===e||a[i]===l.maxPointsPerAttribute,minusDisabled:a[i]<=t[i],hasSlider:l.freePoints>0&&t[i]<l.maxPointsPerAttribute,sliderStopped:0===e,setValueCallback:e=>this.setPoints(i,e),title:n.title}),(0,O.d_)((0,_.jsx)("label",{className:"points",children:(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:i,ref:e=>this.pointsInputRefs[i]=e,disabled:0===l.freePoints||t[i]===l.maxPointsPerAttribute?"disabled":"",value:s[i],autoComplete:"off",onChange:e=>{this.attributePointsInputHandler(i,e.target.value)}})}),(0,_.jsx)("div",{className:"value",title:n.title,children:this.calculateAttributeValue(i)}),{wrapperClass:"pointsRatio"})]},i)})),(0,_.jsx)(F.z,{id:"savePoints",disabledAttribute:l.freePoints<=e||this.state.saveAttributes,onClick:this.saveAttributes,children:(0,O.Jh)("allgemein.saveChanges")})]})})}),l.heroEquipmentBenefits[0]&&(0,_.jsx)("div",{className:"attributeBox",children:(0,_.jsxs)("div",{className:"heroEquipmentBenefits",children:[(0,_.jsx)("strong",{children:(0,O.Jh)("hero.heroEquipmentBenefits")}),(0,_.jsx)("ul",{children:l.heroEquipmentBenefits.map(((e,t)=>(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{className:"listIcon"}),(0,_.jsx)("span",{className:"benefit",dangerouslySetInnerHTML:{__html:e}})]},t)))})]})}),(0,_.jsxs)("div",{className:"attributeBox",children:[(0,_.jsx)(li,{heroState:r||!1}),(0,_.jsx)("div",{className:"formV2 heroHideSwitch",children:(0,_.jsxs)("label",{className:"switch",children:[(0,_.jsx)("input",{type:"checkbox",name:"attackBehaviour",value:"hide",onChange:this.changeAttackBehaviour,checked:"hide"===n}),(0,_.jsx)("div",{className:"switch"}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("hero.escapeStatusHide")})]})})]})]})}}var ci,di,hi;function ui(){return ui=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ui.apply(this,arguments)}const mi=e=>o.createElement("svg",ui({viewBox:"0 0 21.77 22"},e),ci||(ci=o.createElement("path",{d:"M19.09 2.48a8.82 8.82 0 1 0 .19 12.46 8.81 8.81 0 0 0-.19-12.46Zm-10.66 11a6.51 6.51 0 1 1 9.2-.14 6.51 6.51 0 0 1-9.2.14Zm-2.88 2.29.57.55a1.58 1.58 0 0 1 0 2.22l-2.9 3a1.55 1.55 0 0 1-2.21 0L.48 21a1.55 1.55 0 0 1 0-2.21l2.9-3a1.56 1.56 0 0 1 2.17-.02Z"})),di||(di=o.createElement("path",{className:"horizontal",d:"M15.62 9.8h-5.33a.85.85 0 0 1-.85-.8v-.33a.85.85 0 0 1 .85-.85h5.33a.85.85 0 0 1 .85.85V9a.85.85 0 0 1-.85.8Z"})),hi||(hi=o.createElement("path",{className:"vertical",d:"M14 6.15v5.32a.86.86 0 0 1-.85.86h-.29a.86.86 0 0 1-.85-.86V6.15a.85.85 0 0 1 .85-.85h.29a.85.85 0 0 1 .85.85Z"})));var pi,gi;function vi(){return vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},vi.apply(this,arguments)}const xi=e=>o.createElement("svg",vi({viewBox:"0 0 21 21"},e),pi||(pi=o.createElement("path",{className:"female",d:"M21 .8v4.4a.8.8 0 0 1-.8.8h-.4a.8.8 0 0 1-.8-.8V3.42l-4 4a5.51 5.51 0 0 1-5.71 8.5 5.37 5.37 0 0 1-1.22-.43A6.46 6.46 0 0 0 10.2 14a3.36 3.36 0 0 0 1-.05A3.5 3.5 0 0 0 9.76 7.1a3.53 3.53 0 0 0-2.1 1.35 3.38 3.38 0 0 0-.59 1.36 3.41 3.41 0 0 0 0 1.49 2.44 2.44 0 0 1-1.07.58 2.62 2.62 0 0 1-.79 0l-.06-.21A5.52 5.52 0 0 1 9.37 5.1c.23 0 .46-.08.69-.1h.44a5.51 5.51 0 0 1 3.11 1l4-4H15.8a.8.8 0 0 1-.8-.8V.8a.8.8 0 0 1 .8-.8h4.4a.8.8 0 0 1 .8.8Z"})),gi||(gi=o.createElement("path",{className:"male",d:"M10.82 8.11a2.62 2.62 0 0 0-.79 0 2.46 2.46 0 0 0-1.13.59v.11a3.51 3.51 0 0 1-2.77 4.12 3.41 3.41 0 0 1-1.35 0 2.79 2.79 0 0 1-.39-.1A3.5 3.5 0 0 1 5.8 6a6.55 6.55 0 0 1 2.09-1.45A5.58 5.58 0 0 0 5.41 4 5.57 5.57 0 0 0 0 9.22a5.49 5.49 0 0 0 4.5 5.68V17H3.3a.8.8 0 0 0-.8.8v.4a.8.8 0 0 0 .8.8h1.2v1.2a.8.8 0 0 0 .8.8h.4a.8.8 0 0 0 .8-.8V19h1.2a.8.8 0 0 0 .8-.8v-.4a.8.8 0 0 0-.8-.8H6.5v-2.1A5.53 5.53 0 0 0 11 9.5a5.41 5.41 0 0 0-.18-1.39Z"})));var bi,ji;function fi(){return fi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},fi.apply(this,arguments)}const yi=e=>o.createElement("svg",fi({viewBox:"0 0 10 13"},e),bi||(bi=o.createElement("path",{className:"top",d:"M7.6 5.6V4.4c0-.1.2-3.6-2.6-3.6S2.4 4.1 2.4 4.4v1.2",fill:"none",strokeWidth:1.5,strokeMiterlimit:10,stroke:"#000"})),ji||(ji=o.createElement("path",{className:"bottom",d:"M3.8 8.7C3.7 8 4.3 7.4 5 7.4s1.2.6 1.2 1.3S5.7 9.9 5 9.9s-1.2-.5-1.2-1.2zM10 5.6v6.2c0 .7-.6 1.2-1.3 1.2H1.3C.6 13 0 12.5 0 11.8V5.6c0-.7.6-1.2 1.2-1.2h7.5c.7-.1 1.3.5 1.3 1.2zm-1.2 0H1.3v6.2h7.5V5.6z"})));var Ti;function Ni(){return Ni=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ni.apply(this,arguments)}const Ci=e=>o.createElement("svg",Ni({viewBox:"0 0 16.02 16"},e),Ti||(Ti=o.createElement("path",{d:"M2.35 2.35A8 8 0 1 1 .27 10h2.08A6 6 0 1 0 8 2a5.93 5.93 0 0 0-4.22 1.78L7 7H0V0Z","data-name":"Path 78"})));class Si extends o.Component{constructor(e){super(e),this.previewRef=null}componentDidMount(){this.props.renderPreviewCallback(this.previewRef)}render(){const{selectedPremiumOptions:e,costsSelectedPremiumOptions:t,closeDialogCallback:a,confirmCallback:s,gender:i}=this.props,n=this.props.goldCosts[i];return(0,_.jsxs)("div",{id:"appearanceUnlockOptionsDialog",children:[(0,_.jsx)("div",{className:`unlockOptionsPreview ${i}`,children:(0,_.jsx)("div",{className:"canvasWrapper",ref:e=>this.previewRef=e})}),(0,_.jsx)("h3",{children:(0,O.Jh)("heroAppearance.buyCosmeticOptions")}),(0,_.jsx)("div",{className:"description",children:(0,O.Jh)("heroAppearance.buyDescription")}),(0,_.jsx)("ul",{children:Object.keys(e).map((t=>"colors"===t?Object.keys(e.colors).map((t=>(0,_.jsx)("li",{children:(0,_.jsxs)("div",{className:"optionWrapper",children:[(0,_.jsx)("div",{className:"option",children:(0,O.Jh)("heroAppearance."+t)}),(0,_.jsxs)("div",{className:"goldAmount",children:[(0,_.jsx)(Ka.Z,{className:"goldCoin"})," ",(0,_.jsx)("span",{children:n.colors[t][e.colors[t]]})]})]})},t))):(0,_.jsx)("li",{children:(0,_.jsxs)("div",{className:"optionWrapper",children:[(0,_.jsx)("div",{className:"option",children:(0,O.Jh)("heroAppearance."+t+"Option")}),(0,_.jsxs)("div",{className:"goldAmount",children:[(0,_.jsx)(Ka.Z,{className:"goldCoin"})," ",(0,_.jsx)("span",{children:n[t][e[t]]})]})]})},t)))}),(0,_.jsx)(F.z,{appearance:"grey",className:"cancel",onClick:a,children:(0,O.Jh)("allgemein.cancel_with_capital_c")}),(0,_.jsx)(F.z,{forwardRef:e=>this.confirmButtonRef=e,className:"confirm",goldValue:t,onClick:e=>{s(),a(e)},children:(0,O.Jh)("plus.redeem")})]})}}class ki extends o.Component{static previewWidth=875;static previewHeight=1574;static optionsPerPageWithPagination=12;static optionsPerPageWithoutPagination=15;static colorPaletteByCategory={jaw:"skinColor",eyes:"eyeColor",nose:"skinColor",mouth:null,ears:"skinColor",hair:"hairColor",brows:"hairColor",beard:"hairColor",scar:null,tattoo:null};constructor(e){super(e);let t=ki.colorPaletteByCategory.jaw;this.state={storedHeadConfig:e.headConfig,headConfig:e.headConfig,premiumHeadOptions:e.premiumHeadOptions,unlockableHeadOptions:e.unlockableHeadOptions,goldCosts:e.goldCosts??{},selectedPremiumOptions:{},countSelectedPremiumOptions:0,costsSelectedPremiumOptions:0,storedGender:e.gender,gender:e.gender,activeCategory:"jaw",activeColorPalette:t,zoomedOut:!1,isLoading:!0,isAnimating:!1,unsavedChanges:!1,activePage:0,switchToDefaultPage:!0},this.app=null,this.loader=null,this.sprites={},this.previewRef=null,this.optionRefs={},this.checkOnPremiumOptions=this.checkOnPremiumOptions.bind(this),this.addResourcesByGender=this.addResourcesByGender.bind(this),this.applyTextures=this.applyTextures.bind(this),this.renderOptionPreviews=this.renderOptionPreviews.bind(this),this.extractToCanvas=this.extractToCanvas.bind(this),this.onCategoryClick=this.onCategoryClick.bind(this),this.onOptionClick=this.onOptionClick.bind(this),this.onColorClick=this.onColorClick.bind(this),this.onToggleGenderClick=this.onToggleGenderClick.bind(this),this.onShuffleConfigClick=this.onShuffleConfigClick.bind(this),this.onToggleZoomClick=this.onToggleZoomClick.bind(this),this.openUnlockOptionsDialog=this.openUnlockOptionsDialog.bind(this),this.unlockOptions=this.unlockOptions.bind(this),this.onResetClick=this.onResetClick.bind(this),this.saveChanges=this.saveChanges.bind(this),this.premiumFeature=null}componentDidMount(){const e=this,{layerOrder:t}=this.props,{gender:a}=this.state;Travian.Game.ContextualHelp.check("/hero/appearance"),Travian.TimersAndCounters.suppressReloadEvent(),Ks.Xdb.SCALE_MODE=Ks.aH$.NEAREST,e.app=new Ks.MxU({backgroundAlpha:0,view:document.getElementById("heroAppearancePreview"),width:ki.previewWidth,height:ki.previewHeight}),e.loader=new Xs.aN,t.map((t=>(e.sprites[t]=new Ks.jyi,e.app.stage.addChild(e.sprites[t]),!0))),this.setState({isLoading:!0}),Ks.P6Y.clearTextureCache(),this.addResourcesByGender(a),e.loader.load((()=>{this.applyTextures(),this.renderOptionPreviews(),this.setState({isLoading:!1})}))}componentDidUpdate(e,t,a){const s=t.gender,i=this.state.gender,n=this.state.storedGender,r=JSON.stringify(t.headConfig[i]),l=JSON.stringify(this.state.headConfig[i]),o=JSON.stringify(t.storedHeadConfig[i]),c=JSON.stringify(this.state.storedHeadConfig[i]);if(s!==i||JSON.stringify(r)!==JSON.stringify(l)||JSON.stringify(o)!==JSON.stringify(c)){let e=l!==c||i!==n;this.setState({unsavedChanges:e})}s===i&&JSON.stringify(r)===JSON.stringify(l)||this.checkOnPremiumOptions(),Travian.Tip.refresh()}componentWillUnmount(){Travian.TimersAndCounters.enableReloadEvent()}checkOnPremiumOptions(){const{gender:e}=this.state,t=this.state.headConfig[e],a=this.state.premiumHeadOptions[e],s=this.state.goldCosts[e];let i={},n=0,r=0;Object.keys(t).map((e=>{"colors"===e?Object.keys(t.colors).map((l=>{a.colors[l].some((e=>e===t.colors[l]))&&(i.colors=i.colors??{},i.colors[l]=t.colors[l],r+=s[e][l][t.colors[l]],n++)})):a[e]&&a[e].some((a=>a===t[e]))&&(i[e]=t[e],r+=s[e][t[e]],n++)})),this.setState({selectedPremiumOptions:i,countSelectedPremiumOptions:n,costsSelectedPremiumOptions:r})}addResourcesByGender(e,t){let a=this;const s=this.state.headConfig[e],{layerOrder:i,layerConfigs:n}=this.props,r=Travian.Variables.gpackUrl+"textures/hero/";i.filter((e=>{let a=n[e];return!t||t.colorPalette===a.associatedColor})).map((i=>{let l=n[i];const{associatedColor:o}=l;let c=t?t.colorPalette+"-"+t.color:o?o+"-"+s.colors[o]:null,d=e+"-"+(c??i);!a.loader.resources[d]&&a.loader.add(d,r+d+".json")}))}applyTextures(e){let t=this;const{gender:a}=this.state,{layerOrder:s,layerConfigs:i}=this.props,n=this.state.headConfig[a];s.filter((t=>{let a=i[t];return!e||e.category===a.associatedCategory})).map((s=>{let r=i[s],{associatedCategory:l,associatedColor:o}=r,c=e?e.option:l&&null!==n[l]?n[l]:null;if(!l||l&&null!==c){let e=a+"-"+(o?o+"-"+n.colors[o]:s),i=o?n.colors[o]:null,r=a+(o?"/"+o+"/"+i:"")+"/"+s+"/"+s+(l?c:"")+(i?"-"+i:"");t.sprites[s].texture=this.loader.resources[e].textures[r]}else t.sprites[s].texture=Ks.xEZ.EMPTY}))}renderOptionPreviews(){let e=this;const{gender:t,activeCategory:a}=this.state,s=this.props.headOptions[t],i=this.state.headConfig[t];s[a].map((t=>{e.applyTextures({category:a,option:t});let s=a+"option"+(t||"Empty");e.extractToCanvas(this.optionRefs[s])})),e.applyTextures({category:a,option:i[a]})}extractToCanvas(e){let t=this.app.renderer.plugins.extract.canvas(this.app.stage);e&&(e.innerHTML="",e.appendChild(t))}onCategoryClick(e){const t=e.target.dataset.category,a=ki.colorPaletteByCategory[t];this.setState({activeCategory:t,activeColorPalette:a,switchToDefaultPage:!0},this.renderOptionPreviews)}onOptionClick(e){this.setState((t=>{const{gender:a,activeCategory:s}=this.state,i=e.target.dataset.option?parseInt(e.target.dataset.option):null,n=JSON.parse(JSON.stringify(t));return n.headConfig[a][s]=i,n}),(()=>{const{gender:e,activeCategory:t}=this.state,a=this.state.headConfig[e];this.applyTextures({category:t,option:a[t]})}))}onColorClick(e){const{gender:t,activeColorPalette:a}=this.state,s=e.target.dataset.color;this.setState({isLoading:!0}),Ks.P6Y.clearTextureCache();let i={colorPalette:a,color:s};this.addResourcesByGender(t,i),this.loader.load((()=>{this.setState((e=>{const i=JSON.parse(JSON.stringify(e));return i.headConfig[t].colors[a]=s,i}),(()=>{this.applyTextures(),this.renderOptionPreviews(),this.setState({isLoading:!1})}))}))}onToggleGenderClick(e){this.addResourcesByGender("female"===this.state.gender?"male":"female"),this.setState({isLoading:!0},(()=>{this.loader.load((()=>{this.setState((t=>{const a="female"===t.gender?"male":"female",s=this.props.headOptions[a],i="female"===a&&"beard"===t.activeCategory?Object.keys(s)[1]:t.activeCategory,n=ki.colorPaletteByCategory[i],r=t.headConfig,l=t.selectedPremiumOptions;if(Object.keys(l).length>0){const e=t.storedHeadConfig;Object.keys(l).forEach((a=>{"colors"===a?Object.keys(l.colors).forEach((a=>{r[t.gender].colors[a]=e[t.gender].colors[a]})):r[t.gender][a]=e[t.gender][a]}))}return{headConfig:r,gender:a,activeCategory:i,activeColorPalette:n,activePage:e,switchToDefaultPage:!0}}),(()=>{this.applyTextures(),this.renderOptionPreviews(),this.setState({isLoading:!1})}))}))}))}onShuffleConfigClick(e){const t=this.state.gender,a=this.props.headOptions[t],s=this.state.premiumHeadOptions[t],i=this;this.setState({isLoading:!0,activePage:e,switchToDefaultPage:!0}),Ks.P6Y.clearTextureCache(),this.setState((e=>{const i=JSON.parse(JSON.stringify(e)),n=i.headConfig[t];return Object.keys(a).map((e=>{if("colors"===e)Object.keys(a.colors).filter((e=>"tribeColor"!==e)).map((e=>{let t=a.colors[e].filter((t=>!s.colors[e].includes(t)));t.length>0?n.colors[e]=t[Math.floor(Math.random()*t.length)]:n.colors[e]=null}));else{let t=a[e].filter((t=>!s[e].includes(t)));t.length>0?n[e]=t[Math.floor(Math.random()*t.length)]:n[e]=null}})),i}),(()=>{this.addResourcesByGender(t),i.loader.load((()=>{this.applyTextures(),this.renderOptionPreviews(),this.setState({isLoading:!1})}))}))}onToggleZoomClick(){this.setState((e=>({zoomedOut:!e.zoomedOut})))}openUnlockOptionsDialog(e=!1){if(!e)return!1;const{selectedPremiumOptions:t}=this.state;this.premiumFeature=new Travian.Game.PremiumFeature("hero-appearance",{action:Travian.Constants.ACTION.premiumFeature,[this.state.gender]:t}),this.premiumFeature.sign((e=>{window.Travian.React.Dialog({content:(0,_.jsx)(Si,{gender:this.state.gender,selectedPremiumOptions:t,costsSelectedPremiumOptions:e.gold,goldCosts:this.state.goldCosts,confirmCallback:this.unlockOptions,renderPreviewCallback:this.extractToCanvas}),cssClass:"plain heroV2 contentV2",buttonOk:!1,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0},"consumableDialog")}))}unlockOptions(){const{activeCategory:e,activeColorPalette:t,selectedPremiumOptions:a}=this.state,s=this;this.premiumFeature.book((function(){Travian.Game.Layout.updateGold(),s.setState({isLoading:!0,isAnimating:!0},(()=>{a[e]&&document.querySelector(".optionsWrapper .option"+a[e]+" .lockedIndicator").classList.add("unlocked"),a.colors&&a.colors[t]&&document.querySelector(".colorsWrapper .color."+a.colors[t]+" .lockedIndicator").classList.add("unlocked");let s=document.querySelector(".buttonWrapper button.saveChanges");s.classList.add("unlocked"),s.classList.remove("disabled")})),setTimeout((()=>{s.setState((e=>{const t=Object.assign({},e);let a=t.premiumHeadOptions,s=e.selectedPremiumOptions;return Object.keys(s).map((t=>{"colors"===t?Object.keys(s.colors).map((e=>{let t=a.female.colors[e];t.splice(t.indexOf(s.colors[e]),1),t=a.male.colors[e],t.splice(t.indexOf(s.colors[e]),1)})):a[e.gender][t].splice(a[e.gender][t].indexOf(s[t]),1)})),t}),(()=>{s.setState({isLoading:!1,isAnimating:!1}),s.checkOnPremiumOptions()}))}),3e3)}))}onResetClick(e=!1){if(!e)return!1;const{gender:t,storedHeadConfig:a}=this.state;this.setState((e=>{const s=JSON.parse(JSON.stringify(e));return s.headConfig[t]=a[t],s}),(()=>{this.applyTextures(),this.renderOptionPreviews()}))}saveChanges(e=!1){if(!e)return!1;const{gender:t,headConfig:a}=this.state;let s={data:{gender:t,headConfig:a},success:()=>{this.setState((e=>{const a=JSON.parse(JSON.stringify(e));return a.storedHeadConfig[t]=this.state.headConfig[t],a.storedGender=t,a.unsavedChanges=!1,a}),(()=>{Travian.Game.Hero.refreshInHUD()}))}};Travian.api("hero/v2/appearance/save",s,"POST")}render(){const{gender:e,activeCategory:t,activeColorPalette:a,isLoading:s,isAnimating:i,zoomedOut:n,unsavedChanges:r,selectedPremiumOptions:l,activePage:c,switchToDefaultPage:d}=this.state,h=this.props.headOptions[e],u=this.state.premiumHeadOptions[e],m=this.state.unlockableHeadOptions[e],p=this.state.headConfig[e],g=this.state.storedHeadConfig[e],v=h[t],x=u[t],b=m&&m[t]?m[t]:[],j=p[t],f=v.concat(b),y=[],T=f.length>ki.optionsPerPageWithoutPagination?ki.optionsPerPageWithPagination:ki.optionsPerPageWithoutPagination;let N=null;for(let e=0;e<f.length;e+=T){const t=f.slice(e,e+T);y.push(t),d&&t.some((e=>e===j))&&(N=e/T)}const C=null!==N?N:c,S=h.colors[a],k=u.colors[a],w=p.colors[a],E=0!==Object.keys(l).length&&!i,R=this.state.goldCosts[e],I=JSON.stringify(p)!==JSON.stringify(g);return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("div",{className:"categories",children:Object.keys(h).filter((e=>"colors"!==e)).map((e=>(0,_.jsx)("div",{className:["category",e,t===e?"selected":"",0===h[e].length?"disabled":"",s?"isLoading":""].join(" "),"data-category":e,onClick:this.onCategoryClick,title:(0,O.Jh)("heroAppearance."+e),children:(0,_.jsx)("i",{})},e)))}),(0,_.jsxs)("div",{className:"selectionWrapper "+(i?"isAnimating":""),children:[y.map(((a,i)=>(0,_.jsx)("div",{className:`page page${i} ${C===i?"active":""}`,children:(0,_.jsx)("div",{className:"optionsWrapper",children:a.map((a=>{if(b&&b.some((e=>e===a))){let e=t+"option"+(a||"Empty");return(0,_.jsx)("div",{className:["option unlockable","option"+(a||"Empty"),s?"isLoading":""].join(" "),title:(0,O.Jh)("heroAppearance.unlockable_"+t+"_option"+a)},e)}{let i=t+"option"+(a||"Empty");return(0,_.jsxs)("div",{className:["option","option"+(a||"Empty"),j===a?"selected":"",s?"isLoading":""].join(" "),"data-option":a,onClick:this.onOptionClick,children:[(0,_.jsx)("div",{className:`optionPreview ${e} ${t}`,ref:e=>this.optionRefs[i]=e}),j===a&&(0,_.jsx)("div",{className:"selectedIndicator"}),x.some((e=>e===a))&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"lockedIndicator",children:(0,_.jsx)(yi,{className:"lock big"})}),(0,_.jsxs)("div",{className:"goldAmount",children:[(0,_.jsx)(Ka.Z,{className:"goldCoin"})," ",(0,_.jsx)("span",{children:R&&R[t][a]})]})]})]},i)}}))})},`page${i}`))),y.length>1&&(0,_.jsx)(is.tl,{currentPage:C,pageCount:y.length,switchPage:e=>{this.setState({activePage:e,switchToDefaultPage:!1})}}),(0,_.jsxs)("div",{className:"previewWrapper",children:[(0,_.jsx)("div",{className:`preview ${e} ${n?"zoomedOut":"zoomedIn"} ${s?"isLoading":""}`,children:(0,_.jsx)("canvas",{id:"heroAppearancePreview",ref:e=>this.previewRef=e})}),(0,_.jsxs)("div",{className:"actions",children:[(0,_.jsx)(F.z,{iconButton:!0,className:["toggleGender",e,s?"isLoading":""].join(" "),title:(0,O.Jh)("heroAppearance.toggleGender"),onClick:()=>this.onToggleGenderClick(C),children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(xi,{className:"outline"}),(0,_.jsx)(xi,{className:"icon"})]})}),(0,_.jsx)(F.z,{iconButton:!0,className:["shuffleConfig",s?"isLoading":""].join(" "),title:(0,O.Jh)("heroAppearance.shuffle"),onClick:()=>this.onShuffleConfigClick(C),children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(ds,{className:"outline"}),(0,_.jsx)(ds,{className:"icon"})]})}),(0,_.jsx)(F.z,{iconButton:!0,className:"toggleZoom {isLoading ? 'isLoading' : ''}",title:(0,O.Jh)("heroAppearance."+(n?"zoomIn":"zoomOut")),onClick:this.onToggleZoomClick,children:(0,_.jsxs)("svg",{className:n?"zoomIn":"zoomOut",children:[(0,_.jsx)(mi,{className:"outline"}),(0,_.jsx)(mi,{className:"icon"})]})})]})]}),a&&(0,_.jsxs)("div",{className:"colorsWrapper",children:[(0,_.jsx)("div",{className:"colorPalette",children:(0,O.Jh)("heroAppearance."+a)}),(0,_.jsx)("div",{className:`colors ${a}`,children:S.map((e=>{let t=a+e;return(0,_.jsxs)("div",{className:["color",e,w===e?"selected":"",s?"isLoading":""].join(" "),"data-color":e,onClick:this.onColorClick,children:[(0,_.jsx)("div",{className:`colorPreview ${e}`}),w===e&&(0,_.jsx)("div",{className:"selectedIndicator"}),k.some((t=>t===e))&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"lockedIndicator",children:(0,_.jsx)(yi,{className:"lock small"})}),(0,_.jsxs)("div",{className:"goldAmount",children:[(0,_.jsx)(Ka.Z,{className:"goldCoin"})," ",(0,_.jsx)("span",{children:R.colors[a][e]})]})]})]},t)}))})]})]}),(0,_.jsxs)("div",{className:"buttonWrapper",children:[(0,_.jsx)(F.z,{appearance:"gold",className:["buyOptions",s?"isLoading":""].join(" "),disabledClass:!E,onClick:e=>this.openUnlockOptionsDialog(E),children:(0,O.Jh)(E?"heroAppearance.selectedBuyOptions":"heroAppearance.noBuyOptions")}),E&&(0,_.jsxs)("div",{className:"costsWrapper",children:[(0,_.jsxs)("div",{className:"selectedOptions",children:[(0,O.Jh)("heroAppearance.selectedOptions"),": ",this.state.countSelectedPremiumOptions]}),(0,_.jsxs)("div",{className:"costs",children:[(0,_.jsx)(Ka.Z,{}),(0,_.jsx)("span",{children:this.state.costsSelectedPremiumOptions})]})]}),(0,_.jsx)(F.z,{className:["resetChanges",s?"isLoading":""].join(" "),disabledClass:!I,iconButton:!0,title:(0,O.Jh)("heroAppearance.resetChanges"),onClick:e=>this.onResetClick(I),children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(Ci,{className:"outline"}),(0,_.jsx)(Ci,{className:"icon"})]})}),(0,_.jsx)(F.z,{title:E?(0,O.Jh)("heroAppearance.saveChanges_disabled"):(0,O.Jh)("heroAppearance.saveChanges"),className:["saveChanges",s?"isLoading":""].join(" "),disabledClass:!r||E,onClick:e=>this.saveChanges(r&&!E),children:(0,O.Jh)("heroAppearance.saveChanges")})]})]})}}var wi,Ei=a(9693),Ri=a.n(Ei);class Ii extends o.Component{static propTypes={options:d().shape({content:d().oneOfType([d().string,d().object]).isRequired,version:d().number,cssClass:d().string,fullSize:d().bool,allowMobileSidebars:d().bool,buttonOk:d().bool,buttonTextOk:d().string,buttonCloseOnClickOk:d().bool,buttonCancel:d().bool,elementFocus:d().string,relativeTo:d().shape({element:d().string,position:d().oneOf(["center","above","below","before","after"]),offset:d().number}),title:d().string,useEscKey:d().bool,preventFormSubmit:d().bool,overlayCancel:d().bool,enableBackground:d().bool,darkOverlay:d().bool,infoIcon:d().oneOfType([d().string,d().func]),buttonTextInfo:d().string,onOkay:d().func,onFormSubmit:d().func,onClose:d().func,onOpen:d().func}).isRequired,closeCallback:d().func.isRequired};constructor(e){super(e);const t={version:2,cssClass:null,fullSize:!1,allowMobileSidebars:!1,buttonOk:!0,buttonTextOk:Travian.Translation.get("allgemein.ok"),buttonCloseOnClickOk:!1,buttonCancel:!0,elementFocus:".dialogButtonOk",relativeTo:null,title:null,useEscKey:!0,preventFormSubmit:!1,overlayCancel:!0,enableBackground:!0,darkOverlay:!1,infoIcon:null,buttonTextInfo:null,onOkay:()=>{},onFormSubmit:()=>{},onClose:()=>{},onOpen:()=>{}};this.options=Object.assign(t,e.options),null===this.options.cssClass&&2===this.options.version&&(this.options.cssClass="basic"),this.clickedOnOverlay=!1,this.state={visible:!1},this.backgroundClickCallback=this.backgroundClickCallback.bind(this),this.backgroundTouchCallback=this.backgroundTouchCallback.bind(this),this.onInfoIconClick=this.onInfoIconClick.bind(this),this.onFormSubmit=this.onFormSubmit.bind(this),this.onOkayButtonClick=this.onOkayButtonClick.bind(this),this.updatePosition=this.updatePosition.bind(this),this.calculatePosition=this.calculatePosition.bind(this),this.setPosition=this.setPosition.bind(this),this.closeDialog=this.closeDialog.bind(this),this.elements={infoIcon:o.createRef(),overlay:o.createRef(),dialogWrapper:o.createRef()},this.overlaySize={width:0,height:0}}componentDidMount(){let e=this;e.setState({visible:!0}),e.options.onOpen(),Travian.Game.Layout.MobileOptimizations.fixNumericKeyboardOnIOS(),e.options.fullSize&&document.getElementById("reactDialogWrapper").classList.add("fullSize"),e.options.buttonTextInfo&&Travian.Tip.set(e.elements.infoIcon.current,e.options.buttonTextInfo);let t=document.querySelector(e.options.elementFocus);t&&t.focus(),e.options.useEscKey&&document.querySelector("body").addEventListener("keyup",(t=>{"Escape"===t.key&&e.closeDialog()}),{once:!0}),e.overlaySize={width:e.elements.overlay.current.clientWidth,height:e.elements.overlay.current.clientHeight},void 0!==e.options.relativeTo&&(e.updatePosition(),["scroll","resize"].forEach((e=>{window.addEventListener(e,this.updatePosition)})))}backgroundClickCallback(){this.options.overlayCancel&&this.clickedOnOverlay&&this.closeDialog()}backgroundTouchCallback(e){"string"==typeof e.target.className&&-1!==e.target.className.indexOf("dialogOverlay")&&(this.clickedOnOverlay=!0)}onInfoIconClick(){return"string"==typeof this.options.infoIcon?window.open(this.options.infoIcon,"_blank"):"function"==typeof this.options.infoIcon?this.options.infoIcon():void 0}onFormSubmit(e){if(this.options.onOkay(),this.options.onFormSubmit(e,this.props.closeCallback),this.options.preventFormSubmit)return e.preventDefault(),!1}onOkayButtonClick(e){this.options.buttonCloseOnClickOk&&(e.preventDefault(),this.closeDialog())}updatePosition(){if(null!==this.options.relativeTo){let e=this.calculatePosition();this.setPosition({x:e.left,y:e.top})}}calculatePosition(){let e=window.scrollX,t=window.scrollY,a=document.querySelector("body"),s=this.overlaySize.width,i=this.overlaySize.height,n=this.elements.dialogWrapper.current.clientWidth,r=this.elements.dialogWrapper.current.clientHeight,l=document.querySelector(this.options.relativeTo.element);null===l&&(l=a);let o=l.clientWidth,c=l.clientHeight,d=l.getBoundingClientRect(),h={x:d.left+e,y:d.top+t};h.x=this.checkValue(h.x),h.y=this.checkValue(h.y);let u={left:0,top:0};const m=this.options.relativeTo.offset??0;switch(this.options.relativeTo.position){case"above":u.left=h.x+o/2-n/2-e,u.top=h.y-r-m-t;break;case"below":u.left=h.x+o/2-n/2-e,u.top=h.y+c+m-t;break;case"before":u.left=h.x-n-m-e,u.top=h.y+c/2-r/2-t;break;case"after":u.left=h.x+o+m-e,u.top=h.y+c/2-r/2-t;break;default:u.left=h.x+o/2-n/2-e,u.top=h.y+c/2-r/2-t}return u.left=this.checkValue(u.left,5),u.top=this.checkValue(u.top,40),u.top+r>i&&(u.top=i-r),u.top<0&&(u.top=0),u.left+n>s&&(u.left=s-n),u.left<0&&(u.left=0),u}setPosition(e){return this.elements.dialogWrapper.current.style.left=e.x+"px",this.elements.dialogWrapper.current.style.top=e.y+"px",e}checkValue(e,t){return e<0?t||0:e}closeDialog(){this.options.onClose(),this.setState({visible:!1},(()=>{window.setTimeout((()=>{this.options.fullSize&&document.getElementById("reactDialogWrapper").classList.remove("fullSize"),["scroll","resize"].forEach((e=>{window.removeEventListener(e,this.updatePosition)})),this.props.closeCallback()}),400)}))}render(){const{content:e,cssClass:t,enableBackground:a,darkOverlay:s,allowMobileSidebars:i,title:n,infoIcon:r,buttonOk:l,buttonTextOk:c,buttonCancel:d}=this.options,{visible:h}=this.state;let u=null;return u=Ri().compositeTypeElement(e)?o.cloneElement(e,{closeDialogCallback:this.closeDialog}):"string"==typeof e||e instanceof String?(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:e}}):e,(0,_.jsx)("div",{className:["dialogOverlay",h?"dialogVisible":"",a?"enabled":"",s?"dark":"",i?"allowMobileSidebars":""].join(" "),onClick:this.backgroundClickCallback,onTouchStart:e=>this.backgroundTouchCallback(e),onMouseDown:e=>this.backgroundTouchCallback(e),ref:this.elements.overlay,children:(0,_.jsx)("div",{className:"dialogWrapper dialogV2","data-context":"",ref:this.elements.dialogWrapper,children:(0,_.jsx)("div",{className:["dialog",t].join(" "),children:(0,_.jsx)("div",{className:"dialogContainer",children:(0,_.jsx)("div",{className:"dialogContents",children:(0,_.jsxs)("form",{action:"?",method:"get",acceptCharset:"UTF-8",onSubmit:e=>this.onFormSubmit(e),children:[(0,_.jsx)("div",{className:"dialogDragBar"}),r&&(0,_.jsx)("div",{className:"iconButton buttonFramed green withIcon rectangle info",ref:this.elements.infoIcon,onClick:this.onInfoIconClick}),d&&(0,_.jsx)("div",{className:"dialogCancelButton iconButton buttonFramed green withIcon rectangle cancel",onClick:this.closeDialog,children:(0,_.jsxs)("svg",{viewBox:"0 0 20 20",children:[(0,_.jsx)("g",{className:"outline",children:(0,_.jsx)("path",{d:"M0 17.01L7.01 10 .14 3.13 3.13.14 10 7.01 17.01 0 20 2.99 12.99 10l6.87 6.87-2.99 2.99L10 12.99 2.99 20 0 17.01z"})}),(0,_.jsx)("g",{className:"icon",children:(0,_.jsx)("path",{d:"M0 17.01L7.01 10 .14 3.13 3.13.14 10 7.01 17.01 0 20 2.99 12.99 10l6.87 6.87-2.99 2.99L10 12.99 2.99 20 0 17.01z"})})]})}),n&&(0,_.jsx)("div",{className:"title",children:n}),(0,_.jsx)("div",{className:"content",id:"dialogContent",children:u}),l&&(0,_.jsx)("div",{className:"buttons",children:(0,_.jsx)(F.z,{className:"dialogButtonOk",onClick:e=>this.onOkayButtonClick(e),children:c})})]})})})})})})}}function Oi(){return Oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Oi.apply(this,arguments)}const _i=e=>o.createElement("svg",Oi({viewBox:"0 0 20 18.54"},e),wi||(wi=o.createElement("path",{d:"M3.31 4.7h8.5l-1.3 1.37h-7.2zm0 4.85h3.91l1.3-1.37H3.31zm0 3.47h3.45l.06-1.37H3.31zM17.16 1.29l-.94 1-1.43 1.5L13 5.66l-.49.51-2 2.11-1.26 1.37-.81.86-.06 1.24-.07 1.37v.51l3-.44 3.25-3.43.16-.17L20 4zm-.59 12l-.19-3.44L15 11.26a.61.61 0 0 0-.16.45l.07 1a.57.57 0 0 1-.15.43l-3.26 3.58a.57.57 0 0 1-.43.19H2.54a.58.58 0 0 1-.54-.58V2.53a.58.58 0 0 1 .58-.59h11a.59.59 0 0 0 .42-.17L15.7 0H.58A.58.58 0 0 0 0 .58V18a.58.58 0 0 0 .58.58H11.8a.57.57 0 0 0 .43-.19l4.19-4.66a.53.53 0 0 0 .15-.46z"})));var Ai;function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Di.apply(this,arguments)}const Li=e=>o.createElement("svg",Di({viewBox:"0 0 128.01 89.4"},e),Ai||(Ai=o.createElement("path",{d:"M6.2 5.3a9.82 9.82 0 0 1-2.1-4.08L5.22 0h103.31a9 9 0 0 1 .89 1.15 9.78 9.78 0 0 1-2.12 4.15L68.13 49.82a14.77 14.77 0 0 1-20.78 2 15.43 15.43 0 0 1-2-2zM120 52h-10.57V41.52a8 8 0 0 0-8-8h-3a8 8 0 0 0-8 8V52H80a8 8 0 0 0-8 8v3a8 8 0 0 0 8 8h10.53v10.4a8 8 0 0 0 8 8h3a8 8 0 0 0 8-8V70.91H120a8 8 0 0 0 8-8V60a8 8 0 0 0-8-8zm-6.72-17.6V16L103 27.68a13.68 13.68 0 0 1 10.29 6.72zM84.82 76.67h-5A13.69 13.69 0 0 1 66.44 66a23.57 23.57 0 0 1-26.2-4.69l-27.71 6.21 20-14.82L0 15.7v54c0 5.23 3.75 9.49 8.35 9.49h76.47z"})));var Pi;function Bi(){return Bi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Bi.apply(this,arguments)}const Mi=e=>o.createElement("svg",Bi({viewBox:"0 0 93.75 104.17"},e),Pi||(Pi=o.createElement("path",{d:"M93.75 104.17H0C0 86.5 6.73 70.74 17.27 60.39a37.74 37.74 0 0 0 59.2 0C87 70.74 93.75 86.5 93.75 104.17zM74.61 13.51a33.5 33.5 0 0 0-7.51-7.19A35.07 35.07 0 0 0 46.88 0c-19 0-34.34 14.73-34.34 32.89a31.85 31.85 0 0 0 6.59 19.39 33.76 33.76 0 0 0 7.52 7.19 35.17 35.17 0 0 0 20.23 6.32c19 0 34.33-14.72 34.33-32.9a31.89 31.89 0 0 0-6.6-19.38zM23.16 32.89c0-12.53 10.64-22.71 23.72-22.71a24.28 24.28 0 0 1 12.57 3.47L26.79 44.94a21.78 21.78 0 0 1-3.63-12.05zm23.72 22.73a24.35 24.35 0 0 1-12.58-3.47L67 20.84a21.78 21.78 0 0 1 3.63 12.05C70.59 45.42 60 55.62 46.88 55.62z"})));var Ji;function Zi(){return Zi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Zi.apply(this,arguments)}const Fi=e=>o.createElement("svg",Zi({viewBox:"0 0 121.68 98.77"},e),Ji||(Ji=o.createElement("path",{d:"M119.54 76.74L72.11 8.7C66.74 1 54.39 1 49.07 8.75l-47 68c-5.7 8.28.82 19 11.55 19H108c10.78.09 17.3-10.75 11.54-19.01zm-67-45.2a6.93 6.93 0 0 1 6.93-6.94h2.78a6.94 6.94 0 0 1 6.94 6.94v26.12a6.94 6.94 0 0 1-6.94 6.94h-2.8a6.93 6.93 0 0 1-6.93-6.94zm8.32 55.89A8.41 8.41 0 1 1 69.25 79a8.41 8.41 0 0 1-8.41 8.43z"})));var Vi;function Hi(){return Hi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Hi.apply(this,arguments)}const qi=e=>o.createElement("svg",Hi({viewBox:"0 0 20 14.5"},e),Vi||(Vi=o.createElement("path",{d:"M14.12 4.16a1.69 1.69 0 0 1-1.69 1.18A3.08 3.08 0 0 1 10.87 5c-.16-.07-1.1-.65-1.1-.65a2.88 2.88 0 0 1-.83.76l-.62.38a3.82 3.82 0 0 0-.15.67l-4.34 3a.49.49 0 0 0-.21.41.47.47 0 0 0 .09.28.48.48 0 0 0 .55.19l3.9-2.69a4 4 0 0 0 .15.7l-3.63 2.53-.09.06a.47.47 0 0 0-.12.32.49.49 0 0 0 .09.28.51.51 0 0 0 .7.12l.1-.06a.77.77 0 0 1 .19-.17l3.17-2.19V9a6.61 6.61 0 0 0 .37.55l-3.19 2.2a.49.49 0 0 0 0 .58.5.5 0 0 0 .69.13l3-2.05.44.71-1.91 1.36a.49.49 0 0 0-.22.41.51.51 0 0 0 .09.28.51.51 0 0 0 .7.12l1.8-1.29c.25.42.42.74.33.69L8.89 14a1.12 1.12 0 0 1-.67.22 1.19 1.19 0 0 1-1-.51A1.21 1.21 0 0 1 7 13l-.11.07a1.12 1.12 0 0 1-.67.22A1.18 1.18 0 0 1 5 12.14a1.19 1.19 0 0 1-1-.51 1.14 1.14 0 0 1-.2-.87 1.17 1.17 0 0 1-.46-2.13l1.91-1.32a3 3 0 0 1-1.25.3c-.35 0-.76 0-1-.18a4.54 4.54 0 0 1-.62-1.19l2.18-4.86a4.32 4.32 0 0 0 1.93.44C7.77 1.82 8.2.64 9.23.61a1.1 1.1 0 0 1 .69.39 7.59 7.59 0 0 0 1.91 1.5 5.82 5.82 0 0 0 1.17.17 1.32 1.32 0 0 1 1.12 1.49ZM16.91 0l-1.08.51a.49.49 0 0 0-.25.66L18 6.62a.51.51 0 0 0 .66.26l1.08-.47a.51.51 0 0 0 .26-.66L17.57.3a.51.51 0 0 0-.66-.3ZM0 5.61 2.32.53A.51.51 0 0 1 3 .28l.82.37a.5.5 0 0 1 .25.66L1.78 6.39a.49.49 0 0 1-.66.25L.3 6.27a.5.5 0 0 1-.3-.66Zm15.11-4.5.36.84-3.09.22-1.06-.9ZM19.47 9h-2.92V6.23H14.1V9h-2.91v2.44h2.91v3h2.45v-3h2.92Z"}))),Ui=e=>{const{uid:t,closeDialogCallback:a,updateData:s}=e,[i,n]=(0,o.useState)(e.note??"");return(0,_.jsxs)("div",{className:"playerNoteDialog formV2",children:[(0,_.jsx)("strong",{children:(0,O.Jh)("spieler.personalNote")}),(0,_.jsx)("p",{children:(0,O.Jh)("spieler.personalNote_description")}),(0,_.jsx)("label",{className:"textarea fixed",children:(0,_.jsx)("textarea",{name:"playerNote",onChange:e=>n(e.target.value),cols:"",rows:"",maxLength:500,tabIndex:6,defaultValue:i,placeholder:(0,O.Jh)("spieler.personalNote_placeholder")})}),(0,_.jsxs)("div",{className:"characterLimit",children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("spieler.maxLength"),": "]}),(0,_.jsx)("span",{children:(0,O.T_)(i.length,500,{})})]}),(0,_.jsxs)("div",{className:"buttonsWrapper",children:[(0,_.jsx)(F.z,{appearance:"grey",onClick:a,children:(0,O.Jh)("allgemein.cancel_with_capital_c")}),(0,_.jsx)(F.z,{onClick:function(){Travian.api("player/update-note",{data:{playerId:t,note:i,action:"account"},success:function(){a(),s()}})},children:(0,O.Jh)("allgemein.save_with_capital_s")})]})]})},zi=e=>{const{uid:t,closeDialogCallback:a}=e,[s,i]=(0,o.useState)(""),[n,r]=(0,o.useState)(!1),l=(0,o.useRef)();(0,o.useEffect)((()=>{(new O.w3).attach(l.current)}),[]);return(0,_.jsxs)("div",{className:"accusePlayerDialog formV2",ref:l,children:[(0,_.jsx)("strong",{children:(0,O.Jh)("spieler.reportPlayer")}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsxs)("select",{onChange:e=>{r("inappropriateContent"===e.target.value)},size:1,name:"reason",required:"required",defaultValue:"",children:[(0,_.jsx)("option",{value:"",disabled:"disabled"}),Object.keys(e.accusationKeyToTranslationMapping).map((t=>(0,_.jsx)("option",{value:t,dangerouslySetInnerHTML:{__html:(0,O.Jh)(e.accusationKeyToTranslationMapping[t])}},t)))]}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("spieler.reportPlayer_chooseReason")}),(0,_.jsx)("div",{className:"validation","data-rule":"notEmpty",children:(0,O.Jh)("spieler.reportPlayer_chooseReason")})]}),n&&(0,_.jsx)("p",{className:"alert inappropriateContentNotice",children:(0,O.Jh)("spieler.inappropriateContent_description")}),(0,_.jsxs)("label",{className:"textarea",children:[(0,_.jsx)("textarea",{name:"message",onChange:e=>i(e.target.value),cols:"",rows:"",maxLength:300,defaultValue:s}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("spieler.additionalComments")})]}),(0,_.jsxs)("div",{className:"characterLimit",children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("spieler.maxLength"),": "]}),(0,_.jsx)("span",{children:(0,O.T_)(s.length,300,{})})]}),(0,_.jsx)("p",{className:"notice",children:(0,O.Jh)("spieler.reportPlayer_reportsPerDayWarning",{INT:Travian.Constants.PROFILE_MAX_ACCUSATIONS_PLAYER_CAN_CREATE})}),(0,_.jsx)("input",{type:"hidden",name:"uid",value:t}),(0,_.jsxs)("div",{className:"buttonsWrapper",children:[(0,_.jsx)(F.z,{appearance:"grey",onClick:a,children:(0,O.Jh)("allgemein.cancel_with_capital_c")}),(0,_.jsx)(F.z,{type:"submit",children:(0,O.Jh)("spieler.reportButton")})]})]})};var $i=a(7762);const Wi=e=>{const{updateData:t}=e,a=e.data;(0,o.useEffect)((()=>{Travian.Tip.refresh()}));let s="",i=!1;switch(!0){case a.messagesBan.isActive&&!a.isAllianceMember:s=$i.renderToString((0,_.jsx)("div",{className:"notice",children:a.messagesBan.details})),i=!0;break;case!a.readWriteMessages:s=$i.renderToString((0,_.jsx)("div",{className:"notice",children:(0,O.Jh)("spieler.sitter_not_allowed_only_with_right")})),i=!0;break;default:s=(0,O.Jh)("spieler.nachricht_schreiben")}let n="",r=!1;switch(!0){case a.isPlayerBanned:n=$i.renderToString((0,_.jsx)("span",{className:"notice",children:(0,O.Jh)("spieler.reportPlayer_notAllowedWhenBanned")})),r=!0;break;case a.accusingOthersLeft<=0:n=$i.renderToString((0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"notice",children:(0,O.Jh)("spieler.reportPlayer_noReportsLeftForToday")}),(0,_.jsx)("span",{children:(0,O.Jh)("spieler.reportPlayer_reportsPerDayWarning",{INT:Travian.Constants.PROFILE_MAX_ACCUSATIONS_PLAYER_CAN_CREATE})})]})),r=!0;break;default:n=(0,O.Jh)("spieler.reportPlayer")}let l="",c=!1;switch(!0){case a.isAllianceMember:l=(0,O.Jh)("spieler.allianceMember"),c=!0;break;case a.isPlayerInvited:l=(0,O.Jh)("spieler.invitedPlayer"),c=!0;break;default:l=(0,O.Jh)("spieler.invitePlayer")}return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"actionButtons",children:[!a.isPlayerSitted&&(0,_.jsx)(F.z,{className:"notes",iconButton:!0,title:(0,O.Jh)("spieler.note"),onClick:()=>window.Travian.React.Dialog({content:(0,_.jsx)(Ui,{uid:a.uid,note:a.personalNote,updateData:t}),cssClass:"plain contentV2 playerProfile",buttonOk:!1,buttonCancel:!1,enableBackground:!0,darkOverlay:!0,preventFormSubmit:!0},"playerNoteDialog"),children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(_i,{className:"outline"}),(0,_.jsx)(_i,{className:"icon"})]})}),a.interactionPossible&&(0,_.jsxs)(_.Fragment,{children:[!a.isPlayerIgnoring&&(0,_.jsx)(F.z,{href:i?null:`/messages/write?to=${a.uid}`,iconButton:!0,className:"message",disabledClass:i,title:s,children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(Li,{className:"outline"}),(0,_.jsx)(Li,{className:"icon"})]})}),a.allowedToIgnore&&(0,_.jsx)(F.z,{classname:"ignore",active:a.isPlayerIgnoring,iconButton:!0,toggleButton:!0,title:(0,O.Jh)(a.isPlayerIgnoring?"spieler.unignore_tooltip":"spieler.ignorieren_tooltip"),onClick:()=>{return e=!a.isPlayerIgnoring,void Travian.api("player/ignore",{data:{ignore:e,playerId:a.uid},success:()=>{t()}});var e},disabledAttribute:a.ignoredListIsFull&&!a.isPlayerIgnoring,children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(Mi,{className:"outline"}),(0,_.jsx)(Mi,{className:"icon"})]})}),!a.isPlayerSitted&&(0,_.jsx)(F.z,{className:"accusation",iconButton:!0,disabledClass:r,title:n,onClick:r?()=>{}:()=>window.Travian.React.Dialog({content:(0,_.jsx)(zi,{uid:a.uid,accusationKeyToTranslationMapping:a.accusationKeyToTranslationMapping}),cssClass:"plain contentV2 playerProfile",buttonOk:!1,buttonCancel:!1,enableBackground:!0,darkOverlay:!0,preventFormSubmit:!0,onFormSubmit:(e,a)=>((e,t,a)=>{const s=Object.fromEntries(new FormData(e.target).entries()),i=s.uid;delete s.uid,t(),Travian.api("accusePlayer/"+i,{data:s,success:()=>{a(),window.Travian.React.Dialog({content:(0,_.jsx)("p",{className:"success",children:(0,O.Jh)("spieler.reportPlayer_successMessage")}),cssClass:"plain contentV2 playerProfile",buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,darkOverlay:!0},"accusePlayerDialogSuccess")}})})(e,a,t)},"accusePlayerDialog"),children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(Fi,{className:"outline"}),(0,_.jsx)(Fi,{className:"icon"})]})}),a.hasRightToSentInvitation&&!a.isPlayerSitted&&(0,_.jsx)(F.z,{className:"invite",iconButton:!0,disabledClass:c,title:l,onClick:c?()=>{}:()=>{Travian.api("alliance/invite",{data:{playerId:a.uid},success:()=>{t()}})},children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(qi,{className:"outline"}),(0,_.jsx)(qi,{className:"icon"})]})})]})]}),(0,_.jsxs)("div",{className:"notification",children:[a.isPlayerIgnoring&&(0,_.jsx)("p",{children:(0,_.jsx)("span",{className:"notice",children:(0,O.Jh)("spieler.player_is_ignored")})}),!a.isPlayerIgnoring&&a.allowedToIgnore&&a.ignoredListIsFull&&(0,_.jsxs)("p",{children:[(0,_.jsx)("span",{className:"warning",children:(0,O.Jh)("spieler.ignore_list_full")}),(0,_.jsxs)("a",{href:"/messages/ignore",children:[" ",(0,O.Jh)("spieler.edit_ignore_list")]})]}),a.isPlayerInvited&&!a.isPlayerSitted&&a.hasRightToSentInvitation&&(0,_.jsx)("p",{className:"notice",dangerouslySetInnerHTML:{__html:(0,O.Jh)("allianz.sentInvitation",{NAME:a.playerName,LINK:'<a href="/alliance/options/invite">',"/LINK":"</a>"})}})]})]})};var Gi=a(9632),Yi=a.n(Gi);class Ki{constructor(e,t){this.translationFunction=e,this.playerMedalData=t??{medalsGameworld:[],medalsLifetime:[]},this.configuration=this.getConfiguration(),this.usedMedals=[]}getConfiguration(){return{bold:{tag:this.translationFunction("bbcode.bold_tag"),type:"surrounded",title:this.translationFunction("bbcode.buttonBold"),replacement:e=>(0,_.jsx)("span",{style:{fontWeight:"bold"},children:e})},italic:{tag:this.translationFunction("bbcode.italic_tag"),type:"surrounded",title:this.translationFunction("bbcode.buttonItalic"),replacement:e=>(0,_.jsx)("span",{style:{fontStyle:"italic"},children:e})},underscore:{tag:this.translationFunction("bbcode.underscore_tag"),type:"surrounded",title:this.translationFunction("bbcode.buttonUnderscore"),replacement:e=>(0,_.jsx)("span",{style:{textDecoration:"underline"},children:e})},alliance:{tag:this.translationFunction("bbcode.alliance_tag"),type:"surrounded",title:this.translationFunction("bbcode.buttonAlliance"),preProcess:e=>{const t=Number(e);return isNaN(t)?e:t},replacement:e=>null===e?(0,_.jsx)("span",{style:{fontStyle:"italic"},children:this.translationFunction("bbcode.alliance_not_found")}):(0,_.jsx)("a",{href:`/alliance/${e.id}`,children:e.tag}),resolvableType:"alliance"},player:{tag:this.translationFunction("bbcode.player_tag"),type:"surrounded",title:this.translationFunction("bbcode.buttonPlayer"),preProcess:e=>{const t=Number(e);return isNaN(t)?e:t},replacement:e=>null===e?(0,_.jsx)("span",{style:{fontStyle:"italic"},children:this.translationFunction("bbcode.player_not_found")}):(0,_.jsx)("a",{href:`/profile/${e.id}`,children:e.name}),resolvableType:"player"},coordinate:{tag:this.translationFunction("bbcode.coordinate_tag"),type:"surrounded",title:this.translationFunction("bbcode.buttonCoordinate"),preProcess:e=>{const t=(e=e.replace("(","").replace(")","").replace(/\u2212/g,"-")).indexOf(",")>-1?e.split(","):e.split("|");if(t.length<2)return null;const a=Number(t[0]),s=Number(t[1]);return{x:isNaN(a)?t[0]:a,y:isNaN(s)?t[1]:s}},replacement:e=>null===e?(0,_.jsx)("span",{style:{fontStyle:"italic"},children:this.translationFunction("bbcode.coordinate_not_found")}):(0,_.jsx)("a",{className:"bbCoordsLink",href:`/karte.php?d=${e.id}`,children:e.name}),resolvableType:"coordinate"},report:{tag:this.translationFunction("bbcode.report_tag"),type:"surrounded",title:this.translationFunction("bbcode.buttonReport"),replacement:(e,t)=>e.allowed?e.id&&e.allianceId?(0,_.jsx)("a",{href:`/report?id=${e.id}&aid=${e.allianceId}`,dangerouslySetInnerHTML:{__html:e.message}}):(0,_.jsx)("a",{href:`/report?id=${t}`,dangerouslySetInnerHTML:{__html:e.message}}):(0,_.jsx)("a",{children:e.message}),resolvableType:"report"},resource:{replacement:e=>(0,_.jsx)("i",{className:`r${e}`,title:`allgemein.r${e}`}),tags:{[Travian.Constants.RES_LUMBER]:{type:"singleWithBrackets",tag:this.translationFunction("bbcode.resource_tag_lumber"),replacementParameter:Travian.Constants.RES_LUMBER},[Travian.Constants.RES_CLAY]:{type:"singleWithBrackets",tag:this.translationFunction("bbcode.resource_tag_claim"),replacementParameter:Travian.Constants.RES_CLAY},[Travian.Constants.RES_IRON]:{type:"singleWithBrackets",tag:this.translationFunction("bbcode.resource_tag_iron"),replacementParameter:Travian.Constants.RES_IRON},[Travian.Constants.RES_CROP]:{type:"singleWithBrackets",tag:this.translationFunction("bbcode.resource_tag_grain"),replacementParameter:Travian.Constants.RES_CROP}},title:"bbcode.buttonResource"},smilies:{replacement:e=>(0,_.jsx)("img",{className:`smiley ${e}`,src:"/img/x.gif"}),tags:{aha:{type:"single",tag:"*aha*",replacementParameter:"aha"},angry:{type:"single",tag:"*angry*",replacementParameter:"angry"},cool:{type:"single",tag:"*cool*",replacementParameter:"cool"},cry:{type:"single",tag:"*cry*",replacementParameter:"cry"},cute:{type:"single",tag:"*cute*",replacementParameter:"cute"},depressed:{type:"single",tag:"*depressed*",replacementParameter:"depressed"},eek:{type:"single",tag:"*eek*",replacementParameter:"eek"},ehem:{type:"single",tag:"*ehem*",replacementParameter:"ehem"},emotional:{type:"single",tag:"*emotional*",replacementParameter:"emotional"},hit:{type:"single",tag:"*hit*",replacementParameter:"hit"},hmm:{type:"single",tag:"*hmm*",replacementParameter:"hmm"},hmpf:{type:"single",tag:"*hmpf*",replacementParameter:"hmpf"},hrhr:{type:"single",tag:"*hrhr*",replacementParameter:"hrhr"},huh:{type:"single",tag:"*huh*",replacementParameter:"huh"},lazy:{type:"single",tag:"*lazy*",replacementParameter:"lazy"},love:{type:"single",tag:"*love*",replacementParameter:"love"},nocomment:{type:"single",tag:"*nocomment*",replacementParameter:"nocomment"},noemotion:{type:"single",tag:"*noemotion*",replacementParameter:"noemotion"},notamused:{type:"single",tag:"*notamused*",replacementParameter:"notamused"},pout:{type:"single",tag:"*pout*",replacementParameter:"pout"},redface:{type:"single",tag:"*redface*",replacementParameter:"redface"},rolleyes:{type:"single",tag:"*rolleyes*",replacementParameter:"rolleyes"},shy:{type:"single",tag:"*shy*",replacementParameter:"shy"},smile:{type:"single",tag:"*smile*",replacementParameter:"smile"},tongue:{type:"single",tag:"*tongue*",replacementParameter:"tongue"},veryangry:{type:"single",tag:"*veryangry*",replacementParameter:"veryangry"},veryhappy:{type:"single",tag:"*veryhappy*",replacementParameter:"veryhappy"},grin:{type:"single",tag:":D",replacementParameter:"grin"},sad:{type:"single",tag:":(",replacementParameter:"sad"},happy:{type:"single",tag:":)",replacementParameter:"happy"},wink:{type:"single",tag:";)",replacementParameter:"wink"}}},troops:{replacement:e=>(0,_.jsx)("img",{className:`unit u${e}`,src:"/img/x.gif"}),tags:{...Object.entries(Travian.Variables.troopIds).map((e=>Object.entries(e[1]).reduce(((e,t)=>(e[t[1]]={type:"singleWithBrackets",tag:`tid${t[1]}`,replacementParameter:t[1]},e)),{}))),hero:{hero:{type:"singleWithBrackets",tag:this.translationFunction("bbcode.troop_tag_hero"),replacementParameter:"hero"}}}},medals:{replacement:e=>{if(-1!==this.usedMedals.indexOf(e))return`[${e}]`;const t="g"===e.charAt(1);e=e.substring(t?2:1);const a=t?this.playerMedalData.medalsLifetime:this.playerMedalData.medalsGameworld;for(const s of a)if(parseInt(s.id)===parseInt(e))return this.usedMedals.push(s.code.slice(1,-1)),(0,_.jsx)(rn,{...s,isGloriaMedal:t},s.code)},tags:{...Object.entries(this.playerMedalData).map((e=>{const t="medalsLifetime"===e[0],a=t?`#${rn.gloriaMedalPrefix}`:"#";return e[1].map((e=>({type:"singleWithBrackets",tag:a+e.id,replacementParameter:a+e.id,id:t?rn.gloriaMedalPrefix+e.id:e.id})))}))}}}}async resolveValues(e,t){return new Promise(((a,s)=>{Travian.api(`bb/resolve/${e}`,{data:{values:t},success:a,error:s})}))}getMedalsInUse(e){const t={};return Object.entries(this.getConfiguration().medals.tags).forEach((a=>{a[1].forEach((a=>{const s=new RegExp(`\\[${a.tag}\\]`,"g"),i=e.match(s);null!==i&&(t[a.id]=i.length)}))})),t}async render(e){let t=Yi()(e,new RegExp("(\\r\\n|\\r|\\n)","g"),(()=>(0,_.jsx)("br",{}))),a=[];Object.entries(this.getConfiguration()).forEach((e=>{e[1].hasOwnProperty("tag")?a.push(e[1]):Object.entries(e[1].tags).forEach((t=>{let s=t[1];s.hasOwnProperty("tag")?(s.replacement=e[1].replacement,a.push(s)):Object.entries(s).forEach((t=>{let s=t[1];s.replacement=e[1].replacement,a.push(s)}))}))}));for(const s of a){let a;const i=s.tag.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");switch(s.type){default:case"surrounded":a=new RegExp(`\\[${i}\\](.+?)\\[\\/${i}\\]?`,"g");break;case"singleWithBrackets":a=new RegExp(`(\\[${i}\\])`,"g");break;case"single":a=new RegExp(`(${i})`,"g")}if(s.resolvableType){const i=new RegExp(`${Travian.i18n.DIRECTION_OVERRIDE_LTR}|${Travian.i18n.DIRECTION_OVERRIDE_RTL}|${Travian.i18n.DIRECTION_STOP_OVERRIDE}`,"g"),n=[];for(const t of e.matchAll(a)){let e=t[1].replaceAll(i,"");n.push(s.preProcess?s.preProcess(e):e)}if(0===n.length)continue;let r;try{r=await this.resolveValues(s.resolvableType,n)}catch(e){continue}let l=0;t=Yi()(t,a,(e=>s.replacement(r[l++],e)))}else t=Yi()(t,a,(e=>s.replacement(s.replacementParameter??e)))}return(0,_.jsx)(_.Fragment,{children:t})}clearUsedMedals(){this.usedMedals=[]}}const Xi=e=>{const t={};t[Travian.Constants.RES_LUMBER]="lumber",t[Travian.Constants.RES_CLAY]="clay",t[Travian.Constants.RES_IRON]="iron",t[Travian.Constants.RES_CROP]="crop";let a=[...e.bonus].sort(((e,t)=>e.resourceType.id-t.resourceType.id)),s="";return a.map((e=>{s+=s?"-":"",s+=e.resourceType.code+(50===e.amount?"-"+e.resourceType.code:"")})),(0,_.jsx)("i",{className:`${s}_${Object.values(t).includes(s)?"small":"medium"}`,title:$i.renderToString((0,_.jsx)("div",{id:"playerProfileOasisTooltip",children:a.map((e=>{let a=e.resourceType.id;return(0,_.jsxs)("div",{children:[(0,_.jsx)("i",{className:`${t[a]}_tiny`}),(0,_.jsxs)("span",{children:[(0,O.Jh)("allgemein.r"+a)," ",(0,O.eJ)(e.amount,{unit:O.uo.PERCENT})]})]},a)}))}))})};function Qi({bootstrapData:e,player:t}){return t.villages.sort(((e,t)=>t.population-e.population)),(0,_.jsxs)("table",{className:"villages borderGap",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[e.serverSupportedFeatures.keepVidOnConquer&&(0,_.jsx)("th",{className:"tribe"}),(0,_.jsx)("th",{className:"name",children:(0,O.Jh)("spieler.dorfname")}),(0,_.jsx)("th",{className:"oases",children:(0,O.Jh)("spieler.oasen")}),(0,_.jsx)("th",{className:"inhabitants",children:(0,_.jsx)("i",{className:"population_medium",title:(0,O.Jh)("spieler.einwohner")})}),(0,_.jsx)("th",{className:"coordinates",children:(0,O.Jh)("spieler.koordinaten")}),e.serverSupportedFeatures.territory&&(0,_.jsx)("th",{children:(0,O.Jh)("region.region")})]})}),(0,_.jsx)("tbody",{children:t.villages.length&&t.villages.map((t=>(0,_.jsxs)("tr",{children:[e.serverSupportedFeatures.keepVidOnConquer&&(0,_.jsx)("td",{className:"tribe",children:(0,_.jsx)("i",{className:`tribe${t.tribeId}_medium`})}),(0,_.jsxs)("td",{className:"name",children:[(0,_.jsx)("a",{href:`/karte.php?d=${t.mapId}`,children:t.name}),t.typeText&&(0,_.jsx)("span",{className:"additionalInfo",title:t.typeTitle,children:t.typeText})]}),(0,_.jsx)("td",{className:"oases",children:(0,_.jsx)("div",{children:t.occupiedOases&&Object.keys(t.occupiedOases).map((e=>(0,_.jsx)(Xi,{bonus:t.occupiedOases[e].bonus},t.id+e)))})}),(0,_.jsx)("td",{className:"inhabitants",children:t.population}),(0,_.jsx)("td",{className:"coordinates",children:(0,_.jsx)(O.rT,{x:t.x,y:t.y,configInput:{withMarkup:!0,aligned:"coordinatesAligned",linked:!0}})}),e.serverSupportedFeatures.territory&&(0,_.jsx)("td",{className:"region",children:(0,_.jsx)("a",{href:`/region/${t.region.id}`,title:(0,O.Jh)("karte.loadingData"),"data-load-tooltip":"region","data-load-tooltip-data":JSON.stringify({regionIds:[t.region.id]}),children:t.region.name})},t.region.id)]},t.mapId)))})]})}function en({bootstrapData:e,player:t}){return t.villages.sort(((e,t)=>t.victoryPoints-e.victoryPoints)),(0,_.jsxs)("table",{className:"villages borderGap",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[e.serverSupportedFeatures.keepVidOnConquer&&(0,_.jsx)("th",{className:"tribe"}),(0,_.jsx)("th",{className:"name",children:(0,O.Jh)("spieler.name")}),(0,_.jsx)("th",{children:(0,O.Jh)("spieler.victoryPoints")}),(0,_.jsx)("th",{children:(0,O.Jh)("statistiken.perDay")}),(0,_.jsx)("th",{children:(0,O.Jh)("spieler.koordinaten")}),e.serverSupportedFeatures.territory&&(0,_.jsx)("th",{children:(0,O.Jh)("region.region")})]})}),(0,_.jsx)("tbody",{children:t.villages.length&&t.villages.map((t=>(0,_.jsxs)("tr",{children:[e.serverSupportedFeatures.keepVidOnConquer&&(0,_.jsx)("td",{className:"tribe",children:(0,_.jsx)("i",{className:`tribe${t.tribeId}_medium`})}),(0,_.jsxs)("td",{className:"name",children:[(0,_.jsx)("a",{href:`/karte.php?d=${t.mapId}`,children:t.name}),t.typeText&&(0,_.jsx)("span",{className:"additionalInfo",title:t.typeTitle,children:t.typeText})]}),(0,_.jsx)("td",{className:"victoryPoints",children:t.victoryPoints<1?"<1":t.victoryPoints}),(0,_.jsx)("td",{className:"vpPerDay",children:t.victoryPointsPerDay}),(0,_.jsx)("td",{className:"coords",children:(0,_.jsx)(O.rT,{x:t.x,y:t.y,configInput:{withMarkup:!0,aligned:"coordinatesAligned",linked:!0}})}),e.serverSupportedFeatures.territory&&(0,_.jsx)("td",{className:"coords",children:(0,_.jsx)("a",{href:`/region/${t.region.id}`,title:(0,O.Jh)("karte.loadingData"),"data-load-tooltip":"region","data-load-tooltip-data":JSON.stringify({regionIds:[t.region.id]}),children:t.region.name})})]},t.mapId)))})]})}class tn extends o.Component{static propTypes={profile:d().object.isRequired};constructor(e){super(e),this.state={tooltipData:null,showMore:!1,description:{description1:null,description2:null}},this.onItemMouseOver=this.onItemMouseOver.bind(this),this.onItemMouseOut=this.onItemMouseOut.bind(this),this.openMobileHeroItemTooltip=this.openMobileHeroItemTooltip.bind(this),this.itemSlotRefs=[],this.containerRef=null,this.tooltipRef=null}componentDidMount(){const e=this.props.profile.player.profile,t=new Ki(O.Jh,{medalsGameworld:e.medalsGameworld,medalsLifetime:e.medalsLifetime}),a={},s=[];Object.entries(e.descriptionPlain).forEach(((e,i)=>{a[i]=e[0],s.push(t.render(e[1]))})),Promise.allSettled(s).then((e=>{let s=!0;const i=e.reduce(((e,t,i)=>(s=s&&"rejected"!==t.status,e[a[i]]=t.value,e)),{});s&&(t.clearUsedMedals(),this.setState({description:i}))}))}componentDidUpdate(e,t,a){let{tooltipData:s}=this.state;if(null!==s&&this.tooltipRef){const e="rtl"===Travian.Game.getDirection(),t=Object.assign({},s.style);let a,i,n=this.itemSlotRefs[s.itemSlotRefKey].getBoundingClientRect(),r=this.containerRef.getBoundingClientRect(),l=n.top-r.top+2;e?(i=n.right-r.left+2,a="auto"):(a=r.right-n.left+2,i="auto"),s.style={top:l,left:i,right:a},s.style.top===t.top&&s.style.right===t.right&&s.style.left===t.left||this.setState({tooltipData:s})}Travian.Tip.refresh()}openMobileHeroItemTooltip(){window.Travian.React.Dialog({content:(0,_.jsx)(zs,{...this.state.tooltipData}),cssClass:"mobileHeroItemTooltip blankForMobile heroV2 contentV2",buttonOk:!1,buttonCancel:!0,enableBackground:!0,darkOverlay:!0,preventFormSubmit:!0,fullSize:!0},"mobileHeroItemTooltip")}getItemStats(e){let t=[];return null!==e.attributes&&e.attributes.map((e=>(t.push({title:e.effectDescription,details:e.descriptionDetails??null}),!0))),t}onItemMouseOver(e,t,a,s){let i=this.getItemStats(s);this.setState({tooltipData:{itemSlotRefKey:t,tier:ti[s.tier],title:s.name,type:a,stats:i,style:{top:0,left:0,right:"auto"},notClickable:!1,warning:"",errorMessage:""}})}onItemMouseOut(){this.setState({tooltipData:null})}render(){const{player:e,ownPlayer:t,bootstrapData:a,overviewPageFavouriteSubTabKey:s}=this.props.profile,{description:i,tooltipData:n}=this.state;let r="",l="";i.description1&&(r=i.description1),i.description2&&(l=i.description2);const o=e.profile.ownProfile?{}:{uid:e.id,playerName:e.name,ownProfile:e.profile.ownProfile,personalNote:e.profile.personalNote,isPlayerSitted:t.isSitter,interactionPossible:e.profile.interactionPossible,isPlayerIgnoring:e.profile.isPlayerIgnoring,isPlayerBanned:t.isLocked,ignoredListIsFull:e.profile.ignoredListIsFull,allowedToIgnore:e.profile.allowedToIgnore,accusingOthersLeft:t.accusingOthersLeft,messagesBan:t.messagesBan,readWriteMessages:t.accessRights.readWriteMessages,hasRightToSentInvitation:t.hasRightToSentInvitation,isPlayerInvited:e.profile.isPlayerInvited,isAllianceMember:e.profile.isAllianceMember,accusationKeyToTranslationMapping:Travian.Constants.ACCUSATION_REASONS},c=Travian.Browser.isTouchInput;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"playerDetails heroV2 "+(e.tribeId==Travian.Constants.TRIBE_ID.natar?"natar":""),ref:e=>this.containerRef=e,children:[!c&&null!==n&&(0,_.jsx)(zs,{ref:e=>this.tooltipRef=e,...n}),(0,_.jsx)("table",{children:(0,_.jsxs)("tbody",{children:[(0,_.jsx)("tr",{children:(0,_.jsx)("th",{colSpan:"3",className:"header",children:(0,O.Jh)("spieler.details")})}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("spieler.volk")}),(0,_.jsx)("td",{colSpan:"2",children:(0,O.Jh)("allgemein.v"+e.tribeId)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("spieler.allianz")}),(0,_.jsx)("td",{colSpan:"2",children:e.alliance?(0,_.jsx)("a",{className:"lightColor",href:`/alliance/${e.alliance.id}`,children:e.alliance.tag}):"-"})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("spieler.doerfer")}),(0,_.jsx)("td",{colSpan:"2",children:e.villages.length})]}),e.profile.gender&&(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("spieler.geschlecht")}),(0,_.jsx)("td",{colSpan:"2",children:(0,O.Jh)(an(e.profile.gender))})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("spieler.daysPlaying")}),(0,_.jsx)("td",{colSpan:"2",children:e.profile.daysPlaying})]}),""!==e.profile.location&&(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("spieler.wohnort")}),(0,_.jsx)("td",{colSpan:"2",className:"value",children:e.profile.location})]}),a.serverSupportedFeatures.multiLanguage&&e.profile.additionalLanguages&&e.profile.additionalLanguages.length>0?(0,_.jsx)("tr",{className:"multiLanguage",children:(0,_.jsx)("td",{colSpan:"3",children:e.profile.additionalLanguages.map((e=>{let t=a.languages.find((t=>t.id===e));return(0,_.jsx)("img",{src:`../../../../img/svg/flags/${t.flag}.svg`,className:"languageFlag",alt:`${t.langNative} (${t.countryNative})`,title:`${t.langNative} (${t.countryNative})`},t.flag)}))})}):e.profile.showCountryFlag&&Object.keys(e.profile.countryFlag).length>0?(0,_.jsx)("tr",{className:"countryFlag",children:(0,_.jsx)("td",{colSpan:"3",className:"flags",children:(0,_.jsx)("img",{src:"/img/x.gif",className:`flag_${e.profile.countryFlag.language}`,alt:e.profile.countryFlag.languageName,title:e.profile.countryFlag.languageName})})}):(0,_.jsx)(_.Fragment,{}),!e.profile.isNPC&&e.ranks&&Object.keys(e.ranks).length>0&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("tr",{children:(0,_.jsx)("th",{colSpan:"3",className:"header",children:(0,O.Jh)("spieler.ranks")})}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("statistiken.bevoelkerung")}),(0,_.jsx)("td",{className:"rank",children:e.ranks.populationRank}),(0,_.jsxs)("td",{className:"value",children:[e.ranks.population," ",(0,O.Jh)("statistiken.bevoelkerung")]})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("statistiken.angreifer")}),(0,_.jsx)("td",{className:"rank",children:e.ranks.attackerRank}),(0,_.jsxs)("td",{className:"value",children:[e.ranks.attackerPoints," ",(0,O.Jh)("statistiken.punkte")]})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("statistiken.verteidiger")}),(0,_.jsx)("td",{className:"rank",children:e.ranks.defenderRank}),(0,_.jsxs)("td",{className:"value",children:[e.ranks.defenderPoints," ",(0,O.Jh)("statistiken.punkte")]})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,O.Jh)("hero.level")}),(0,_.jsx)("td",{className:"rank",children:e.hero.level}),(0,_.jsxs)("td",{className:"value",children:[e.hero.xp," ",(0,O.Jh)("hero.erfahrung")]})]})]})]})}),(0,_.jsx)("div",{className:"personalNote",children:e.profile.personalNote&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"text "+(this.state.showMore?"showMore":"showLess"),children:e.profile.personalNote}),(0,_.jsx)("a",{href:"",className:"lightColor",onClick:e=>{e.preventDefault(),this.setState({showMore:!this.state.showMore})},children:(0,O.Jh)(this.state.showMore?"spieler.showLess":"spieler.showMore")})]})}),e.profile.allowEdit&&e.profile.ownProfile&&(0,_.jsx)(F.z,{className:"editProfile",onClick:()=>{window.location.href="/profile/edit"},children:(0,O.Jh)("spieler.m_profil")}),!e.profile.ownProfile&&(0,_.jsx)(Wi,{data:o,updateData:this.props.updateData}),!e.profile.isNPC&&(0,_.jsx)("div",{className:["hero",e.hero&&e.hero.gender,e.hero&&e.hero.equipment&&e.hero.equipment.horse?"horse item"+e.hero.equipment.horse.typeId:""].join(" "),children:e.hero&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("img",{src:`/heroV2/body/${e.hero.imageHash}.1.png`,className:"heroBodyImage",alt:(0,O.Jh)("hero.heroBody")}),(0,_.jsx)("div",{className:"equipmentSlots",children:ai.filter((e=>"bag"!==si[e])).map(((t,a)=>{let s=si[t],i=e.hero.equipment[s],n="equipped_"+(a+1);return i?(Travian.Tip.clearOnElement(this.itemSlotRefs[n]),(0,_.jsx)(Cs.Z,{ref:e=>this.itemSlotRefs[n]=e,disabled:!0,id:i.id,slot:s,typeId:i.typeId,tier:ti[i.tier],notClickable:!0,onClick:c?e=>{this.openMobileHeroItemTooltip(this.itemSlotRefs[n],s,i)}:null,onMouseOver:e=>{this.onItemMouseOver(e,n,s,i)},onMouseOut:this.onItemMouseOut},n)):(0,_.jsx)(Cs.Z,{ref:e=>this.itemSlotRefs[n]=e,slot:s,disabled:!0,empty:!0},n)}))})]})})]}),(0,_.jsxs)("div",{className:"playerDescription",children:[(0,_.jsx)("div",{className:"description1",children:r}),(0,_.jsx)("div",{className:"description2",children:l})]}),a.serverSupportedFeatures.victoryPoints2021&&(0,_.jsx)(Ma,{onFavouritize:this.props.updateData,name:this.props.subTabBarName,items:[{key:"population",title:(0,O.Jh)("spieler.bevoelkerung"),content:(0,_.jsx)(Qi,{...this.props.profile})},{key:"victoryPoints",title:(0,O.Jh)("spieler.victoryPoints"),content:(0,_.jsx)(en,{...this.props.profile})}],favouriteSubTab:s.key}),!a.serverSupportedFeatures.victoryPoints2021&&(0,_.jsx)(Qi,{...this.props.profile})]})}}const an=(e,t)=>{switch(e){case Travian.Constants.PLAYER_GENDER_NOT_SPECIFIED:default:return t?"spieler.genderDoNotSpecify":"spieler.genderNotSpecified";case Travian.Constants.PLAYER_GENDER_DIVERSE:return"spieler.genderDiverse";case Travian.Constants.PLAYER_GENDER_FEMALE:return"spieler.genderFemale";case Travian.Constants.PLAYER_GENDER_MALE:return"spieler.genderMale"}};var sn=a(3991);const nn=e=>(0,_.jsxs)("div",{className:"medal",children:[e.isGloriaMedal?(0,_.jsx)("img",{src:e.imgUrl,className:"medalGloria",width:e.width,alt:e.name}):(0,_.jsx)("img",{src:"/img/x.gif",className:`medal t${e.type}_${e.rank}`,alt:e.name}),(0,_.jsx)("div",{className:"description",dangerouslySetInnerHTML:{__html:e.desc}})]}),rn=e=>{const t=e.inUse?$i.renderToString((0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("span",{dangerouslySetInnerHTML:{__html:e.desc}}),(0,_.jsx)("br",{}),(0,_.jsx)("br",{}),(0,_.jsx)("span",{className:"warning",children:(0,O.Jh)("spieler.medalAlreadyInUse")})]})):e.desc,a=()=>{window.Travian.React.Dialog({content:(0,_.jsx)(nn,{...e,desc:t,isGloriaMedal:d}),cssClass:"mobileProfileMedal blankForMobile contentV2 playerProfile",buttonOk:!1,buttonCancel:!0,enableBackground:!0,darkOverlay:!0,preventFormSubmit:!0,fullSize:!0},"mobileProfileMedal")},[s,i]=(0,o.useState)(!1),n=(0,o.useRef)(null),r=Travian.Browser.isTouchInput;let l,c;switch(!0){case e.hasContextMenu&&r:l=()=>i(!0),c=null;break;case r:l=a,c=null;break;case void 0!==e.onClickCallback:l=e.onClickCallback,c=t;break;default:l=()=>{},c=t}const d=e.isGloriaMedal??!1;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"medal",ref:n,title:c,onClick:l,children:d?(0,_.jsx)("img",{src:e.imgUrl,className:"medalGloria "+(e.inUse?"used":""),width:e.width,alt:e.name}):(0,_.jsx)("img",{src:"/img/x.gif",className:`medal t${e.type}_${e.rank} ${e.inUse?"used":""}`,alt:e.name})}),s&&n&&(0,_.jsx)($s,{contextParent:n.current,onClose:()=>i(!1),content:[{icon:(0,_.jsx)(Rs,{}),text:(0,O.Jh)("spieler.insertMedal"),disabled:e.inUse,onClick:()=>{e.onClickCallback(e.code),i(!1)}},{icon:(0,_.jsx)(Js,{}),text:(0,O.Jh)("spieler.showInfo"),disabled:!1,onClick:a}]})]})};rn.gloriaMedalPrefix="g";const ln=function({type:e,onClick:t,classPrefix:a,title:s}){return(0,_.jsx)("button",{title:s,onClick:t,type:"button",className:a??"",children:(0,_.jsx)("img",{alt:s,src:"/img/x.gif",className:e})})},on=function({insertAtCursor:e,insertAroundCursor:t,textValues:a,setPreviewTexts:s,inPreviewMode:i,setInPreviewMode:n,previewTexts:r,playerMedalData:l}){const[c,d]=(0,o.useState)(!1),[h,u]=(0,o.useState)(!1),[m,p]=(0,o.useState)(!1),[g,v]=(0,o.useState)(!1),[x,b]=(0,o.useState)(!1),j=(0,o.useMemo)((()=>new Ki(O.Jh,l)),[]);(0,o.useEffect)((()=>{Travian.Tip.refresh()}),[h,c,m]),(0,o.useEffect)((()=>{v(!1)}),[...Object.entries(a).map((e=>e[1]))]);const f=(e,t)=>{i||(d(!1),u(!1),p(!1),t(...e))};return(0,_.jsx)("div",{className:"bbEditor",children:(0,_.jsxs)("div",{className:"bbToolbar noBackground",children:[Object.entries(j.configuration).map((e=>{const a=e[0].charAt(0).toUpperCase()+e[0].slice(1);return e[1].tag&&(0,_.jsx)(ln,{title:e[1].title,classPrefix:`icon bbButton bb${a}`,onClick:()=>f([`[${e[1].tag}]`,`[/${e[1].tag}]`],t),type:`bb${a}`},e[0])})),(0,_.jsx)(ln,{title:(0,O.Jh)("bbcode.buttonResource"),classPrefix:"icon bbButton bbResource",type:"bbResource",onClick:()=>{d(!c),u(!1),p(!1)}}),(0,_.jsx)(ln,{title:(0,O.Jh)("bbcode.buttonSmilie"),classPrefix:"icon bbButton",type:"bbSmilies",onClick:()=>{u(!h),d(!1),p(!1)}}),(0,_.jsx)(ln,{title:(0,O.Jh)("bbcode.buttonTroop"),classPrefix:"icon bbButton",type:"bbTroops",onClick:()=>{u(!1),d(!1),p(!m)}}),(0,_.jsx)(ln,{title:(0,O.Jh)("bbcode.buttonPreview"),classPrefix:"icon bbButton bbPreview",type:"bbPreview",onClick:()=>{if(x)return;if(i)return d(!1),u(!1),p(!1),void n(!1);if(g)return n(!0),void s(r);b(!0);const e={},t=[];Object.entries(a).forEach(((a,s)=>{e[s]=a[0],t.push(j.render(a[1]))})),Promise.allSettled(t).then((t=>{let a=!0;const i=t.reduce(((t,s,i)=>(a=a&&"rejected"!==s.status,t[e[i]]=s.value,t)),{});if(!a)return b(!1),v(!1),void n(!1);b(!1),v(!0),n(!0),s(i),j.clearUsedMedals()}))}}),(0,_.jsxs)("div",{className:"bbToolbarWindow",children:[c&&!i&&(0,_.jsx)("div",{className:"resources",children:Object.entries(j.configuration.resource.tags).map((t=>(0,_.jsx)("button",{type:"button",onClick:()=>f([`[${t[1].tag}]`],e),children:(0,_.jsx)("i",{className:`r${t[0]}`,title:(0,O.Jh)(`allgemein.r${t[0]}`)})},t[0])))}),h&&!i&&(0,_.jsx)("div",{className:"smilies messages",children:Object.entries(j.configuration.smilies.tags).map((t=>(0,_.jsx)(ln,{title:t[1].tag,onClick:()=>f([t[1].tag],e),type:`smiley ${t[0]}`},t[0])))}),m&&!i&&(0,_.jsx)("div",{className:"troops",id:"message_troops",children:Object.entries(j.configuration.troops.tags).map((t=>(0,_.jsxs)(o.Fragment,{children:[Object.entries(t[1]).map((t=>(0,_.jsx)(ln,{title:(0,O.Jh)("hero"===t[0]?`truppen.${t[0]}`:`truppen.tid${t[0]}`),onClick:()=>f([`[${t[1].tag}]`],e),type:`unit u${t[0]}`},t[0]))),(0,_.jsx)("hr",{})]},t[0])))})]})]})})},cn=e=>{const{saveCallback:t}=e;let a=o.createRef(),s=o.createRef(),i=o.createRef();const[n,r]=(0,o.useState)(e.profile),[l,c]=(0,o.useState)({}),[d,h]=(0,o.useState)({}),[u,m]=(0,o.useState)("description1"),[p,g]=(0,o.useState)(null),[v,x]=(0,o.useState)(!1),[b,j]=(0,o.useState)(!1),[f,y]=(0,o.useState)(!1),[T,N]=(0,o.useState)(!1),[C,S]=(0,o.useState)(!1),[k,w]=(0,o.useState)(!1),[E,I]=(0,o.useState)({description1:"",description2:""}),[A,D]=(0,o.useState)([]),[L,P]=(0,o.useState)(!1);if(0===Object.keys(l).length||JSON.stringify(e.profile)!==JSON.stringify(n)){r(e.profile);const{player:t}=e.profile;let a=[];t.villages&&t.villages.forEach((e=>a.push({id:e.id,name:e.name})));const s={location:t.profile.location??"",gender:t.profile.gender??Travian.Constants.PLAYER_GENDER_NOT_SPECIFIED,showCountryFlag:t.profile.showCountryFlag,additionalLanguages:t.profile.additionalLanguages,description1:t.profile.descriptionPlain?t.profile.descriptionPlain.description1:"",description2:t.profile.descriptionPlain?t.profile.descriptionPlain.description2:"",villageNames:a};c(s),h(s)}(0,o.useEffect)((()=>{Z(l.description1,l.description2)}),[]),(0,o.useEffect)((()=>{let e=e=>{if(e.detail.languagesSelected){let t=e.detail.languagesSelected;Object.keys(t).map((e=>{t[e]=G.languages.find((t=>t.id===e))})),c({...l,additionalLanguages:Object.keys(t)})}};if($.profile.allowEdit){if((new O.w3).attach(a.current),G.serverSupportedFeatures.multiLanguage&&l.additionalLanguages){let t={};G.languages.map((e=>{t[e.id]=e})),Travian.Game.Profile.Languages.init("#editPlayerLanguages",l.additionalLanguages,t,"#PlayerProfileEditor"),window.addEventListener("travian.profileLanguages.sync",e)}}if(null!==p){let e=s.current;"description2"===u&&(e=i.current),e.focus(),e.selectionStart=p,e.selectionEnd=p,g(null)}return y(JSON.stringify(l)!==JSON.stringify(d)&&!L),Travian.Tip.refresh(),()=>{window.removeEventListener("travian.profileLanguages.sync",e)}}),[n,l,c,d,y,p,g,u,s,i,a,Travian]);const B=e=>{let t=s.current;"description2"===u&&(t=i.current);let a=t.selectionStart,n=t.selectionEnd,r=l[u];c({...l,[u]:r.substring(0,a)+e+r.substring(n)}),g(a+e.length)},M=e=>{e.preventDefault();let a={data:l,success:()=>{N(!1),S(!0),setTimeout((()=>{S(!1),h(l)}),1e3),t()},error:e=>{N(!1),Travian.defaultErrorFunction(e)}};!f||T||C||(Travian.api("profile",a,"PUT"),N(!0))},J=(e,t)=>()=>{(e=>A.some((t=>t==e)))(e)||(B(t),D([...A,e]))},Z=(e,t)=>{const a=Y.getMedalsInUse(e),s=Y.getMedalsInUse(t);D(Object.keys({...a,...s}));let i=a;for(let[e,t]of Object.entries(s))i[e]=a.hasOwnProperty(e)?t+a[e]:t;const n=Object.values(i).some((e=>e>1));P(n)},V=l.additionalLanguages&&l.additionalLanguages.length>1,H=l.additionalLanguages&&l.additionalLanguages.length<4,q=5e3,U=l.description1?l.description1.length:0,z=l.description2?l.description2.length:0,{player:$,ownPlayer:W,bootstrapData:G}=n,Y=(0,o.useMemo)((()=>new Ki(O.Jh,{medalsGameworld:$.profile.medalsGameworld,medalsLifetime:$.profile.medalsLifetime})),[]);let K={};return W.villages&&W.villages.forEach((e=>K[e.id]=e.sortIndex)),$.villages.sort(((e,t)=>(K[e.id]??0)-(K[t.id]??0))),(0,_.jsx)("form",{ref:a,className:"formV2 "+(T?"loading":""),children:$.profile.allowEdit&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("h3",{children:(0,O.Jh)("spieler.wohnort")}),(0,_.jsxs)("label",{className:"input",children:[(0,_.jsx)("input",{type:"text",name:"location",maxLength:"30",onChange:e=>c({...l,location:e.target.value}),value:l.location??"",tabIndex:1}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("spieler.yourLocation")})]}),!G.serverSupportedFeatures.multiLanguage&&(0,_.jsx)("div",{className:"showCountryFlag",children:(0,_.jsxs)("label",{className:"switch showCountryFlag",children:[(0,_.jsx)("input",{type:"checkbox",name:"showCountryFlag",value:"1",onChange:e=>c({...l,showCountryFlag:e.target.checked}),checked:l.showCountryFlag,tabIndex:3}),(0,_.jsx)("div",{className:"switch"}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("spieler.showCountryFlag")})]})}),(0,_.jsx)("h3",{children:(0,O.Jh)("spieler.geschlecht")}),(0,_.jsx)("div",{className:"genderOptions",children:[Travian.Constants.PLAYER_GENDER_NOT_SPECIFIED,Travian.Constants.PLAYER_GENDER_FEMALE,Travian.Constants.PLAYER_GENDER_MALE,Travian.Constants.PLAYER_GENDER_DIVERSE].map((e=>(0,_.jsxs)("label",{className:"radio",children:[(0,_.jsx)("input",{type:"radio",name:"gender",onChange:()=>c({...l,gender:e}),checked:l.gender===e,tabIndex:2}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)(an(e,!0))})]},e)))}),G.serverSupportedFeatures.multiLanguage&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("h3",{children:(0,O.Jh)("spieler.languagesYouSpeakOrUnderstand")}),(0,_.jsxs)("div",{id:"editPlayerLanguages",children:[(0,_.jsx)("div",{className:"languages",children:l.additionalLanguages&&l.additionalLanguages.map((e=>{let t=G.languages.find((t=>t.id===e));return(0,_.jsxs)("div",{className:"language "+(V?"deletable":""),onClick:V?()=>{(e=>{let t=[...l.additionalLanguages];t.splice(t.indexOf(e),1),c({...l,additionalLanguages:t})})(e)}:()=>{},children:[V&&(0,_.jsx)(R.Z,{className:"delete"}),(0,_.jsx)("img",{src:`../../../../img/svg/flags/${t.flag}.svg`,className:"languageFlag",alt:`${t.langNative} (${t.countryNative})`,title:`${t.langNative} (${t.countryNative})`})]},t.flag)}))}),H&&(0,_.jsx)(F.z,{className:"addLanguageButton",iconButton:!0,tabIndex:3,children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(ma.Z,{className:"outline"}),(0,_.jsx)(ma.Z,{className:"icon"})]})})]})]}),(0,_.jsx)("h3",{children:(0,O.Jh)("spieler.beschreibung")}),(0,_.jsx)(on,{textValues:{description1:l.description1,description2:l.description2},insertAtCursor:B,insertAroundCursor:(e,t)=>{let a="description2"===u?i.current:s.current,n=a.selectionStart,r=a.selectionEnd;const o=a.value.substring(n,r);let d=l[u];c({...l,[u]:d.substring(0,n)+e+o+t+d.substring(r)}),g(n+e.length)},previewTexts:E,setPreviewTexts:I,inPreviewMode:k,setInPreviewMode:w,playerMedalData:{medalsGameworld:$.profile.medalsGameworld,medalsLifetime:$.profile.medalsLifetime}}),(0,_.jsxs)("div",{className:"description messages",children:[(0,_.jsxs)("div",{className:"description1",children:[(0,_.jsxs)("label",{className:"textarea fixed",children:[!k&&(0,_.jsx)("textarea",{name:"description1",ref:s,onFocus:()=>m("description1"),onChange:e=>{c({...l,description1:e.target.value}),Z(e.target.value,l.description2)},cols:"",rows:"",maxLength:q,tabIndex:4,placeholder:(0,O.Jh)("spieler.writeSomethingAboutYou"),value:l.description1&&l.description1}),k&&(0,_.jsxs)("div",{className:"preview",children:[E.description1," "]})]}),(0,_.jsxs)("div",{className:`characterLimit ${k?"hidden":""} ${U>=q?"error":""}`,children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("spieler.maxLength"),": "]}),(0,_.jsx)("span",{children:(0,O.T_)(U,q,{})})]})]}),(0,_.jsxs)("div",{className:"description2",children:[(0,_.jsxs)("label",{className:"textarea fixed",children:[!k&&(0,_.jsx)("textarea",{name:"description2",ref:i,onFocus:()=>m("description2"),onChange:e=>{c({...l,description2:e.target.value}),Z(l.description1,e.target.value)},cols:"",rows:"",maxLength:q,tabIndex:5,placeholder:(0,O.Jh)("spieler.writeSomethingAboutYou"),value:l.description2&&l.description2}),k&&(0,_.jsxs)("div",{className:"preview",children:[E.description2," "]})]}),(0,_.jsxs)("div",{className:`characterLimit ${k?"hidden":""} ${z>=q?"error":""}`,children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("spieler.maxLength"),": "]}),(0,_.jsx)("span",{children:(0,O.T_)(z,q,{})})]})]})]}),L&&(0,_.jsx)("span",{className:"warning",children:(0,O.Jh)("spieler.medalCanBeUsedOnlyOnce")}),$.profile.medalsGameworld&&$.profile.medalsGameworld.length>0&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("h3",{children:(0,O.Jh)("spieler.yourServerMedals")}),(0,_.jsxs)("div",{className:"medals gameworld",children:[!v&&$.profile.medalsGameworld.slice(0,11).map(((e,t)=>(0,o.createElement)(rn,{...e,key:t,hasContextMenu:!0,onClickCallback:J(e.id,e.code),inUse:A.some((t=>t==e.id))}))),v&&$.profile.medalsGameworld.map(((e,t)=>(0,o.createElement)(rn,{...e,key:t,hasContextMenu:!0,onClickCallback:J(e.id,e.code),inUse:A.some((t=>t==e.id))})))]}),$.profile.medalsGameworld.length>11&&(0,_.jsx)("div",{className:"toggleMedals",children:(0,_.jsx)("a",{onClick:()=>x(!v),children:(0,O.Jh)(v?"spieler.showLess":"spieler.showMore")})})]}),$.profile.medalsLifetime&&$.profile.medalsLifetime.length>0&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("h3",{children:(0,O.Jh)("spieler.yourLifetimeMedals")}),(0,_.jsxs)("div",{className:"medals lifetime",children:[!b&&$.profile.medalsLifetime.slice(0,8).map(((e,t)=>{const a=rn.gloriaMedalPrefix+e.id;return(0,o.createElement)(rn,{...e,key:t,isGloriaMedal:!0,hasContextMenu:!0,onClickCallback:J(a,e.code),inUse:A.some((e=>e==a))})})),b&&$.profile.medalsLifetime.map(((e,t)=>{const a=rn.gloriaMedalPrefix+e.id;return(0,o.createElement)(rn,{...e,key:t,isGloriaMedal:!0,hasContextMenu:!0,onClickCallback:J(a,e.code),inUse:A.some((e=>e==a))})}))]}),$.profile.medalsLifetime.length>8&&(0,_.jsx)("div",{className:"toggleMedals",children:(0,_.jsx)("a",{onClick:()=>j(!b),children:(0,O.Jh)(b?"spieler.showLess":"spieler.showMore")})})]}),(0,_.jsxs)("table",{className:"villages borderGap",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[G.serverSupportedFeatures.keepVidOnConquer&&(0,_.jsx)("th",{className:"tribe"}),(0,_.jsx)("th",{className:"name",children:(0,O.Jh)("spieler.dorfname")}),(0,_.jsx)("th",{className:"additionalInfoColumn"}),(0,_.jsx)("th",{className:"oases",children:(0,O.Jh)("spieler.oasen")}),(0,_.jsx)("th",{className:"inhabitants",children:(0,_.jsx)("i",{className:"population_medium",title:(0,O.Jh)("spieler.einwohner")})}),(0,_.jsx)("th",{className:"coordinates",children:(0,O.Jh)("spieler.koordinaten")})]})}),(0,_.jsx)("tbody",{children:$.villages.length&&l.villageNames&&$.villages.map(((e,t)=>(0,_.jsxs)("tr",{children:[G.serverSupportedFeatures.keepVidOnConquer&&(0,_.jsx)("td",{className:"tribe",children:(0,_.jsx)("i",{className:`tribe${e.tribeId}_medium`})}),(0,_.jsx)("td",{className:"name",children:(0,_.jsx)("label",{className:"input fixed",children:(0,_.jsx)("input",{type:"text",name:`village${e.id}`,value:l.villageNames.find((t=>e.id===t.id)).name??"",tabIndex:6+t,maxLength:"20",onChange:t=>c({...l,villageNames:[...l.villageNames.filter((t=>e.id!==t.id)),{id:e.id,name:t.target.value}]})})})}),(0,_.jsx)("td",{className:"additionalInfoColumn",children:e.typeText&&(0,_.jsx)("span",{className:"additionalInfo",title:e.typeTitle,children:e.typeText})}),(0,_.jsx)("td",{className:"oases",children:(0,_.jsx)("div",{children:e.occupiedOases&&Object.keys(e.occupiedOases).map((t=>(0,_.jsx)(Xi,{bonus:e.occupiedOases[t].bonus},e.id+t)))})}),(0,_.jsx)("td",{className:"inhabitants",children:e.population}),(0,_.jsx)("td",{className:"coordinates",children:(0,_.jsx)(O.rT,{x:e.x,y:e.y,configInput:{withMarkup:!0,aligned:"coordinatesAligned",linked:!0}})})]},e.mapId)))})]}),(0,_.jsx)("div",{className:"save",children:(0,_.jsxs)(F.z,{type:"submit",disabledClass:T||C||!f,disabledAttribute:!f,onClick:M,onSubmit:M,tabIndex:7+$.villages.length,children:[(0,_.jsx)("span",{children:(0,O.Jh)("allgemein.saveChanges")}),T&&(0,_.jsx)("i",{className:"loadingIndicator"}),C&&(0,_.jsx)(ee,{className:"saved"})]})})]})})};var dn=a(6407);class hn extends o.Component{static propTypes={viewData:d().object.isRequired};constructor(e){super(e),this.state={viewData:e.viewData,expandTimeCalculation:!1,walkingCalculationMapId:e.viewData.data.ownPlayer.hero.homeVillage.mapId,calculatedTravelingDurations:{}},this.updateWalkingCalculation=this.updateWalkingCalculation.bind(this),this.sendHeroRedirect=this.sendHeroRedirect.bind(this),this.startAdventure=this.startAdventure.bind(this)}componentDidMount(){new Travian.FormV2("#walkingCalculationVillage"),Travian.Game.ContextualHelp.check("/hero/adventures"),Travian.Tip.refresh()}componentDidUpdate(){Travian.Tip.refresh()}static getDerivedStateFromProps(e,t){return void 0!==e.viewData&&JSON.stringify(e.viewData)!==JSON.stringify(t.viewData)?{viewData:e.viewData,expandTimeCalculation:!1,calculatedTravelingDurations:{},walkingCalculationMapId:e.viewData.data.ownPlayer.hero.homeVillage.mapId}:null}sendHeroRedirect(){const{viewData:e,walkingCalculationMapId:t}=this.state,a=e.data.ownPlayer.villages,s=e.data.ownPlayer.hero;let i=a.find((e=>e.mapId===t));if(!i.hasRallyPoint||s.status.status!==Travian.Constants.HERO_STATUS_IN_VILLAGE)return!1;window.location.href="/build.php?id="+Travian.Constants.BUILDING_SLOT_RALLY_POINT+"&tt=2&newdid="+s.homeVillage.id+"&t11=1&x="+i.x+"&y="+i.y}updateWalkingCalculation(e){const t=parseInt(e.target.value),{walkingCalculationMapId:a,viewData:s}=this.state,i=s.data.ownPlayer.hero.adventures,n=s.data.ownPlayer.villages.find((e=>e.mapId===t));if(t!==a){const e=this,a=Object.values(i.map((e=>e.mapId)));a.push(t),Travian.api("adventures/calculate-travelingdurations",{data:{fromVillageId:n.id,adventureMapIds:a},success:function(a){a.travelingDurations&&e.setState({calculatedTravelingDurations:a.travelingDurations,walkingCalculationMapId:t})}})}}startAdventure(e){this.state.walkingCalculationMapId===this.state.viewData.data.ownPlayer.hero.homeVillage.mapId&&this.props.startAdventureCallback(e)}render(){const{viewData:e,walkingCalculationMapId:t,calculatedTravelingDurations:a}=this.state,{adventures:s,...i}=e.data.ownPlayer.hero,n=e.data.ownPlayer.villages,r=n?n.find((e=>e.mapId===t)):null,l=!!n&&n.find((e=>e.mapId===i.homeVillage.mapId)).hasRallyPoint,o=i.status.status===Travian.Constants.HERO_STATUS_IN_VILLAGE,c=o&&l;let d="";if(r)switch(!0){case!l:d="adventure.noRallyPointInHomeVillage";break;case!r.hasRallyPoint&&!o:d="adventure.noRallyPointAndHeroNotAvailableTooltip";break;case!r.hasRallyPoint:d="adventure.noRallyPointInThisVillageTooltip";break;case!o:d="adventure.heroNotAvailableTooltip"}return(0,_.jsxs)(_.Fragment,{children:[l?(0,_.jsx)(li,{heroState:i||!1}):(0,_.jsx)("span",{className:"noRallyPointInHomeVillage",children:(0,O.Jh)("adventure.noRallyPointInHomeVillage")}),(0,_.jsxs)("div",{className:["walkingCalculationWrapper",n&&n.length>1&&s&&s.length>0?"":"disabled",this.state.expandTimeCalculation?"expanded":"collapsed"].join(" "),children:[(0,_.jsxs)("div",{className:"title",onClick:e=>{this.setState({expandTimeCalculation:!this.state.expandTimeCalculation})},children:[(0,O.Jh)("adventure.durationCalculations"),(0,_.jsx)(dn.Z,{})]}),(0,_.jsxs)("div",{className:"formV2 walkingCalculationVillage",id:"walkingCalculationVillage",children:[(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{name:"village",value:t,onChange:this.updateWalkingCalculation,children:n&&n.map((e=>(0,_.jsx)("option",{value:e.mapId,children:e.name},e.mapId)))}),(0,_.jsx)("div",{className:"label pinned",children:(0,O.Jh)("adventure.selectVillage")})]}),t===i.homeVillage.mapId&&(0,_.jsx)(_.Fragment,{children:o?(0,_.jsx)("div",{className:"homeVillage",children:(0,O.Jh)("adventure.heroInSelectedVillage")}):(0,_.jsx)("div",{className:"heroNotAvailable",children:(0,O.Jh)("adventure.heroNotAvailable")})}),t!==i.homeVillage.mapId&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"walkingTime",children:[(0,_.jsx)("i",{className:"clock_medium"}),(0,_.jsx)("span",{children:(0,O.Jh)("adventure.walkingTimeToVillage",{DURATION:O.qp.durationFormat(a[t])})})]}),(0,_.jsx)(F.z,{className:"sendHero",disabledClass:!c||!r.hasRallyPoint,title:(0,O.Jh)(d),onClick:this.sendHeroRedirect,children:(0,O.Jh)("adventure.sendHero")}),(0,_.jsx)("div",{className:"moveHeroFirst",children:(0,O.Jh)("adventure.moveHeroFirst")}),!r.hasRallyPoint&&(0,_.jsx)("div",{className:"rallyPointNeeded",children:(0,O.Jh)("adventure.rallyPointNeeded")}),!o&&(0,_.jsx)("div",{className:"heroNotAvailable",children:(0,O.Jh)("adventure.heroNotAvailable")})]})]})]}),(0,_.jsxs)("table",{className:"borderGap adventureList",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{className:"place",children:(0,O.Jh)("adventure.place")}),(0,_.jsx)("th",{className:"coordinates"}),(0,_.jsx)("th",{className:"duration",children:(0,O.Jh)("adventure.move_time")}),(0,_.jsx)("th",{className:"difficulty",children:(0,O.Jh)("adventure.danger")}),(0,_.jsx)("th",{className:"button"})]})}),(0,_.jsx)("tbody",{children:s.length>0?s.map((e=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"place",children:(0,_.jsx)("img",{src:"/img/x.gif",className:e.place,alt:(0,O.Jh)("adventure."+e.place),title:(0,O.Jh)("adventure."+e.place)})}),(0,_.jsx)("td",{className:"coordinates",children:(0,_.jsx)(O.rT,{x:e.x,y:e.y,from:t,configInput:{withMarkup:!0,aligned:"coordinatesAligned",linked:!0}},`x${e.x}_y${e.y}_f${t}`)}),a[e.mapId]?(0,_.jsx)("td",{className:"duration "+(a[e.mapId]<=e.travelingDuration?"faster":"slower"),children:O.qp.durationFormat(a[e.mapId])}):(0,_.jsx)("td",{className:"duration",children:O.qp.durationFormat(e.travelingDuration)}),(0,_.jsx)("td",{className:"difficulty",children:(0,_.jsx)("i",{title:(0,O.Jh)("adventure.adventureDifficulty"+e.difficulty),alt:(0,O.Jh)("adventure.adventureDifficulty"+e.difficulty),className:"difficulty_"+(e.difficulty>0?"normal":"hard")})}),(0,_.jsx)("td",{className:"button",children:(0,_.jsx)(F.z,{disabledClass:!c||t!==i.homeVillage.mapId,"data-mapid":e.mapId,onClick:t=>!!c&&this.startAdventure(e),children:(0,_.jsx)("div",{children:(0,O.Jh)("adventure.explore")})})})]},e.mapId))):(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:"5",className:"noAdventures",children:(0,O.Jh)("adventure.noAdventures")})})})]})]})}}const un=e=>{const t=(0,o.useRef)(null);(0,o.useEffect)((()=>{Travian.Tip.refresh(),Travian.TimersAndCounters.initTimersInContext(t.current)}),[]);const{x:a,y:s,place:i,arrivalAt:n,arrivalIn:r,fromVillageId:l}=e.adventure;return(0,_.jsxs)("div",{className:`adventureStarted ${i}`,ref:t,children:[(0,_.jsxs)("div",{className:"heroState",children:[(0,_.jsx)("i",{className:"statusRunning_medium"}),(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{children:(0,O.Jh)("hero.status50",{NAME:(0,_.jsx)("span",{children:(0,_.jsx)(O.rT,{x:a,y:s,configInput:{withMarkup:!0,linked:!0},from:void 0})})},!0)})," ",(0,_.jsx)("span",{children:(0,O.Jh)("hero.heroArrival",{ARRIVAL:(0,_.jsx)("span",{className:"timer",counting:"down",value:r,children:O.qp.durationFormat(r)}),TIME:O.qp.timeFormat(n,ri.zt.TIME_WITHOUT_SECONDS)},!0)}),(0,_.jsx)("br",{}),(0,_.jsx)("span",{className:"hint",children:(0,O.Jh)("adventure.adventureInRallyPoint",{LINK:(0,_.jsx)("a",{href:`/build.php?id=${Travian.Constants.BUILDING_SLOT_RALLY_POINT}&tt=1&newdid=${l}`,children:(0,O.Jh)("adventure.adventureRallyPointLinkText")})},!0)})]})]}),(0,_.jsx)(F.z,{className:"continue",onClick:()=>{const{adventure:t,from:a,activePerspective:s}=e;window.location.href="tile"===a?"/karte.php?x="+t.x+"&y="+t.y:s===Travian.Constants.VILLAGE_PERSPECTIVE_RESOURCES?"/dorf1.php":"/dorf2.php"},children:(0,O.Jh)("allgemein.button_continue")})]})},mn=e=>(0,_.jsxs)("div",{className:"confirmationDialog",children:[(0,_.jsx)("div",{className:"message",children:(0,_.jsx)("p",{children:e.message})}),(0,_.jsxs)("div",{className:"buttons",children:[(0,_.jsx)(F.z,{appearance:e.appearanceCancel??"grey",onClick:e.closeDialogCallback,children:e.cancelText}),(0,_.jsx)(F.z,{appearance:e.appearanceConfirm??"green",onClick:t=>{e.onConfirm(),e.closeDialogCallback()},children:e.confirmText})]})]});mn.propTypes={message:d().string.isRequired,cancelText:d().string.isRequired,confirmText:d().string.isRequired,onConfirm:d().func.isRequired,appearanceCancel:d().string,appearanceConfirm:d().string};const pn=e=>{window.Travian.React.Dialog({content:(0,_.jsx)(mn,{...e}),cssClass:"plain",version:2,buttonOk:!1,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0},"confirmationDialog")},gn=e=>{const t=String.fromCharCode(60),a=String.fromCharCode(62),s=e.receive/e.give;return(0,_.jsx)("div",{className:"ratioIndicator "+("offerQuality"+(()=>{switch(!0){case isNaN(s):return 0;case s<.5:return 1;case s<=.7:return 2;case s<1:return 3;case s<1.3:return 4;default:return 5}})()),children:(0,_.jsx)("span",{className:"value",children:isNaN(s)&&(0,_.jsx)(_.Fragment,{children:"–"})||s<.5&&(0,_.jsxs)(_.Fragment,{children:[t,(0,O.eJ)(.5,{fraction:1})]})||s>2&&(0,_.jsxs)(_.Fragment,{children:[a,(0,O.eJ)(2,{fraction:0})]})||(0,_.jsx)(_.Fragment,{children:(0,O.eJ)(s,{fraction:1})})})})};gn.propTypes={receive:d().number.isRequired,give:d().number.isRequired};a(5615);var vn=a(7175),xn=a(1053),bn=a(7640),jn=a(6346);const fn=()=>{const[e,t]=(0,o.useState)(0),[a,s]=(0,o.useState)(1),[i,n]=(0,o.useState)(2),[r,l]=(0,o.useState)(3),[c,d]=(0,o.useState)(4),[h,u]=(0,o.useState)(8),[m,p]=(0,o.useState)(9),[g,v]=(0,o.useState)(100),[x,b]=(0,o.useState)(!1),[j,f]=(0,o.useState)("crop"),[y,T]=(0,o.useState)(!1),[N,C]=(0,o.useState)(!1),[S,k]=(0,o.useState)(!1);let w=(0,o.useRef)(null);const[E,I]=(0,o.useState)(""),[O,A]=(0,o.useState)(""),[D,L]=(0,o.useState)(""),[P,B]=(0,o.useState)(""),M=e=>{const t=e.target.dataset.option;f(t)};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("section",{className:"paginationExamples",children:[(0,_.jsx)("h4",{children:"Pagination"}),(0,_.jsx)(is.tl,{currentPage:e,pageCount:1,switchPage:t}),(0,_.jsx)(is.tl,{currentPage:a,pageCount:2,switchPage:s}),(0,_.jsx)(is.tl,{currentPage:i,pageCount:3,switchPage:n}),(0,_.jsx)(is.tl,{currentPage:r,pageCount:4,switchPage:l}),(0,_.jsx)(is.tl,{currentPage:c,pageCount:5,switchPage:d}),(0,_.jsx)(is.tl,{currentPage:h,pageCount:9,switchPage:u}),(0,_.jsx)(is.tl,{currentPage:m,pageCount:10,switchPage:p}),(0,_.jsx)(is.tl,{currentPage:g,pageCount:200,switchPage:v})]}),(0,_.jsxs)("section",{className:"selection",children:[(0,_.jsx)("h4",{children:"Selection"}),["lumber","clay","iron","crop"].map((e=>(0,_.jsx)(F.z,{active:j===e,"data-option":e,iconButton:!0,toggleButton:!0,activeNotClickable:!0,onClick:M,children:(0,_.jsx)("i",{className:`${e}_small`})},e)))]}),(0,_.jsxs)("section",{className:"toggle",children:[(0,_.jsx)("h4",{children:"Toggle"}),(0,_.jsx)(F.z,{active:x,iconButton:!0,toggleButton:!0,onClick:()=>{b((e=>!e))},children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(Et,{className:"outline"}),(0,_.jsx)(Et,{className:"icon"})]})})]}),(0,_.jsxs)("section",{className:"contextMenu",children:[(0,_.jsx)("h4",{children:"Context Menu"}),(0,_.jsxs)("div",{children:[(0,_.jsx)(F.z,{className:"openContextMenu",iconButton:!0,onClick:e=>{w.current=e.target,T(!0)},children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(vn.Z,{className:"outline"}),(0,_.jsx)(vn.Z,{className:"icon"})]})}),(0,_.jsx)("span",{children:"Default styles"}),y&&(0,_.jsx)($s,{contextParent:w.current,onClose:e=>T(!1),content:[{icon:(0,_.jsx)(Rs,{className:"swap"}),text:"Swap",disabled:!1,onClick:e=>{}},{icon:(0,_.jsx)(Ls,{className:"block"}),text:"Disabled",disabled:!0,onClick:e=>{}},{icon:(0,_.jsx)(_s,{}),text:"Move",disabled:!1,onClick:e=>{}}]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)(F.z,{className:"openContextMenu",iconButton:!0,onClick:e=>{w.current=e.target,C(!0)},children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(vn.Z,{className:"outline"}),(0,_.jsx)(vn.Z,{className:"icon"})]})}),(0,_.jsx)("span",{children:"With default buttons"}),N&&(0,_.jsx)($s,{contextParent:w.current,onClose:e=>C(!1),appearance:"defaultButtons",content:[{icon:(0,_.jsx)(xs.Z,{}),text:"Edit",disabled:!1,onClick:e=>{}},{icon:(0,_.jsx)(xn.Z,{}),text:"Duplicate",disabled:!0,onClick:e=>{}},{icon:(0,_.jsx)(R.Z,{}),text:"Delete",disabled:!1,onClick:e=>{}}]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)(F.z,{className:"openContextMenu",iconButton:!0,onClick:e=>{w.current=e.target,k(!0)},children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(vn.Z,{className:"outline"}),(0,_.jsx)(vn.Z,{className:"icon"})]})}),(0,_.jsx)("span",{children:"For sorting"}),S&&(0,_.jsx)($s,{contextParent:w.current,description:"Sort by",onClose:e=>k(!1),appearance:"sorting",content:[{icon:(0,_.jsx)("i",{className:"attack_lost_small"}),text:"Combat result",disabled:!1,onClick:e=>{},sortingArrow:(0,_.jsx)(bn.Z,{className:"sortingArrow down"})},{icon:(0,_.jsx)("i",{className:"clock_small"}),text:"Last raid",disabled:!1,onClick:e=>{},sortingArrow:(0,_.jsx)(bn.Z,{className:"sortingArrow up inactive"})},{icon:(0,_.jsx)(jn.Z,{}),text:"Total amount",disabled:!1,onClick:e=>{},sortingArrow:(0,_.jsx)(bn.Z,{className:"sortingArrow up inactive"})}]})]})]}),(0,_.jsxs)("section",{className:"progressBars",children:[(0,_.jsx)("h4",{children:"Progress Bars"}),(0,_.jsx)(Ra,{color:"green",primary:{nominator:30,denominator:100},title:"My little progress bar"}),(0,_.jsx)(Ra,{color:"orange",primary:{percent:55},title:"My little progress bar"}),(0,_.jsx)(Ra,{color:"blue",primary:{percent:60},secondary:{percent:20},hasPlusMinusButtons:!0,plusDisabled:!0,minusDisabled:!0,hasSlider:!1})]}),(0,_.jsxs)("section",{className:"snackbars",children:[(0,_.jsx)("h4",{children:"Snackbar"}),(0,_.jsx)(F.z,{onClick:e=>{I("This is a success message"),A(Math.random())},children:"Show success message"}),E&&(0,_.jsx)(Qt,{message:E,id:O,additionalClass:"success"}),(0,_.jsx)(F.z,{onClick:e=>{L("This is a warning message"),B(Math.random())},children:"Show warning message"}),D&&(0,_.jsx)(Qt,{message:D,id:P,additionalClass:"warning"})]}),(0,_.jsxs)("section",{className:"subNavigationExample",children:[(0,_.jsx)("h4",{children:"SubNavigation"}),(0,_.jsx)(qa,{activeKey:"one",items:[{kex:"one",text:"One"},{kex:"two",text:"Two"},{kex:"three",text:"Three"},{kex:"four",text:"Four"},{kex:"five",text:"Five"},{kex:"six",text:"Six"}]})]})]})};var yn=a(7999);const Tn=()=>{let e=(0,o.createRef)(),t=(0,o.useRef)(new O.w3);(0,o.useEffect)((()=>{t.current.attach(e.current)}),[]);const[a,s]=(0,o.useState)(null);return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)("form",{ref:e,className:"formV2",children:[(0,_.jsxs)("section",{className:"formHelper",children:[(0,_.jsx)("h4",{children:"React forms handler"}),(0,_.jsxs)("label",{className:"input",children:[(0,_.jsx)("input",{type:"text"}),(0,_.jsx)("div",{className:"label",children:"Username"}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,children:"Come on, write some text."})]}),(0,_.jsxs)("label",{className:"input",children:[(0,_.jsx)("input",{type:"text"}),(0,_.jsx)("div",{className:"label",children:"Username"}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.SHORTER_THAN,"data-parameter":5,children:"Type at most 5 characters"})]}),(0,_.jsxs)("label",{className:"radio",children:[(0,_.jsx)("input",{type:"radio",name:"dummyOption"}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsx)("div",{className:"label",children:"Radio option A"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.CHECKED,children:"Select this option."})]}),(0,_.jsxs)("label",{className:"radio",children:[(0,_.jsx)("input",{type:"radio",name:"dummyOption"}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsx)("div",{className:"label",children:"Radio option B"})]}),(0,_.jsxs)("label",{className:"input",children:[(0,_.jsx)("input",{type:"text"}),(0,_.jsx)("div",{className:"label",children:"Email"}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.IS_EMAIL,children:"Provide valid email address"})]}),(0,_.jsxs)("div",{className:"dateExample",children:[(0,_.jsxs)("label",{className:"input fixed",children:[(0,_.jsx)("input",{type:"text",placeholder:"DD",maxLength:"2"}),(0,_.jsx)("div",{className:"label",children:"Day"}),(0,_.jsxs)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,"data-render-into":".exampleValidationMessage",children:[(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{children:"Please set the day"})]})]}),(0,_.jsxs)("label",{className:"input fixed",children:[(0,_.jsx)("input",{type:"text",placeholder:"MM",maxLength:"2"}),(0,_.jsx)("div",{className:"label",children:"Month"}),(0,_.jsxs)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,"data-render-into":".exampleValidationMessage",children:[(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{children:"Enter a month"})]})]}),(0,_.jsxs)("label",{className:"input fixed",children:[(0,_.jsx)("input",{type:"text",placeholder:"YYYY",maxLength:"4"}),(0,_.jsx)("div",{className:"label",children:"Year"}),(0,_.jsxs)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,"data-render-into":".exampleValidationMessage",children:[(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{children:"Year missing"})]})]}),(0,_.jsx)("div",{className:"customValidationRenderElement exampleValidationMessage"})]}),(0,_.jsx)(F.z,{className:"dialogButtonOk",type:"submit",children:(0,_.jsx)("div",{children:"Submit"})})]}),(0,_.jsxs)("section",{className:"formHelper",children:[(0,_.jsx)("h4",{children:"Player Search"}),(0,_.jsx)("p",{children:(0,_.jsx)("i",{children:"Accepts multiple values. This example mimics the player selection when writing a message."})}),(0,_.jsx)(yn.M,{type:Travian.Constants.AUTO_COMPLETE.playerName,minLength:2,context:"messageRecipient",multiple:!0,multipleSeparator:"; "})]}),(0,_.jsxs)("section",{className:"formHelper",children:[(0,_.jsx)("h4",{children:"Target selection"}),(0,_.jsx)("p",{children:(0,_.jsx)("i",{children:"The target selector is a generic component that can be used in many ways and can be enhanced with custom error handling. In this example, it will prompt an error if the target village is named 'XAP'. Make sure there is a village with this name on this server, so it can be found."})}),(0,_.jsx)("p",{children:(0,_.jsx)("i",{children:"Duration and Arrival values depend on what is sent, therefore we cannot display values in this example."})}),(0,_.jsx)("p",{children:(0,_.jsx)("i",{children:"Autocompletion: Settings from player options -> Auto-complete are taken into account"})}),(0,_.jsx)(is.WM,{formHandler:t,onSelect:e=>{s("XAP"===e.name?"Sorry, we do not ship to XAP, it is dangerous territory.":null)},customError:a,duration:null,arrival:null})]}),(0,_.jsxs)("section",{className:"formHelper indeterminate",children:[(0,_.jsx)("h4",{children:"Indeterminate states"}),(0,_.jsx)("p",{children:(0,_.jsx)("i",{children:'For input elements in "edit"-forms that edit multiple entries, and one or more entry has a different value, we use the "indeterminate" state. The input value won\'t change for any entry unless you explicitly remove the indeterminate state by clicking on the radio button / checkbox or entering some new value.'})}),(0,_.jsxs)("label",{className:"input",title:(0,O.Jh)("form.selectionIncludesMultipleValues"),children:[(0,_.jsx)("input",{type:"text",defaultValue:(0,O.Jh)("form.indeterminate_input_text"),className:"indeterminate"}),(0,_.jsx)("div",{className:"label",children:"Text"})]}),(0,_.jsxs)("label",{className:"input",title:(0,O.Jh)("form.selectionIncludesMultipleValues"),children:[(0,_.jsx)("input",{type:"text",inputMode:"numeric",defaultValue:(0,O.Jh)("form.indeterminate_input_numeric"),className:"indeterminate"}),(0,_.jsx)("div",{className:"label",children:"Number"})]}),(0,_.jsxs)("label",{className:"radio",title:(0,O.Jh)("form.selectionIncludesMultipleValues"),children:[(0,_.jsx)("input",{type:"radio",name:"indeterminateOption",value:"a",className:"indeterminate"}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsx)("div",{className:"label",children:"A"})]}),(0,_.jsxs)("label",{className:"radio",title:(0,O.Jh)("form.selectionIncludesMultipleValues"),children:[(0,_.jsx)("input",{type:"radio",name:"indeterminateOption",value:"b",className:"indeterminate"}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsx)("div",{className:"label",children:"B"})]}),(0,_.jsxs)("label",{className:"checkbox",title:(0,O.Jh)("form.selectionIncludesMultipleValues"),children:[(0,_.jsx)("input",{type:"checkbox",name:"someOption",value:"a",className:"indeterminate"}),(0,_.jsx)(ts.Z,{className:"checkbox"}),(0,_.jsx)("div",{className:"label",children:"Indeterminate Checkbox"})]}),(0,_.jsxs)("label",{className:"switch",title:(0,O.Jh)("form.selectionIncludesMultipleValues"),children:[(0,_.jsx)("input",{type:"checkbox",name:"someSwitchOption",value:"a",className:"indeterminate"}),(0,_.jsx)("div",{className:"switch"}),(0,_.jsx)("div",{className:"label",children:"Indeterminate Switch"})]})]})]})})},Nn=()=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("section",{className:"troopicons",children:[(0,_.jsx)("h4",{children:"Troop icons"}),(0,_.jsx)("p",{children:"Comparison of old an new troop icons"}),(0,_.jsx)("div",{className:"oldNew",children:Object.values(Travian.Constants.TRIBE_ID).map((e=>(0,_.jsxs)("div",{className:"tribe",children:[(0,_.jsx)("b",{children:(0,O.Jh)(`allgemein.v${e}`)}),Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).map((t=>(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{className:"oldUnitIcons",children:(0,_.jsx)("i",{className:`unit tribe${e} ${t}`})}),(0,_.jsx)("span",{children:(0,_.jsx)("i",{className:`unit_small tribe${e} ${t}`})}),(0,_.jsx)("span",{children:(0,O.Jh)(`truppen.tid${10*(e-1)+parseInt(t.slice(1))}`)})]},`${e}${t}`))),(0,_.jsx)("br",{})]},e)))}),(0,_.jsx)("p",{children:"Comparison all new troop icons"}),(0,_.jsx)("div",{className:"allNew",children:Object.values(Travian.Constants.TRIBE_ID).map((e=>(0,_.jsxs)("div",{className:"tribe",children:[Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).map((t=>(0,_.jsx)("i",{className:`unit_medium tribe${e} ${t}`},`${e}${t}`))),(0,_.jsx)("br",{})]},e)))})]}),(0,_.jsxs)("section",{className:"iconOverview",children:[(0,_.jsx)("h4",{children:"Icon overview"}),(0,_.jsx)("div",{className:"overviewWrapper",children:(0,_.jsx)("div",{className:"groupWrapper",children:Object.values(Travian.Constants.TRIBE_ID).map((e=>e===Travian.Constants.TRIBE_ID.nature?"":(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{children:(0,_.jsx)("i",{className:`tribe${e}_small`})}),(0,_.jsx)("span",{children:(0,_.jsx)("i",{className:`tribe${e}_medium`})}),(0,_.jsx)("span",{children:(0,O.Jh)(`allgemein.v${e}`)})]},e)))})})]})]}),Cn=e=>{const{merchants:t,tradeShips:a}=e;return(0,_.jsx)(_.Fragment,{children:0===Object.keys(t).length?(0,_.jsx)("div",{className:"merchantsInformation placeholder"}):(0,_.jsxs)("div",{className:"merchantsInformation",children:[(0,_.jsxs)("div",{className:"available",children:[(0,O.Jh)("gid17.haendler"),": ",(0,_.jsx)("span",{className:"value",children:(0,O.T_)(t.available,t.total)})]}),(0,_.jsxs)("div",{className:"capacity",children:[(0,O.Jh)("gid17.merchantCapacity"),": ",(0,_.jsx)("span",{className:"value",children:t.capacity})]}),null!=a&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"available",children:[(0,O.Jh)("gid49.type_t901p"),": ",(0,_.jsx)("span",{className:"value",children:(0,O.T_)(a.available,a.total)})]}),(0,_.jsxs)("div",{className:"capacity",children:[(0,O.Jh)("gid17.tradeShipCapacity"),": ",(0,_.jsx)("span",{className:"value",children:a.capacity})]})]})]})})},Sn=e=>{const{data:t,setAmount:a,setResource:s,stock:i,capacity:n,totalCapacity:r,disabledResourceType:l}=e;return(0,_.jsxs)("div",{className:"resourcePicker",children:[Object.keys(Travian.Constants.RESOURCE_NAME).map((e=>{const a=Travian.Constants.RESOURCE_NAME[e];return(0,_.jsx)("div",{className:`resource ${a}`,children:(0,_.jsx)(F.z,{className:"selectResource",active:t.resource===a,disabledAttribute:l===a,iconButton:!0,toggleButton:!0,activeNotClickable:!0,onClick:e=>{s(a)},children:(0,_.jsx)("i",{className:`${a}_small`})})},e)})),(0,_.jsx)(Ra,{color:"blue",primary:{nominator:t.amount,denominator:r},steps:n,hasPlusMinusButtons:!0,hasSlider:!0,minusDisabled:0===t.amount,plusDisabled:t.amount>=r||t.amount===i,setValueCallback:e=>{a(e)},titlePlusButton:(0,O.Jh)("gid17.addMerchant"),titleMinusButton:(0,O.Jh)("gid17.subtractMerchant")}),(0,O.d_)((0,_.jsx)("label",{className:"input amount",children:(0,_.jsx)("input",{type:"text",inputMode:"numeric",disabled:i<=0||r<=0,value:t.amount,autoComplete:"off",onChange:e=>{a(parseInt(e.target.value))}})}),i,{wrapperClass:"stock",numeralConfig:{grouping:!0}})]})};Sn.propTypes={data:d().object.isRequired,setAmount:d().func.isRequired,setResource:d().func.isRequired,stock:d().number.isRequired,capacity:d().number.isRequired,totalCapacity:d().number.isRequired,disabledResourceType:d().string};const kn=e=>{const{deliveries:t,setDeliveries:a,hasPlus:s,hasGoldClub:i}=e,n=s||i,r=i,l=null===t;return(0,_.jsxs)("div",{className:"deliveriesSelector",children:[(0,_.jsx)("div",{children:(0,O.Jh)("gid17.deliveries")}),(0,_.jsxs)("label",{className:"radio",children:[(0,_.jsx)("input",{type:"radio",name:"deliveries",className:l?"indeterminate":"",defaultChecked:1===t,onChange:e=>{a(1)},tabIndex:8}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsxs)("div",{className:"label",children:[(0,_.jsx)("span",{className:"value",children:(0,O.eJ)(1,{unit:O.uo.TIMES})}),(0,_.jsx)("i",{className:"deliveries_1x"})]})]}),(0,_.jsxs)("label",{className:"radio "+(n?"":"disabledInput"),title:n?"":(0,O.Jh)("plus.goldClubOrPlusRequired"),onClick:n?e=>{}:e=>new Travian.Game.PlusDialog({featureKey:"tradeMulti",cssClass:"premiumFeaturePackage premiumFeaturePlus paymentShopV4",premiumFeatureDialogVersion:2,version:2,paymentShopVersion:4}),children:[(0,_.jsx)("input",{type:"radio",name:"deliveries",className:l?"indeterminate":"",disabled:!n,defaultChecked:2===t,onChange:e=>{a(2)},tabIndex:8}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsxs)("div",{className:"label",children:[(0,_.jsx)("span",{className:"value",children:(0,O.eJ)(2,{unit:O.uo.TIMES})}),(0,_.jsx)("i",{className:"deliveries_2x"})]})]}),(0,_.jsxs)("label",{className:"radio "+(r?"":"disabledInput"),title:r?"":(0,O.Jh)("plus.goldClubRequired"),onClick:r?e=>{}:e=>new Travian.Game.GoldclubDialog({featureKey:"tradeThreeTimes",cssClass:"premiumFeaturePackage premiumFeatureGoldclub paymentShopV4",premiumFeatureDialogVersion:2,version:2,paymentShopVersion:4}),children:[(0,_.jsx)("input",{type:"radio",name:"deliveries",className:l?"indeterminate":"",disabled:!r,defaultChecked:3===t,onChange:e=>{a(3)},tabIndex:8}),(0,_.jsx)(sn.Z,{className:"radio"}),(0,_.jsxs)("div",{className:"label",children:[(0,_.jsx)("span",{className:"value",children:(0,O.eJ)(3,{unit:O.uo.TIMES})}),(0,_.jsx)("i",{className:"deliveries_3x"})]})]})]})};kn.propTypes={deliveries:d().number,setDeliveries:d().func.isRequired,hasPlus:d().bool.isRequired,hasGoldClub:d().bool.isRequired};var wn=a(1279);const En=Ba.Ps`query {ownPlayer{banInfo{type} goldFeatures{travianPlus{isActive} goldClub} village{id marketplace{merchantsInfo{capacity available} tradeShipsInfo{capacity available}} isShore hasHarbour resources{lumberStock clayStock ironStock cropStock}}}}`,Rn=e=>{const{coordinates:t,source:a}=e,s="dialog"===a,i=(0,o.useRef)(),[n,r]=(0,o.useState)(!0),[l,c]=(0,o.useState)(null),[d,h]=(0,o.useState)(!1),[u,m]=(0,o.useState)(""),[p,g]=(0,o.useState)(0),[v,x]=(0,o.useState)(!1),[b,j]=(0,wn.w)("marketplace/resources/send"),[f,y]=(0,o.useState)(null),[T,N]=(0,o.useState)({}),C={capacity:1,available:0},[S,k]=(0,o.useState)({merchantsInfo:C,tradeShipsInfo:C}),[w,E]=(0,o.useState)({lumberStock:0,clayStock:0,ironStock:0,cropStock:0}),[R,I]=(0,o.useState)({travianPlus:!0,goldClub:!0}),[A,D]=(0,o.useState)(!1),[L,P]=(0,o.useState)(0),[B,M]=(0,o.useState)({[Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_LUMBER]]:0,[Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_CLAY]]:0,[Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_IRON]]:0,[Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_CROP]]:0}),[J,Z]=(0,o.useState)({x:null,y:null}),[V,H]=(0,o.useState)(1),[q,U]=(0,o.useState)(null),[z,$]=(0,o.useState)(null),[W,G]=(0,o.useState)(!1),Y=W?S.tradeShipsInfo:S.merchantsInfo,K=Y.available,X=K*Y.capacity,Q=Math.ceil(L/Y.capacity),ee=L>=X,te=L>X,ae=(0,Pa.a)();let se=(0,o.useRef)(new O.w3),ie=(0,o.useRef)();(0,o.useEffect)((()=>{Travian.Tip.refresh(),(new O.w3).attach(i.current.closest("form")),ne((()=>{null!==t.x&&null!==t.y&&Z(t)})),i.current.addEventListener("click",le)}),[]);const ne=(e=(()=>{}))=>{ae({query:En}).then((e=>{r(!1),y(e.data.ownPlayer.village.id),k(e.data.ownPlayer.village.marketplace),N({isShore:e.data.ownPlayer.village.isShore,hasHarbour:e.data.ownPlayer.village.hasHarbour}),E(e.data.ownPlayer.village.resources),I({travianPlus:e.data.ownPlayer.goldFeatures.travianPlus.isActive,goldClub:e.data.ownPlayer.goldFeatures.goldClub}),D(!!e.data.ownPlayer.banInfo&&e.data.ownPlayer.banInfo.type),c(null)})).then(e).catch(Travian.Autoreload.autoreload)};let re=!0;const le=e=>{re&&"submit"!==e.target.parentNode.type&&(re=!1,ne(),setTimeout((()=>{re=!0}),1e3))},oe=async e=>{const t={action:Travian.Constants.ACTION.marketPlace,resources:B,destination:J,runs:V,useTradeShips:W};return 0===L&&(t.resources=Object.assign({},{...t.resources,[Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_LUMBER]]:1})),b(t).then((e=>{if(e.duration){const t=Date.now()/1e3+e.duration;U(O.qp.durationFormat(e.duration)),null===z?$((0,_.jsx)("span",{className:"timer",counting:"up",value:t,ref:ie,children:O.qp.timeFormat(t,ri.zt.TIME)})):Travian.TimersAndCounters.updateTimer(ie.current,t)}})).catch((t=>{e&&c(t.message)}))},ce=async t=>{if(t.preventDefault(),t.currentTarget.classList.contains("disabled"))return!1;const a=i.current.closest("form");se.current.attach(a),se.current.validateForm(),se.current.formValid&&(await oe(!0),await j(),r(!0),ne(),m((0,O.Jh)("gid17.resourcesSent")),g(Math.random()),Travian.Game.Layout.updateResources(),"function"==typeof e.onSuccess&&e.onSuccess())},de=(e,t)=>{t=isNaN(parseInt(t))?0:parseInt(t),t=Math.max(0,t),t=Math.min(t,parseInt(w[e+"Stock"]));let a=0;Object.keys(B).filter((t=>t!==e)).forEach((e=>{a+=B[e]})),a+=t,M({...B,[e]:t}),P(a),x(!1)};return(0,o.useEffect)((()=>{let e=!1;Object.keys(B).map((t=>{const a=B[t],s=w[t+"Stock"];a>s&&(de(t,s),e=!0)})),e&&x(!0)}),[w]),(0,o.useEffect)((()=>{null!==J.x&&null!==J.y&&oe()}),[J,W]),(0,o.useEffect)((()=>{Travian.TimersAndCounters.initTimersInContext(i.current)}),[z]),(0,o.useEffect)((()=>{Travian.Tip.updateAllInElement(i.current)}),[R]),(0,o.useEffect)((()=>{h(L>0&&L<=X&&null!==J.x&&null!==J.y&&!A)}),[L,J,A,X]),(0,_.jsxs)("div",{className:"contentV2 sendResourcesView formV2",children:[n&&(0,_.jsx)("div",{className:"loadingIndicator",children:(0,_.jsx)("i",{className:"spinner"})}),(0,_.jsx)("h3",{children:(0,O.Jh)("gid17.sendRessources")}),(0,_.jsxs)("div",{className:"sendResourcesForm formV2",ref:i,children:[(0,_.jsx)(is.WM,{context:"sendResources",sourceVillageId:f,formHandler:se,onSelect:e=>{void 0!==e.x&&void 0!==e.y?Z({x:e.x,y:e.y}):Z({x:null,y:null})},duration:q,arrival:z,coordinates:t,tabIndexStart:1,resultsWrapperRef:i}),(0,_.jsxs)("div",{className:"merchantCarryInfo",children:[(0,_.jsxs)("p",{children:[!W&&(0,O.Jh)("gid17.haendler_tragen_kann_x_res_tragen",{INT:(0,_.jsx)("strong",{children:Y.capacity})},!0),W&&(0,O.Jh)("gid17.tradeShipsCanCarry",{INT:(0,_.jsx)("strong",{children:Y.capacity})},!0)]}),T.isShore&&(0,_.jsxs)("label",{className:"switch",title:T.hasHarbour?"":(0,O.Jh)("gid17.buildHarbourAndTradeShipsFirst"),children:[(0,_.jsx)("input",{type:"checkbox",name:"useTradeShips",value:"hide",onChange:e=>{G(e.target.checked)},checked:W,disabled:!T.hasHarbour}),(0,_.jsx)("div",{className:"switch"}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid17.useTradeShips")})]})]}),(0,_.jsx)("div",{className:"resourceSelector",children:Object.keys(B).map(((e,t)=>{const a=parseInt(B[e]),s=parseInt(w[e+"Stock"]);return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)("i",{className:`icon ${e}_medium`,title:(0,O.Jh)("allgemein.r"+(t+1))}),(0,_.jsx)(Ra,{color:"blue",primary:{nominator:a,denominator:X},steps:Y.capacity,hasPlusMinusButtons:!0,hasSlider:!0,minusDisabled:0===a,plusDisabled:ee||a>=s,setValueCallback:t=>{de(e,t)},titlePlusButton:(0,O.Jh)("gid17.addMerchant"),titleMinusButton:(0,O.Jh)("gid17.subtractMerchant")}),(0,_.jsx)(F.z,{className:"fillup",iconButton:!0,title:(0,O.Jh)("gid17.fillupResources"),onClick:()=>{de(e,Math.min(Math.max(a,X-L+a),s))},children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(Et,{className:"outline"}),(0,_.jsx)(Et,{className:"icon"})]})}),(0,O.d_)((0,_.jsx)("label",{className:"input amount",children:(0,_.jsx)("input",{type:"text",inputMode:"numeric",name:e,className:te&&a>0?"invalid":"",disabled:s<=0,value:a,autoComplete:"off",tabIndex:t+4,onChange:t=>{de(e,t.target.value)}})}),s,{wrapperClass:"stock",numeralConfig:{grouping:!0}})]},e)}))}),(0,_.jsxs)("div",{className:"summary",children:[(0,_.jsxs)("div",{children:[(0,O.Jh)("gid17.total"),": ",(0,O.T_)(L,X,{useSpaces:!0,useWrapper:!0,numeralConfig:{grouping:!0}})]}),(0,_.jsxs)("div",{className:te?"invalid":"",children:[W?(0,O.Jh)("gid49.type_"+Travian.Variables.shipIds.TRADE_SHIP+"p"):(0,O.Jh)("gid17.haendler"),": ",(0,O.T_)(Q,K,{useSpaces:!0,useWrapper:!0,numeralConfig:{grouping:!0}})]})]}),(0,_.jsx)(kn,{deliveries:V,setDeliveries:H,hasPlus:R.travianPlus,hasGoldClub:R.goldClub}),te&&!W&&(0,_.jsx)("div",{className:"error",children:(0,O.Jh)("gid17.notEnoughMerchants",{MERCHANTS_NEEDED:Q,MERCHANTS_AVAILABLE:K})}),te&&W&&(0,_.jsx)("div",{className:"error",children:(0,O.Jh)("gid17.notEnoughTradeShips",{NEEDED:Q,AVAILABLE:K})}),v&&(0,_.jsx)("div",{className:"error",children:(0,O.Jh)("gid17.resourcesAdjusted")}),l&&(0,_.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:l}}),(0,_.jsxs)("div",{className:"actionButtons",children:[s&&(0,_.jsx)(F.z,{appearance:"grey",className:"cancel",onClick:e.closeDialogCallback,children:(0,O.Jh)("allgemein.cancel_with_capital_c")}),(0,_.jsx)(F.z,{type:"submit",className:"send",disabledClass:!d,title:A?(0,O.Jh)("spieler.avatar_locked"):"",tabIndex:9,onSubmit:ce,onClick:ce,children:(0,O.Jh)("gid17.sendRessources")})]})]}),u&&(0,_.jsx)(Qt,{message:u,id:p,stickyTo:i.current,additionalClass:"success"})]})};var In;function On(){return On=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},On.apply(this,arguments)}const _n=e=>o.createElement("svg",On({viewBox:"0 0 256 256"},e),In||(In=o.createElement("path",{d:"m252.5 76.16-83.49 42.75c-3.07 1.57-6.53-.99-6.53-4.81v-22H6.05c-3.2 0-5.8-2.59-5.8-5.8V55.94c0-3.2 2.6-5.8 5.8-5.8h156.43V28.59c0-3.83 3.46-6.38 6.53-4.81l83.49 42.75c3.65 1.86 3.65 7.76 0 9.63zM2.99 189.77l83.49 42.75c3.07 1.57 6.53-.98 6.53-4.81v-21.99h156.43c3.2 0 5.8-2.6 5.8-5.8v-30.37c0-3.2-2.6-5.8-5.8-5.8H93.01V142.2c0-3.83-3.46-6.38-6.53-4.81L2.99 180.14c-3.65 1.87-3.65 7.76 0 9.63z"}))),An=["97","98","99"],Dn=e=>{const{selection:t}=e;let a=(0,o.createRef)(),s=(0,o.useRef)(new O.w3);const[i,n]=(0,o.useState)({x:null,y:null}),[r,l]=(0,o.useState)({x:null,y:null}),c=(0,o.useRef)("source"),d=(0,o.useRef)(),h=(0,o.useRef)(),u=(0,o.useRef)(),m=(0,o.useRef)(),[p,g]=(0,o.useState)(t.slowestUnitSpeed.default),[v,x]=(0,o.useState)(t.tournamentSquareLevel.default),[b,j]=(0,o.useState)(t.artefactBonus.default),[f,y]=(0,o.useState)(t.heroBoots.default),[T,N]=(0,o.useState)(t.heroItem.default),[C,S]=(0,o.useState)(t.heroHorse.default),[k,w]=(0,o.useState)(t.heroAbility.default),[E,R]=(0,o.useState)(t.useShip?t.useShip.default:null),[I,A]=(0,o.useState)(!1),[D,L]=(0,o.useState)(!1),[P,B]=(0,o.useState)(null),[M,J]=(0,o.useState)({distance:null,land:null,sea:null}),[Z,V]=(0,o.useState)(null);(0,o.useEffect)((()=>(s.current.attach(a.current),Travian.Game.Village.enableVillageListShortcuts(),jQuery(window).on("travian.villageList.coordinatesShortcut",H),()=>{Travian.Game.Village.disableVillageListShortcuts(),jQuery(window).off("travian.villageList.coordinatesShortcut",H)})),[]);const H=(e,t,a,s)=>{"source"===c.current?n({x:t,y:a}):l({x:t,y:a}),q(c.current)},q=e=>{setTimeout((()=>{"source"===e?(d.current.dispatchEvent(new Event("change")),h.current.dispatchEvent(new Event("change")),s.current.validate(d.current),s.current.validate(h.current)):(u.current.dispatchEvent(new Event("change")),m.current.dispatchEvent(new Event("change")),s.current.validate(u.current),s.current.validate(m.current))}),5)};(0,o.useEffect)((()=>{A(null!==i.x&&null!==i.y&&null!==r.x&&null!==r.y),V(null)}),[i,r,p,v,b,f,T,C,k,E]);const U=(e,t)=>{const a=e.clipboardData.getData("text/plain").replace(/[\u202D\u202C\u202E]/g,"").replace(/−/g,"-").replace(/[^0-9\-|/]/g,"").match(/^([0-9\-.,]+)([|/])([0-9\-.,]+)$/);e.preventDefault();let s=null!==a?a[1]:"",i=null!==a?a[3]:"";"source"==t?(n({x:s,y:i}),d.current.value=s,h.current.value=i,d.current.dispatchEvent(new Event("change")),h.current.dispatchEvent(new Event("change")),h.current.focus()):(l({x:s,y:i}),u.current.value=s,m.current.value=i,u.current.dispatchEvent(new Event("change")),m.current.dispatchEvent(new Event("change")),m.current.focus())};return(0,_.jsxs)("div",{ref:a,className:"formV2 travelSimulator",children:[(0,_.jsx)("div",{className:"description",children:(0,O.Jh)("gid16.ts_description")}),(0,_.jsxs)("div",{className:"coordinatesWrapper",children:[(0,_.jsx)("div",{className:"name",children:(0,O.Jh)("gid16.ts_source")}),(0,_.jsxs)("label",{className:"input coordinateX",children:[(0,_.jsx)("input",{type:"text",inputMode:"numeric",maxLength:"4",onFocus:e=>{c.current="source"},onPaste:e=>U(e,"source"),onChange:e=>{Travian.Formatter.Filter.aNumber(e.target),n({...i,x:e.target.value})},value:i.x??"",ref:d}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("allgemein.coordinateX")}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,"data-render-into":".sourceCoordinatesValidation",children:(0,O.Jh)("gid16.ts_source_invalid")})]}),(0,_.jsxs)("label",{className:"input coordinateY",children:[(0,_.jsx)("input",{type:"text",inputMode:"numeric",maxLength:"4",onFocus:e=>{c.current="source"},onPaste:e=>U(e,"source"),onChange:e=>{Travian.Formatter.Filter.aNumber(e.target),n({...i,y:e.target.value})},value:i.y??"",ref:h}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("allgemein.coordinateY")}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,"data-render-into":".sourceCoordinatesValidation",children:(0,O.Jh)("gid16.ts_source_invalid")})]}),(0,_.jsx)("div",{className:"customValidationRenderElement sourceCoordinatesValidation"}),(0,_.jsx)(F.z,{className:"switchSourceAndTarget",iconButton:!0,title:(0,O.Jh)("gid16.switchSourceAndTarget"),disabledAttribute:!(i.x||i.y||r.x||r.y),onClick:()=>{const e=i;n(r),l(e),q("source"),q("target")},children:(0,_.jsxs)("svg",{children:[(0,_.jsx)(_n,{className:"outline"}),(0,_.jsx)(_n,{className:"icon"})]})}),(0,_.jsx)("div",{className:"name",children:(0,O.Jh)("gid16.ts_target")}),(0,_.jsxs)("label",{className:"input coordinateX",children:[(0,_.jsx)("input",{type:"text",inputMode:"numeric",maxLength:"4",onFocus:e=>{c.current="target"},onPaste:e=>U(e,"target"),onChange:e=>{Travian.Formatter.Filter.aNumber(e.target),l({...r,x:e.target.value})},value:r.x??"",ref:u}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("allgemein.coordinateX")}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,"data-render-into":".targetCoordinatesValidation",children:(0,O.Jh)("gid16.ts_target_invalid")})]}),(0,_.jsxs)("label",{className:"input coordinateY",children:[(0,_.jsx)("input",{type:"text",inputMode:"numeric",maxLength:"4",onFocus:e=>{c.current="target"},onPaste:e=>U(e,"target"),onChange:e=>{Travian.Formatter.Filter.aNumber(e.target),l({...r,y:e.target.value})},value:r.y??"",ref:m}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("allgemein.coordinateY")}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,"data-render-into":".targetCoordinatesValidation",children:(0,O.Jh)("gid16.ts_target_invalid")})]}),(0,_.jsx)("div",{className:"customValidationRenderElement targetCoordinatesValidation"})]}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{size:"1",name:"slowestUnitSpeed",value:p,onChange:e=>g(e.target.value),children:Object.values(t.slowestUnitSpeed.options).map((e=>(0,_.jsx)("option",{value:e.key,children:e.value},"slowestUnitSpeed"+e.key)))}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid16.ts_slowestUnitSpeed")})]}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{size:"1",name:"tournamentSquareLevel",value:v,onChange:e=>x(e.target.value),children:Object.values(t.tournamentSquareLevel.options).map((e=>(0,_.jsx)("option",{value:e.key,children:"none"===e.key?(0,O.Jh)("gid16.ts_noTournamentSquare"):e.value},"tournamentSquareLevel"+e.key)))}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid16.ts_tournamentSquareLevel")})]}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{size:"1",name:"artefactBonus",value:b,onChange:e=>j(e.target.value),children:Object.values(t.artefactBonus.options).map((e=>(0,_.jsxs)("option",{value:e.key,children:["none"===e.key?(0,O.Jh)("gid16.ts_none"):(0,O.Jh)("gid27.arte_"+e.key+"_4"),"none"!==e.key&&(0,_.jsxs)(_.Fragment,{children:[" (",(0,O.eJ)(e.value,{unit:O.uo.TIMES,fraction:e.value%1==0?0:1}),")"]})]},"artefactBonus"+e.key)))}),(0,_.jsx)("div",{className:"label",children:Travian.Variables.feature_flags.territory?(0,O.Jh)("gid16.ts_ancientPowerBonus"):(0,O.Jh)("gid16.ts_artefactBonus")})]}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{size:"1",name:"heroBoots",value:f,onChange:e=>y(e.target.value),children:Object.values(t.heroBoots.options).map((e=>(0,_.jsx)("option",{value:e.key,dangerouslySetInnerHTML:{__html:"none"===e.key?(0,O.Jh)("gid16.ts_none"):e.description}},"heroBoots"+e.value)))}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid16.ts_heroBoots")})]}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{size:"1",name:"heroItem",value:T,onChange:e=>N(e.target.value),children:Object.values(t.heroItem.options).map((e=>(0,_.jsx)("option",{value:e.key,dangerouslySetInnerHTML:{__html:"none"===e.key?(0,O.Jh)("gid16.ts_none"):e.description}},"heroItem"+e.value)))}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid16.ts_heroItem")})]}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{size:"1",name:"heroHorse",value:C,onChange:e=>S(e.target.value),children:Object.values(t.heroHorse.options).map((e=>(0,_.jsx)("option",{value:e.key,dangerouslySetInnerHTML:{__html:"none"===e.key?(0,O.Jh)("gid16.ts_none"):e.description}},"heroHorse_"+e.key)))}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid16.ts_heroHorse")})]}),(0,_.jsxs)("label",{className:"select",children:[(0,_.jsx)("select",{size:"1",name:"heroAbility",value:k,onChange:e=>w(e.target.value),children:Object.values(t.heroAbility.options).map((e=>(0,_.jsx)("option",{value:e.key,dangerouslySetInnerHTML:{__html:"none"===e.key?(0,O.Jh)("gid16.ts_none"):e.description}},"heroAbility_"+e.key)))}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid16.ts_heroAbility")})]}),null!==E&&(0,_.jsxs)("label",{className:"switch",children:[(0,_.jsx)("input",{type:"checkbox",name:"useShips",value:E,checked:E,onChange:e=>R(e.target.checked)}),(0,_.jsx)("div",{className:"switch"}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("gid16.ts_useShips")})]}),(0,_.jsx)("br",{}),(0,_.jsxs)("div",{className:"calculationWrapper",children:[(0,_.jsx)(F.z,{disabledAttribute:!I,onClick:()=>{A(!1),B(null),J({distance:null,land:null,sea:null}),L(!0),Travian.api("troop/travelInfo",{data:{source:{x:parseInt(i.x),y:parseInt(i.y)},target:{x:parseInt(r.x),y:parseInt(r.y)},slowestUnitSpeed:t.slowestUnitSpeed.options.find((e=>e.key==p)).value,tournamentSquareLevel:t.tournamentSquareLevel.options.find((e=>e.key==v)).value,artefactBonus:t.artefactBonus.options.find((e=>e.key==b)).value,heroBoots:t.heroBoots.options.find((e=>e.key==f)).value,heroItem:t.heroItem.options.find((e=>e.key==T)).value,heroHorse:t.heroHorse.options.find((e=>e.key==C)).value,heroAbility:t.heroAbility.options.find((e=>e.key==k)).value,useShip:E},success:e=>{B(e.data.duration),J({distance:e.data.distance,land:e.data.land??null,sea:e.data.sea??null}),L(!1);let t=[];const a=E&&null===e.data.warning,s=!!Travian.Variables.pathfinding;(a&&s&&e.data.land<=Travian.Constants.TROOPS_MOVEMENT_SPEEDUP_DISTANCE||a&&!s&&e.data.distance<=Travian.Constants.TROOPS_MOVEMENT_SPEEDUP_DISTANCE||!a&&e.data.distance<=Travian.Constants.TROOPS_MOVEMENT_SPEEDUP_DISTANCE)&&("none"!==v&&t.push((0,O.Jh)(s?"gid16.ts_tournamentSquareLevel_distanceToShort_withShip":"gid16.ts_tournamentSquareLevel_distanceToShort")),An.includes(f)&&t.push((0,O.Jh)(s?"gid16.ts_heroItem_distanceToShort_withShip":"gid16.ts_heroItem_distanceToShort"))),E&&null!==e.data.warning&&t.push(e.data.warning),V(t.join("<br/>"))}})},children:(0,O.Jh)("gid16.ts_calculate")}),D&&(0,_.jsx)("div",{className:"loadingIndicator",children:(0,_.jsx)("i",{className:"spinner"})}),(0,_.jsxs)("div",{className:"duration "+(null!==P&&I?"outdated":""),children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("gid16.ts_travelDuration"),":"]})," ",null!==P?O.qp.durationFormat(P):"-"]}),null!==M.land?(0,_.jsxs)("div",{className:"distance ocean  "+(null!==M.distance&&I?"outdated":""),children:[(0,_.jsxs)("div",{className:"land",children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("gid16.ts_travelDistanceLand"),":"]})," ",(0,O.eJ)(M.land,{fraction:2})]}),(0,_.jsxs)("div",{className:"sea",children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("gid16.ts_travelDistanceSea"),":"]})," ",(0,O.eJ)(M.sea,{fraction:2})]})]}):(0,_.jsxs)("div",{className:"distance "+(null!==M.distance&&I?"outdated":""),children:[(0,_.jsxs)("span",{children:[(0,O.Jh)("gid16.ts_travelDistance"),":"]})," ",null!==M.distance?(0,O.eJ)(M.distance,{fraction:2}):"-"]})]}),Z&&(0,_.jsx)("div",{className:"warning",dangerouslySetInnerHTML:{__html:Z}})]})};var Ln;function Pn(){return Pn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Pn.apply(this,arguments)}const Bn=e=>o.createElement("svg",Pn({viewBox:"0 0 16.5 11.3"},e),Ln||(Ln=o.createElement("path",{d:"M8.2 9c.9 0 1.7-.3 2.4-1s1-1.5 1-2.4c0-.9-.3-1.7-1-2.4s-1.5-1-2.4-1c-.9 0-1.7.3-2.4 1s-1 1.5-1 2.4c0 .9.3 1.7 1 2.4s1.5 1 2.4 1zm0-1.3c-.6 0-1-.2-1.4-.6-.4-.4-.6-.9-.6-1.5s.2-1 .6-1.4c.4-.4.9-.6 1.4-.6.6 0 1 .2 1.4.6.4.4.6.9.6 1.4s-.2 1-.6 1.4c-.3.5-.8.7-1.4.7zm0 3.6c-1.8 0-3.5-.5-5-1.5C1.8 8.7.7 7.3 0 5.6c.7-1.7 1.8-3.1 3.3-4.1C4.8.5 6.5 0 8.3 0c1.8 0 3.5.5 5 1.5s2.6 2.4 3.3 4.1c-.7 1.7-1.8 3.1-3.3 4.1-1.5 1-3.3 1.6-5.1 1.6zm0-1.5c1.4 0 2.7-.4 3.9-1.1 1.2-.7 2.1-1.8 2.7-3-.6-1.2-1.5-2.3-2.7-3-1.1-.8-2.5-1.2-3.9-1.2s-2.7.4-3.9 1.1c-1.2.7-2.1 1.8-2.7 3 .6 1.2 1.5 2.3 2.7 3 1.2.8 2.6 1.2 3.9 1.2z"})));var Mn;function Jn(){return Jn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Jn.apply(this,arguments)}const Zn=e=>o.createElement("svg",Jn({viewBox:"0 0 200 10"},e),Mn||(Mn=o.createElement("path",{d:"m200 5-78.7-2.5c.2.75.54 1.57.67 2.35h-2.49c-.08-1.31-1.16-2.35-2.48-2.35s-2.41 1.04-2.48 2.35h-9.67L100 0l-4.85 4.85h-9.67C85.4 3.54 84.32 2.5 83 2.5s-2.41 1.04-2.48 2.35h-2.49c.13-.78.47-1.6.67-2.35L0 5l78.7 2.5c-.22-.74-.55-1.58-.67-2.35h2.49C80.6 6.46 81.68 7.5 83 7.5s2.41-1.04 2.48-2.35h9.67L100 10l4.85-4.85h9.67c.08 1.31 1.16 2.35 2.48 2.35s2.41-1.04 2.48-2.35h2.49c-.12.77-.46 1.61-.67 2.35L200 5Z"})));var Fn,Vn,Hn,qn,Un,zn,$n,Wn,Gn;function Yn(){return Yn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Yn.apply(this,arguments)}const Kn=e=>o.createElement("svg",Yn({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 128 57"},e),Fn||(Fn=o.createElement("path",{fill:"url(#a)",stroke:"#2E1509",strokeWidth:1.876,d:"M38 1.062h-.938v37.045l.416.28 24.5 16.393.522.349.522-.35 24.5-16.393.416-.278V1.062H38Z"})),Vn||(Vn=o.createElement("path",{fill:"url(#b)",d:"M39 3h47v34.237L62.5 53 39 37.237V3Z"})),Hn||(Hn=o.createElement("mask",{id:"d",width:101,height:21,x:14,y:22,fill:"#000",maskUnits:"userSpaceOnUse"},o.createElement("path",{fill:"#fff",d:"M14 22h101v21H14z"}),o.createElement("path",{d:"M16.986 36v-7.81h1.59v6.483h3.953V36h-5.543Zm6.36-3.889c0-.802.12-1.475.36-2.02.178-.4.422-.76.73-1.079a3.094 3.094 0 0 1 1.02-.709c.49-.207 1.057-.311 1.698-.311 1.16 0 2.087.36 2.782 1.08.698.719 1.047 1.72 1.047 3.002 0 1.27-.345 2.266-1.037 2.986-.69.716-1.614 1.074-2.771 1.074-1.17 0-2.102-.356-2.793-1.069-.691-.716-1.037-1.7-1.037-2.954Zm1.638-.053c0 .891.205 1.568.617 2.03.412.458.935.687 1.569.687.633 0 1.153-.227 1.557-.682.409-.458.613-1.144.613-2.057 0-.902-.2-1.575-.597-2.02-.393-.443-.918-.665-1.573-.665-.656 0-1.184.225-1.585.676-.4.448-.601 1.125-.601 2.03Zm7.25-3.932h3.148c.623 0 1.087.027 1.391.08a2 2 0 0 1 .822.323 2 2 0 0 1 .607.66c.161.273.242.579.242.919 0 .369-.1.707-.301 1.015a1.83 1.83 0 0 1-.806.693c.48.14.849.378 1.107.714.257.337.386.733.386 1.187 0 .358-.084.708-.252 1.048a2.1 2.1 0 0 1-.682.81c-.287.201-.641.325-1.064.371-.265.029-.904.047-1.917.054h-2.68v-7.874Zm1.59 1.31v1.821h1.043c.619 0 1.004-.009 1.154-.027.272-.032.485-.125.64-.279a.835.835 0 0 0 .236-.617c0-.244-.068-.44-.204-.591-.133-.154-.332-.247-.597-.28-.157-.018-.61-.027-1.358-.027h-.913Zm0 3.132v2.105h1.472c.573 0 .937-.016 1.09-.048a.98.98 0 0 0 .575-.312c.15-.168.226-.392.226-.67 0-.237-.057-.438-.172-.602a.971.971 0 0 0-.5-.36c-.215-.075-.684-.113-1.407-.113h-1.283Zm6.36-4.442h3.147c.623 0 1.087.027 1.391.08a2 2 0 0 1 .822.323 2 2 0 0 1 .607.66c.161.273.242.579.242.919 0 .369-.1.707-.301 1.015a1.83 1.83 0 0 1-.806.693c.48.14.849.378 1.107.714.258.337.386.733.386 1.187 0 .358-.084.708-.252 1.048a2.1 2.1 0 0 1-.682.81c-.286.201-.641.325-1.063.371-.265.029-.905.047-1.918.054h-2.68v-7.874Zm1.59 1.31v1.821h1.042c.62 0 1.004-.009 1.154-.027.273-.032.486-.125.64-.279a.835.835 0 0 0 .236-.617c0-.244-.068-.44-.204-.591-.133-.154-.331-.247-.596-.28-.158-.018-.61-.027-1.36-.027h-.912Zm0 3.132v2.105h1.471c.573 0 .937-.016 1.09-.048a.98.98 0 0 0 .575-.312c.15-.168.226-.392.226-.67 0-.237-.057-.438-.172-.602a.971.971 0 0 0-.5-.36c-.214-.075-.683-.113-1.407-.113h-1.283ZM50.196 36v-3.314l-2.885-4.56h1.864l1.853 3.115 1.816-3.115h1.831l-2.895 4.57V36h-1.584Zm14.818 0h-1.73l-.687-1.789H59.45L58.8 36h-1.686l3.066-7.874h1.682L65.014 36Zm-2.927-3.115-1.085-2.922-1.063 2.922h2.148Zm8.814.22 1.542.489c-.237.86-.63 1.498-1.182 1.917-.548.416-1.244.623-2.09.623-1.045 0-1.904-.356-2.578-1.069-.673-.716-1.01-1.693-1.01-2.932 0-1.31.34-2.328 1.016-3.051.677-.727 1.566-1.09 2.67-1.09.962 0 1.745.284 2.346.854.359.336.627.82.806 1.45l-1.574.376c-.093-.408-.288-.73-.585-.967-.294-.236-.652-.354-1.074-.354-.584 0-1.058.21-1.424.628-.361.419-.542 1.098-.542 2.036 0 .995.179 1.704.537 2.127.358.422.824.633 1.397.633.422 0 .785-.134 1.09-.402.304-.269.523-.691.655-1.268Zm7.95 0 1.54.489c-.236.86-.63 1.498-1.18 1.917-.549.416-1.245.623-2.09.623-1.046 0-1.905-.356-2.578-1.069-.674-.716-1.01-1.693-1.01-2.932 0-1.31.338-2.328 1.015-3.051.677-.727 1.567-1.09 2.67-1.09.963 0 1.745.284 2.347.854.358.336.626.82.805 1.45l-1.573.376c-.093-.408-.289-.73-.586-.967-.293-.236-.651-.354-1.074-.354-.584 0-1.058.21-1.423.628-.362.419-.543 1.098-.543 2.036 0 .995.18 1.704.537 2.127.358.422.824.633 1.397.633.422 0 .786-.134 1.09-.402.304-.269.523-.691.655-1.268Zm2.588-.994c0-.802.12-1.475.36-2.02.18-.4.423-.76.73-1.079a3.095 3.095 0 0 1 1.021-.709c.49-.207 1.056-.311 1.697-.311 1.16 0 2.088.36 2.782 1.08.699.719 1.048 1.72 1.048 3.002 0 1.27-.346 2.266-1.037 2.986-.69.716-1.615 1.074-2.771 1.074-1.171 0-2.102-.356-2.793-1.069-.691-.716-1.037-1.7-1.037-2.954Zm1.638-.053c0 .891.206 1.568.618 2.03.412.458.935.687 1.568.687.634 0 1.153-.227 1.558-.682.408-.458.612-1.144.612-2.057 0-.902-.198-1.575-.596-2.02-.394-.443-.918-.665-1.574-.665-.655 0-1.183.225-1.584.676-.401.448-.602 1.125-.602 2.03Zm7.235-3.932h1.59v4.265c0 .676.02 1.115.06 1.316.067.322.228.581.483.778.257.194.608.29 1.052.29.451 0 .792-.09 1.02-.273.23-.187.368-.414.414-.683.047-.268.07-.714.07-1.337v-4.356h1.59v4.136c0 .945-.043 1.613-.129 2.003-.086.39-.245.72-.478.988a2.4 2.4 0 0 1-.924.645c-.386.157-.891.236-1.514.236-.752 0-1.323-.086-1.714-.258a2.49 2.49 0 0 1-.918-.676 2.19 2.19 0 0 1-.446-.876c-.104-.451-.156-1.117-.156-1.998v-4.2ZM98.288 36v-7.874h1.547l3.223 5.258v-5.258h1.477V36h-1.595l-3.175-5.135V36h-1.477Zm9.706 0v-6.542h-2.337v-1.332h6.258v1.332h-2.331V36h-1.59Z"}))),qn||(qn=o.createElement("path",{fill:"url(#c)",d:"M16.986 36v-7.81h1.59v6.483h3.953V36h-5.543Zm6.36-3.889c0-.802.12-1.475.36-2.02.178-.4.422-.76.73-1.079a3.094 3.094 0 0 1 1.02-.709c.49-.207 1.057-.311 1.698-.311 1.16 0 2.087.36 2.782 1.08.698.719 1.047 1.72 1.047 3.002 0 1.27-.345 2.266-1.037 2.986-.69.716-1.614 1.074-2.771 1.074-1.17 0-2.102-.356-2.793-1.069-.691-.716-1.037-1.7-1.037-2.954Zm1.638-.053c0 .891.205 1.568.617 2.03.412.458.935.687 1.569.687.633 0 1.153-.227 1.557-.682.409-.458.613-1.144.613-2.057 0-.902-.2-1.575-.597-2.02-.393-.443-.918-.665-1.573-.665-.656 0-1.184.225-1.585.676-.4.448-.601 1.125-.601 2.03Zm7.25-3.932h3.148c.623 0 1.087.027 1.391.08a2 2 0 0 1 .822.323 2 2 0 0 1 .607.66c.161.273.242.579.242.919 0 .369-.1.707-.301 1.015a1.83 1.83 0 0 1-.806.693c.48.14.849.378 1.107.714.257.337.386.733.386 1.187 0 .358-.084.708-.252 1.048a2.1 2.1 0 0 1-.682.81c-.287.201-.641.325-1.064.371-.265.029-.904.047-1.917.054h-2.68v-7.874Zm1.59 1.31v1.821h1.043c.619 0 1.004-.009 1.154-.027.272-.032.485-.125.64-.279a.835.835 0 0 0 .236-.617c0-.244-.068-.44-.204-.591-.133-.154-.332-.247-.597-.28-.157-.018-.61-.027-1.358-.027h-.913Zm0 3.132v2.105h1.472c.573 0 .937-.016 1.09-.048a.98.98 0 0 0 .575-.312c.15-.168.226-.392.226-.67 0-.237-.057-.438-.172-.602a.971.971 0 0 0-.5-.36c-.215-.075-.684-.113-1.407-.113h-1.283Zm6.36-4.442h3.147c.623 0 1.087.027 1.391.08a2 2 0 0 1 .822.323 2 2 0 0 1 .607.66c.161.273.242.579.242.919 0 .369-.1.707-.301 1.015a1.83 1.83 0 0 1-.806.693c.48.14.849.378 1.107.714.258.337.386.733.386 1.187 0 .358-.084.708-.252 1.048a2.1 2.1 0 0 1-.682.81c-.286.201-.641.325-1.063.371-.265.029-.905.047-1.918.054h-2.68v-7.874Zm1.59 1.31v1.821h1.042c.62 0 1.004-.009 1.154-.027.273-.032.486-.125.64-.279a.835.835 0 0 0 .236-.617c0-.244-.068-.44-.204-.591-.133-.154-.331-.247-.596-.28-.158-.018-.61-.027-1.36-.027h-.912Zm0 3.132v2.105h1.471c.573 0 .937-.016 1.09-.048a.98.98 0 0 0 .575-.312c.15-.168.226-.392.226-.67 0-.237-.057-.438-.172-.602a.971.971 0 0 0-.5-.36c-.214-.075-.683-.113-1.407-.113h-1.283ZM50.196 36v-3.314l-2.885-4.56h1.864l1.853 3.115 1.816-3.115h1.831l-2.895 4.57V36h-1.584Zm14.818 0h-1.73l-.687-1.789H59.45L58.8 36h-1.686l3.066-7.874h1.682L65.014 36Zm-2.927-3.115-1.085-2.922-1.063 2.922h2.148Zm8.814.22 1.542.489c-.237.86-.63 1.498-1.182 1.917-.548.416-1.244.623-2.09.623-1.045 0-1.904-.356-2.578-1.069-.673-.716-1.01-1.693-1.01-2.932 0-1.31.34-2.328 1.016-3.051.677-.727 1.566-1.09 2.67-1.09.962 0 1.745.284 2.346.854.359.336.627.82.806 1.45l-1.574.376c-.093-.408-.288-.73-.585-.967-.294-.236-.652-.354-1.074-.354-.584 0-1.058.21-1.424.628-.361.419-.542 1.098-.542 2.036 0 .995.179 1.704.537 2.127.358.422.824.633 1.397.633.422 0 .785-.134 1.09-.402.304-.269.523-.691.655-1.268Zm7.95 0 1.54.489c-.236.86-.63 1.498-1.18 1.917-.549.416-1.245.623-2.09.623-1.046 0-1.905-.356-2.578-1.069-.674-.716-1.01-1.693-1.01-2.932 0-1.31.338-2.328 1.015-3.051.677-.727 1.567-1.09 2.67-1.09.963 0 1.745.284 2.347.854.358.336.626.82.805 1.45l-1.573.376c-.093-.408-.289-.73-.586-.967-.293-.236-.651-.354-1.074-.354-.584 0-1.058.21-1.423.628-.362.419-.543 1.098-.543 2.036 0 .995.18 1.704.537 2.127.358.422.824.633 1.397.633.422 0 .786-.134 1.09-.402.304-.269.523-.691.655-1.268Zm2.588-.994c0-.802.12-1.475.36-2.02.18-.4.423-.76.73-1.079a3.095 3.095 0 0 1 1.021-.709c.49-.207 1.056-.311 1.697-.311 1.16 0 2.088.36 2.782 1.08.699.719 1.048 1.72 1.048 3.002 0 1.27-.346 2.266-1.037 2.986-.69.716-1.615 1.074-2.771 1.074-1.171 0-2.102-.356-2.793-1.069-.691-.716-1.037-1.7-1.037-2.954Zm1.638-.053c0 .891.206 1.568.618 2.03.412.458.935.687 1.568.687.634 0 1.153-.227 1.558-.682.408-.458.612-1.144.612-2.057 0-.902-.198-1.575-.596-2.02-.394-.443-.918-.665-1.574-.665-.655 0-1.183.225-1.584.676-.401.448-.602 1.125-.602 2.03Zm7.235-3.932h1.59v4.265c0 .676.02 1.115.06 1.316.067.322.228.581.483.778.257.194.608.29 1.052.29.451 0 .792-.09 1.02-.273.23-.187.368-.414.414-.683.047-.268.07-.714.07-1.337v-4.356h1.59v4.136c0 .945-.043 1.613-.129 2.003-.086.39-.245.72-.478.988a2.4 2.4 0 0 1-.924.645c-.386.157-.891.236-1.514.236-.752 0-1.323-.086-1.714-.258a2.49 2.49 0 0 1-.918-.676 2.19 2.19 0 0 1-.446-.876c-.104-.451-.156-1.117-.156-1.998v-4.2ZM98.288 36v-7.874h1.547l3.223 5.258v-5.258h1.477V36h-1.595l-3.175-5.135V36h-1.477Zm9.706 0v-6.542h-2.337v-1.332h6.258v1.332h-2.331V36h-1.59Z"})),Un||(Un=o.createElement("path",{fill:"#2E1509",d:"M16.986 36h-2.501v2.502h2.501V36Zm0-7.81V25.69h-2.501v2.501h2.501Zm1.59 0h2.501V25.69h-2.501v2.501Zm0 6.483h-2.502v2.502h2.502v-2.502Zm3.953 0h2.502v-2.501h-2.502v2.501Zm0 1.327v2.502h2.502V36h-2.502Zm-3.041 0v-7.81h-5.003V36h5.003Zm-2.502-5.308h1.59v-5.003h-1.59v5.003Zm-.912-2.502v6.483h5.003V28.19h-5.003Zm2.502 8.985h3.953v-5.003h-3.953v5.003Zm1.451-2.502V36h5.004v-1.327h-5.003Zm2.502-1.175h-5.543v5.004h5.543v-5.004Zm1.176-3.406-2.284-1.02-.005.01 2.29 1.01Zm.73-1.08-1.788-1.748-.005.005-.005.005 1.799 1.738Zm1.021-.709.964 2.309.011-.005-.975-2.304Zm4.48.768-1.8 1.737.004.005 1.796-1.742Zm.01 5.99 1.8 1.736.005-.004-1.805-1.733Zm-5.564.004-1.8 1.738.004.004 1.796-1.742Zm1.22-.977-1.868 1.664.006.008 1.861-1.672Zm3.125.005L26.86 32.43v.001l1.868 1.663Zm.016-4.076-1.87 1.66.007.008 1.863-1.668Zm-3.158.01 1.863 1.67.007-.008-1.87-1.662Zm.262 2.084c0-.569.087-.874.147-1.01l-4.578-2.018c-.42.952-.572 1.993-.572 3.028h5.003Zm.143-1c.059-.132.137-.25.245-.36l-3.598-3.477a6.232 6.232 0 0 0-1.216 1.798l4.569 2.04Zm.235-.35a.621.621 0 0 1 .195-.15l-1.927-4.616a5.59 5.59 0 0 0-1.846 1.269l3.578 3.497Zm.206-.154c.127-.054.35-.114.723-.114V25.49c-.91 0-1.818.148-2.673.51l1.95 4.607Zm.723-.114c.599 0 .835.163.982.316l3.6-3.475c-1.242-1.287-2.861-1.844-4.582-1.844v5.003Zm.986.32c.13.133.342.44.342 1.26h5.003c0-1.743-.486-3.437-1.754-4.744l-3.59 3.484Zm.342 1.26c0 .81-.21 1.119-.34 1.255l3.609 3.465c1.252-1.304 1.734-2.987 1.734-4.72h-5.003Zm-.335 1.25c-.143.148-.375.31-.972.31v5.003c1.716 0 3.332-.554 4.572-1.839l-3.6-3.474Zm-.972.31c-.626 0-.861-.17-.997-.31l-3.592 3.484c1.247 1.285 2.873 1.829 4.589 1.829v-5.003Zm-.993-.305c-.132-.137-.335-.435-.335-1.217h-5.003c0 1.726.488 3.396 1.738 4.692l3.6-3.475Zm-3.7-1.27c0 1.238.283 2.608 1.252 3.694l3.735-3.329c.067.076.075.124.062.083a1.633 1.633 0 0 1-.046-.448h-5.003Zm1.259 3.702c.901 1.003 2.108 1.517 3.429 1.517v-5.003c-.01 0 .048 0 .136.038.09.04.143.09.156.104l-3.721 3.344Zm3.429 1.517c1.314 0 2.525-.508 3.426-1.52l-3.738-3.327a.526.526 0 0 1 .173-.117c.092-.04.151-.04.139-.04v5.004Zm3.425-1.52c.976-1.095 1.246-2.486 1.246-3.72h-5.003c0 .277-.032.427-.049.485-.015.049-.007-.006.07-.093l3.736 3.328Zm1.246-3.72c0-1.212-.259-2.6-1.234-3.689l-3.727 3.337c-.09-.1-.101-.166-.089-.122.016.052.047.197.047.473h5.003Zm-1.226-3.68c-.921-1.039-2.158-1.508-3.445-1.508v5.003c.042 0-.001.006-.09-.031a.6.6 0 0 1-.208-.144l3.743-3.32Zm-3.445-1.508c-1.301 0-2.535.482-3.455 1.516l3.74 3.324a.558.558 0 0 1-.19.131c-.088.038-.133.032-.095.032V26.85Zm-3.448 1.509c-.977 1.091-1.24 2.481-1.24 3.7h5.003c0-.277.032-.424.047-.477.014-.044.003.02-.084.116l-3.726-3.339Zm8.513-.232v-2.502h-2.502v2.502h2.502Zm4.538.08-.434 2.464.016.003.016.003.402-2.47Zm.822.323-1.416 2.062.007.005.007.005 1.402-2.072Zm.607.66-2.16 1.263.004.006.003.006 2.153-1.274Zm-.06 1.934-2.095-1.365-.006.009-.006.008 2.108 1.348Zm-.805.693-1.031-2.279-6.164 2.79 6.496 1.89.7-2.401Zm1.24 2.949-2.241-1.11-.005.01 2.247 1.1Zm-.681.81 1.434 2.05.005-.004-1.44-2.045Zm-1.064.371.27 2.487h.004l-.274-2.487ZM34.915 36v2.502h.017L34.915 36Zm-2.68 0h-2.502v2.502h2.502V36Zm1.59-6.564v-2.501h-2.502v2.502h2.502Zm0 1.821h-2.502v2.502h2.502v-2.502Zm2.196-.027-.294-2.484h-.002l.296 2.485Zm.672-1.487-1.897 1.631.02.024.022.023 1.855-1.678Zm-.597-.28.302-2.483-.01-.001-.01-.001-.282 2.485Zm-2.271 3.105v-2.502h-2.502v2.502h2.502Zm0 2.105h-2.502v2.502h2.502v-2.502Zm2.561-.048-.447-2.461-.033.006-.032.006.512 2.449Zm.575-.312-1.865-1.666-.002.002 1.867 1.664Zm.054-1.273 2.053-1.428-2.053 1.429Zm-.5-.36-.826 2.362.012.004.814-2.365Zm-4.28-2.052h3.147v-5.003h-3.147v5.003Zm3.147 0c.593 0 .877.028.957.042l.869-4.927c-.529-.093-1.172-.118-1.826-.118v5.003Zm.99.048a.592.592 0 0 1-.192-.084l2.83-4.125a4.498 4.498 0 0 0-1.835-.73l-.804 4.939Zm-.179-.075a.608.608 0 0 1-.15-.15l4.319-2.524a4.5 4.5 0 0 0-1.365-1.47L36.193 30.6Zm-.144-.137a.812.812 0 0 1-.085-.204.613.613 0 0 1-.022-.152h5.003c0-.754-.184-1.506-.59-2.193l-4.306 2.549Zm-.107-.356a.656.656 0 0 1 .104-.35l4.193 2.73a4.324 4.324 0 0 0 .706-2.38h-5.003Zm.093-.333a.675.675 0 0 1 .27-.238l2.064 4.558a4.332 4.332 0 0 0 1.881-1.624l-4.215-2.696Zm.603 4.443c.039.011.024.012-.021-.017a.652.652 0 0 1-.16-.15l3.972-3.042c-.637-.832-1.495-1.334-2.393-1.595l-1.398 4.804Zm-.18-.167a.673.673 0 0 1-.103-.197.477.477 0 0 1-.026-.137h5.003c0-.962-.285-1.902-.903-2.708l-3.971 3.042Zm-.13-.334a.25.25 0 0 1 .007-.056c.004-.016.007-.018 0-.006l4.485 2.219c.328-.664.512-1.39.512-2.157h-5.003Zm.003-.052a.467.467 0 0 1 .125-.135l2.88 4.091a4.6 4.6 0 0 0 1.489-1.757l-4.494-2.199Zm.13-.139a.556.556 0 0 1 .13-.07c.023-.007.016-.002-.033.004l.548 4.973c.75-.083 1.527-.32 2.224-.808l-2.869-4.099Zm.102-.067a15.772 15.772 0 0 1-.48.021c-.294.009-.688.015-1.186.019l.035 5.002c.971-.006 1.752-.023 2.17-.068l-.539-4.974Zm-1.648.04h-2.68V38.5h2.68V33.5ZM34.736 36v-7.874h-5.003V36h5.003Zm-3.413-6.564v1.821h5.003v-1.82h-5.003Zm2.502 4.323h1.041v-5.003h-1.041v5.003Zm1.041 0c.562 0 1.12-.005 1.451-.045l-.592-4.967c.047-.006.06-.006.014-.003a31.733 31.733 0 0 1-.873.012v5.003Zm1.45-.044c.682-.081 1.469-.35 2.113-.995l-3.537-3.538c.336-.336.696-.42.835-.436l.588 4.969Zm2.113-.995c.694-.694.97-1.57.97-2.386h-5.004c0-.133.021-.327.106-.55.088-.228.224-.435.39-.602l3.538 3.538Zm.97-2.386c0-.733-.219-1.57-.851-2.27l-3.71 3.357a1.754 1.754 0 0 1-.357-.601 1.503 1.503 0 0 1-.086-.486h5.003Zm-.81-2.223c-.654-.76-1.506-1.048-2.19-1.13l-.605 4.966c-.154-.02-.61-.121-.998-.573l3.793-3.263Zm-2.21-1.133c-.334-.038-.962-.043-1.642-.043v5.003a45.408 45.408 0 0 1 1.076.013c.061.002.05.003.001-.002l.565-4.971Zm-1.642-.043h-.913v5.003h.913v-5.003Zm-3.414 5.633v2.105h5.003v-2.105h-5.003Zm2.502 4.607h1.471v-5.003h-1.471v5.003Zm1.471 0c.492 0 1.142-.005 1.603-.101l-1.025-4.898c.094-.02.148-.023.125-.02a14.077 14.077 0 0 1-.703.016v5.003Zm1.538-.089a3.48 3.48 0 0 0 1.995-1.108l-3.735-3.329c.116-.13.26-.246.421-.333.16-.087.308-.131.424-.152l.895 4.922Zm1.992-1.106c.652-.728.862-1.596.862-2.338h-5.003c0-.183.06-.603.41-.995l3.732 3.333Zm.862-2.338c0-.654-.164-1.376-.62-2.03l-4.107 2.857a1.486 1.486 0 0 1-.276-.827h5.003Zm-.62-2.03a3.47 3.47 0 0 0-1.738-1.297l-1.629 4.73a1.538 1.538 0 0 1-.74-.576l4.107-2.857Zm-1.726-1.292a4.611 4.611 0 0 0-1.14-.218 14.025 14.025 0 0 0-1.094-.036v5.003c.326 0 .552.01.695.02.07.006.099.01.097.01a1.572 1.572 0 0 1-.21-.058l1.652-4.721Zm-2.234-.254h-1.283v5.003h1.283v-5.003Zm5.076-1.94v-2.502h-2.502v2.502h2.502Zm4.538.08-.434 2.464.016.003.017.003.401-2.47Zm.822.323-1.416 2.062.007.005.008.005 1.401-2.072Zm.607.66-2.16 1.263.004.006.004.006 2.152-1.274Zm-.059 1.934-2.096-1.365-.006.009-.005.008 2.107 1.348Zm-.806.693-1.031-2.279-6.164 2.79 6.496 1.89.7-2.401Zm1.241 2.949-2.242-1.11-.005.01 2.247 1.1Zm-.682.81 1.434 2.05.006-.004-1.44-2.045Zm-1.063.371.268 2.487h.005l-.273-2.487ZM42.864 36v2.502h.018L42.864 36Zm-2.68 0h-2.502v2.502h2.502V36Zm1.59-6.564v-2.501h-2.502v2.502h2.502Zm0 1.821h-2.502v2.502h2.502v-2.502Zm2.197-.027-.295-2.484h-.001l.296 2.485Zm.67-1.487-1.895 1.631.02.024.02.023 1.856-1.678Zm-.595-.28.302-2.483-.01-.001-.01-.001-.282 2.485Zm-2.272 3.105v-2.502h-2.502v2.502h2.502Zm0 2.105h-2.502v2.502h2.502v-2.502Zm2.562-.048-.448-2.461-.032.006-.033.006.513 2.449Zm.574-.312-1.865-1.666-.002.002 1.867 1.664Zm.054-1.273 2.054-1.428-2.054 1.429Zm-.5-.36-.826 2.362.012.004.815-2.365Zm-4.28-2.052h3.147v-5.003h-3.147v5.003Zm3.147 0c.593 0 .877.028.957.042l.87-4.927c-.53-.093-1.173-.118-1.827-.118v5.003Zm.99.048a.597.597 0 0 1-.192-.084l2.831-4.125a4.499 4.499 0 0 0-1.836-.73l-.803 4.939Zm-.178-.075a.606.606 0 0 1-.152-.15l4.32-2.524a4.501 4.501 0 0 0-1.365-1.47L44.143 30.6Zm-.144-.137a.812.812 0 0 1-.086-.204.613.613 0 0 1-.022-.152h5.003c0-.754-.183-1.506-.59-2.193l-4.305 2.549Zm-.108-.356a.656.656 0 0 1 .105-.35l4.192 2.73a4.324 4.324 0 0 0 .706-2.38h-5.003Zm.094-.333a.675.675 0 0 1 .27-.238l2.063 4.558a4.332 4.332 0 0 0 1.881-1.624l-4.214-2.696Zm.602 4.443c.04.011.024.012-.021-.017a.654.654 0 0 1-.16-.15l3.973-3.042c-.637-.832-1.496-1.334-2.394-1.595l-1.398 4.804Zm-.18-.167a.673.673 0 0 1-.103-.197.477.477 0 0 1-.026-.137h5.003c0-.962-.285-1.902-.902-2.708l-3.972 3.042Zm-.129-.334a.25.25 0 0 1 .007-.056c.004-.016.006-.018 0-.006l4.484 2.219c.329-.664.512-1.39.512-2.157h-5.003Zm.002-.052a.465.465 0 0 1 .125-.135l2.88 4.091a4.6 4.6 0 0 0 1.489-1.757l-4.494-2.199Zm.13-.139a.558.558 0 0 1 .131-.07c.022-.007.015-.002-.033.004l.547 4.973c.751-.083 1.527-.32 2.224-.808l-2.869-4.099Zm.103-.067a15.759 15.759 0 0 1-.48.021c-.295.009-.689.015-1.187.019l.036 5.002c.97-.006 1.75-.023 2.168-.068l-.537-4.974Zm-1.649.04h-2.68V38.5h2.68V33.5ZM42.685 36v-7.874h-5.003V36h5.003Zm-3.413-6.564v1.821h5.003v-1.82h-5.003Zm2.502 4.323h1.042v-5.003h-1.042v5.003Zm1.042 0c.561 0 1.118-.005 1.45-.045l-.591-4.967c.046-.006.06-.006.013-.003a31.733 31.733 0 0 1-.873.012v5.003Zm1.449-.044c.683-.081 1.469-.35 2.114-.995l-3.538-3.538c.336-.336.697-.42.835-.436l.589 4.969Zm2.114-.995c.694-.694.968-1.57.968-2.386h-5.003c0-.133.021-.327.106-.55a1.73 1.73 0 0 1 .39-.602l3.538 3.538Zm.968-2.386c0-.733-.218-1.57-.85-2.27l-3.71 3.357a1.755 1.755 0 0 1-.356-.601 1.503 1.503 0 0 1-.087-.486h5.003Zm-.809-2.223c-.653-.76-1.505-1.048-2.19-1.13l-.604 4.966c-.155-.02-.61-.121-.998-.573l3.792-3.263Zm-2.21-1.133c-.334-.038-.961-.043-1.641-.043v5.003a45.404 45.404 0 0 1 1.075.013c.061.002.05.003.001-.002l.565-4.971Zm-1.641-.043h-.913v5.003h.913v-5.003Zm-3.415 5.633v2.105h5.003v-2.105h-5.003Zm2.502 4.607h1.471v-5.003h-1.471v5.003Zm1.471 0c.492 0 1.143-.005 1.603-.101l-1.025-4.898c.094-.02.148-.023.125-.02a14.075 14.075 0 0 1-.703.016v5.003Zm1.538-.089a3.479 3.479 0 0 0 1.995-1.108l-3.735-3.329c.117-.13.26-.246.422-.333.159-.087.307-.131.423-.152l.895 4.922Zm1.993-1.106c.651-.728.861-1.596.861-2.338h-5.002c0-.183.06-.603.41-.995l3.73 3.333Zm.861-2.338c0-.654-.164-1.376-.62-2.03l-4.106 2.857a1.486 1.486 0 0 1-.276-.827h5.003Zm-.62-2.03a3.47 3.47 0 0 0-1.738-1.297l-1.629 4.73a1.538 1.538 0 0 1-.74-.576l4.108-2.857Zm-1.726-1.292a4.61 4.61 0 0 0-1.14-.218 14.023 14.023 0 0 0-1.094-.036v5.003c.327 0 .552.01.695.02.07.006.1.01.097.01a1.564 1.564 0 0 1-.21-.058l1.652-4.721Zm-2.234-.254h-1.283v5.003h1.283v-5.003ZM50.196 36h-2.502v2.502h2.502V36Zm0-3.314h2.501v-.725l-.387-.612-2.114 1.337Zm-2.885-4.56v-2.502H42.77l2.428 3.84 2.114-1.338Zm1.864 0 2.15-1.279-.727-1.223h-1.423v2.502Zm1.853 3.115-2.15 1.279 2.172 3.652 2.14-3.671-2.162-1.26Zm1.816-3.115v-2.502h-1.438l-.724 1.242 2.161 1.26Zm1.831 0 2.113 1.338 2.433-3.84h-4.546v2.502Zm-2.895 4.57-2.113-1.338-.389.613v.726h2.502Zm0 3.304v2.502h2.502V36H51.78Zm.917 0v-3.314h-5.003V36h5.003Zm-.387-4.651-2.885-4.56-4.228 2.674 2.884 4.56 4.229-2.674Zm-4.999-.721h1.864v-5.003h-1.864v5.003Zm-.286-1.223 1.853 3.115 4.3-2.558-1.853-3.115-4.3 2.558ZM53.19 32.5l1.816-3.115-4.323-2.52-1.815 3.116 4.322 2.519Zm-.346-1.873h1.832v-5.003h-1.831v5.003Zm-.281-3.84-2.895 4.57 4.226 2.677 2.895-4.57-4.226-2.677Zm-3.283 5.909V36h5.003v-3.303h-5.003Zm2.501.801h-1.584v5.004h1.584v-5.004ZM65.014 36v2.502h3.697l-1.374-3.432-2.323.93Zm-1.73 0-2.334.898.616 1.603h1.719V36Zm-.687-1.789 2.335-.897-.616-1.604h-1.719v2.501Zm-3.147 0V31.71h-1.753l-.598 1.647 2.351.854ZM58.8 36v2.502h1.753l.598-1.648L58.8 36Zm-1.686 0-2.331-.908-1.328 3.41h3.659V36Zm3.066-7.874v-2.502h-1.71l-.62 1.594 2.33.908Zm1.682 0 2.322-.93-.63-1.572h-1.692v2.502Zm.225 4.759v2.501h3.597l-1.252-3.372-2.345.87Zm-1.085-2.922 2.345-.87-2.368-6.38-2.328 6.394 2.351.856Zm-1.063 2.922-2.35-.856-1.223 3.357h3.573v-2.501Zm5.075.614h-1.73V38.5h1.73V33.5Zm.606 1.603-.688-1.788-4.67 1.795.688 1.788 4.67-1.794Zm-3.023-3.392H59.45v5.003h3.147V31.71ZM57.1 33.357l-.65 1.789 4.702 1.708.65-1.788-4.702-1.709Zm1.701.142h-1.686V38.5H58.8V33.5Zm.645 3.409 3.066-7.874-4.662-1.816-3.066 7.874 4.661 1.816Zm.735-6.28h1.682v-5.003H60.18v5.003Zm-.64-1.572 3.152 7.874 4.645-1.86-3.153-7.874-4.645 1.86Zm4.892 2.958-1.085-2.922-4.69 1.742 1.085 2.921 4.69-1.741Zm-5.78-2.907-1.064 2.922 4.701 1.711 1.064-2.922-4.702-1.71Zm1.287 6.28h2.148v-5.004H59.94v5.003ZM70.9 33.104l.756-2.384-2.586-.82-.608 2.644 2.438.56Zm1.542.489 2.412.663.638-2.32-2.294-.728-.756 2.385ZM71.26 35.51l1.511 1.994.002-.002-1.513-1.992Zm-4.667-.446L64.77 36.78l.004.004 1.819-1.718Zm.005-5.983 1.826 1.71.005-.005-1.831-1.705Zm5.016-.236-1.719 1.817.006.005 1.713-1.822Zm.806 1.45.581 2.433 2.539-.606-.714-2.51-2.406.683Zm-1.574.376-2.438.556.561 2.464 2.459-.587-.582-2.433Zm-.585-.967-1.569 1.949.006.004.006.005 1.557-1.958Zm-2.498.274-1.885-1.644-.008.01 1.893 1.634Zm2.381 5.51 1.542.49 1.512-4.77-1.542-.488-1.512 4.768Zm-.114-2.558c-.133.482-.28.586-.283.588l3.026 3.984c1.1-.836 1.74-2.01 2.08-3.246l-4.823-1.326Zm-.281.587c-.021.016-.151.115-.578.115v5.003c1.263 0 2.526-.317 3.6-1.131l-3.022-3.987Zm-.578.115c-.41 0-.594-.11-.76-.285l-3.637 3.435c1.18 1.25 2.714 1.853 4.397 1.853v-5.003Zm-.756-.28c-.131-.14-.33-.445-.33-1.22h-5.004c0 1.702.474 3.353 1.689 4.646l3.645-3.427Zm-.33-1.22c0-.886.221-1.216.34-1.342l-3.654-3.418c-1.235 1.32-1.69 3.025-1.69 4.76h5.003Zm.344-1.346c.148-.16.345-.294.838-.294V25.49c-1.712 0-3.295.593-4.5 1.887l3.662 3.41Zm.838-.294c.436 0 .566.111.628.17l3.439-3.634c-1.141-1.08-2.575-1.539-4.067-1.539v5.003Zm.634.175c-.064-.06.017-.024.113.312l4.812-1.368c-.262-.925-.718-1.856-1.498-2.589l-3.427 3.645Zm1.938-2.805-1.574.376 1.163 4.866 1.573-.376-1.162-4.866Zm1.446 2.253c-.205-.902-.68-1.742-1.467-2.369l-3.114 3.916a.931.931 0 0 1-.214-.243.683.683 0 0 1-.082-.192l4.877-1.112Zm-1.456-2.36c-.791-.637-1.722-.907-2.642-.907v5.003a.665.665 0 0 1-.199-.037.955.955 0 0 1-.296-.161l3.137-3.898Zm-2.642-.907c-1.266 0-2.442.492-3.31 1.486l3.772 3.288a.719.719 0 0 1-.462.23v-5.004Zm-3.317 1.495c-.947 1.098-1.15 2.516-1.15 3.67h5.002c0-.319.032-.495.052-.568.018-.069.007.024-.117.168l-3.787-3.27Zm-1.15 3.67c0 1.167.184 2.629 1.13 3.745l3.816-3.235c.134.158.14.255.115.157a2.89 2.89 0 0 1-.059-.666H64.72Zm1.13 3.745c.852 1.005 2.025 1.518 3.305 1.518v-5.003c.026 0 .125.006.254.065.132.06.218.138.257.185l-3.816 3.235Zm3.305 1.518c1.004 0 1.963-.34 2.745-1.029l-3.31-3.751a.924.924 0 0 1 .565-.223v5.003Zm2.745-1.029c.839-.74 1.24-1.72 1.438-2.583l-4.876-1.12c-.03.13-.054.174-.047.16a.781.781 0 0 1 .175-.208l3.31 3.751Zm6.95-3.143.755-2.384-2.586-.82-.608 2.644 2.438.56Zm1.54.489 2.413.663.638-2.32-2.294-.728-.756 2.385Zm-1.18 1.917 1.51 1.994.002-.002-1.513-1.992Zm-4.668-.446L72.72 36.78l.004.004 1.819-1.718Zm.005-5.983 1.827 1.71.004-.005-1.83-1.705Zm5.017-.236-1.72 1.817.006.005 1.714-1.822Zm.805 1.45.582 2.433 2.538-.606-.713-2.51-2.407.683Zm-1.573.376-2.44.556.563 2.464 2.458-.587-.581-2.433Zm-.586-.967-1.568 1.949.005.004.006.005 1.557-1.958Zm-2.497.274-1.886-1.644-.008.01 1.894 1.634Zm2.38 5.51 1.542.49 1.512-4.77-1.542-.488-1.512 4.768Zm-.114-2.558c-.133.482-.28.586-.283.588l3.026 3.984c1.1-.836 1.741-2.01 2.08-3.246l-4.823-1.326Zm-.281.587c-.021.016-.151.115-.578.115v5.003c1.263 0 2.526-.317 3.6-1.131L77.7 33.518Zm-.578.115c-.409 0-.593-.11-.76-.285l-3.637 3.435c1.18 1.25 2.714 1.853 4.397 1.853v-5.003Zm-.756-.28c-.131-.14-.33-.445-.33-1.22H71.03c0 1.702.474 3.353 1.689 4.646l3.645-3.427Zm-.33-1.22c0-.886.222-1.216.34-1.342l-3.653-3.418c-1.236 1.32-1.69 3.025-1.69 4.76h5.002Zm.344-1.346c.148-.16.345-.294.838-.294V25.49c-1.712 0-3.295.593-4.5 1.887l3.662 3.41Zm.838-.294c.436 0 .566.111.628.17l3.44-3.634c-1.142-1.08-2.576-1.539-4.067-1.539v5.003Zm.634.175c-.064-.06.018-.024.113.312l4.813-1.368c-.263-.925-.719-1.856-1.499-2.589l-3.427 3.645Zm1.938-2.805-1.574.376 1.163 4.866 1.574-.376-1.163-4.866Zm1.447 2.253c-.206-.902-.68-1.742-1.468-2.369l-3.114 3.916a.927.927 0 0 1-.213-.243.681.681 0 0 1-.083-.192l4.877-1.112Zm-1.456-2.36c-.792-.637-1.723-.907-2.643-.907v5.003a.665.665 0 0 1-.198-.037.955.955 0 0 1-.296-.161l3.137-3.898Zm-2.643-.907c-1.265 0-2.442.492-3.309 1.486l3.771 3.288a.719.719 0 0 1-.462.23v-5.004Zm-3.317 1.495c-.947 1.098-1.15 2.516-1.15 3.67h5.003c0-.319.032-.495.05-.568.02-.069.008.024-.116.168l-3.787-3.27Zm-1.15 3.67c0 1.167.184 2.629 1.13 3.745l3.817-3.235c.133.158.139.255.114.157a2.893 2.893 0 0 1-.058-.666H72.67Zm1.13 3.745c.852 1.005 2.026 1.518 3.305 1.518v-5.003c.027 0 .126.006.255.065.131.06.217.138.257.185L73.8 35.76Zm3.305 1.518c1.004 0 1.964-.34 2.745-1.029l-3.31-3.751a.924.924 0 0 1 .565-.223v5.003Zm2.745-1.029c.839-.74 1.24-1.72 1.438-2.583l-4.876-1.12c-.03.13-.054.174-.047.16a.781.781 0 0 1 .175-.208l3.31 3.751Zm1.95-6.156-2.285-1.02-.005.01 2.29 1.01Zm.73-1.08-1.79-1.748-.004.005-.005.005 1.799 1.738Zm1.02-.709.964 2.309.011-.005-.975-2.304Zm4.48.768-1.8 1.737.004.005 1.796-1.742Zm.01 5.99 1.8 1.736.005-.004-1.805-1.733Zm-5.564.004-1.8 1.738.004.004 1.796-1.742Zm1.22-.977-1.868 1.664.006.008 1.861-1.672Zm3.125.005-1.868-1.664v.001l1.868 1.663Zm.016-4.076-1.871 1.66.007.008 1.864-1.668Zm-3.158.01 1.863 1.67.007-.008-1.87-1.662Zm.262 2.084c0-.569.087-.874.147-1.01l-4.578-2.018c-.42.952-.572 1.993-.572 3.028h5.003Zm.142-1c.06-.132.138-.25.245-.36l-3.597-3.477a6.236 6.236 0 0 0-1.216 1.798l4.568 2.04Zm.235-.35a.62.62 0 0 1 .196-.15l-1.928-4.616a5.592 5.592 0 0 0-1.845 1.269l3.577 3.497Zm.207-.154c.126-.054.35-.114.722-.114V25.49c-.91 0-1.817.148-2.672.51l1.95 4.607Zm.722-.114c.6 0 .835.163.983.316l3.6-3.475c-1.243-1.287-2.862-1.844-4.583-1.844v5.003Zm.987.32c.13.133.341.44.341 1.26h5.003c0-1.743-.486-3.437-1.753-4.744l-3.59 3.484Zm.341 1.26c0 .81-.209 1.119-.34 1.255l3.61 3.465c1.251-1.304 1.733-2.987 1.733-4.72h-5.003Zm-.335 1.25c-.142.148-.374.31-.971.31v5.003c1.716 0 3.332-.554 4.571-1.839l-3.6-3.474Zm-.971.31c-.626 0-.862-.17-.998-.31l-3.59 3.484c1.246 1.285 2.872 1.829 4.588 1.829v-5.003Zm-.993-.305c-.132-.137-.335-.435-.335-1.217h-5.003c0 1.726.488 3.396 1.738 4.692l3.6-3.475Zm-3.7-1.27c0 1.238.283 2.608 1.252 3.694l3.734-3.329c.068.076.076.124.063.083a1.633 1.633 0 0 1-.046-.448h-5.003Zm1.258 3.702c.902 1.003 2.109 1.517 3.43 1.517v-5.003c-.01 0 .048 0 .136.038.09.04.143.09.156.104l-3.722 3.344Zm3.43 1.517c1.314 0 2.525-.508 3.426-1.52l-3.738-3.327a.523.523 0 0 1 .173-.117c.092-.04.15-.04.138-.04v5.004Zm3.425-1.52c.976-1.095 1.246-2.486 1.246-3.72h-5.003c0 .277-.032.427-.05.485-.014.049-.006-.006.071-.093l3.736 3.328Zm1.246-3.72c0-1.212-.26-2.6-1.234-3.689l-3.728 3.337c-.089-.1-.1-.166-.088-.122.015.052.047.197.047.473h5.003Zm-1.227-3.68c-.92-1.039-2.157-1.508-3.445-1.508v5.003c.043 0 0 .006-.09-.031a.601.601 0 0 1-.207-.144l3.743-3.32Zm-3.445-1.508c-1.3 0-2.534.482-3.454 1.516l3.74 3.324a.558.558 0 0 1-.19.131c-.088.038-.133.032-.096.032V26.85Zm-3.447 1.509c-.978 1.091-1.24 2.481-1.24 3.7h5.003c0-.277.032-.424.047-.477.013-.044.002.02-.084.116l-3.726-3.339Zm8.496-.232v-2.502h-2.501v2.502h2.501Zm1.59 0h2.502v-2.502h-2.502v2.502Zm.06 5.58-2.455.483.003.017.004.017 2.447-.517Zm.483.78-1.532 1.977.015.012.016.012 1.5-2.002Zm2.073.016 1.559 1.956.01-.008.008-.007-1.577-1.941ZM95 28.125v-2.502H92.5v2.502H95Zm1.59 0h2.502v-2.502H96.59v2.502Zm-.607 7.127-1.89-1.638-.006.007-.007.008 1.903 1.623Zm-.924.645.944 2.317.01-.004.008-.004-.962-2.31Zm-3.228-.022L90.8 38.156l.012.005.013.006 1.008-2.29Zm-.918-.676-1.946 1.572.005.006.005.006 1.936-1.584Zm-.446-.876-2.438.561.003.012 2.435-.573Zm-.156-3.696h1.59v-5.003h-1.59v5.003Zm-.911-2.502v4.265h5.003v-4.265H89.4Zm0 4.265c0 .617.01 1.313.106 1.798l4.909-.965c.013.067.014.094.01.057a3.722 3.722 0 0 1-.01-.166 16.803 16.803 0 0 1-.012-.724H89.4Zm.113 1.832c.187.887.663 1.67 1.399 2.24l3.064-3.955a1.208 1.208 0 0 1 .432.682l-4.895 1.033Zm1.43 2.264c.827.62 1.769.79 2.553.79v-5.003c-.103 0 .136-.024.448.21l-3.001 4.003Zm2.553.79c.728 0 1.725-.138 2.58-.82l-3.118-3.912a1.36 1.36 0 0 1 .483-.254c.091-.024.12-.017.055-.017v5.003Zm2.598-.834a3.604 3.604 0 0 0 1.301-2.196l-4.93-.855c.03-.165.091-.338.188-.498.095-.157.203-.266.286-.334l3.155 3.883Zm1.301-2.196c.087-.5.107-1.133.107-1.765H92.5c0 .284-.006.505-.014.671-.01.178-.02.245-.02.24l4.93.854Zm.107-1.765v-4.356H92.5v4.356h5.003ZM95 30.628h1.59v-5.003h-1.59v5.003Zm-.912-2.502v4.136h5.004v-4.136h-5.004Zm0 4.136c0 .439-.01.785-.026 1.049-.009.13-.019.232-.028.307-.009.077-.016.11-.016.11l4.886 1.075c.15-.682.188-1.593.188-2.541h-5.004Zm-.07 1.465c-.005.022-.005.015.007-.011a.468.468 0 0 1 .068-.1l3.78 3.276a4.7 4.7 0 0 0 1.031-2.089l-4.886-1.076Zm.062-.097a.462.462 0 0 1 .069-.066c.008-.005-.005.005-.052.025l1.924 4.618a4.895 4.895 0 0 0 1.865-1.33l-3.806-3.247Zm.035-.049c.021-.008-.008.007-.11.023-.1.015-.251.029-.46.029v5.003c.802 0 1.662-.097 2.458-.421l-1.888-4.634Zm-.57.052c-.287 0-.488-.017-.62-.037-.139-.02-.15-.037-.086-.009l-2.016 4.579c.864.38 1.848.47 2.722.47v-5.003Zm-.68-.035c-.053-.023-.072-.038-.07-.036a.42.42 0 0 1 .053.054l-3.871 3.168a4.984 4.984 0 0 0 1.82 1.37l2.068-4.556Zm-.006.03c-.014-.017-.01-.015.002.008a.514.514 0 0 1 .041.115l-4.87 1.146c.17.72.508 1.346.935 1.875l3.892-3.144Zm.046.135c-.04-.17-.092-.608-.092-1.437H87.81c0 .933.05 1.827.22 2.56l4.875-1.123Zm-.092-1.437v-4.2H87.81v4.2h5.003ZM98.288 36h-2.501v2.502h2.501V36Zm0-7.874v-2.502h-2.501v2.502h2.501Zm1.547 0 2.133-1.307-.732-1.194h-1.4v2.501Zm3.223 5.258-2.133 1.307 4.634 7.562v-8.869h-2.501Zm0-5.258v-2.502h-2.502v2.502h2.502Zm1.477 0h2.501v-2.502h-2.501v2.502Zm0 7.874v2.502h2.501V36h-2.501Zm-1.595 0-2.128 1.315.733 1.187h1.395V36Zm-3.175-5.135 2.128-1.315-4.63-7.489v8.804h2.502Zm0 5.135v2.502h2.502V36h-2.502Zm1.025 0v-7.874h-5.003V36h5.003Zm-2.502-5.372h1.547v-5.003h-1.547v5.003Zm-.586-1.195 3.223 5.258 4.266-2.614-3.223-5.258-4.266 2.614Zm7.857 3.951v-5.258h-5.003v5.258h5.003Zm-2.501-2.756h1.477v-5.003h-1.477v5.003Zm-1.025-2.502V36h5.003v-7.874h-5.003Zm2.502 5.372h-1.595v5.004h1.595v-5.004Zm.532 1.187-3.174-5.135-4.255 2.63 3.174 5.135 4.255-2.63Zm-7.803-3.82V36h5.003v-5.135h-5.003Zm2.501 2.634h-1.477V38.5h1.477V33.5ZM107.994 36h-2.502v2.502h2.502V36Zm0-6.542h2.501v-2.502h-2.501v2.502Zm-2.337 0h-2.501v2.502h2.501v-2.502Zm0-1.332v-2.502h-2.501v2.502h2.501Zm6.258 0h2.501v-2.502h-2.501v2.502Zm0 1.332v2.502h2.501v-2.502h-2.501Zm-2.331 0v-2.502h-2.502v2.502h2.502Zm0 6.542v2.502h2.501V36h-2.501Zm.911 0v-6.542h-5.003V36h5.003Zm-2.501-9.044h-2.337v5.003h2.337v-5.003Zm.165 2.502v-1.332h-5.003v1.332h5.003Zm-2.502 1.17h6.258v-5.003h-6.258v5.003Zm3.756-2.502v1.332h5.003v-1.332h-5.003Zm2.502-1.17h-2.331v5.003h2.331v-5.003Zm-4.833 2.502V36h5.003v-6.542h-5.003Zm2.502 4.04h-1.59v5.004h1.59v-5.004Z",mask:"url(#d)"})),zn||(zn=o.createElement("mask",{id:"f",width:90,height:22,x:18,y:5,fill:"#000",maskUnits:"userSpaceOnUse"},o.createElement("path",{fill:"#fff",d:"M18 5h90v22H18z"}),o.createElement("path",{d:"M20.503 22v-.848h.672c.16 0 .299-.021.416-.064a.54.54 0 0 0 .288-.304c.075-.15.112-.373.112-.672v-7.648c0-.31-.037-.533-.112-.672a.48.48 0 0 0-.288-.288.999.999 0 0 0-.416-.08h-.672v-.848h5.52v.848h-.672c-.149 0-.288.021-.416.064a.544.544 0 0 0-.288.272c-.074.139-.112.352-.112.64v8.624h2.976c.246 0 .454-.053.624-.16.182-.107.326-.261.432-.464.118-.213.208-.47.272-.768l.256-1.2h.896L29.88 22h-9.376Zm11.845 0v-.848h.672c.15 0 .283-.021.4-.064a.537.537 0 0 0 .304-.272c.075-.139.112-.347.112-.624v-7.728c0-.31-.037-.533-.112-.672a.48.48 0 0 0-.288-.288.999.999 0 0 0-.416-.08h-.672v-.848h8.88l.064 2.944h-1.12l-.08-.752a1.792 1.792 0 0 0-.16-.656.912.912 0 0 0-.32-.416c-.139-.096-.32-.144-.544-.144H36.38v4h3.792v.96H36.38v4.512h3.2a.84.84 0 0 0 .528-.16c.139-.107.245-.25.32-.432.085-.181.144-.39.176-.624l.128-.752h1.104L41.724 22h-9.376Zm18.15.16c-1.323 0-2.422-.245-3.297-.736a4.758 4.758 0 0 1-1.952-2.048c-.426-.885-.64-1.92-.64-3.104 0-1.152.224-2.165.672-3.04a4.788 4.788 0 0 1 2-2.064c.896-.501 1.995-.752 3.296-.752.886 0 1.622.085 2.208.256.598.16 1.046.379 1.344.656.299.277.448.592.448.944 0 .373-.176.693-.528.96-.352.267-.864.4-1.536.4 0-.437-.074-.816-.224-1.136a1.622 1.622 0 0 0-.64-.768c-.288-.192-.661-.288-1.12-.288-.778 0-1.408.192-1.888.576-.47.373-.81.917-1.024 1.632-.213.715-.32 1.59-.32 2.624 0 1.024.112 1.893.336 2.608.224.715.587 1.259 1.088 1.632.512.373 1.184.56 2.016.56.203 0 .4-.005.592-.016.203-.021.395-.053.576-.096v-2.352c0-.288-.042-.512-.128-.672a.689.689 0 0 0-.384-.352c-.16-.075-.368-.112-.624-.112h-.208v-.848h5.024v.848h-.208c-.213 0-.394.037-.544.112a.661.661 0 0 0-.304.368c-.064.17-.096.41-.096.72v2.624a9.672 9.672 0 0 1-1.888.656 9.655 9.655 0 0 1-2.048.208ZM57.85 22v-.848h.672c.15 0 .283-.021.4-.064a.537.537 0 0 0 .304-.272c.075-.139.112-.347.112-.624v-7.728c0-.31-.037-.533-.112-.672a.48.48 0 0 0-.288-.288.999.999 0 0 0-.416-.08h-.672v-.848h8.88l.064 2.944h-1.12l-.08-.752a1.792 1.792 0 0 0-.16-.656.912.912 0 0 0-.32-.416c-.139-.096-.32-.144-.544-.144h-2.688v4h3.792v.96h-3.792v4.512h3.2a.84.84 0 0 0 .528-.16c.139-.107.245-.25.32-.432.085-.181.144-.39.176-.624l.128-.752h1.104L67.226 22H57.85Zm11.83 0v-.848h.671c.15 0 .283-.021.4-.064a.602.602 0 0 0 .304-.304c.075-.15.112-.373.112-.672V12.4c0-.288-.037-.501-.112-.64a.537.537 0 0 0-.304-.272 1.164 1.164 0 0 0-.4-.064h-.672v-.848h3.552l5.648 7.984V12.4c0-.288-.037-.501-.112-.64a.537.537 0 0 0-.304-.272 1.164 1.164 0 0 0-.4-.064h-.672v-.848h4.176v.848h-.672c-.15 0-.288.027-.416.08-.117.043-.213.139-.288.288-.074.139-.112.363-.112.672V22h-1.472l-6.24-8.816v6.928c0 .299.038.523.112.672.075.15.17.25.288.304.128.043.267.064.416.064h.672V22H69.68Zm13.985 0v-.848h.672c.16 0 .298-.021.416-.064a.54.54 0 0 0 .288-.304c.074-.15.112-.373.112-.672V12.4c0-.288-.038-.501-.112-.64a.537.537 0 0 0-.304-.272 1.165 1.165 0 0 0-.4-.064h-.672v-.848h5.28c1.184 0 2.197.208 3.04.624a4.254 4.254 0 0 1 1.936 1.84c.458.81.688 1.824.688 3.04 0 1.163-.214 2.192-.64 3.088a4.788 4.788 0 0 1-1.904 2.08c-.832.501-1.872.752-3.12.752h-5.28Zm4.912-.992c.736 0 1.349-.197 1.84-.592.49-.395.858-.96 1.104-1.696.256-.747.384-1.632.384-2.656 0-1.013-.128-1.85-.384-2.512-.246-.672-.614-1.173-1.104-1.504-.491-.33-1.1-.496-1.824-.496h-.912v9.456h.896Zm12.505 1.152c-.714 0-1.312-.064-1.792-.192-.48-.139-.864-.315-1.152-.528a2.096 2.096 0 0 1-.624-.736 1.939 1.939 0 0 1-.176-.784c0-.363.086-.65.256-.864a1.4 1.4 0 0 1 .672-.48c.278-.096.57-.144.88-.144 0 .608.09 1.12.272 1.536.192.405.454.715.784.928.331.203.71.304 1.136.304.63 0 1.115-.165 1.456-.496.352-.33.528-.741.528-1.232 0-.363-.101-.672-.304-.928-.192-.267-.485-.507-.88-.72-.394-.224-.89-.459-1.488-.704a8.663 8.663 0 0 1-1.408-.704 4.082 4.082 0 0 1-.928-.784 2.889 2.889 0 0 1-.512-.912 3.891 3.891 0 0 1-.144-1.088c0-.65.17-1.216.512-1.696.342-.48.806-.853 1.392-1.12.598-.267 1.27-.4 2.016-.4.79 0 1.435.085 1.936.256.502.16.87.379 1.104.656.246.277.368.592.368.944 0 .373-.165.688-.496.944-.32.256-.81.384-1.472.384 0-.299-.058-.619-.176-.96a2.104 2.104 0 0 0-.528-.88c-.245-.245-.576-.368-.992-.368-.288 0-.554.059-.8.176a1.365 1.365 0 0 0-.576.496c-.138.213-.208.48-.208.8 0 .299.07.576.208.832.139.256.4.512.784.768.384.245.934.512 1.648.8.736.299 1.328.608 1.776.928.448.32.774.683.976 1.088.203.395.304.853.304 1.376 0 .683-.181 1.29-.544 1.824-.352.523-.853.933-1.504 1.232-.65.299-1.418.448-2.304.448Z"}))),$n||($n=o.createElement("path",{fill:"url(#e)",d:"M20.503 22v-.848h.672c.16 0 .299-.021.416-.064a.54.54 0 0 0 .288-.304c.075-.15.112-.373.112-.672v-7.648c0-.31-.037-.533-.112-.672a.48.48 0 0 0-.288-.288.999.999 0 0 0-.416-.08h-.672v-.848h5.52v.848h-.672c-.149 0-.288.021-.416.064a.544.544 0 0 0-.288.272c-.074.139-.112.352-.112.64v8.624h2.976c.246 0 .454-.053.624-.16.182-.107.326-.261.432-.464.118-.213.208-.47.272-.768l.256-1.2h.896L29.88 22h-9.376Zm11.845 0v-.848h.672c.15 0 .283-.021.4-.064a.537.537 0 0 0 .304-.272c.075-.139.112-.347.112-.624v-7.728c0-.31-.037-.533-.112-.672a.48.48 0 0 0-.288-.288.999.999 0 0 0-.416-.08h-.672v-.848h8.88l.064 2.944h-1.12l-.08-.752a1.792 1.792 0 0 0-.16-.656.912.912 0 0 0-.32-.416c-.139-.096-.32-.144-.544-.144H36.38v4h3.792v.96H36.38v4.512h3.2a.84.84 0 0 0 .528-.16c.139-.107.245-.25.32-.432.085-.181.144-.39.176-.624l.128-.752h1.104L41.724 22h-9.376Zm18.15.16c-1.323 0-2.422-.245-3.297-.736a4.758 4.758 0 0 1-1.952-2.048c-.426-.885-.64-1.92-.64-3.104 0-1.152.224-2.165.672-3.04a4.788 4.788 0 0 1 2-2.064c.896-.501 1.995-.752 3.296-.752.886 0 1.622.085 2.208.256.598.16 1.046.379 1.344.656.299.277.448.592.448.944 0 .373-.176.693-.528.96-.352.267-.864.4-1.536.4 0-.437-.074-.816-.224-1.136a1.622 1.622 0 0 0-.64-.768c-.288-.192-.661-.288-1.12-.288-.778 0-1.408.192-1.888.576-.47.373-.81.917-1.024 1.632-.213.715-.32 1.59-.32 2.624 0 1.024.112 1.893.336 2.608.224.715.587 1.259 1.088 1.632.512.373 1.184.56 2.016.56.203 0 .4-.005.592-.016.203-.021.395-.053.576-.096v-2.352c0-.288-.042-.512-.128-.672a.689.689 0 0 0-.384-.352c-.16-.075-.368-.112-.624-.112h-.208v-.848h5.024v.848h-.208c-.213 0-.394.037-.544.112a.661.661 0 0 0-.304.368c-.064.17-.096.41-.096.72v2.624a9.672 9.672 0 0 1-1.888.656 9.655 9.655 0 0 1-2.048.208ZM57.85 22v-.848h.672c.15 0 .283-.021.4-.064a.537.537 0 0 0 .304-.272c.075-.139.112-.347.112-.624v-7.728c0-.31-.037-.533-.112-.672a.48.48 0 0 0-.288-.288.999.999 0 0 0-.416-.08h-.672v-.848h8.88l.064 2.944h-1.12l-.08-.752a1.792 1.792 0 0 0-.16-.656.912.912 0 0 0-.32-.416c-.139-.096-.32-.144-.544-.144h-2.688v4h3.792v.96h-3.792v4.512h3.2a.84.84 0 0 0 .528-.16c.139-.107.245-.25.32-.432.085-.181.144-.39.176-.624l.128-.752h1.104L67.226 22H57.85Zm11.83 0v-.848h.671c.15 0 .283-.021.4-.064a.602.602 0 0 0 .304-.304c.075-.15.112-.373.112-.672V12.4c0-.288-.037-.501-.112-.64a.537.537 0 0 0-.304-.272 1.164 1.164 0 0 0-.4-.064h-.672v-.848h3.552l5.648 7.984V12.4c0-.288-.037-.501-.112-.64a.537.537 0 0 0-.304-.272 1.164 1.164 0 0 0-.4-.064h-.672v-.848h4.176v.848h-.672c-.15 0-.288.027-.416.08-.117.043-.213.139-.288.288-.074.139-.112.363-.112.672V22h-1.472l-6.24-8.816v6.928c0 .299.038.523.112.672.075.15.17.25.288.304.128.043.267.064.416.064h.672V22H69.68Zm13.985 0v-.848h.672c.16 0 .298-.021.416-.064a.54.54 0 0 0 .288-.304c.074-.15.112-.373.112-.672V12.4c0-.288-.038-.501-.112-.64a.537.537 0 0 0-.304-.272 1.165 1.165 0 0 0-.4-.064h-.672v-.848h5.28c1.184 0 2.197.208 3.04.624a4.254 4.254 0 0 1 1.936 1.84c.458.81.688 1.824.688 3.04 0 1.163-.214 2.192-.64 3.088a4.788 4.788 0 0 1-1.904 2.08c-.832.501-1.872.752-3.12.752h-5.28Zm4.912-.992c.736 0 1.349-.197 1.84-.592.49-.395.858-.96 1.104-1.696.256-.747.384-1.632.384-2.656 0-1.013-.128-1.85-.384-2.512-.246-.672-.614-1.173-1.104-1.504-.491-.33-1.1-.496-1.824-.496h-.912v9.456h.896Zm12.505 1.152c-.714 0-1.312-.064-1.792-.192-.48-.139-.864-.315-1.152-.528a2.096 2.096 0 0 1-.624-.736 1.939 1.939 0 0 1-.176-.784c0-.363.086-.65.256-.864a1.4 1.4 0 0 1 .672-.48c.278-.096.57-.144.88-.144 0 .608.09 1.12.272 1.536.192.405.454.715.784.928.331.203.71.304 1.136.304.63 0 1.115-.165 1.456-.496.352-.33.528-.741.528-1.232 0-.363-.101-.672-.304-.928-.192-.267-.485-.507-.88-.72-.394-.224-.89-.459-1.488-.704a8.663 8.663 0 0 1-1.408-.704 4.082 4.082 0 0 1-.928-.784 2.889 2.889 0 0 1-.512-.912 3.891 3.891 0 0 1-.144-1.088c0-.65.17-1.216.512-1.696.342-.48.806-.853 1.392-1.12.598-.267 1.27-.4 2.016-.4.79 0 1.435.085 1.936.256.502.16.87.379 1.104.656.246.277.368.592.368.944 0 .373-.165.688-.496.944-.32.256-.81.384-1.472.384 0-.299-.058-.619-.176-.96a2.104 2.104 0 0 0-.528-.88c-.245-.245-.576-.368-.992-.368-.288 0-.554.059-.8.176a1.365 1.365 0 0 0-.576.496c-.138.213-.208.48-.208.8 0 .299.07.576.208.832.139.256.4.512.784.768.384.245.934.512 1.648.8.736.299 1.328.608 1.776.928.448.32.774.683.976 1.088.203.395.304.853.304 1.376 0 .683-.181 1.29-.544 1.824-.352.523-.853.933-1.504 1.232-.65.299-1.418.448-2.304.448Z"})),Wn||(Wn=o.createElement("path",{fill:"#2E1509",d:"M20.503 22h-2.501v2.502h2.501V22Zm0-.848V18.65h-2.501v2.502h2.501Zm1.088-.064.855 2.35.054-.019.053-.022-.962-2.309Zm.288-.304-2.237-1.119-.033.066-.029.068 2.3.985Zm0-8.992-2.299.985.044.103.053.098 2.202-1.186Zm-.288-.288-1.035 2.277.12.055.124.041.791-2.373Zm-1.088-.08h-2.501v2.502h2.501v-2.502Zm0-.848V8.074h-2.501v2.502h2.501Zm5.52 0h2.502V8.074h-2.502v2.502Zm0 .848v2.502h2.502v-2.502h-2.502Zm-1.088.064-.79-2.373-.033.01-.031.012.854 2.351Zm-.4 9.536h-2.501v2.502h2.501v-2.502Zm3.6-.16-1.268-2.156-.029.017-.029.018 1.326 2.121Zm.432-.464-2.192-1.205-.01.02-.011.02 2.213 1.165Zm.272-.768 2.446.524v-.002l-2.446-.522Zm.256-1.2v-2.501h-2.024l-.422 1.98 2.446.521Zm.896 0 2.5.079.082-2.58H29.99v2.501ZM29.88 22v2.502h2.425l.076-2.424-2.5-.078Zm-6.874 0v-.848h-5.003V22h5.003Zm-2.502 1.654h.672V18.65h-.672v5.003Zm.672 0a3.71 3.71 0 0 0 1.271-.215l-1.71-4.702c.222-.08.386-.086.44-.086v5.003Zm1.378-.257a3.038 3.038 0 0 0 1.626-1.628L19.58 19.8c.066-.154.178-.351.363-.547.191-.202.425-.364.686-.473l1.924 4.618Zm1.564-1.494c.336-.672.376-1.365.376-1.791H19.49c0 .052-.004.04.006-.02.009-.051.04-.214.146-.427l4.475 2.238Zm.376-1.791v-7.648H19.49v7.648h5.003Zm0-7.648c0-.396-.029-1.148-.411-1.858l-4.405 2.372a1.837 1.837 0 0 1-.139-.328 1.343 1.343 0 0 1-.042-.175c-.01-.062-.006-.074-.006-.011h5.003Zm-.314-1.657c-.283-.66-.853-1.362-1.797-1.676L20.8 13.877a2.077 2.077 0 0 1-.81-.5 1.925 1.925 0 0 1-.41-.6l4.599-1.97Zm-1.552-1.58a3.493 3.493 0 0 0-1.452-.305v5.003a1.52 1.52 0 0 1-.619-.144l2.07-4.554Zm-1.452-.305h-.672v5.003h.672V8.922Zm1.83 2.502v-.848h-5.003v.848h5.003Zm-2.502 1.654h5.52V8.074h-5.52v5.004Zm3.019-2.502v.848h5.003v-.848h-5.003Zm2.501-1.654h-.672v5.003h.672V8.922Zm-.672 0c-.39 0-.798.057-1.207.193l1.582 4.746a1.2 1.2 0 0 1-.375.064V8.922Zm-1.27.215a3.04 3.04 0 0 0-1.636 1.437l4.405 2.372a1.966 1.966 0 0 1-1.06.893l-1.71-4.702Zm-1.636 1.437c-.374.694-.411 1.415-.411 1.826h5.003c0-.043.003-.018-.01.055a1.65 1.65 0 0 1-.177.491l-4.405-2.372Zm-.411 1.826v8.624h5.003V12.4h-5.003Zm2.501 11.126h2.976v-5.003h-2.976v5.003Zm2.976 0a3.65 3.65 0 0 0 1.95-.54l-2.651-4.243c.306-.192.58-.22.701-.22v5.003Zm1.893-.506a3.638 3.638 0 0 0 1.377-1.455l-4.427-2.33c.09-.171.258-.377.513-.527l2.537 4.312Zm1.355-1.415a5.3 5.3 0 0 0 .526-1.449l-4.892-1.048a.9.9 0 0 1-.028.105c-.005.014-.003.006.01-.018l4.384 2.41Zm.527-1.451.256-1.2-4.893-1.044-.256 1.2 4.893 1.044Zm-2.19.78h.895V15.93h-.896v5.003Zm-1.605-2.58-.112 3.568 5 .156.113-3.567-5-.157Zm2.388 1.145h-9.376v5.003h9.376v-5.003ZM32.35 22h-2.502v2.502h2.501V22Zm0-.848V18.65h-2.502v2.502h2.501Zm1.071-.064-.79-2.373-.033.01-.032.012.855 2.351Zm.304-.272 2.203 1.186-2.203-1.186Zm0-9.024-2.3.985.045.103.053.098 2.202-1.186Zm-.288-.288-1.035 2.277.12.055.124.041.791-2.373Zm-1.088-.08h-2.501v2.502h2.501v-2.502Zm0-.848V8.074h-2.501v2.502h2.501Zm8.88 0 2.501-.054-.053-2.448h-2.448v2.502Zm.064 2.944v2.502h2.557l-.056-2.556-2.5.054Zm-1.12 0-2.487.265.238 2.236h2.25V13.52Zm-.08-.752-2.493.2.002.032.004.033 2.487-.265Zm-.16-.656-2.313.953.035.084.04.082 2.238-1.119Zm-3.552-.56V9.05H33.88v2.502h2.501Zm0 4H33.88v2.502h2.501v-2.502Zm3.792 0h2.502V13.05h-2.502v2.502Zm0 .96v2.502h2.502v-2.502h-2.502Zm-3.792 0V14.01H33.88v2.502h2.501Zm0 4.512H33.88v2.502h2.501v-2.502Zm4.048-.592-2.263-1.065-.026.056-.024.057 2.313.952Zm.176-.624-2.466-.42-.007.041-.005.041 2.478.338Zm.128-.752v-2.502H38.62l-.354 2.082 2.466.42Zm1.104 0 2.5.095.099-2.596h-2.599v2.501ZM41.724 22v2.502h2.408l.092-2.407-2.5-.095Zm-6.874 0v-.848h-5.003V22h5.003Zm-2.502 1.654h.672V18.65h-.672v5.003Zm.672 0c.385 0 .816-.055 1.255-.215l-1.71-4.702a1.35 1.35 0 0 1 .455-.086v5.003Zm1.191-.193a3.036 3.036 0 0 0 1.716-1.459l-4.405-2.372a1.88 1.88 0 0 1 .402-.506c.202-.18.443-.322.705-.41l1.582 4.747Zm1.716-1.459c.368-.684.41-1.39.41-1.81h-5.002c0 .034-.003 0 .01-.078.014-.073.054-.256.177-.484l4.405 2.372Zm.41-1.81v-7.728h-5.002v7.728h5.003Zm0-7.728c0-.396-.028-1.148-.41-1.858l-4.405 2.372a1.83 1.83 0 0 1-.139-.328 1.348 1.348 0 0 1-.042-.175c-.01-.062-.006-.074-.006-.011h5.003Zm-.314-1.657c-.283-.66-.853-1.362-1.796-1.676l-1.582 4.746a2.076 2.076 0 0 1-.81-.5 1.927 1.927 0 0 1-.41-.6l4.598-1.97Zm-1.552-1.58a3.493 3.493 0 0 0-1.45-.305v5.003a1.52 1.52 0 0 1-.62-.144l2.07-4.554Zm-1.45-.305h-.673v5.003h.672V8.922Zm1.829 2.502v-.848h-5.003v.848h5.003Zm-2.502 1.654h8.88V8.074h-8.88v5.004Zm6.38-2.448.063 2.944 5.002-.108-.064-2.944-5.002.108Zm2.564.388h-1.12v5.003h1.12v-5.003Zm1.368 2.237-.08-.752-4.975.53.08.752 4.975-.53Zm-.074-.687a4.27 4.27 0 0 0-.416-1.575l-4.475 2.238a1.133 1.133 0 0 1-.09-.234c-.01-.041-.008-.054-.006-.03l4.987-.399Zm-.34-1.409a3.41 3.41 0 0 0-1.21-1.52l-2.848 4.114a1.598 1.598 0 0 1-.569-.688l4.626-1.905Zm-1.21-1.52c-.675-.467-1.4-.589-1.968-.589v5.003c-.12 0-.483-.025-.88-.3l2.848-4.114Zm-1.968-.589H36.38v5.003h2.688V9.05Zm-5.19 2.502v4h5.004v-4h-5.003Zm2.502 6.502h3.792V13.05H36.38v5.002Zm1.29-2.502v.96h5.004v-.96H37.67Zm2.502-1.541H36.38v5.003h3.792V14.01Zm-6.293 2.501v4.512h5.003v-4.512h-5.003Zm2.501 7.014h3.2v-5.003h-3.2v5.003Zm3.2 0c.64 0 1.388-.168 2.053-.68l-3.05-3.965c.388-.298.783-.358.997-.358v5.003Zm2.053-.68a3.521 3.521 0 0 0 1.108-1.462l-4.626-1.904c.072-.176.217-.406.468-.599l3.05 3.966Zm1.058-1.349c.212-.449.331-.909.392-1.351l-4.957-.676c-.004.027-.002-.017.039-.103l4.526 2.13Zm.38-1.27.127-.751-4.932-.84-.128.752 4.932.84Zm-2.339 1.33h1.104v-5.002h-1.104v5.003Zm-1.396-2.596-.112 2.944 5 .19.112-2.944-5-.19Zm2.388.538h-9.376v5.003h9.376v-5.003Zm5.477 1.925-1.235 2.175.011.007 1.224-2.182Zm-1.952-2.048-2.253 1.086.008.016.008.017 2.237-1.119Zm.032-6.144 2.227 1.14.005-.01-2.232-1.13Zm2-2.064 1.213 2.188.009-.005-1.222-2.183Zm5.504-.496-.698 2.402.025.007.026.007.647-2.416Zm1.344.656 1.702-1.833-1.702 1.833Zm-.08 1.904-1.51-1.994 1.51 1.994Zm-1.536.4h-2.501v2.502h2.501v-2.502Zm-.224-1.136-2.307.967.02.046.02.045 2.267-1.058Zm-.64-.768-1.387 2.081.027.019.027.017 1.333-2.117Zm-3.008.288 1.558 1.958.005-.005-1.563-1.953Zm-1.024 1.632 2.397.716-2.397-.716Zm.016 5.232 2.387-.748-2.387.748Zm1.088 1.632-1.494 2.006.01.008.01.007 1.474-2.021Zm2.608.544.139 2.498.062-.004.061-.006-.262-2.488Zm.576-.096.573 2.435 1.929-.454V20.96h-2.502Zm-.128-3.024-2.237 1.119.014.03.016.028 2.207-1.177Zm-.384-.352-1.058 2.267.089.041.09.034.88-2.342Zm-.832-.112H48.06v2.502h2.501v-2.502Zm0-.848v-2.501H48.06v2.501h2.501Zm5.024 0h2.502v-2.501h-2.502v2.501Zm0 .848v2.502h2.502v-2.502h-2.502Zm-.752.112-1.118-2.237-.034.017-.034.018 1.186 2.202Zm-.304.368-2.342-.878 2.342.878Zm-.096 3.344 1.056 2.268 1.446-.673v-1.595h-2.502Zm-1.888.656.53 2.445.02-.004.019-.005-.569-2.436Zm-2.048-2.294c-1.026 0-1.672-.191-2.072-.416l-2.448 4.364c1.35.756 2.901 1.055 4.52 1.055v-5.003Zm-2.06-.41a2.259 2.259 0 0 1-.95-.99l-4.475 2.237a7.258 7.258 0 0 0 2.954 3.104l2.47-4.35Zm-.934-.958c-.234-.484-.392-1.134-.392-2.018h-5.003c0 1.484.268 2.904.888 4.19l4.507-2.172Zm-.392-2.018c0-.824.158-1.434.397-1.9l-4.453-2.28c-.658 1.283-.947 2.7-.947 4.18h5.003Zm.402-1.91c.217-.43.524-.753.98-1.006L46.07 8.98a7.289 7.289 0 0 0-3.02 3.122l4.464 2.26Zm.99-1.011c.435-.244 1.088-.434 2.074-.434V7.915c-1.617 0-3.161.312-4.517 1.071l2.443 4.366Zm2.074-.434c.745 0 1.227.075 1.51.157l1.397-4.804c-.89-.259-1.881-.356-2.907-.356v5.004Zm1.561.171c.179.048.284.092.334.116.05.025.02.018-.045-.043l3.404-3.666c-.712-.662-1.594-1.024-2.399-1.24l-1.294 4.833Zm.29.073a1.05 1.05 0 0 1-.223-.316 1.35 1.35 0 0 1-.13-.573h5.004c0-1.16-.527-2.108-1.248-2.777l-3.404 3.666Zm-.352-.889c0-.225.058-.468.177-.686a1.11 1.11 0 0 1 .286-.348l3.02 3.988c.848-.642 1.52-1.65 1.52-2.954h-5.003Zm.463-1.034a.741.741 0 0 1 .232-.127s-.02.005-.064.01-.108.01-.194.01v5.003c.948 0 2.086-.18 3.047-.908l-3.021-3.988Zm2.476 2.394c0-.718-.123-1.473-.459-2.194l-4.534 2.116c-.037-.08-.01-.079-.01.078h5.003Zm-.419-2.103a4.124 4.124 0 0 0-1.614-1.918l-2.666 4.234a.918.918 0 0 1-.334-.382l4.614-1.934Zm-1.56-1.882c-.812-.542-1.712-.709-2.507-.709v5.003c.123 0-.03.026-.267-.132l2.775-4.162Zm-2.507-.709c-1.192 0-2.42.3-3.45 1.125l3.125 3.906c-.024.02-.034.018 0 .008.038-.012.14-.036.325-.036V8.938Zm-3.445 1.12c-.958.762-1.54 1.79-1.864 2.874l4.794 1.431c.052-.175.105-.277.138-.33a.378.378 0 0 1 .047-.06l-3.115-3.915Zm-1.864 2.874c-.303 1.018-.424 2.15-.424 3.34h5.003c0-.879.092-1.496.215-1.908l-4.794-1.432Zm-.424 3.34c0 1.192.128 2.329.45 3.356l4.774-1.496c-.126-.402-.221-1.004-.221-1.86h-5.003Zm.45 3.356c.35 1.116.979 2.144 1.981 2.89l2.988-4.012s-.096-.06-.195-.374l-4.774 1.496Zm2.001 2.905c1.057.77 2.294 1.04 3.49 1.04V18.57c-.467 0-.574-.103-.542-.08l-2.948 4.043Zm3.49 1.04c.247 0 .49-.006.731-.02l-.278-4.995a8.143 8.143 0 0 1-.453.012v5.003Zm.854-.03c.298-.03.594-.08.887-.148l-1.146-4.87c-.07.016-.157.032-.265.043l.524 4.976Zm2.816-2.583v-2.352h-5.003v2.352h5.003Zm0-2.352c0-.481-.063-1.174-.423-1.85l-4.414 2.355a1.503 1.503 0 0 1-.154-.42c-.015-.077-.012-.11-.012-.085h5.003Zm-.392-1.79a3.19 3.19 0 0 0-1.743-1.576l-1.757 4.684a1.818 1.818 0 0 1-.975-.871l4.475-2.238Zm-1.564-1.5c-.606-.284-1.212-.348-1.682-.348v5.004c.01 0-.025 0-.094-.012a1.395 1.395 0 0 1-.34-.111l2.116-4.534Zm-1.682-.348h-.208v5.004h.208V14.97Zm2.294 2.502v-.848H48.06v.848h5.003Zm-2.502 1.653h5.024v-5.002h-5.024v5.002Zm2.523-2.501v.848h5.003v-.848h-5.003Zm2.501-1.653h-.208v5.003h.208V14.97Zm-.208 0c-.497 0-1.083.086-1.663.376l2.238 4.474c-.28.14-.504.152-.575.152v-5.002Zm-1.73.41a3.16 3.16 0 0 0-1.46 1.693l4.684 1.756c-.113.302-.375.7-.852.957l-2.372-4.405Zm-1.46 1.693c-.218.58-.255 1.168-.255 1.598h5.003c0-.073.004-.096.002-.081a1.367 1.367 0 0 1-.065.24l-4.685-1.757Zm-.255 1.598v2.624h5.003v-2.624h-5.003Zm1.445.356a7.177 7.177 0 0 1-1.4.488l1.137 4.872c.814-.19 1.606-.466 2.375-.824l-2.111-4.536Zm-1.361.48a7.16 7.16 0 0 1-1.519.15v5.003c.885 0 1.746-.084 2.578-.264l-1.06-4.89ZM57.85 22H55.35v2.502h2.501V22Zm0-.848V18.65H55.35v2.502h2.501Zm1.072-.064-.79-2.373-.033.01-.032.012.855 2.351Zm.304-.272 2.203 1.186-2.203-1.186Zm0-9.024-2.3.985.045.103.053.098 2.202-1.186Zm-.288-.288-1.035 2.277.12.055.124.041.791-2.373Zm-1.088-.08H55.35v2.502h2.501v-2.502Zm0-.848V8.074H55.35v2.502h2.501Zm8.88 0 2.501-.054-.053-2.448H66.73v2.502Zm.064 2.944v2.502h2.557l-.056-2.556-2.5.054Zm-1.12 0-2.487.265.238 2.236h2.25V13.52Zm-.08-.752-2.493.2.002.032.004.033 2.487-.265Zm-.16-.656-2.313.953.035.084.04.082 2.238-1.119Zm-3.552-.56V9.05h-2.501v2.502h2.501Zm0 4h-2.501v2.502h2.501v-2.502Zm3.792 0h2.502V13.05h-2.502v2.502Zm0 .96v2.502h2.502v-2.502h-2.502Zm-3.792 0V14.01h-2.501v2.502h2.501Zm0 4.512h-2.501v2.502h2.501v-2.502Zm4.048-.592-2.263-1.065-.027.056-.023.057 2.313.952Zm.176-.624-2.466-.42-.007.041-.006.041 2.48.338Zm.128-.752v-2.502h-2.112l-.354 2.082 2.466.42Zm1.104 0 2.5.095.099-2.596h-2.599v2.501ZM67.226 22v2.502h2.408l.092-2.407-2.5-.095Zm-6.874 0v-.848h-5.003V22h5.003Zm-2.502 1.654h.672V18.65h-.672v5.003Zm.672 0c.385 0 .816-.055 1.255-.215l-1.71-4.702a1.35 1.35 0 0 1 .455-.086v5.003Zm1.191-.193a3.036 3.036 0 0 0 1.716-1.459l-4.405-2.372a1.88 1.88 0 0 1 .402-.506c.202-.18.442-.322.705-.41l1.582 4.747Zm1.716-1.459c.368-.684.41-1.39.41-1.81h-5.002c0 .034-.003 0 .01-.078.014-.073.054-.256.177-.484l4.405 2.372Zm.41-1.81v-7.728h-5.002v7.728h5.003Zm0-7.728c0-.396-.028-1.148-.41-1.858l-4.405 2.372a1.83 1.83 0 0 1-.139-.328 1.348 1.348 0 0 1-.042-.175c-.01-.062-.006-.074-.006-.011h5.003Zm-.314-1.657c-.282-.66-.852-1.362-1.796-1.676l-1.582 4.746a2.076 2.076 0 0 1-.81-.5 1.927 1.927 0 0 1-.41-.6l4.598-1.97Zm-1.552-1.58a3.493 3.493 0 0 0-1.45-.305v5.003a1.52 1.52 0 0 1-.62-.144l2.07-4.554Zm-1.45-.305h-.673v5.003h.672V8.922Zm1.829 2.502v-.848h-5.003v.848h5.003Zm-2.502 1.654h8.88V8.074h-8.88v5.004Zm6.38-2.448.063 2.944 5.002-.108-.064-2.944-5.002.108Zm2.564.388h-1.12v5.003h1.12v-5.003Zm1.368 2.237-.08-.752-4.975.53.08.752 4.975-.53Zm-.074-.687a4.27 4.27 0 0 0-.416-1.575l-4.475 2.238a1.133 1.133 0 0 1-.09-.234c-.01-.041-.008-.054-.007-.03l4.988-.399Zm-.34-1.409a3.41 3.41 0 0 0-1.21-1.52l-2.848 4.114a1.598 1.598 0 0 1-.569-.688l4.626-1.905Zm-1.21-1.52c-.674-.467-1.4-.589-1.968-.589v5.003c-.12 0-.483-.025-.88-.3l2.848-4.114ZM64.57 9.05h-2.688v5.003h2.688V9.05Zm-5.19 2.502v4h5.004v-4H59.38Zm2.502 6.502h3.792V13.05h-3.792v5.002Zm1.29-2.502v.96h5.004v-.96h-5.003Zm2.502-1.541h-3.792v5.003h3.792V14.01Zm-6.293 2.501v4.512h5.003v-4.512H59.38Zm2.501 7.014h3.2v-5.003h-3.2v5.003Zm3.2 0c.64 0 1.388-.168 2.053-.68l-3.05-3.965c.388-.298.783-.358.997-.358v5.003Zm2.053-.68a3.521 3.521 0 0 0 1.108-1.462l-4.626-1.904c.072-.176.217-.406.468-.599l3.05 3.966Zm1.058-1.349c.212-.449.331-.909.392-1.351l-4.957-.676c-.004.027-.002-.017.039-.103l4.526 2.13Zm.38-1.27.127-.751-4.932-.84-.128.752 4.932.84Zm-2.339 1.33h1.104v-5.002h-1.104v5.003Zm-1.396-2.596-.112 2.944 5 .19.112-2.944-5-.19Zm2.388.538H57.85v5.003h9.376v-5.003ZM69.68 22h-2.501v2.502h2.501V22Zm0-.848V18.65h-2.501v2.502h2.501Zm1.072-.064.855 2.35.054-.019.053-.022-.962-2.309Zm.304-.304-2.237-1.119 2.237 1.119Zm-.304-9.296-.855 2.35.032.013.032.01.791-2.373Zm-1.072-.064h-2.501v2.502h2.501v-2.502Zm0-.848V8.074h-2.501v2.502h2.501Zm3.552 0 2.042-1.445-.747-1.057H73.23v2.502Zm5.648 7.984-2.042 1.445 4.544 6.423V18.56h-2.502Zm-.112-6.8-2.202 1.186 2.202-1.186Zm-.304-.272-.855 2.35.032.013.032.01.791-2.373Zm-1.072-.064H74.89v2.502h2.501v-2.502Zm0-.848V8.074H74.89v2.502h2.501Zm4.176 0h2.502V8.074h-2.502v2.502Zm0 .848v2.502h2.502v-2.502h-2.502Zm-1.088.08.855 2.35.054-.019.053-.022-.962-2.309Zm-.288.288 2.203 1.186.018-.033.017-.034-2.238-1.119ZM80.08 22v2.502h2.502V22h-2.502Zm-1.472 0-2.042 1.445.748 1.056h1.294V22Zm-6.24-8.816 2.042-1.445-4.543-6.42v7.865h2.501Zm.112 7.6 2.238-1.119-2.238 1.119Zm.288.304-1.035 2.277.12.055.124.041.791-2.373Zm1.088.064h2.502V18.65h-2.502v2.502Zm0 .848v2.502h2.502V22h-2.502Zm-1.674 0v-.848h-5.003V22h5.003Zm-2.502 1.654h.672V18.65h-.672v5.003Zm.672 0c.386 0 .816-.055 1.255-.215l-1.71-4.702c.205-.074.369-.086.455-.086v5.003Zm1.362-.257a3.1 3.1 0 0 0 1.58-1.494l-4.475-2.238c.136-.273.437-.664.971-.886l1.924 4.618Zm1.58-1.494c.336-.672.376-1.365.376-1.791h-5.003c0 .052-.004.04.006-.02.008-.051.04-.214.146-.427l4.475 2.238Zm.376-1.791V12.4h-5.003v7.712h5.003Zm0-7.712c0-.412-.038-1.132-.411-1.826l-4.405 2.372a1.646 1.646 0 0 1-.178-.49c-.013-.074-.01-.1-.01-.056h5.004Zm-.411-1.826a3.036 3.036 0 0 0-1.716-1.46l-1.582 4.747a2.017 2.017 0 0 1-.705-.409 1.88 1.88 0 0 1-.402-.506l4.405-2.372Zm-1.652-1.437c-.44-.16-.87-.215-1.255-.215v5.003c-.086 0-.25-.012-.455-.086l1.71-4.702Zm-1.255-.215h-.672v5.003h.672V8.922Zm1.83 2.502v-.848h-5.003v.848h5.003Zm-2.502 1.654h3.552V8.074H69.68v5.004Zm1.51-1.057 5.648 7.984 4.084-2.89-5.648-7.984-4.084 2.89Zm10.192 6.539V12.4h-5.003v6.16h5.003Zm0-6.16c0-.412-.038-1.132-.411-1.826l-4.405 2.372a1.646 1.646 0 0 1-.178-.49c-.013-.074-.01-.1-.01-.056h5.004Zm-.411-1.826a3.036 3.036 0 0 0-1.716-1.46l-1.582 4.747a2.017 2.017 0 0 1-.705-.409 1.88 1.88 0 0 1-.402-.506l4.405-2.372Zm-1.652-1.437c-.44-.16-.87-.215-1.255-.215v5.003c-.086 0-.25-.012-.455-.086l1.71-4.702Zm-1.255-.215h-.672v5.003h.672V8.922Zm1.83 2.502v-.848H74.89v.848h5.003Zm-2.502 1.654h4.176V8.074h-4.176v5.004Zm1.675-2.502v.848h5.003v-.848h-5.003Zm2.501-1.654h-.672v5.003h.672V8.922Zm-.672 0c-.454 0-.922.083-1.378.273l1.924 4.618c-.2.083-.39.112-.546.112V8.922Zm-1.27.231c-.9.327-1.41.996-1.671 1.52l4.475 2.238c-.113.225-.431.703-1.095.944l-1.71-4.702Zm-1.636 1.453c-.383.71-.411 1.462-.411 1.858h5.003c0-.063.004-.051-.006.011a1.343 1.343 0 0 1-.043.175c-.024.08-.066.194-.138.328l-4.405-2.372Zm-.411 1.858V22h5.003v-9.536h-5.003Zm2.501 7.034h-1.472v5.003h1.472v-5.003Zm.57 1.057-6.24-8.816-4.084 2.89 6.24 8.816 4.084-2.89Zm-10.783-7.371v6.928h5.003v-6.928h-5.003Zm0 6.928c0 .426.04 1.119.376 1.79l4.475-2.237c.106.213.137.376.146.428.01.058.006.07.006.019h-5.003Zm.376 1.79c.254.51.714 1.11 1.49 1.463l2.07-4.554c.542.246.81.644.915.854l-4.475 2.238Zm1.734 1.56a3.81 3.81 0 0 0 1.207.192V18.65a1.2 1.2 0 0 1 .375.064l-1.582 4.746Zm1.207.192h.672V18.65h-.672v5.003Zm-1.83-2.502V22h5.004v-.848h-5.003Zm2.502-1.654H69.68v5.003h4.176v-5.003ZM83.665 22h-2.502v2.502h2.502V22Zm0-.848V18.65h-2.502v2.502h2.502Zm1.088-.064.855 2.35.054-.019.053-.022-.962-2.309Zm.288-.304-2.238-1.119-.033.066-.029.068 2.3.985Zm-.304-9.296-.855 2.35.031.013.033.01.79-2.373Zm-1.072-.064h-2.502v2.502h2.502v-2.502Zm0-.848V8.074h-2.502v2.502h2.502Zm8.32.624-1.108 2.243.012.006.011.005 1.085-2.254Zm1.936 1.84-2.197 1.198.01.017.01.017 2.177-1.232Zm.048 6.128 2.253 1.086.005-.01-2.258-1.076Zm-1.904 2.08-1.28-2.15-.011.007 1.29 2.143Zm-1.648-.832-1.568-1.95 1.568 1.95Zm1.104-1.696-2.367-.811-.003.01-.004.01 2.374.791Zm0-5.168-2.35.858.008.022.009.023 2.333-.903Zm-3.84-2V9.05h-2.502v2.502h2.502Zm0 9.456h-2.502v2.502h2.502v-2.502ZM86.166 22v-.848h-5.003V22h5.003Zm-2.501 1.654h.672V18.65h-.672v5.003Zm.672 0a3.71 3.71 0 0 0 1.27-.215l-1.71-4.702c.222-.08.386-.086.44-.086v5.003Zm1.378-.257a3.039 3.039 0 0 0 1.625-1.628L82.74 19.8c.066-.154.178-.351.364-.547.19-.202.425-.364.685-.473l1.925 4.618Zm1.563-1.494c.336-.672.376-1.365.376-1.791h-5.003c0 .052-.004.04.006-.02.009-.051.04-.214.146-.427l4.475 2.238Zm.376-1.791V12.4h-5.003v7.712h5.003Zm0-7.712c0-.412-.037-1.132-.41-1.826l-4.406 2.372a1.65 1.65 0 0 1-.177-.49c-.013-.074-.01-.1-.01-.056h5.003Zm-.41-1.826a3.036 3.036 0 0 0-1.716-1.46l-1.582 4.747a2.017 2.017 0 0 1-.705-.409 1.88 1.88 0 0 1-.403-.506l4.405-2.372ZM85.59 9.137c-.439-.16-.87-.215-1.254-.215v5.003a1.35 1.35 0 0 1-.455-.086l1.71-4.702Zm-1.254-.215h-.672v5.003h.672V8.922Zm1.83 2.502v-.848h-5.004v.848h5.003Zm-2.502 1.654h5.28V8.074h-5.28v5.004Zm5.28 0c.897 0 1.512.157 1.932.365l2.215-4.486c-1.265-.624-2.677-.883-4.147-.883v5.004Zm1.955.376c.37.178.627.422.825.784l4.392-2.396a6.755 6.755 0 0 0-3.048-2.896L90.9 13.454Zm.843.818c.191.337.364.896.364 1.808h5.003c0-1.52-.286-2.988-1.012-4.272l-4.355 2.464Zm.364 1.808c0 .854-.155 1.505-.397 2.013l4.517 2.15c.612-1.284.883-2.692.883-4.163h-5.003Zm-.392 2.002c-.214.444-.51.767-.93 1.016l2.559 4.3a7.288 7.288 0 0 0 2.878-3.144l-4.507-2.172Zm-.942 1.023c-.346.209-.908.393-1.828.393v5.003c1.575 0 3.093-.316 4.41-1.11l-2.582-4.286Zm-1.828.393h-5.28v5.003h5.28v-5.003Zm-.368 4.011c1.205 0 2.4-.333 3.407-1.144l-3.135-3.898c-.002 0-.004.005-.027.012a.827.827 0 0 1-.245.027v5.003Zm3.407-1.144c.944-.758 1.548-1.769 1.91-2.854l-4.747-1.582c-.128.387-.26.507-.298.538l3.135 3.898Zm1.903-2.834c.367-1.072.52-2.245.52-3.467h-5.004c0 .826-.104 1.424-.249 1.845l4.733 1.622Zm.52-3.467c0-1.2-.15-2.37-.554-3.415l-4.665 1.806c.107.278.215.783.215 1.609h5.003Zm-.537-3.37c-.387-1.062-1.042-2.038-2.055-2.72l-2.796 4.148c-.006-.003.003 0 .025.03.025.034.073.111.127.258l4.7-1.716Zm-2.055-2.72c-.99-.667-2.112-.924-3.222-.924v5.003c.173 0 .282.02.343.037.057.015.079.03.083.032l2.796-4.148Zm-3.222-.924h-.912v5.003h.912V9.05Zm-3.414 2.502v9.456h5.003v-9.456H85.18Zm2.502 11.957h.896v-5.003h-.896v5.003Zm11.61-1.541-.695 2.403.025.007.025.007.644-2.417Zm-1.153-.528-1.536 1.975.024.018.023.017 1.49-2.01Zm-.624-.736-2.29 1.008.017.037.018.038 2.255-1.083Zm.08-1.648 1.954 1.563.018-.023.018-.024-1.99-1.516Zm.672-.48-.818-2.364.818 2.364Zm.88-.144h2.502v-2.501h-2.502v2.501Zm.272 1.536-2.293 1 .016.035.016.036 2.261-1.071Zm.784.928-1.356 2.102.024.016.025.015 1.307-2.133Zm2.592-.192-1.713-1.823-.014.013-.013.013 1.74 1.797Zm.224-2.16-2.03 1.462.033.046.036.045 1.961-1.553Zm-.88-.72-1.235 2.175.023.013.023.013 1.189-2.201Zm-1.488-.704.951-2.314-.007-.003-.007-.003-.937 2.32Zm-2.336-1.488-1.939 1.58.015.018.015.018 1.91-1.616Zm-.512-.912-2.402.697.014.047.015.047 2.373-.791Zm.368-2.784 2.039 1.45-2.039-1.45Zm1.392-1.12-1.02-2.284-.007.003-.008.004 1.035 2.277Zm3.952-.144-.806 2.368.023.008.023.007.76-2.383Zm1.104.656-1.909 1.616.017.02.019.021 1.873-1.657Zm-.128 1.888-1.531-1.978-.016.012-.015.013 1.562 1.953Zm-1.472.384h-2.501v2.502h2.501V13.6Zm-.176-.96-2.387.746.01.034.012.033 2.365-.813Zm-2.32-1.072 1.035 2.277.023-.01.022-.01-1.08-2.257Zm-.576.496-2.081-1.388-.008.012-.008.013 2.097 1.363Zm0 1.632 2.2-1.191-2.2 1.191Zm.784.768-1.387 2.081.02.014.02.013 1.347-2.108Zm1.648.8.941-2.318-.006-.002-.935 2.32Zm2.752 2.016-2.237 1.119.006.012.006.012 2.225-1.143Zm-.24 3.2-2.068-1.407-.007.01 2.075 1.397Zm-1.504 1.232 1.044 2.273-1.044-2.273Zm-2.304-2.053c-.583 0-.947-.055-1.147-.108l-1.29 4.834c.76.203 1.591.276 2.437.276v-5.003Zm-1.097-.094a2.208 2.208 0 0 1-.3-.107c-.062-.028-.075-.041-.058-.028l-2.978 4.02c.602.446 1.285.73 1.947.921l1.388-4.806Zm-.311-.1c-.052-.04.021.002.095.157l-4.51 2.165c.33.687.82 1.22 1.343 1.628l3.072-3.95Zm.13.232a.609.609 0 0 1 .036.223h-5.003c0 .648.15 1.251.388 1.791l4.579-2.014Zm.036.223c0 .019-.007.342-.292.699l-3.907-3.126c-.627.784-.804 1.683-.804 2.427h5.003Zm-.256.652a1.123 1.123 0 0 1-.5.368l-1.636-4.728a3.9 3.9 0 0 0-1.844 1.328l3.98 3.032Zm-.5.368s.016-.007.062-.007v-5.002c-.573 0-1.144.09-1.698.281l1.637 4.728Zm-2.44-2.508c0 .841.124 1.717.481 2.536l4.586-2c-.005-.013-.063-.161-.063-.536h-5.003Zm.513 2.607c.364.766.914 1.46 1.69 1.959l2.711-4.204a.493.493 0 0 1 .111.096c.023.027.023.035.01.007l-4.522 2.142Zm1.738 1.99a4.63 4.63 0 0 0 2.443.672v-5.003c-.014 0 .004-.001.043.01.041.01.086.03.128.055l-2.614 4.266Zm2.443.672c1.062 0 2.253-.286 3.197-1.2l-3.481-3.594a.873.873 0 0 1 .314-.199c.068-.023.071-.01-.03-.01v5.003Zm3.169-1.174a4.123 4.123 0 0 0 1.317-3.055h-5.003c0-.06.012-.174.07-.31a.856.856 0 0 1 .19-.281l3.426 3.646Zm1.317-3.055a3.95 3.95 0 0 0-.844-2.48l-3.923 3.105a1.158 1.158 0 0 1-.188-.35.915.915 0 0 1-.048-.275h5.003Zm-.776-2.39c-.478-.664-1.108-1.128-1.72-1.459l-2.379 4.402a1.244 1.244 0 0 1 .121.075c.003.003-.033-.026-.082-.094l4.06-2.924Zm-1.675-1.434a15.835 15.835 0 0 0-1.772-.842L99.7 19.434c.537.22.93.41 1.203.566l2.47-4.351Zm-1.786-.848a6.199 6.199 0 0 1-.998-.492l-2.694 4.216c.547.35 1.162.65 1.819.915l1.873-4.639Zm-.998-.492a1.664 1.664 0 0 1-.365-.292l-3.82 3.232c.432.51.947.928 1.491 1.276l2.694-4.216Zm-.336-.256c-.062-.077-.076-.118-.078-.123l-4.746 1.582c.212.635.54 1.202.946 1.701l3.878-3.16Zm-.048-.03a1.391 1.391 0 0 1-.045-.39h-5.003c0 .597.072 1.198.243 1.785l4.805-1.394Zm-.045-.39c0-.188.04-.234.049-.246l-4.077-2.9c-.674.948-.975 2.033-.975 3.146h5.003Zm.049-.246c.062-.087.164-.19.388-.293l-2.07-4.554c-.95.431-1.775 1.074-2.395 1.947l4.077 2.9Zm.373-.286c.234-.104.551-.182.996-.182V7.914c-1.048 0-2.075.189-3.035.618l2.039 4.568Zm.996-.182c.636 0 .982.072 1.13.122l1.612-4.736c-.855-.291-1.799-.39-2.742-.39v5.004Zm1.176.137c.109.035.146.058.134.052a.767.767 0 0 1-.179-.163l3.819-3.232c-.645-.762-1.494-1.18-2.253-1.423l-1.521 4.766Zm-.009-.07a1.125 1.125 0 0 1-.26-.713h5.003c0-.996-.369-1.893-.996-2.601l-3.747 3.314Zm-.26-.713c0-.198.047-.428.163-.648.111-.21.242-.333.311-.386l3.063 3.956c.858-.665 1.466-1.675 1.466-2.922h-5.003Zm.443-1.01a.937.937 0 0 1 .323-.178c.009-.003-.004.001-.045.006a1.74 1.74 0 0 1-.188.008v5.004c.905 0 2.071-.162 3.035-.933l-3.125-3.906Zm2.592 2.338c0-.626-.123-1.223-.312-1.773l-4.731 1.626c.045.133.04.176.04.147h5.003Zm-.29-1.706a4.627 4.627 0 0 0-1.147-1.903l-3.538 3.538a.415.415 0 0 1-.09-.143l4.775-1.492Zm-1.147-1.903c-.806-.806-1.823-1.1-2.761-1.1v5.002a.925.925 0 0 1-.31-.064 1.325 1.325 0 0 1-.467-.3l3.538-3.538Zm-2.761-1.1a4.33 4.33 0 0 0-1.88.42l2.16 4.514a.738.738 0 0 1-.28.069V8.89Zm-1.835.4a3.86 3.86 0 0 0-1.622 1.385l4.163 2.776a1.112 1.112 0 0 1-.471.393l-2.07-4.554ZM97.85 10.7c-.463.712-.612 1.483-.612 2.163h5.003c0 .04-.011.278-.196.563l-4.195-2.726Zm-.612 2.163c0 .704.168 1.392.51 2.023l4.399-2.382a.777.777 0 0 1 .094.359h-5.003Zm.51 2.023c.414.765 1.051 1.295 1.596 1.658l2.775-4.162a1.4 1.4 0 0 1-.098-.07l-.023-.02a1.136 1.136 0 0 1 .149.212l-4.4 2.382Zm1.636 1.685c.574.366 1.286.7 2.06 1.012l1.87-4.64c-.655-.264-1.041-.464-1.236-.588l-2.694 4.216Zm2.055 1.01c.627.254 1.027.477 1.262.646l2.908-4.072c-.66-.471-1.444-.867-2.289-1.21l-1.881 4.636Zm1.262.646c.187.133.208.2.193.17l4.475-2.237c-.421-.84-1.05-1.498-1.76-2.005l-2.908 4.072Zm.205.195c-.009-.017.028.037.028.233h5.003c0-.85-.167-1.713-.581-2.519l-4.45 2.286Zm.028.233c0 .212-.048.324-.111.417l4.137 2.814a5.672 5.672 0 0 0 .977-3.231h-5.003Zm-.118.427c-.061.091-.181.222-.472.356l2.087 4.546c1.01-.463 1.893-1.154 2.535-2.108l-4.15-2.794Zm-.472.356c-.256.117-.653.22-1.261.22v5.003c1.163 0 2.302-.196 3.348-.677l-2.087-4.546Z",mask:"url(#f)"})),Gn||(Gn=o.createElement("defs",null,o.createElement("linearGradient",{id:"a",x1:62.5,x2:62.5,y1:2,y2:54,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#D7B672"}),o.createElement("stop",{offset:.261,stopColor:"#835E35"}),o.createElement("stop",{offset:.532,stopColor:"#AA8050"}),o.createElement("stop",{offset:.709,stopColor:"#EFBF7B"}),o.createElement("stop",{offset:.828,stopColor:"#F3E2AE"}),o.createElement("stop",{offset:1,stopColor:"#CBA467"})),o.createElement("linearGradient",{id:"b",x1:62.5,x2:62.5,y1:3,y2:53,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#991212"}),o.createElement("stop",{offset:1,stopColor:"#610606"})),o.createElement("linearGradient",{id:"c",x1:64.144,x2:64.144,y1:26,y2:49.252,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#CFCFCF"}),o.createElement("stop",{offset:.261,stopColor:"#787878"}),o.createElement("stop",{offset:.532,stopColor:"#B5B5B5"}),o.createElement("stop",{offset:.709,stopColor:"#F3F3F3"}),o.createElement("stop",{offset:.828,stopColor:"#E8E8E8"}),o.createElement("stop",{offset:1,stopColor:"#C7C7C7"})),o.createElement("linearGradient",{id:"e",x1:63.144,x2:63.144,y1:5,y2:28.252,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#D7B672"}),o.createElement("stop",{offset:.261,stopColor:"#835E35"}),o.createElement("stop",{offset:.532,stopColor:"#AA8050"}),o.createElement("stop",{offset:.709,stopColor:"#EFBF7B"}),o.createElement("stop",{offset:.828,stopColor:"#F3E2AE"}),o.createElement("stop",{offset:1,stopColor:"#CBA467"}))))),Xn=e=>{let t=(0,o.useRef)(null),a=(0,o.useRef)(new O.w3);const[s,i]=(0,o.useState)(!1),[n,r]=(0,o.useState)(null),[l,c]=(0,o.useState)(null),[d,h]=(0,o.useState)(null),[u,m]=(0,o.useState)(!1);(0,o.useEffect)((()=>{t.current&&a.current.attach(t.current.closest("form"))}),[]),(0,o.useEffect)((()=>{null!==n&&v()}),[l,d]);const p=e=>{if(e.preventDefault(),a.current&&a.current.validateForm(),!s&&a.current.formValid){const e=new FormData(t.current&&t.current.closest("form")||void 0);i(!0),Travian.api("auth/login",{data:{name:e.get("name"),password:e.get("password"),w:screen.width+":"+screen.height,mobileOptimizations:!!e.get("mobileOptimizations"),captcha:Travian.Login.captchaSolution},success:({redirectTo:e})=>{window.location.href=e,i(!1)},error:g})}},g=function(e,t){i(!1),446===t.status?window.grecaptcha?(Travian.Login.captchaSolution=void 0,window.grecaptcha.reset&&window.grecaptcha.reset()):Travian.Browser.getScript("https://recaptcha.net/recaptcha/api.js?render=explicit&onload=onRecaptchaLoad"):r(e.message)},v=()=>{r(null)};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("h1",{children:(0,O.Jh)("login.loginToWorld",{WORLD:e.title})}),(0,_.jsxs)("div",{ref:t,className:"formV2",children:[(0,_.jsxs)("label",{className:"input fixed "+(n?"withCustomValidationRenderElement":""),children:[(0,_.jsx)("input",{type:"text",name:"name",placeholder:(0,O.Jh)("login.input_emailAccount_placeholder"),onChange:e=>c(e.target.value),onFocus:v}),(0,_.jsxs)("div",{className:"label",children:[(0,O.Jh)("login.input_emailAccount_label"),":"]}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,children:(0,O.Jh)("login.input_emailAccount_error_empty")}),n&&(0,_.jsx)("div",{className:"validation custom","data-rule":O.w3.NO_CUSTOM_ERROR,"data-name":"password","data-render-into":".errorMessage",children:n})]}),(0,_.jsxs)("label",{className:"input fixed",children:[(0,_.jsx)("input",{type:u?"text":"password",name:"password",placeholder:(0,O.Jh)("login.input_password_placeholder"),onChange:e=>h(e.target.value),onFocus:v}),(0,_.jsxs)("div",{className:"label",children:[(0,O.Jh)("login.input_password_label"),":"]}),(0,_.jsx)(Xa.Z,{className:"valid"}),(0,_.jsx)(es,{className:"invalid"}),(0,_.jsx)(Bn,{className:"visibility",onClick:e=>{e.preventDefault(),m(!u)}}),(0,_.jsx)("div",{className:"validation","data-rule":O.w3.NOT_EMPTY,children:(0,O.Jh)("login.input_password_error_empty")}),n&&(0,_.jsx)("div",{className:"validation custom errorMessage","data-rule":O.w3.NO_CUSTOM_ERROR,"data-name":"password",children:n})]}),e.isMobile&&(0,_.jsxs)("label",{className:"checkbox",children:[(0,_.jsx)("input",{type:"checkbox",name:"mobileOptimizations",value:"1",defaultChecked:e.mobileOptimizationsEnabled}),(0,_.jsx)(ts.Z,{className:"checkbox"}),(0,_.jsx)("div",{className:"label",children:(0,O.Jh)("login.loginWithMobileVersion")})]}),(0,_.jsx)("div",{id:"recaptcha","data-sitekey":e.recaptchaKey}),(0,_.jsxs)("div",{className:"centeredText",children:[(0,_.jsx)(F.z,{type:"submit",onClick:p,onSubmit:p,disabledClass:n||s,withLoadingIndicator:!0,isLoading:s,children:(0,O.Jh)("z2_allgemein.doLogin")}),(0,_.jsxs)("div",{children:[(0,O.Jh)("login.forgotYourPassword")," ",(0,_.jsx)("a",{href:e.forgotPasswordLink,title:"",children:(0,O.Jh)("login.recover")})]})]}),(0,_.jsx)(Zn,{className:"divider"}),(0,_.jsxs)("div",{className:"lobbyAccountInfoBanner",children:[(0,_.jsx)(Kn,{className:"logoLobbyAccount"}),(0,_.jsx)("div",{className:"description",children:(0,O.Jh)("login.lobbyAccountDescription")}),(0,_.jsx)(F.z,{appearance:"buttonSecondary",href:e.registerLink,children:(0,O.Jh)("login.createLobbyAccount")})]})]})]})}},925:(e,t,a)=>{"use strict";a.d(t,{T:()=>l,a:()=>o});var s=a(7294),i=a(5893);const n={query:e=>new Promise(((t,a)=>{window.Travian.graphQL({query:e.query.loc&&e.query.loc.source&&r(e.query.loc.source.body),variables:e.variables},t,a)}))},r=e=>e.replaceAll(/(\n|\r)+/g," ").replaceAll(/(\s*({)\s*|\s*(})\s*|(\s)\s+)/g,"$2$3$4"),l=e=>class extends s.Component{render(){return(0,i.jsx)(e,{client:n,...this.props})}},o=()=>e=>n.query(e)},6613:(e,t,a)=>{"use strict";a.d(t,{r:()=>o});a(7294);var s=a(1809),i=a(9632),n=a.n(i),r=a(5893);const l={aligned:"",text:"",linked:!1,linkedCssClass:"",direction:null,withMarkup:!1},o=({configInput:e,x:t,y:a,from:i})=>{const o=Object.assign({},l,e),c=(0,s.eJ)(t),d=(0,s.eJ)(a);let h;h=o.withMarkup?(0,r.jsxs)("span",{className:"coordinates coordinatesWrapper"+(o.aligned?" coordinatesAligned coordinates"+(s.ag.RTL_COORDINATES.indexOf(Travian.Game.language)>=0?"rtl":"ltr"):""),children:[(0,r.jsxs)("span",{className:"coordinateX",children:["(",c]}),(0,r.jsx)("span",{className:"coordinatePipe",children:"|"}),(0,r.jsxs)("span",{className:"coordinateY",children:[d,")"]})]}):(0,r.jsxs)(r.Fragment,{children:["(",c,"|",d,")"]});let u=s.ag.RTL_COORDINATES.indexOf(Travian.Game.language)>=0?s.ag.DIRECTION_OVERRIDE_RTL:s.ag.DIRECTION_OVERRIDE_LTR;if(h=(0,r.jsxs)(r.Fragment,{children:[u,h,s.ag.DIRECTION_STOP_OVERRIDE]}),o.linked&&o.withMarkup&&(h=(0,r.jsx)("a",{className:o.linkedCssClass,href:`/karte.php?x=${t}&y=${a}`,title:(0,s.Jh)("layout.waitingForTooltip"),"data-load-tooltip":"distance","data-load-tooltip-data":JSON.stringify({x:t,y:a,from:i}),children:h})),o.text){const e=/\[COORDS\]/;h=e.test(o.text)?n()(o.text,e,(()=>h)):(0,r.jsxs)(r.Fragment,{children:[o.text.trim()," ",h]})}return h}},4455:(e,t,a)=>{"use strict";a.d(t,{e:()=>l,u:()=>o});a(7294);var s=a(7762),i=a(1809),n=a(5893);let r=e=>{const{config:t,value:a}=e;let{overwriteLanguage:s}=e;const n={PLUS:String.fromCharCode(43),MINUS:String.fromCharCode(8722)},r="de-DE";null===s&&"com"===Travian.Game.language&&(s="en-US");const l=null!==s?s:Travian.Game.Languages;let c={mathDirection:null,unit:null,sign:null,locale:null,grouping:null,fraction:null,signWrapper:t.signWrapper||null};const d=Number(a);return c.mathDirection=i.ag.RTL_MATHS.indexOf(l)>=0?i.ag.RTL:i.ag.LTR,c.unit="",void 0!==t.unit&&(Object.keys(o).indexOf(t.unit)>=0?c.unit=o[t.unit]:c.unit=t.unit),c.sign=d<0?n.MINUS:void 0!==t.sign&&t.sign?n.PLUS:"",c.locale=i.ag.ARABIC_NUMBERS.indexOf(l)>=0?r:l||r,c.grouping=void 0!==t.grouping&&t.grouping,c.fraction=void 0!==t.fraction?t.fraction:0,function(e,t={}){e=Math.abs(e);let a={};t.grouping||(a.useGrouping=t.grouping);void 0!==t.fraction&&(a.minimumFractionDigits=t.fraction,a.maximumFractionDigits=t.fraction);if(e=i.ag.DIRECTION_OVERRIDE_LTR+e.toLocaleString(t.locale,a)+i.ag.DIRECTION_STOP_OVERRIDE,t.unit||t.sign){let a=t.mathDirection===i.ag.LTR?i.ag.DIRECTION_OVERRIDE_LTR:i.ag.DIRECTION_OVERRIDE_RTL,s=t.sign;t.signWrapper&&(s=t.signWrapper.replace("SIGN",s)),e=`${a}${s}${e}${t.unit}${i.ag.DIRECTION_STOP_OVERRIDE}`}return e}(d,c)};function l(e,t={},a=null){let l=s.renderToStaticMarkup((0,n.jsx)(r,{value:e,config:t,overwriteLanguage:a}));return t.signWrapper&&(l=(0,i.r4)(l)),l}const o={PERCENT:String.fromCharCode(37),TIMES:String.fromCharCode(215)}},4822:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n,a:()=>i});const s=["ar-AE","he-IL"];const i={DIRECTION_OVERRIDE_LTR:String.fromCharCode(8237),DIRECTION_STOP_OVERRIDE:String.fromCharCode(8236),DIRECTION_OVERRIDE_RTL:String.fromCharCode(8238),RTL_LANGUAGES:s,ARABIC_NUMBERS:["ar-AE","he-IL"],RTL_MATHS:["ar-AE"],RTL_COORDINATES:["ar-AE"],RTL_RATIO:["ar-AE"],LTR:"ltr",RTL:"rtl",isLtr:function(e){return s.indexOf(e)<0},getDirection:function(e){return s.indexOf(e)>=0?"rtl":"ltr"}},n=i},6619:(e,t,a)=>{"use strict";a.d(t,{k:()=>n});a(7294);var s=a(4455),i=a(9208);function n(e,t,a={}){let n,r=e>0?1:-1,l=Math.abs(e),o=l/1e3,c=l/1e6,d=l/1e9,h=l/1e12,u=1;1===t&&(u=10),2===t&&(u=100);const m=Object.assign({grouping:!0,fraction:t,floor:!0},a);switch(!0){case h>=1:return n=m.floor?Math.floor(h*u):Math.round(h*u),n/=u,(0,s.e)(n*r,Object.assign(m,{unit:(0,i.Wb)("allgemein.abbreviationTrillion")}));case d>=1:return n=m.floor?Math.floor(d*u):Math.round(d*u),n/=u,(0,s.e)(n*r,Object.assign(m,{unit:(0,i.Wb)("allgemein.abbreviationBillion")}));case c>=1:return n=m.floor?Math.floor(c*u):Math.round(c*u),n/=u,(0,s.e)(n*r,Object.assign(m,{unit:(0,i.Wb)("allgemein.abbreviationMillion")}));case o>=1:return n=m.floor?Math.floor(o*u):Math.round(o*u),n/=u,(0,s.e)(n*r,Object.assign(m,{unit:(0,i.Wb)("allgemein.abbreviationThousand")}));default:return(0,s.e)(e,m)}}},3063:(e,t,a)=>{"use strict";a.d(t,{J6:()=>c,qp:()=>h,zt:()=>o});a(7294);var s=a(7762),i=a(8),n=a.n(i),r=(a(4229),a(9208)),l=a(5893);class o{static get DATETIME(){return"dateTime"}static get DYNAMIC_DATETIME(){return"dynamicDateTime"}static get DATETIME_WITH_SECONDS(){return"dateTimeWithSeconds"}static get TIME_SPAN(){return"timeSpan"}static get TIME(){return"time"}static get TIME_WITHOUT_SECONDS(){return"timeWithoutSeconds"}static get DATE(){return"date"}static get DATE_WITHOUT_YEAR(){return"dateWithoutYear"}static get TIME_WITHOUT_SECONDS_SPAN(){return"timeWithoutSecondsSpan"}static get DATE_WITHOUT_YEAR_TIME_FULL_HOUR(){return"dateWithoutYearTimeFullHour"}static get TIME_ONLY_HOURS(){return"timeOnlyHours"}static get TIME_ONLY_MINUTES(){return"timeOnlyMinutes"}}class c{static get UNIT_HOUR(){return"h"}static get UNIT_MINUTE(){return"min"}static get UNIT_SECOND(){return"s"}}class d{static get EU(){return Travian.Constants.TIME_FORMAT_MODE.eu}static get US(){return Travian.Constants.TIME_FORMAT_MODE.us}static get UK(){return Travian.Constants.TIME_FORMAT_MODE.uk}static get ISO(){return Travian.Constants.TIME_FORMAT_MODE.iso}static get ACP(){return Travian.Constants.TIME_FORMAT_MODE.acp}}class h{static timeFormat(e,t,a=!1,i=!0){const n=(0,l.jsx)(u,{timestamp:e,format:t,toText:a});return i?n:s.renderToString(n)}static durationFormat(e,t=!1,a=!0,i=!0){const n=(0,l.jsx)(m,{duration:e,showDays:t,showSeconds:a});return i?n:s.renderToString(n)}static getDate(e,t){const a=n().tz(e,t)._d;return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0)}}const u=e=>{const{timestamp:t}=e;let{format:a,toText:s}=e;const i=Travian.Game.timeZone,l=Travian.Game.timeForamt;let c,d;const u=h.getDate(1e3*t,i),m=h.getDate(Date.now(),i),S=(u.getTime()-m.getTime())/864e5;if(a===o.DYNAMIC_DATETIME)switch(!0){default:case S>0:a=o.DATETIME;break;case 0===S:a=o.TIME;break;case-1===S:s=!0,a=o.DATE;break;case S<-1:a=o.DATE}switch(s&&[o.DATETIME,o.DATE,o.DATE_WITHOUT_YEAR].includes(a)&&Math.abs(S)<=2&&(d=(0,r.Wb)("allgemein.day"+(S<0?"-":"+")+Math.abs(S))),a){default:case o.DATETIME_WITH_SECONDS:c=p(l);break;case o.DATETIME:c=g(l,d);break;case o.TIME:c=v(l);break;case o.TIME_SPAN:c=x(l);break;case o.TIME_WITHOUT_SECONDS:c=b(l);break;case o.DATE:c=f(l,d);break;case o.DATE_WITHOUT_YEAR:c=y(l,d);break;case o.TIME_WITHOUT_SECONDS_SPAN:c=j(l);break;case o.DATE_WITHOUT_YEAR_TIME_FULL_HOUR:c=T(l);break;case o.TIME_ONLY_HOURS:c=N(l);break;case o.TIME_ONLY_MINUTES:c=C(l)}const k=c?n().tz(1e3*t,i).format(c):"";return d?d+k:k},m=e=>{const{duration:t,showDays:a,showSeconds:s}=e;if(t<0)return(0,l.jsx)("span",{dangerouslySetInnerHTML:{__html:Travian.Templates.EventJam}});const i=Math.floor(t%60),n=Math.floor(t/60)%60;let r=Math.floor(t/3600);if(!a||r<24)return s?`${r}:${n.toString().padStart(2,0)}:${i.toString().padStart(2,0)}`:`${r}:${n.toString().padStart(2,0)}`;const o=Math.floor(r/24);return r-=24*o,s?`${o}d ${r}:${n.toString().padStart(2,0)}:${i.toString().padStart(2,0)}`:`${o}d ${r}:${n.toString().padStart(2,0)}`},p=e=>{switch(e){default:case d.EU:return"D.M.Y, HH:mm:ss";case d.US:return"M/D/Y, hh:mm:ss a";case d.UK:return"D/M/Y, hh:mm:ss a";case d.ISO:return"Y/M/D, HH:mm:ss";case d.ACP:return"D.M.YYYY, HH:mm:ss"}},g=(e,t)=>{switch(e){default:case d.EU:return t?", HH:mm":"D.M.Y, HH:mm";case d.US:return t?", hh:mm a":"M/D/Y, hh:mm a";case d.UK:return t?", hh:mm a":"D/M/Y, hh:mm a";case d.ISO:return t?", HH:mm":"Y/M/D, HH:mm";case d.ACP:return t?", HH:mm":"D.M.YYYY, HH:mm"}},v=e=>{switch(e){default:case d.EU:return"HH:mm:ss";case d.US:case d.UK:return"hh:mm:ss a";case d.ISO:case d.ACP:return"HH:mm:ss"}},x=e=>{const t=(0,r.Wb)("allgemein.uhr");switch(e){default:case d.EU:return`HH:mm:ss[</span><span>] [${t}]`;case d.US:case d.UK:return"hh:mm:ss[</span><span>] a";case d.ISO:case d.ACP:return`HH:mm:ss[</span><span>] [${t}]`}},b=e=>{switch(e){default:case d.EU:return"HH:mm";case d.US:case d.UK:return"hh:mm a";case d.ISO:case d.ACP:return"HH:mm"}},j=e=>{const t=(0,r.Wb)("allgemein.uhr");switch(e){default:case d.EU:return`HH:mm[</span><span>] [${t}]`;case d.US:case d.UK:return"hh:mm[</span><span>] a";case d.ISO:case d.ACP:return`HH:mm[</span><span>] [${t}]`}},f=(e,t)=>{if(t)return"";switch(e){default:case d.EU:return"D.M.Y";case d.US:return"M/D/Y";case d.UK:return"D/M/Y";case d.ISO:return"Y/M/D";case d.ACP:return"D.M.YYYY"}},y=(e,t)=>{if(t)return"";switch(e){default:case d.EU:return"D.M";case d.US:return"M/D";case d.UK:return"D/M";case d.ISO:return"M/D";case d.ACP:return"D.M"}},T=e=>{switch(e){default:case d.EU:return"D.M - HH:00";case d.US:return"M/D - hh:00 a";case d.UK:return"D/M - hh:00 a";case d.ISO:return"M/D - HH:00";case d.ACP:return"D.M - HH:00"}},N=e=>{switch(e){default:case d.EU:return"HH";case d.US:case d.UK:return"hh";case d.ISO:case d.ACP:return"HH"}},C=e=>"mm"},9208:(e,t,a)=>{"use strict";a.d(t,{Wb:()=>o,vV:()=>l});a(7294);var s=a(7762),i=a(8538),n=a(5893);const r={},l=function(e){const t=e.filter((function(e){return void 0===r[e]})).map((function(e){return fetch("/js/"+Travian.Game.language+"/"+e+".json").then((t=>{if(t.status>399)throw new Error("Cannot fetch translation group "+e);return t.json()})).then((t=>({[e]:t})))}));return Promise.allSettled(t).then((function(e){const t=e.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value}));Object.assign(r,...t)}))},o=function(e,t=null,a=!1){const[l,o]=e.split("."),c=r[l]&&r[l][o]&&function(e,t){let a=e;return t&&a&&Object.keys(t).forEach((e=>{const i="object"==typeof t[e]?s.renderToString(t[e]):t[e],n=a.replace(new RegExp(`\\[${e}\\]`),i);n&&(a=n)})),a}(r[l][o],t)||e;return a?(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:c}}):(0,i.r)(c)}},4229:(e,t,a)=>{"use strict";a.d(t,{_:()=>n,k:()=>r});var s=a(7294),i=a(5893);const n=s.createContext({}),r=({children:e,contexts:t})=>(0,i.jsx)(n.Provider,{value:t,children:e})},8538:(e,t,a)=>{"use strict";a.d(t,{r:()=>n});const s={amp:"&",lt:"<",gt:">",quot:'"',"#039":"'","#60":"<","#62":">","#92":"\\","#34":'"',"#39":"'","#x27":"'"},i=new RegExp(`&(${Object.keys(s).join("|")});`,"g"),n=e=>e.replace(i,((e,t)=>s[t]||e))},1279:(e,t,a)=>{"use strict";a.d(t,{w:()=>s});const s=e=>{let t;return[a=>new Promise(((s,i)=>{Travian.api(e,{data:a,success:function(e,i){t={nonce:i.getResponseHeader("x-nonce"),payload:a},s(e)},error:function(e){t=void 0,i(e)}},"PUT")})),()=>new Promise(((a,s)=>{Travian.api(e,{data:t.payload,headers:{"X-Nonce":t.nonce},success:a,error:s},"POST")}))]}},1809:(e,t,a)=>{"use strict";a.d(t,{rT:()=>m.r,w3:()=>b,Wb:()=>v,d_:()=>u,kT:()=>g.k,eJ:()=>l.e,T_:()=>d,qp:()=>x.qp,Jh:()=>n.Wb,uo:()=>l.u,iA:()=>i,r4:()=>p.r,Ny:()=>j,ag:()=>r.a,rz:()=>f});var s=a(7294);function i(e,t=null,a=null){let s=(""+(e=e||0)).replace(/\D/g,"");return s=s.replace(/^00$/,0),s=s.replace(/^0(\d)$/g,"$1"),null!==t&&(s=s<t?t:s),null!==a&&(s=s>a?a:s),parseInt(s)}var n=a(9208),r=a(4822),l=a(4455),o=a(5893);let c=e=>{let t=(0,l.e)(e.nominator,e.config.numeralConfig),a=(0,l.e)(e.denominator,e.config.numeralConfig);const s={[r.a.LTR]:"/",[r.a.RTL]:"\\"},i=String.fromCharCode(160),n=r.a.RTL_RATIO.indexOf(Travian.Game.language)<0;let c=n?s[r.a.LTR]:s[r.a.RTL],d=n?r.a.DIRECTION_OVERRIDE_LTR:r.a.DIRECTION_OVERRIDE_RTL;return e.config.useSpaces&&(c=`${i}${c}${i}`),e.config.useWrapper&&(t=(0,o.jsx)("span",{className:"nominator",children:t}),a=(0,o.jsx)("span",{className:"denominator",children:a})),(0,o.jsxs)(o.Fragment,{children:[d,t,c,a,r.a.DIRECTION_STOP_OVERRIDE]})};function d(e,t,a={}){return(0,o.jsx)(c,{nominator:e,denominator:t,config:a})}let h=e=>{let t=s.isValidElement(e.nominator)?e.nominator:(0,l.e)(e.nominator,e.config.numeralConfig),a=s.isValidElement(e.denominator)?e.denominator:(0,l.e)(e.denominator,e.config.numeralConfig);const i={[r.a.LTR]:"/",[r.a.RTL]:"\\"},n=r.a.RTL_RATIO.indexOf(Travian.Game.language)<0;let c=n?i[r.a.LTR]:i[r.a.RTL];return(0,o.jsxs)("div",{className:`inputRatio ${e.config.wrapperClass} ${n?"isLtr":"isRtl"}`,children:[(0,o.jsx)("span",{className:"nominator",children:t}),(0,o.jsx)("span",{className:"separator",children:c}),(0,o.jsx)("span",{className:"denominator",children:a})]})};function u(e,t,a={}){return(0,o.jsx)(h,{nominator:e,denominator:t,config:a})}var m=a(6613),p=a(8538),g=a(6619);function v(e,t,a){let s="inlineIcon",i=void 0===a?s:s+" "+a;return(0,o.jsxs)("div",{className:i,children:[(0,o.jsx)("i",{className:e}),(0,o.jsx)("span",{className:"value",children:t})]})}var x=a(3063);class b{static get NOT_EMPTY(){return"notEmpty"}static get CHECKED(){return"checked"}static get SHORTER_THAN(){return"shorterThan"}static get LONGER_THAN(){return"longerThan"}static get IS_EMAIL(){return"isEmail"}static get NO_CUSTOM_ERROR(){return"customErrorExists"}formValid=!1;constructor(){this.validationRules={[b.NOT_EMPTY]:e=>""!==e.value,[b.CHECKED]:e=>e.checked,[b.SHORTER_THAN]:(e,t)=>e.value.length<=t,[b.LONGER_THAN]:(e,t)=>e.value.length>=t,[b.IS_EMAIL]:e=>/^\S+@\S+\.\S+$/.test(e.value),[b.NO_CUSTOM_ERROR]:()=>!1},this.onCustomErrorFocus=()=>{},this.indeterminateText=(0,n.Wb)("form.indeterminate_input_text"),this.indeterminateNumeric=(0,n.Wb)("form.indeterminate_input_numeric")}attach(e){this.form=e,this.bindEventListeners(),this.initElementWithCustomValidationRenderElement(),Travian.Game.Layout.MobileOptimizations.fixNumericKeyboardOnIOS()}bindEventListeners(){for(let e of this.form.querySelectorAll("label input:not([type=radio]):not([type=checkbox]), label textarea, label select")){const t=e.closest("label").closest("label");let a=t.querySelector(".label");a&&(""!==e.value&&a.classList.add("pinned"),e.addEventListener("change",(()=>{""!==e.value?a.classList.add("pinned"):a.classList.remove("pinned"),e.classList.contains("indeterminate")&&e.value!==this.indeterminateText&&e.value!==this.indeterminateNumeric&&(e.classList.remove("indeterminate"),Travian.Tip.clearOnElement(e.closest("label")))})),e.addEventListener("blur",(()=>{this.validate(e)})),e.addEventListener("focus",(()=>{let t=e.closest("label");t.classList.remove("valid"),t.classList.remove("invalid");let a=t.querySelectorAll(".validation");a&&a.forEach((e=>{e.classList.remove("show"),e.classList.contains("custom")&&this.onCustomErrorFocus(e)})),this.isElementIndeterminate(e)&&(e.selectionStart=0,e.selectionEnd=e.value.length)})));new MutationObserver(((t,a)=>{for(const a of t)"childList"===a.type&&this.validate(e)})).observe(t,{childList:!0})}for(let e of this.form.querySelectorAll("input[type=radio], input[type=checkbox]"))e.addEventListener("click",(()=>{for(let t of this.form.querySelectorAll("input[name="+e.name+"]"))t.classList.contains("indeterminate")&&(t.classList.remove("indeterminate"),Travian.Tip.clearOnElement(t.closest("label"))),this.validate(t)}));this.form.addEventListener("submit",((e,t)=>{void 0===t&&(e.preventDefault(),this.validateForm(),this.formValid&&this.form.submit())}))}initElementWithCustomValidationRenderElement(){let e=this.form.querySelectorAll("label");for(let t of e)t.querySelectorAll(".validation[data-render-into]").length>0&&t.classList.add("withCustomValidationRenderElement")}validateForm(){let e=this.form.querySelectorAll("label input, label select, label textarea");this.formValid=!0;for(let t of e)this.validate(t)}validate(e){const t=e.closest("label");if(null===t)return;let a=t.querySelectorAll(".validation"),s=!0;if(a.length>0){if(!e.classList.contains("indeterminate")){e.closest("label").classList.remove("valid");for(let t of a){let a=t.dataset.rule,i=t.dataset.parameter;if("function"==typeof this.validationRules[a]&&!this.validationRules[a](e,i)){this.formValid=!1,this.highlightInvalidElement(t),s=!1;break}}}if(s){e.closest("label").classList.remove("invalid"),e.closest("label").classList.add("valid");for(let t of e.closest("label").querySelectorAll(".validation"))t.classList.remove("show"),t.dataset.renderInto&&this.removeCustomValidationRenderElement(t.dataset.renderInto)}}}highlightInvalidElement(e){const t=e.closest("label");if(e.dataset.renderInto){const t=document.querySelector(e.dataset.renderInto);t.innerHTML=e.innerHTML,t.classList.add("show")}else e.classList.add("show");t.classList.add("invalid")}removeCustomValidationRenderElement(e){const t=document.querySelectorAll(".validation[data-render-into='"+e+"']");if(t)for(let e of t){const t=e.closest("label");if(t.classList.contains("invalid"))return this.validate(t.querySelector("input, select, textarea")),!1}document.querySelector(e).classList.remove("show")}resetAllValidations(){let e=this.form.querySelectorAll("label");for(let t of e){t.classList.remove("valid","invalid");let e=t.querySelectorAll(".validation");for(let t of e)t.classList.remove("show"),t.dataset.renderInto&&this.removeCustomValidationRenderElement(t.dataset.renderInto)}}isElementIndeterminate(e){return e.classList.contains("indeterminate")||e.value===this.indeterminateText||e.value===this.indeterminateNumeric}}function j(e){let t=e.pageX,a=e.pageY;return void 0===a&&(t=e.touches[0].pageX,a=e.touches[0].pageY),{x:t,y:a,timestamp:new Date}}const f=(e,t,a,s,i,n)=>{const r=e.clipboardData.getData("text/plain").replace(/[\u202D\u202C\u202E]/g,"").replace(/−/g,"-").replace(/[^0-9\-|/]/g,""),l=r.match(/^([0-9\-.,]+)([|/])([0-9\-.,]+)$/);if(e.preventDefault(),null!==l)i({x:l[1],y:l[3]}),a.focus();else{const t=r.replace(/[^0-9\-]/g,"");i({...s,[e.target.parentNode.classList.contains("coordinateX")?"x":"y"]:t})}n()}},5386:(e,t,a)=>{"use strict";var s=a(7294),i=a(745),n=a(4229),r=a(9208),l=a(5697),o=a.n(l),c=a(1809),d=a(7015),h=a(5893);const u=e=>{const[t,a]=(0,s.useState)(e.activeTab),[i,n]=(0,s.useState)(e.screenData),[r,l]=(0,s.useState)(e.favouriteSubTabKey);(0,s.useEffect)((()=>{history.pushState(null,"","/build.php?id=39&gid=16&tt=3&screen="+t)}),[]);const o=e=>{const t={success:t=>{history.pushState(null,"","/build.php?id=39&gid=16&tt=3&screen="+e),a(e),n(t)}};Travian.api("rallyPointSimulators/screen/"+e,t,"GET")};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.K0,{onFavouritize:()=>{},name:e.subTabBarName,items:[{key:"combatSimulator",title:(0,c.Jh)("gid16.kampf_simulator"),content:(0,h.jsx)(h.Fragment,{}),onTabClick:()=>o("combatSimulator")},{key:"travelSimulator",title:(0,c.Jh)("gid16.travelSimulator"),content:(0,h.jsx)(h.Fragment,{}),onTabClick:()=>o("travelSimulator")}],favouriteSubTab:e.favouriteSubTabKey,initialTab:t}),"combatSimulator"===t&&(0,h.jsx)(d.ls,{...i,gameData:e.gameData}),"travelSimulator"===t&&(0,h.jsx)(d.Ay,{...i})]})};u.propTypes={screenData:o().object.isRequired,subTabBarName:o().string.isRequired,activeTab:o().string.isRequired,favouriteSubTabKey:o().string};var m=a(3012);class p extends s.Component{constructor(e){super(e)}render(){const{serverProgression:e,populationRank:t,villageStrength:a,resourceRank:s,culturePointsRank:i}=this.props;return s.positive&&(s.positive.raid=new m.p(s.positive.raid),s.positive.trade=new m.p(s.positive.trade),s.positive.production=new m.p(s.positive.production),s.positive.sum=new m.p(s.positive.sum)),s.negative&&(s.negative.raid=new m.p(s.negative.raid),s.negative.trade=new m.p(s.negative.trade),s.negative.sum=new m.p(s.negative.sum)),s.production&&(s.production.soFar.r1=new m.p(s.production.soFar.r1),s.production.soFar.r2=new m.p(s.production.soFar.r2),s.production.soFar.r3=new m.p(s.production.soFar.r3),s.production.soFar.r4=new m.p(s.production.soFar.r4),s.production.perDay.r1=new m.p(s.production.perDay.r1),s.production.perDay.r2=new m.p(s.production.perDay.r2),s.production.perDay.r3=new m.p(s.production.perDay.r3),s.production.perDay.r4=new m.p(s.production.perDay.r4)),(0,h.jsxs)("div",{children:[(0,h.jsx)(d.v3,{data:e}),!!Object.keys(t).length&&(0,h.jsx)(d.F2,{data:t}),!!Object.keys(s).length&&(0,h.jsx)(d.bg,{data:s}),!!Object.keys(a).length&&(0,h.jsx)(d.eX,{data:a}),!!Object.keys(i).length&&(0,h.jsx)(d.Xo,{data:i})]})}}class g extends s.Component{constructor(e){super(e),this.state={items:[{name:(0,c.Jh)("production.tabTitleLumber"),key:"lumber"},{name:(0,c.Jh)("production.tabTitleClay"),key:"clay"},{name:(0,c.Jh)("production.tabTitleIron"),key:"iron"},{name:(0,c.Jh)("production.tabTitleCrop"),key:"crop"},{name:(0,c.Jh)("production.tabTitleBalance"),key:"balance"}],activeTab:e.activeTab},this.onBackButtonClick=this.onBackButtonClick.bind(this),this.onTabClick=this.onTabClick.bind(this)}onBackButtonClick(e){if(e.state){const t=e.state;this.setState({activeTab:t.previousTab})}}onTabClick(e){const t=parseInt(e.target.dataset.tab);history.pushState({previousTab:t},"","?t="+t),this.setState({activeTab:t}),"undefined"!=typeof Travian&&Travian.updateSideboxVillageHref(t)}componentDidMount(){const e=this.state.activeTab;history.pushState({previousTab:e},"","?t="+e)}render(){const{productionsData:e}=this.props,t=e[this.state.activeTab-1];return(0,h.jsxs)("div",{children:[(0,h.jsx)(d.h4,{title:(0,c.Jh)("production.title")}),(0,h.jsx)(d.mQ,{onBackButtonClick:this.onBackButtonClick,onTabClick:this.onTabClick,items:this.state.items,activeTab:this.state.activeTab,contentBaseClass:"production"}),5!=this.state.activeTab&&(0,h.jsx)(d.X6,{currentProductionData:t}),5==this.state.activeTab&&(0,h.jsx)(d.$z,{currentProductionData:t})]})}}class v extends s.Component{tabToDataSource={1:"activeVillageTasks",2:"generalTasks"};constructor(e){super(e);const{activeTab:t,tasksData:a,heroData:s}=this.props;this.state={activeTab:t,showDetailView:!1,detailview:null,tasksData:a,heroData:s},this.onBackButtonClick=this.onBackButtonClick.bind(this),this.onTabClick=this.onTabClick.bind(this),this.showDetailView=this.showDetailView.bind(this),this.setTaskLevelCollected=this.setTaskLevelCollected.bind(this),this.reload=this.reload.bind(this)}showDetailView(e,t){this.setState({showDetailView:e,detailview:t})}onBackButtonClick(e){if(e.state){const t=e.state;this.setState({activeTab:t.previousTab})}}onTabClick(e){const t=parseInt(e.target.dataset.tab);history.pushState({previousTab:t},"","?t="+t),this.setState({activeTab:t,detailview:null,showDetailView:!1}),Travian.updateSideboxVillageHref(t)}setTaskLevelCollected(e,t,a,s,i,n){const r=Object.assign({},this.state);if(n?(r.tasksData.generalTasks=n.generalTasks,r.tasksData.activeVillageTasks=n.activeVillageTasks):(r.tasksData[this.tabToDataSource[e]][t].levels[a-1].readyToBeCollected=!1,r.tasksData[this.tabToDataSource[e]][t].levels[a-1].wasCollected=!0),r.heroData=s,r.tasksData.rewardBonus=i,!this.isRewardClaimable(r.tasksData)){const e=document.querySelector("#questmasterButton .bigSpeechBubble");e&&e.parentElement.removeChild(e)}this.setState(r)}isRewardClaimable(e){for(let t=0,a=e.generalTasks.length;t<a;t++)for(let a=0,s=e.generalTasks[t].levels.length;a<s;a++)if(e.generalTasks[t].levels[a].readyToBeCollected)return!0;for(let t=0,a=e.activeVillageTasks.length;t<a;t++)for(let a=0,s=e.activeVillageTasks[t].levels.length;a<s;a++)if(e.activeVillageTasks[t].levels[a].readyToBeCollected)return!0;return!1}reload(){Travian.api("progressive-tasks/reload",{success:e=>{this.setState({tasksData:{activeVillageName:e.activeVillageName,activeVillageTribe:e.activeVillageTribe,generalTasks:e.tasks.generalTasks,activeVillageTasks:e.tasks.activeVillageTasks,rewardBonus:e.rewardBonus},heroData:e.heroData})}},"GET")}componentDidMount(){const e=this.state.activeTab;history.pushState({previousTab:e},"","?t="+e)}render(){const{activeTab:e,tasksData:t,heroData:a}=this.state,s=[{name:(0,c.Jh)("tasks.tasksForVillage",{VILLAGE:t.activeVillageName}),contentClass:"village",key:"village",knowledgeBaseLink:t.knowledgeBaseLink},{name:(0,c.Jh)("tasks.generalTasks"),contentClass:"general",key:"general",knowledgeBaseLink:t.knowledgeBaseLink}];let i=t[this.tabToDataSource[e]];return(0,h.jsxs)("div",{children:[(0,h.jsx)(d.h4,{title:(0,c.Jh)("tasks.title")}),(0,h.jsx)(d.mQ,{onBackButtonClick:this.onBackButtonClick,onTabClick:this.onTabClick,items:s,activeTab:this.state.activeTab,contentBaseClass:"tasks"}),!1===this.state.showDetailView&&(0,h.jsx)(d._I,{taskIndexToFind:this.state.detailview,tab:this.state.activeTab,data:i,rewardBonus:t.rewardBonus,tribe:t.activeVillageTribe,hero:a,showDetailview:this.showDetailView,setTaskLevelCollected:this.setTaskLevelCollected,reloadCallback:this.reload},this.state.activeTab),!0===this.state.showDetailView&&(0,h.jsx)(d.a$,{tab:this.state.activeTab,data:i[this.state.detailview],rewardBonus:t.rewardBonus,tribe:t.activeVillageTribe,hero:a,showDetailview:this.showDetailView,setTaskLevelCollected:this.setTaskLevelCollected,reloadCallback:this.reload},this.state.activeTab+"_"+this.state.detailview)]})}}const x=s.createContext({common:{},buy:{},bids:{},sell:{},accounting:{}}),b=x;class j extends s.Component{static propTypes={common:o().object.isRequired,buy:o().shape({auctions:o().shape({data:o().array.isRequired,count:o().number.isRequired}).isRequired}).isRequired,sell:o().shape({auctions:o().shape({data:o().array.isRequired,count:o().number.isRequired}).isRequired,finishedAuctions:o().shape({data:o().array.isRequired,count:o().number.isRequired}).isRequired,items:o().array.isRequired}).isRequired,bids:o().shape({current:o().array.isRequired,finished:o().shape({data:o().array.isRequired,count:o().number.isRequired}).isRequired}),accounting:o().object.isRequired,children:o().object};state={error:null,common:this.props.common,buy:this.props.buy,sell:this.props.sell,accounting:this.props.accounting,finishedAuctionsPage:1,bids:this.props.bids,buyPage:1,buyFilter:this.props.buy.filterData,bidsPage:1,bidsFilter:this.props.bids.filterData,contextualHelpData:void 0};setError=e=>{this.setState({error:e})};setCommon=e=>{this.setState({common:e})};setBuy=e=>{this.setState({buy:e})};setSell=e=>{this.setState({sell:e})};setBids=e=>{this.setState({bids:e})};setAccounting=e=>{this.setState({accounting:e})};setBuyPage=e=>{this.setState({buyPage:e})};setBuyFilter=e=>{this.setState({buyFilter:e})};setFinishedAuctionsPage=e=>{this.setState({finishedAuctionsPage:e})};setBidsPage=e=>{this.setState({bidsPage:e})};setBidsFilter=e=>{this.setState({bidsFilter:e})};setContextualHelpData=e=>{this.setState({contextualHelpData:e})};render(){const e={error:this.state.error,common:this.state.common,buy:this.state.buy,bids:this.state.bids,sell:this.state.sell,accounting:this.state.accounting,buyPage:this.state.buyPage,buyFilter:this.state.buyFilter,finishedAuctionsPage:this.state.finishedAuctionsPage,bidsPage:this.state.bidsPage,bidsFilter:this.state.bidsFilter,contextualHelpData:this.state.contextualHelpData,setError:this.setError,setCommon:this.setCommon,setBuy:this.setBuy,setBids:this.setBids,setSell:this.setSell,setBuyPage:this.setBuyPage,setBuyFilter:this.setBuyFilter,setFinishedAuctionsPage:this.setFinishedAuctionsPage,setBidsPage:this.setBidsPage,setBidsFilter:this.setBidsFilter,setAccounting:this.setAccounting,setContextualHelpData:this.setContextualHelpData};return(0,h.jsx)(x.Provider,{value:e,children:this.props.children})}}class f extends s.Component{static contextType=b;adventureCountFragment=e=>(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("div",{className:"auctionAdventureBarText",children:(0,c.Jh)("hero.unlockAuctionsWithAdventures",{INT:e.minimumAdventuresNumberRequired})}),(0,h.jsx)("div",{className:"auctionAdventureBarNumbers",dangerouslySetInnerHTML:{__html:`(${e.adventuresRatio})`}}),(0,h.jsx)("div",{className:"clear"}),(0,h.jsx)("div",{className:"auctionAdventureBar",children:(0,h.jsx)("div",{className:"bar",style:{width:`${Math.round(100*e.adventureCount/e.minimumAdventuresNumberRequired)}%`}})})]});auctionNotAllowedFragment=e=>(0,h.jsx)(s.Fragment,{children:e.map(((e,t)=>(0,h.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:e}},t)))});render(){const{error:e,common:t}=this.context;return(0,h.jsxs)(s.Fragment,{children:[t.adventureCount<t.minimumAdventuresNumberRequired&&this.adventureCountFragment(t),t.auctionNotAllowedReason.length>0&&this.auctionNotAllowedFragment(t.auctionNotAllowedReason),e&&(0,h.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:e}})]})}}class y extends s.Component{constructor(e){super(e),this.table=s.createRef()}componentDidMount(){this.table.current.addEventListener(Travian.TimersAndCounters.timerEndEvent,this.props.onTimerExpire)}render(){return(0,h.jsxs)("table",{className:"currentBid",cellSpacing:"1",cellPadding:"1",ref:this.table,children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"name",colSpan:this.props.colspan,children:(0,c.Jh)("hero.description")}),(0,h.jsx)("th",{className:"bids",children:(0,h.jsx)("img",{title:(0,c.Jh)("hero.bids"),alt:(0,c.Jh)("hero.bids"),className:"bids",src:"/img/x.gif"})}),(0,h.jsx)("th",{className:"silver",children:(0,h.jsx)("img",{title:(0,c.Jh)("allgemein.silver"),alt:(0,c.Jh)("allgemein.silver"),className:"silver",src:"/img/x.gif"})}),(0,h.jsx)("th",{className:"time",children:(0,h.jsx)("img",{title:(0,c.Jh)("hero.time"),alt:(0,c.Jh)("hero.time"),className:"clock",src:"/img/x.gif"})}),this.props.withBidInfo&&(0,h.jsx)("th",{className:"bid",children:(0,c.Jh)("hero.auctions")})]})}),(0,h.jsx)("tbody",{children:this.props.children})]})}}var T=a(8497),N=a(7762);class C extends s.Component{static contextType=b;constructor(e){super(e),this.itemWrapper=s.createRef(),this.item=s.createRef()}componentDidMount(){const{item:e,sellHorseForSilver:t,horseCanNotSell:a,vacationMode:s}=this.props;this.context.common.isInVacationMode?this.itemWrapper.current.addEventListener("click",(()=>{s()})):this.context.common.isAllowedToSell&&e.isAuctionable&&e.isHorse?this.context.common.canSellHorse?e.isFirstTypeHorse?this.itemWrapper.current.addEventListener("click",(a=>{t(this.item.current,e.id)})):this.itemWrapper.current.addEventListener("click",(e=>{this.sellItem()})):this.itemWrapper.current.addEventListener("click",(e=>{a(this.item.current)})):this.context.common.isAllowedToSell&&e.isAuctionable&&this.itemWrapper.current.addEventListener("click",(e=>{this.sellItem()}))}sellItem(){const{item:e,showSellItemDialog:t}=this.props;t(e.possibleAmountsToSell,e.amount,e.id,this.item.current)}render(){const{item:e}=this.props,t=(0,h.jsx)("span",{className:"itemNotMoveable",children:(0,c.Jh)("hero.itemIsNotAuctionable")}),a=this.context.common.auctionNotAllowedReason.reduce(((e,t,a)=>[...e,(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("span",{className:"itemNotMoveable",children:t}),(0,h.jsx)("br",{})]},a)]),[]);let i;e.isAuctionable?this.context.common.isAllowedToSell||(i=(0,h.jsx)("div",{children:a})):i=t;const n=N.renderToString(i),r=this.context.common.isAllowedToSell&&e.isAuctionable,l=e.type===T.Y.tierConsumable?T.Y.tierConsumable:S.tiers[e.tier];return(0,h.jsx)("div",{id:`item_${e.id}`,ref:this.itemWrapper,title:`${(0,c.Jh)("items.item"+e.typeId)}||${n}${e.isAuctionable?e.itemAttributes:""}`,children:(0,h.jsx)("div",{ref:this.item,className:`itemInInventory ${r?"":"disabled"} item ${this.context.common.isMale?"male":"female"}_item_${e.typeId} item${e.typeId} ${l} inventory`,children:(0,h.jsx)("div",{className:"amount",children:e.amount})})})}}class S extends s.Component{static contextType=b;constructor(e){super(e),this.state={dialogOpened:!1,sellAmount:null,itemToSell:null}}static tiers={1:T.Y.tier1,2:T.Y.tier2,3:T.Y.tier3};componentDidMount(){Travian.Tip.updateAllInElement("#auction")}componentDidUpdate(){Travian.Tip.updateAllInElement("#auction")}onSellAmountChange(e){this.setState({sellAmount:e.currentTarget.value})}sellHorseForSilver(e,t){if(this.state.dialogOpened)return;let a=new Travian.Dialog.Dialog({relativeTo:e,buttonTextOk:(0,c.Jh)("allgemein.ok"),preventFormSubmit:!0,onOpen:()=>this.setState({sellAmount:1,itemToSell:t,dialogOpened:!0}),onOkay:()=>this.sell(),onClose:()=>{this.setState({dialogOpened:!1})}});a.setContent((0,c.Jh)("hero.heroAuctionFirstHorseExchangeForSilver",{INT:this.context.common.firstHorsePrice})),a.show()}showDialog(e,t){if(this.state.dialogOpened)return;let a=new Travian.Dialog.Dialog({relativeTo:t,elementFocus:"#sellAmount",buttonTextOk:(0,c.Jh)("allgemein.ok"),preventFormSubmit:!0,onClose:()=>{this.setState({dialogOpened:!1})}});a.setContent(e),a.show(),this.setState({dialogOpened:!0})}horseCanNotSell(e){if(!this.state.dialogOpened){var t=new Travian.Dialog.Dialog({relativeTo:e,buttonTextOk:(0,c.Jh)("allgemein.ok"),preventFormSubmit:!0,onClose:(e,t)=>{this.setState({dialogOpened:!1})}});t.setContent((0,c.Jh)("hero.heroAuctionHorseCanNotSell")),t.show(),this.setState({dialogOpened:!0})}}showSellItemDialog(e,t,a,s){let i,n;const r=e.length>1&&e[0]>t;if(e.length>1&&e[0]<=t){i=document.createElement("span");const a=document.createElement("select");a.setAttribute("id","sellAmount"),e.map(((e,s)=>{if(e<=t){let t=document.createElement("option");t.setAttribute("value",e),0===s&&(n=e,t.setAttribute("selected","selected")),t.innerHTML=e,a.appendChild(t)}})),i.appendChild(a),i=(0,c.Jh)("hero.sellMulti",{AMOUNT:i.innerHTML})}else r?i=(0,c.Jh)("hero.notEnoughItems",{MIN_AMOUNT:e[0]}):(n=1,i=(0,c.Jh)("hero.sellSingle"));if(this.state.dialogOpened)return;let l=new Travian.Dialog.Dialog({relativeTo:s,elementFocus:"#sellAmount",buttonTextOk:(0,c.Jh)("spieler.ja"),title:(0,c.Jh)("hero.sellTitle"),buttonOk:this.state.valid,preventFormSubmit:!0,onOpen:()=>this.setState({sellAmount:n||0,itemToSell:a,dialogOpened:!0}),onOkay:()=>!r&&this.sell(s),onClose:()=>this.setState({sellAmount:null,itemToSell:null,dialogOpened:!1})});l.setContent(i);const o=document.querySelector("#sellAmount");null!==o&&o.addEventListener("change",this.onSellAmountChange.bind(this)),l.show()}vacationMode(){window.location.href=this.context.data.vacationModeUrl}sell(e){const t=this,a=new Travian.Game.TwoStepAction("hero/auction/sell-item",{id:this.state.itemToSell,amount:parseInt(this.state.sellAmount),action:Travian.Constants.ACTION.auction});a.sign((function(){a.execute((function(e){t.context.setSell(e)}),(function(a){t.showDialog(a.message,e)}))}),(function(a){t.showDialog(a.message,e)}))}render(){const{sell:{items:e}}=this.context;return(0,h.jsx)("div",{className:"hero_inventory",children:(0,h.jsxs)("div",{id:"itemsToSale",children:[e.map((e=>(0,h.jsx)(C,{item:e,showSellItemDialog:this.showSellItemDialog.bind(this),horseCanNotSell:this.horseCanNotSell.bind(this),vacationMode:this.vacationMode,sellHorseForSilver:this.sellHorseForSilver.bind(this),showDialog:this.showDialog.bind(this)},e.id))),0===e.length&&(0,h.jsx)("span",{className:"none",children:(0,c.Jh)("hero.noItemsInInventory")}),(0,h.jsx)("div",{className:"clear"})]})})}}class k extends s.Component{static contextType=b;showDetailsColumn(){const{item:e,index:t,onRowExpand:a,isRowExpanded:s}=this.props;let i;switch(!0){case e.time_end<=this.context.common.currentTime:i=(0,h.jsx)("td",{className:"notEnoughSilver",children:(0,h.jsxs)("span",{className:"disabled",children:[e.uid_bidder===e.currentBidder&&(0,c.Jh)("hero.change"),e.uid_bidder!==e.currentBidder&&(0,c.Jh)("hero.bid")]})});break;case this.getMinimalBid(e.price,e.bids)<=this.context.common.silver||e.currentBidder:i=(0,h.jsxs)("td",{className:"bid "+(s?"selected":""),children:[this.context.common.isAllowedToBid&&e.currentBidder&&(0,h.jsx)("button",{"data-index":t,onClick:a,className:"bidButton openedClosedSwitch "+(s?"switchOpened":"switchClosed"),children:(0,c.Jh)("hero.change")}),this.context.common.isAllowedToBid&&!e.currentBidder&&(0,h.jsx)("button",{"data-index":t,onClick:a,className:"bidButton openedClosedSwitch "+(s?"switchOpened":"switchClosed"),children:(0,c.Jh)("hero.bid")}),!this.context.common.isAllowedToBid&&(0,h.jsx)("span",{className:"disabled",children:(0,c.Jh)("hero.bid")})]});break;default:i=(0,h.jsx)("td",{className:"notEnoughSilver",children:(0,c.Jh)("hero.notEnoughSilver")})}return i}getMinimalBid(e,t){return t>0?parseInt(e)+1:e}render(){const{item:e,isRowExpanded:t,onBidFormSubmit:a,onEntryDelete:i,deletable:n}=this.props,r=e.type===T.Y.tierConsumable?T.Y.tierConsumable:S.tiers[e.tier];return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsxs)("tr",{children:[n&&(0,h.jsx)("td",{className:"delete "+(t?"selected":""),children:!e.currentBidder&&(0,h.jsx)("button",{"data-id":e.id,onClick:i,children:(0,h.jsx)("img",{alt:(0,c.Jh)("hero.delete"),title:(0,c.Jh)("hero.delete"),src:"/img/x.gif",className:"del"})})}),(0,h.jsx)("td",{className:`icon ${t?"selected":""} ${r}`,dangerouslySetInnerHTML:{__html:e.itemDescription}}),(0,h.jsx)("td",{className:"name "+(t?"selected":""),dangerouslySetInnerHTML:{__html:e.amountFormatted+" "+(0,c.Jh)("items.item"+e.item_type_id)}}),(0,h.jsx)("td",{className:"bids "+(t?"selected":""),children:e.bids}),(0,h.jsx)("td",{className:"silver "+(t?"selected":""),title:`${Math.round(e.price/e.amount)}${e.currentBidder?` (${Math.round(e.maxBid/e.amount)})`:""} ${(0,c.Jh)("hero.perUnit")}`,children:e.price}),(0,h.jsx)("td",{className:"time "+(t?"selected":""),dangerouslySetInnerHTML:{__html:e.timer}}),this.showDetailsColumn()]}),t&&(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"selected"}),(0,h.jsx)("td",{colSpan:"6",className:"name selected detail",children:(0,h.jsx)("form",{onSubmit:a,className:"auctionDetails","data-id":e.identifier,id:`auctionDetails${e.identifier}`,method:"POST",children:(0,h.jsxs)("div",{children:[(0,c.Jh)("hero.currentBid")," ",(0,h.jsx)("img",{title:(0,c.Jh)("allgemein.silver"),alt:(0,c.Jh)("allgemein.silver"),className:"silver",src:"/img/x.gif"}),(0,h.jsxs)("span",{children:[" ",e.price]}),(0,h.jsx)("br",{}),(0,c.Jh)("hero.highestBidder"),Object.prototype.hasOwnProperty.call(e,"name_bidder")&&(0,h.jsxs)("span",{children:[(0,h.jsxs)("a",{className:"hidden",href:`/profile/${e.uid_bidder}`,children:[" ",e.name_bidder]}),Object.prototype.hasOwnProperty.call(e,"allianceId")&&(0,h.jsxs)("a",{className:"hidden",href:`/alliance/${e.allianceId}`,children:[" (",e.allianceTag,")"]}),!Object.prototype.hasOwnProperty.call(e,"allianceId")&&(0,h.jsx)(s.Fragment,{children:" ( - )"})]}),(0,h.jsx)("br",{}),(0,c.Jh)("hero.maxBid"),(0,h.jsx)("input",{className:"maxBid text",type:"text",inputMode:"numeric",name:"maxBid",defaultValue:e.maxBid}),(0,h.jsxs)("span",{children:[" (",(0,c.Jh)("hero.min")," ",(0,h.jsx)("img",{title:(0,c.Jh)("allgemein.silver"),alt:(0,c.Jh)("allgemein.silver"),className:"silver",src:"/img/x.gif"})," ",0===this.context.common.bidsCount||e.currentBidder?e.price:e.minBid,")"]}),(0,h.jsx)("div",{className:"submitBid",dangerouslySetInnerHTML:{__html:e.button}})]})})})]})]})}}class w extends s.Component{static contextType=b;static propTypes={withBidInfo:o().bool.isRequired,colspan:o().number.isRequired,entries:o().array.isRequired,deletable:o().bool.isRequired,onRowExpand:o().func};constructor(e){super(e),this.state={expandedRows:[]},this.tableWrapper=s.createRef(),this.onTimerExpire=this.onTimerExpire.bind(this)}componentDidMount(){Travian.Tip.updateAllInElement("#auction"),Travian.TimersAndCounters.initTimersInContext(this.tableWrapper.current)}componentDidUpdate(e,t){e.entries!==this.props.entries&&(Travian.Tip.updateAllInElement("#auction"),Travian.TimersAndCounters.initTimersInContext(this.tableWrapper.current),this.setState({expandedRows:[]}))}onBidFormSubmit(e){e.preventDefault();const t=e.currentTarget.dataset.id,a=e.currentTarget.elements.maxBid.value;Travian.api("hero/auction/bid",{data:{maxBid:Number(a),auctionId:String(t),buyFilter:this.context.buyFilter,buyPage:this.context.buyPage,bidsFilter:this.context.bidsFilter,bidsPage:this.context.bidsPage,action:Travian.Constants.ACTION.auction,showResponseData:!0},success:e=>{this.context.setError(null),this.context.setCommon(e.common),this.context.setBuy(e.buy),this.context.setBids(e.bids),document.querySelector(".ajaxReplaceableSilverAmount").innerHTML=e.common.silver},error:e=>{this.context.setError(e.message),this.context.setBuy(e.buy),this.context.setBids(e.bids)}})}onRowExpand(e){const t=parseInt(e.currentTarget.dataset.index),a=[...this.state.expandedRows],s=a.indexOf(t);-1===s?a.push(t):a.splice(s,1),this.setState({expandedRows:a}),this.props.onRowExpand&&this.props.onRowExpand()}onTimerExpire(){let e=Travian.Autoreload.reloadParameter+"="+Travian.Autoreload.autoreloadParameterValue;Travian.api("hero/auction/data?"+e,{data:{buyPage:this.context.buyPage,finishedAuctionsPage:this.context.finishedAuctionsPage,bidsPage:this.context.bidsPage,buyFilter:this.context.buyFilter,bidsFilter:this.context.bidsFilter},success:e=>{this.context.setCommon(e.common),this.context.setBuy(e.buy),this.context.setSell(e.sell),this.context.setBids(e.bids)}})}onEntryDelete(e){const t=parseInt(e.currentTarget.dataset.id);Travian.api("hero/auction",{data:{status:"runningOutbid",auctions:[t],bidsFilter:this.context.bidsFilter,bidsPage:this.context.bidsPage},success:e=>{this.context.setError(null),this.context.setBids(e)},error:e=>{this.context.setError(e.message)}},"DELETE")}render(){const{colspan:e,withBidInfo:t,deletable:a,entries:s}=this.props;return(0,h.jsx)("div",{ref:this.tableWrapper,children:(0,h.jsxs)(y,{onTimerExpire:this.onTimerExpire,colspan:e,withBidInfo:t,children:[s.map(((e,t)=>{const s=-1!==this.state.expandedRows.indexOf(t);return(0,h.jsx)(k,{deletable:a,item:e,index:t,isRowExpanded:s,onRowExpand:this.onRowExpand.bind(this),onBidFormSubmit:this.onBidFormSubmit.bind(this),onEntryDelete:this.onEntryDelete.bind(this)},e.id)})),0===s.length&&(0,h.jsx)("tr",{children:(0,h.jsx)("td",{className:"noData",colSpan:"7",children:(0,c.Jh)("hero.noAuctionsFound")})})]})})}}class E extends s.Component{getPaginatorItemElement(e){const{setPage:t,currentPage:a}=this.props;return e===a?(0,h.jsx)("span",{className:"number currentPage",children:e},e):(0,h.jsx)("a",{onClick:()=>t(e),className:"number",children:e},e)}render(){const{setPage:e,currentPage:t,totalCount:a,perPage:i}=this.props,n=Math.ceil(a/i),r=t>1,l=n>t,o=[];let d=!1,u=!1;for(let e=1;e<=n;e++)n<=6||e<=t+1&&e>=t-1||1===e||e===n?o.push(this.getPaginatorItemElement(e)):(e<t&&!d&&(d=!0,o.push((0,h.jsx)("span",{children:" ... "}))),e>t&&!u&&(u=!0,o.push((0,h.jsx)("span",{children:" ... "}))));return(0,h.jsx)(s.Fragment,{children:0!==n&&(0,h.jsxs)("div",{className:"paginator",children:[r&&(0,h.jsx)("a",{onClick:()=>e(1),className:"first",children:(0,h.jsx)("img",{src:"/img/x.gif",alt:(0,c.Jh)("allgemein.firstPager")})}),!r&&(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.firstPager"),src:"/img/x.gif",className:"first disabled"}),r&&(0,h.jsx)("a",{onClick:()=>e(t-1),className:"previous",children:(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.prevPager"),src:"/img/x.gif"})}),!r&&(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.prevPager"),src:"/img/x.gif",className:"previous disabled"}),(0,h.jsx)("span",{children:o}),l&&(0,h.jsx)("a",{onClick:()=>{e(t+1)},className:"next",children:(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.nextPager"),src:"/img/x.gif"})}),!l&&(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.nextPager"),src:"/img/x.gif",className:"next disabled"}),l&&(0,h.jsx)("a",{onClick:()=>e(n),className:"last",children:(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.lastPager"),src:"/img/x.gif"})}),!l&&(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.lastPager"),src:"/img/x.gif",className:"last disabled"})]})})}}class R extends s.Component{static contextType=b;constructor(e){super(e),this.onPageChange=this.onPageChange.bind(this)}componentDidMount(){Travian.Game.ContextualHelp.initialize()}onRowExpand(){void 0===this.context.contextualHelpData&&Travian.api("hero/auction/bid-help",{success:e=>{this.context.setContextualHelpData(e.contextualHelpData),e.contextualHelpData&&(Travian.Game.contextHelpData=e.contextualHelpData,Travian.Game.ContextualHelp.initialize())}},"GET")}onPageChange(e){this.context.setBuyPage(e),Travian.api("hero/auction/data",{data:{dataType:"buy",buyPage:e,buyFilter:this.context.buyFilter},success:e=>{this.context.setBuy(e)}})}render(){const{common:e,buy:{auctions:t},buyPage:a}=this.context;return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)(w,{entries:t.data,colspan:2,withBidInfo:!0,onRowExpand:this.onRowExpand.bind(this),deletable:!1}),(0,h.jsx)(E,{currentPage:a,setPage:this.onPageChange,totalCount:t.count,perPage:e.perPage})]})}}const I=e=>{const[t,a]=(0,s.useState)(e.filterValue),i=s=>{const i=s.currentTarget.dataset.key===t?null:s.currentTarget.dataset.key;a(i),e.onChange(i)};return(0,h.jsx)("div",{id:"filter",children:(0,h.jsxs)("div",{className:"wrapper",children:[(0,h.jsx)("div",{className:"filterContainer",children:e.filterCategories.map((e=>(0,h.jsx)("button",{title:(0,c.Jh)(`hero.filter_${e}`),"data-key":e,className:t===e?"iconFilterActive iconFilter":"iconFilter",onClick:i,children:(0,h.jsx)("img",{src:"/img/x.gif",className:`itemCategory itemCategory_${e}`})},e)))}),(0,h.jsx)("div",{className:"clear"})]})})};I.propTypes={onChange:o().func.isRequired,filterValue:o().string,filterCategories:o().array.isRequired};class O extends s.Component{static contextType=b;onFilterChange(e){this.context.setBuyPage(1),this.context.setBuyFilter(e),Travian.api("hero/auction/data",{data:{dataType:"buy",buyPage:1,buyFilter:e},success:e=>{this.context.setBuy(e)}})}render(){return(0,h.jsxs)("div",{className:this.props.visible?"":"hidden",children:[(0,h.jsx)(f,{}),(0,h.jsx)(I,{onChange:this.onFilterChange.bind(this),filterValue:this.context.buyFilter,filterCategories:this.context.common.filterCategories}),(0,h.jsx)(R,{})]})}}class _ extends s.Component{static contextType=b;constructor(e){super(e),this.onPageChange=this.onPageChange.bind(this)}onPageChange(e){this.context.setFinishedAuctionsPage(e),Travian.api("hero/auction/data",{data:{dataType:"sell",finishedAuctionsPage:e},success:e=>{this.context.setSell(e)}})}render(){const{common:e,sell:{finishedAuctions:t},finishedAuctionsPage:a}=this.context;return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("h4",{className:"auctionEnded spacer",children:(0,c.Jh)("hero.bidsOld")}),(0,h.jsxs)(y,{colspan:2,children:[t.data.map(((e,t)=>{const a=e.type===T.Y.tierConsumable?T.Y.tierConsumable:S.tiers[e.tier];return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:`icon ${a}`,dangerouslySetInnerHTML:{__html:e.description}}),(0,h.jsx)("td",{className:"name",dangerouslySetInnerHTML:{__html:e.nameFormatted}}),(0,h.jsx)("td",{className:"bids",children:e.isFinished?e.bids:(0,c.Jh)("hero.auction_na")}),(0,h.jsx)("td",{className:"silver",children:e.isFinished?e.price:(0,c.Jh)("hero.auction_na")}),(0,h.jsx)("td",{className:"time",children:(0,c.Jh)(`hero.${e.status}`)})]},t)})),0===t.data.length&&(0,h.jsx)("tr",{children:(0,h.jsx)("td",{className:"noData",colSpan:"5",children:(0,c.Jh)("hero.noAuctionsFound")})})]}),(0,h.jsxs)("div",{className:"footer",children:[(0,h.jsx)(E,{currentPage:a,setPage:this.onPageChange,totalCount:t.count,perPage:e.perPage}),(0,h.jsx)("div",{className:"clear"})]})]})}}class A extends s.Component{static contextType=b;onAuctionDelete(e){const t=parseInt(e.currentTarget.dataset.id);Travian.api("hero/auction",{data:{auctions:[t],status:"running",finishedAuctionsPage:this.context.finishedAuctionsPage},success:e=>{this.context.setSell(e)}},"DELETE")}render(){const{common:{maxDuration:e},sell:{auctions:t}}=this.context;return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("h4",{className:"spacer",children:(0,c.Jh)("hero.auction_duration",{MAX_DURATION:e})}),(0,h.jsxs)(y,{colspan:3,children:[t.data.map((e=>{const t=e.type===T.Y.tierConsumable?T.Y.tierConsumable:S.tiers[e.tier];return(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{className:"delete",children:[e.couldBeDeleted&&(0,h.jsx)("button",{onClick:this.onAuctionDelete.bind(this),"data-id":e.id,children:(0,h.jsx)("img",{alt:(0,c.Jh)("hero.delete"),title:(0,c.Jh)("hero.delete"),src:"/img/x.gif",className:"del"})}),!e.couldBeDeleted&&(0,h.jsx)("img",{alt:(0,c.Jh)("hero.deleteInactive"),title:(0,c.Jh)("hero.deleteInactive"),src:"/img/x.gif",className:"del inactive"})]}),(0,h.jsx)("td",{className:`icon ${t}`,dangerouslySetInnerHTML:{__html:e.description}}),(0,h.jsx)("td",{className:"name",dangerouslySetInnerHTML:{__html:e.nameFormatted}}),(0,h.jsx)("td",{className:"bids",title:(0,c.Jh)("hero.bids"),children:(0,c.Jh)("hero.auction_na")}),(0,h.jsx)("td",{className:"silver",title:"",children:(0,c.Jh)("hero.auction_na")}),(0,h.jsx)("td",{className:"time",children:(0,c.Jh)("hero.running")})]},e.id)})),0===t.data.length&&(0,h.jsx)("tr",{children:(0,h.jsx)("td",{className:"noData",colSpan:"6",children:(0,c.Jh)("hero.noAuctionsFound")})})]})]})}}class D extends s.Component{static contextType=b;render(){return(0,h.jsxs)("div",{className:this.props.visible?"":"hidden",children:[(0,h.jsx)(f,{}),(0,h.jsx)("div",{className:"silverAmount",children:(0,h.jsxs)("div",{className:"silver",children:[(0,h.jsx)("img",{alt:(0,c.Jh)("allgemein.silver"),className:"silver",src:"/img/x.gif"})," ",(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:this.context.common.silverRatio}})]})}),(0,h.jsx)("div",{className:"clear"}),(0,h.jsx)(A,{}),(0,h.jsx)(S,{}),(0,h.jsx)(_,{})]})}}class L extends s.Component{static contextType=b;render(){const{bids:{current:e}}=this.context;return(0,h.jsx)(w,{entries:e,colspan:3,withBidInfo:!0,deletable:!0})}}class P extends s.Component{static contextType=b;constructor(e){super(e),this.state={markedEntries:[],allMarked:!1},this.onPageChange=this.onPageChange.bind(this)}onMarkEntry(e){const t=parseInt(e.currentTarget.dataset.id),a=[...this.state.markedEntries],s=a.indexOf(t);-1===s?a.push(t):a.splice(s,1),this.setState({markedEntries:a,allMarked:!1})}markAll(e){const t=[];e.currentTarget.checked?(this.context.bids.finished.data.map((e=>t.push(e.id))),this.setState({allMarked:!0,markedEntries:t})):this.setState({allMarked:!1,markedEntries:t})}onDelete(e){e.preventDefault(),Travian.api("hero/auction",{data:{auctions:this.state.markedEntries,status:"finished"},success:e=>{this.context.setBids(e)}},"DELETE")}onPageChange(e){this.context.setBidsPage(e),Travian.api("hero/auction/data",{data:{dataType:"bids",bidsPage:e,bidsFilter:this.context.bidsFilter},success:e=>{this.context.setBids(e)}})}render(){const{common:e,bids:{finished:t},bidsPage:a}=this.context;return(0,h.jsxs)("form",{method:"post",onSubmit:this.onDelete.bind(this),children:[(0,h.jsxs)(y,{colspan:this.props.colspan,withBidInfo:!0,children:[t.data.map((e=>{const t=e.type===T.Y.tierConsumable?T.Y.tierConsumable:S.tiers[e.tier],a=e.currentBidder?"win":"outbid";return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"delete",children:(0,h.jsx)("input",{type:"checkbox",checked:-1!==this.state.markedEntries.indexOf(e.id),"data-id":e.id,className:"check",onChange:this.onMarkEntry.bind(this)})}),(0,h.jsx)("td",{className:`icon ${t}`,dangerouslySetInnerHTML:{__html:e.description}}),(0,h.jsx)("td",{className:"name",dangerouslySetInnerHTML:{__html:e.amountFormatted+" "+(0,c.Jh)(`items.item${e.item_type_id}`)}}),(0,h.jsx)("td",{className:"bids",children:e.isFinished?e.bids:(0,c.Jh)("hero.auction_na")}),(0,h.jsx)("td",{className:"silver",children:e.isFinished?e.price:(0,c.Jh)("hero.auction_na")}),(0,h.jsx)("td",{className:"time",children:(0,c.Jh)(`hero.${e.status}`)}),(0,h.jsx)("td",{className:`bid ${a}`,children:(0,c.Jh)(`hero.${a}`)})]},e.id)})),0===t.data.length&&(0,h.jsx)("tr",{children:(0,h.jsx)("td",{className:"noData",colSpan:"7",children:(0,c.Jh)("hero.noAuctionsFound")})})]}),t.data.length>0&&(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"footer",children:[(0,h.jsxs)("div",{id:"markAll",children:[(0,h.jsx)("input",{className:"check",checked:this.state.allMarked,type:"checkbox",id:"sAll",onChange:this.markAll.bind(this)}),(0,h.jsx)("span",{children:(0,h.jsx)("label",{htmlFor:"sAll",children:(0,c.Jh)("berichte.markAll")})})]}),(0,h.jsx)(E,{currentPage:a,setPage:this.onPageChange,totalCount:t.count,perPage:e.perPage}),(0,h.jsx)("div",{className:"clear"})]}),(0,h.jsx)("div",{dangerouslySetInnerHTML:{__html:e.deleteButton}})]})]})}}class B extends s.Component{static contextType=b;onFilterChange(e){this.context.setBidsPage(1),this.context.setBidsFilter(e),Travian.api("hero/auction/data",{data:{dataType:"bids",bidsPage:1,bidsFilter:e},success:e=>{this.context.setBids(e)}})}render(){return(0,h.jsxs)("div",{className:this.props.visible?"":"hidden",children:[(0,h.jsx)(f,{}),(0,h.jsx)(I,{onChange:this.onFilterChange.bind(this),filterValue:this.context.bidsFilter,filterCategories:this.context.common.filterCategories}),(0,h.jsx)("div",{className:"clear"}),(0,h.jsx)(L,{}),(0,h.jsx)(P,{colspan:3})]})}}class M extends s.Component{static contextType=b;constructor(e){super(e),this.ownAuctions=s.createRef(),this.switch=s.createRef()}onToggle(){Travian.toggleSwitch(this.ownAuctions.current,this.switch.current),Travian.toggleSwitchDescription(jQuery(this.switch.current),(0,c.Jh)("hero.showBlockedSilverDetails"),(0,c.Jh)("hero.hideBlockedSilverDetails")),Travian.Tip.updateAllInElement("#silverAccounting")}render(){const{common:e,accounting:t}=this.context,a=t.ownAuctions.length,i=t.silverHistory.length;let n=e.silver;return(0,h.jsxs)("div",{className:this.props.visible?"":"hidden",children:[(0,h.jsxs)("table",{id:"silverAccounting",cellSpacing:"1",cellPadding:"1",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"date",children:(0,c.Jh)("hero.theadDate")}),(0,h.jsx)("th",{className:"cause",children:(0,c.Jh)("hero.theadCause")}),(0,h.jsx)("th",{className:"accounting",children:(0,c.Jh)("hero.theadAccounting")}),(0,h.jsx)("th",{className:"balance",children:(0,c.Jh)("hero.theadBalance")})]})}),a>0&&(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("tbody",{className:"blockedSilver",children:(0,h.jsxs)("tr",{id:"showHideBlockedSilverDetails",onClick:this.onToggle.bind(this),children:[(0,h.jsxs)("td",{colSpan:"2",className:"cause",children:[(0,h.jsx)("img",{src:"/img/x.gif",className:"openedClosedSwitch switchClosed",alt:(0,c.Jh)("hero.showBlockedSilverDetails"),title:(0,c.Jh)("hero.showBlockedSilverDetails"),ref:this.switch}),(0,c.Jh)("hero.blockedSilverAuctionCount",{INT:a})]}),(0,h.jsx)("td",{className:"accounting",children:e.silverInAuctions}),(0,h.jsx)("td",{className:"balance",children:n})]})}),void(n+=e.silverInAuctions),(0,h.jsx)("tbody",{className:"currentBids hide",ref:this.ownAuctions,children:t.ownAuctions.map((e=>(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{colSpan:"2",className:"cause",children:[(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:e.heroItem}}),(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:e.amountFormatted}}),(0,c.Jh)("items.item"+e.item_type_id)]}),(0,h.jsx)("td",{className:"accounting",dangerouslySetInnerHTML:{__html:e.maxBidFormatted}}),(0,h.jsx)("td",{className:"balance"})]},e.id)))})]}),0===a&&(0,h.jsx)("tbody",{className:"noBlockedSilver",children:(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{colSpan:"2",className:"cause",children:[(0,h.jsx)("img",{src:"/img/x.gif",className:"openedClosedSwitch switchDisabled",alt:""}),(0,c.Jh)("hero.noBlockedSilverinAuctions"),(0,h.jsx)("div",{className:"clear"})]}),(0,h.jsx)("td",{className:"accounting",children:"0"}),(0,h.jsx)("td",{className:"balance",children:e.silver+e.silverInAuctions})]})}),i>0&&(0,h.jsx)("tbody",{className:"latestBookings",children:t.silverHistory.map(((e,t)=>(0,h.jsxs)(s.Fragment,{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"date",children:e.timeFormatted}),(0,h.jsx)("td",{className:"cause",dangerouslySetInnerHTML:{__html:e.accountingSaleCause}}),(0,h.jsx)("td",{className:"accounting",dangerouslySetInnerHTML:{__html:e.accountingSaleFormatted}}),(0,h.jsx)("td",{className:"balance",children:n})]}),void(n-=e.accountingSale),Object.prototype.hasOwnProperty.call(e,"seller")&&Object.prototype.hasOwnProperty.call(e,"bidder")&&e.seller===e.bidder&&(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"date",children:e.timeFormatted}),(0,h.jsx)("td",{className:"cause",dangerouslySetInnerHTML:{__html:e.accountingBuyCause}}),(0,h.jsx)("td",{className:"accounting",dangerouslySetInnerHTML:{__html:e.accountingBuyFormatted}}),(0,h.jsx)("td",{className:"balance",children:n-=e.accountingBuy})]})]},t)))}),0===i&&(0,h.jsx)("tbody",{className:"noBookings",children:(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:"4",children:(0,c.Jh)("hero.noAccountingLastXDays",{INT:e.historySinceValue})})})}),(0,h.jsx)("tbody",{children:(0,h.jsxs)("tr",{className:"oldBalance",children:[(0,h.jsx)("td",{colSpan:"3",className:"oldBalance",children:(0,c.Jh)("hero.oldBalance",{DATE:e.historySinceDate})}),(0,h.jsx)("td",{className:"balance",children:n})]})})]}),(0,h.jsx)("span",{className:"balanceSince",children:(0,c.Jh)("hero.balanceSince",{INT:e.historySinceValue})})]})}}var J=a(4333),Z=a(925),F=a(3265),V=a(2623);const H=e=>{const t=Travian.Constants.TRANSFER_TYPE_GOLD_TO_SILVER,a=Travian.Constants.TRANSFER_TYPE_SILVER_TO_GOLD,[i,n]=(0,s.useState)(t),[r,l]=(0,s.useState)(0),[o,d]=(0,s.useState)(1),[u,m]=(0,s.useState)(Travian.Variables.rateSilverToGold),[p,g]=(0,s.useState)(Travian.Variables.rateGoldToSilver),[v,x]=(0,s.useState)(""),[b,j]=(0,s.useState)(e.activeTabKey);let f;const y=(0,Z.a)(),T=J.Ps`query {
        ownPlayer {
            wallet {
                silverAmount
            }
        }
    }`;(0,s.useEffect)((t=>{b!==e.activeTabKey&&(x(""),j(e.activeTabKey))})),(0,s.useEffect)((e=>{N()}),[]),(0,s.useEffect)((e=>{g(i===t?o*Travian.Variables.rateGoldToSilver:Math.floor(u/Travian.Variables.rateSilverToGold))}),[o,u,i]);const N=()=>{y({query:T}).then((e=>{l(e.data.ownPlayer.wallet.silverAmount)}))},C=(e,a,s)=>{x((0,c.Jh)("plus.silverExchangeInfoMsgExchangeSuccess",{FROM:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("img",{src:"/img/x.gif",className:e===t?"gold":"silver"}),(0,h.jsx)("span",{className:"value",children:a})]}),TO:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("img",{src:"/img/x.gif",className:e===t?"silver":"gold"}),(0,h.jsx)("span",{className:"value",children:s})]})},!0)),Travian.Game.Layout.updateGold(),Travian.Game.Layout.updateSilver(),N()},S=()=>{f&&f.book((e=>{C(t,e.gold,e.silver)})),f=void 0};return(0,h.jsxs)("div",{className:"exchangeOffice",children:[(0,h.jsx)("h4",{children:(0,c.Jh)("plus.silverExchangeTitle")}),[t,a].map((e=>(0,h.jsxs)("button",{className:["directionButton",e===t?"goldToSilver":"silverToGold",i===e?"active":""].join(" "),onClick:t=>{n(e),x("")},title:(0,c.Jh)(e===t?"plus.silverExchangeDirectionBtnTooltipGoldToSilver":"plus.silverExchangeDirectionBtnTooltipSilverToGold"),children:[(0,h.jsx)("img",{src:"/img/x.gif",className:e===t?"gold":"silver"}),(0,h.jsx)("img",{src:"/img/x.gif",className:"arrow"}),(0,h.jsx)("img",{src:"/img/x.gif",className:e===t?"silver":"gold"})]},`directionButton${e}`))),(0,h.jsx)("img",{src:"/img/x.gif",className:i===t?"gold":"silver"}),(0,h.jsx)("input",{type:"text",className:"text exchangeValue",value:i===t?o:u,onChange:e=>{x(""),i===t?d(isNaN(parseInt(e.target.value,10))?"":parseInt(e.target.value,10)):m((t=>isNaN(parseInt(e.target.value,10))?"":Math.min(parseInt(e.target.value,10),r)))},inputMode:"numeric"}),i===t?(0,h.jsx)("span",{children:"×"}):(0,h.jsx)("span",{children:"÷"}),(0,h.jsx)("span",{children:i===t?Travian.Variables.rateGoldToSilver:Travian.Variables.rateSilverToGold}),(0,h.jsx)("span",{children:"="}),(0,h.jsx)("img",{src:"/img/x.gif",className:i===t?"silver":"gold"}),(0,h.jsx)("span",{children:p}),i===t?(0,h.jsx)("button",{type:"button",className:["textButtonV1","gold",o<1?"disabled":""].join(" "),onClick:o<1?e=>{}:()=>{f=new Travian.Game.PremiumFeature("gold-to-silver",{action:Travian.Constants.ACTION.premiumFeature,coins:o});const e=e=>(0,h.jsxs)(h.Fragment,{children:[(0,c.Jh)("plus.goldToSilverConfirmationWithIcons",{GOLD:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(F.Z,{className:"goldCoin"}),(0,h.jsx)("span",{className:"value",children:e.fromGold})]}),SILVER:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("i",{className:"silverCoin_medium"}),(0,h.jsx)("span",{className:"value",children:e.toSilver})]})},!0),(0,h.jsx)(V.z,{appearance:"grey",onClick:e.closeDialogCallback,children:(0,c.Jh)("allgemein.cancel_with_capital_c")}),(0,h.jsx)(V.z,{goldValue:e.fromGold,onClick:t=>{S(),e.closeDialogCallback()},children:(0,c.Jh)("plus.redeem")})]});f.sign((t=>{window.Travian.React.Dialog({content:(0,h.jsx)(e,{fromGold:t.gold,toSilver:t.silver}),cssClass:"plain exchangeGoldToSilverConfirmation",buttonOk:!1,buttonCancel:!1,enableBackground:!0,preventFromSubmit:!0},"silverExchange")}))},title:o<1?(0,c.Jh)("plus.silverExchangeExchangeBtnTooltipGoldToSilver_disabled"):"",children:(0,c.Jh)("plus.silverExchangeExchangeBtnLabelGoldToSilver")}):(0,h.jsx)("button",{type:"button",className:["textButtonV1","green",u<Travian.Variables.rateSilverToGold?"disabled":""].join(" "),onClick:u<Travian.Variables.rateSilverToGold?e=>{}:()=>{Travian.api("silver-to-gold",{data:{action:Travian.Constants.ACTION.silverExchange,coins:u},success:function(e){C(a,e.silver,e.gold)}})},title:u<Travian.Variables.rateSilverToGold?(0,c.Jh)("plus.silverExchangeWarning_NotEnoughSilver",{SILVER_AMOUNT:Travian.Variables.rateSilverToGold}):"",children:(0,c.Jh)("plus.silverExchangeExchangeBtnLabelSilverToGold")}),v&&(0,h.jsx)("div",{className:"successMessage",children:v})]})},q=e=>Object.keys(e).reduce(((t,a,s)=>{let i=`${a}=${e[a]}`;return t+(0===s?i:"&"+i)}),"?");class U extends s.Component{static contextType=b;static propTypes={currentTab:o().string.isRequired};constructor(e){super(e);const t=this.props.tabsData.findIndex((t=>t.name===e.currentTab)),a=-1===t?1:t+1;this.state={activeTabKey:e.currentTab,activeTab:a},this.onChangeTab=this.onChangeTab.bind(this),this.onChangeSubTab=this.onChangeSubTab.bind(this),this.onBackButtonPressed=this.onBackButtonPressed.bind(this)}componentDidMount(){const{activeTabKey:e,activeTab:t}=this.state;this.pushToHistory({previousActiveTabKey:e,previousActiveTab:t},e)}pushToHistory(e,t){const a=((e,t,a)=>{const s=Travian.Browser.parseURL(window.location.href);return s.searchObject[t]=a,q(s.searchObject)})(window.location.href,"tab",t);history.pushState(e,"",a)}onChangeTab(e){e.preventDefault();const t=parseInt(e.target.dataset.tab),a=this.props.tabsData[t-1],s=void 0!==a&&a.hasOwnProperty("name")?a.name:this.props.tabsData[0].name;this.pushToHistory({previousActiveTabKey:s,previousActiveTab:t},s),this.setState({activeTabKey:s,activeTab:t})}onChangeSubTab(e){e.preventDefault();const t=e.target.dataset.key;this.pushToHistory({previousActiveTabKey:t},t),this.setState({activeTabKey:t})}onBackButtonPressed(e,t){if(!e.state)return;const a=e.state,s=this.props.tabsData.find((e=>e.name===a.previousActiveTabKey));s&&s.knowledgeBaseLink&&t(s.knowledgeBaseLink),this.setState({activeTabKey:a.previousActiveTabKey,activeTab:a.previousActiveTab})}render(){const{common:e}=this.context;return(0,h.jsxs)(s.Fragment,{children:[this.props.isSeparatePage&&(0,h.jsx)(d.mQ,{onBackButtonClick:this.onBackButtonPressed,onTabClick:this.onChangeTab,items:this.props.tabsData.map((e=>({name:(0,c.Jh)("hero."+e.name),enabled:!0,key:e.name,contentClass:e.name,knowledgeBaseLink:e.knowledgeBaseLink}))),activeTab:this.state.activeTab,contentBaseClass:"hero hero_auction"}),e.isAllowedToBid&&(0,h.jsx)(H,{activeTabKey:this.state.activeTabKey}),!this.props.isSeparatePage&&(0,h.jsx)(d.Su,{items:this.props.tabsData.map((e=>({name:(0,c.Jh)("hero."+e.name),enabled:!0,key:e.name,knowledgeBaseLink:e.knowledgeBaseLink}))),onBackButtonPressed:this.onBackButtonPressed.bind(this),onChangeTab:this.onChangeSubTab,activeTabKey:this.state.activeTabKey}),(0,h.jsxs)("div",{id:"auction",className:this.props.isSeparatePage?"heroV2":"",children:[(0,h.jsx)(O,{visible:"buy"===this.state.activeTabKey}),(0,h.jsx)(D,{visible:"sell"===this.state.activeTabKey}),(0,h.jsx)(B,{visible:"bids"===this.state.activeTabKey}),(0,h.jsx)(M,{visible:"accounting"===this.state.activeTabKey})]})]})}}class z extends s.Component{static propTypes={currentTab:o().string.isRequired,common:o().shape({isSeparatePage:o().bool.isRequired,tabsData:o().array.isRequired})};render(){return(0,h.jsx)(j,{...this.props,children:(0,h.jsx)(U,{currentTab:this.props.currentTab,isSeparatePage:this.props.common.isSeparatePage,tabsData:this.props.common.tabsData})})}}class $ extends s.Component{constructor(e){super(e);const{activeTab:t,viewData:a}=this.props;this.state={activeTab:parseInt(t),viewData:a},this.onTabClick=this.onTabClick.bind(this),this.openTab=this.openTab.bind(this),this.updateData=this.updateData.bind(this),this.onBackButtonClick=this.onBackButtonClick.bind(this)}onBackButtonClick(e){if(e.state){const t=e.state;this.setState({activeTab:t.previousTab})}}onTabClick(e){const t=parseInt(e.target.dataset.tab);history.pushState({previousTab:t},"","?t="+t),this.setState({activeTab:parseInt(t)})}openTab(e){history.pushState({previousTab:e},"","?t="+e),this.setState({activeTab:parseInt(e)})}updateData(e){let t=this.state.viewData;t.overview=e,this.setState({viewData:t})}componentDidMount(){const e=this.state.activeTab;history.pushState({previousTab:e},"","?t="+e)}render(){const{activeTab:e,viewData:t}=this.state,a=[{name:(0,c.Jh)("referAFriend.referAFriendInfoTab"),contentClass:"info",key:"info",knowledgeBaseLink:t.knowledgeBaseLink},{name:(0,c.Jh)("referAFriend.referralOverviewTab"),contentClass:"overview",key:"overview",knowledgeBaseLink:t.knowledgeBaseLink}];return(0,h.jsxs)("div",{children:[(0,h.jsx)(d.h4,{title:(0,c.Jh)("referAFriend.referAFriend")}),(0,h.jsx)(d.mQ,{onTabClick:this.onTabClick,onBackButtonClick:this.onBackButtonClick,items:a,activeTab:e,contentBaseClass:"referAFriend"}),1===e&&(0,h.jsx)(d.B6,{viewData:t.info,openTabCallback:this.openTab,isMobile:t.isMobile}),2===e&&(0,h.jsx)(d.Pl,{viewData:t.overview,updateDataCallback:this.updateData})]})}}var W=a(5615);const G=()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.mQ,{onTabClick:e=>{},onBackButtonClick:e=>{},activeTab:1,contentBaseClass:"styleguideReact",favouriteTabKey:"favored",withFavourite:!0,items:[{name:"Active",key:"active"},{name:"Favored",key:"favored"},{name:"Default",key:"default"},{name:"Default Disabled",enabled:!1,key:"defaultDisabled"},{name:"Premium",premium:!0,key:"premium"},{name:"Premium Disabled",enabled:!1,premium:!0,key:"premiumDisabled"},{name:"If tabs are wider then the content window",key:"long1"},{name:"pagination arrows are shown!",key:"long2"}]}),(0,h.jsx)("a",{className:"switch arrow",href:"/debug_styleguide.php?type=classic",children:"Styleguide - Classic version"}),(0,h.jsx)(d.K0,{name:"styleguideReact_subtabs",onFavouritize:e=>{},items:[{key:"forms",title:"Forms",content:(0,h.jsx)(d.ey,{})},{key:"dialogs",title:"Dialogs",content:(0,h.jsx)(W.b,{})},{key:"others",title:"Others",content:(0,h.jsx)(d.qm,{})},{key:"icons",title:"Icons",content:(0,h.jsx)(d.J4,{})}]})]});class Y extends s.Component{static propTypes={screen:o().string.isRequired,screens:o().object.isRequired};static screens=["create","myBanner","gallery"];static screensToURL={create:"create",myBanner:"my",gallery:"gallery"};constructor(e){super(e);const t=-1!==Y.screens.indexOf(e.screen)?e.screen:Y.screens[0];this.state={screen:t,screenProps:e.screens[t]}}switchToScreen(e){const t=this;if(-1===Y.screens.indexOf(e))return!1;const a={success:a=>{t.updateBannerTemplateSVG(a.bannerTemplateSVG),history.pushState(null,"","/alliance/options/banner/"+Y.screensToURL[e]),t.setState({screen:e,screenProps:a.screensProps[e]})}};Travian.api("alliance/banner/screen/"+e,a,"GET")}updateBannerTemplateSVG(e){let t=document.getElementById("bannerTemplateSVG"),a=document.createElement("div");a.innerHTML=e;let s=a.getElementsByTagName("svg")[0];t.parentNode.replaceChild(s,t)}render(){const{screen:e,screenProps:t}=this.state;return(0,h.jsxs)(s.Fragment,{children:["create"===e&&(0,h.jsx)(d.g6,{...t,switchToScreen:this.switchToScreen.bind(this)}),"myBanner"===e&&(0,h.jsx)(d.TK,{...t,switchToScreen:this.switchToScreen.bind(this)}),"gallery"===e&&(0,h.jsx)(d.ri,{...t,switchToScreen:this.switchToScreen.bind(this)})]})}}class K extends s.Component{static propTypes={screen:o().string.isRequired,screenData:o().object.isRequired,favouriteTab:o().string,tabBarName:o().string.isRequired};static screens=["inventory","attributes","appearance"];constructor(e){super(e);const t=-1!==K.screens.indexOf(e.screen)?K.screens.indexOf(e.screen)+1:1,a=K.screens[t-1];this.state={activeTab:t,screen:a,screenProps:e.screenData},this.onBackButtonClick=this.onBackButtonClick.bind(this),this.onTabClick=this.onTabClick.bind(this),this.loadScreen=this.loadScreen.bind(this)}onBackButtonClick(e){const t=e.state;this.setState({activeTab:t.previousTab})}onTabClick(e){const t=parseInt(e.target.dataset.tab),a=K.screens[t-1];if(-1===K.screens.indexOf(a))return!1;this.loadScreen(a)}loadScreen(e){const t=this,a={success:a=>{history.pushState(null,"","/hero/"+e),t.setState({screen:e,activeTab:K.screens.indexOf(e)+1,screenProps:a})}};Travian.api("hero/v2/screen/"+e,a,"GET")}componentDidMount(){const e=this.state.screen;history.pushState(null,"","/hero/"+e)}render(){const{activeTab:e,screen:t,screenProps:a}=this.state,{favouriteTab:i,tabBarName:n}=this.props,r=[{name:(0,c.Jh)("hero.heroInventory"),contentClass:"inventory",key:"inventory",knowledgeBaseLink:a.knowledgeBaseLink},{name:(0,c.Jh)("hero.heroSettings"),contentClass:"attributes",key:"attributes",knowledgeBaseLink:a.knowledgeBaseLink},{name:(0,c.Jh)("hero.heroEditor"),contentClass:"appearance",key:"appearance",knowledgeBaseLink:a.knowledgeBaseLink}];return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)(d.mQ,{onBackButtonClick:this.onBackButtonClick,onTabClick:this.onTabClick,items:r,activeTab:e,contentBaseClass:"heroV2",favouriteTabKey:i,withFavourite:!0,name:n}),"inventory"===t&&(0,h.jsx)(d.F8,{reloadCallback:()=>{this.loadScreen(t)},...a}),"attributes"===t&&(0,h.jsx)(d.zj,{reloadCallback:()=>{this.loadScreen(t)},...a}),"appearance"===t&&(0,h.jsx)(d.um,{...a})]})}}class X extends s.Component{static propTypes={gql:o().string.isRequired,viewData:o().object.isRequired,playerId:o().number.isRequired,activeTab:o().string.isRequired,client:o().object.isRequired,subTabBarName:o().string.isRequired};constructor(e){super(e);const{activeTab:t,viewData:a}=this.props,s=[{name:(0,c.Jh)("spieler.m_uebersicht"),contentClass:"overview",key:"overview"},{name:(0,c.Jh)("spieler.m_profil"),contentClass:"edit",key:"edit"}];this.historyKey="previousTabIndex",this.state={profile:a.data,activeTabIndex:s.findIndex((e=>e.key===t)),tabItems:s},this.onTabClick=this.onTabClick.bind(this),this.onBackButtonClick=this.onBackButtonClick.bind(this),this.updateData=this.updateData.bind(this)}onBackButtonClick(e){const t=e.state;t.hasOwnProperty(this.historyKey)&&this.setState({activeTabIndex:t[this.historyKey]})}onTabClick(e){const t=parseInt(e.target.dataset.tab)-1,a=this.state.tabItems[t].key,s=this.getTargetUrl(a);history.pushState({...history.state,[this.historyKey]:t},"",s),this.setState({activeTabIndex:t})}updateData(){this.props.client.query({query:(0,J.Ps)(this.props.gql),variables:{uid:this.props.playerId,subTabBarName:this.props.subTabBarName}}).then((e=>this.setState({profile:e.data}))),Travian.Game.VillageList.updateVillageNames(),Travian.Game.ActiveVillage.updateActiveVillageName()}componentDidMount(){const e=this.state.activeTabIndex,t=this.state.tabItems[e].key,a=this.getTargetUrl(t);history.replaceState({[this.historyKey]:e},"",a)}getTargetUrl(e){const t="/profile";switch(!0){case"overview"!==e:return`${t}/${e}`;case""!==this.props.playerId:return`${t}/${this.props.playerId}`;default:return t}}componentDidUpdate(e,t,a){Travian.Tip.refresh()}render(){const{profile:e,activeTabIndex:t}=this.state,a=this.state.tabItems[t].key;return(0,h.jsxs)("div",{children:[e.player.profile.allowEdit&&(0,h.jsx)(d.mQ,{onTabClick:this.onTabClick,items:this.state.tabItems,activeTab:t+1,contentBaseClass:"playerProfile",onBackButtonClick:this.onBackButtonClick}),"overview"===a&&(0,h.jsx)(d.XC,{profile:e,updateData:this.updateData,subTabBarName:this.props.subTabBarName}),"edit"===a&&(0,h.jsx)(d.yC,{profile:e,saveCallback:this.updateData})]})}}const Q=(0,Z.T)(X);var ee=a(1279);const te=e=>{(0,J.Ps)(e.gql);const[t,a]=(0,s.useState)(e.adventure),[i,n]=(0,s.useState)(e.viewData),[r,l]=(0,ee.w)("troop/send");return(0,h.jsx)(h.Fragment,{children:t?(0,h.jsx)(d.Jd,{adventure:t,activePerspective:e.activePerspective}):(0,h.jsx)(d.Vk,{viewData:i,startAdventureCallback:async e=>{const t={action:Travian.Constants.ACTION.troopsSend,targetMapId:e.mapId,eventType:50,troops:[{t11:1}]};await r(t);const s=await l();e.arrivalAt=s.troops[0].timeArrive,e.arrivalIn=s.troops[0].arrivalIn,e.fromVillageId=s.sourceVillage.id,a(e),Travian.Game.Hero.refreshInHUD(),Travian.Game.ContextualHelp.reset(),Travian.Tip.refresh()}})})};te.propTypes={gql:o().string.isRequired,viewData:o().object,adventureStarted:o().object};const ae=(0,Z.T)(te);var se=a(3991),ie=a(4984),ne=a(9394),re=a(3063);const le=J.Ps`query {ownPlayer{village{marketplace{merchantsInfo{total capacity} tradeShipCapacity tradeShipsInfo{total capacity} destinations{id name x y cropOnly player{id}}} isShore hasHarbour}}}`,oe=["all","only-mine","others"],ce=[24,12,8,6,4,3,2,1,0],de=e=>{const t=e.type===he,a=e.type===ue,i=(0,s.useRef)();let n=(0,s.useRef)(new c.w3);const r=(0,s.useRef)(),l=(0,s.useRef)(),o=(0,s.useRef)(),u=(0,Z.a)(),[m,p]=(0,s.useState)(!0),g={capacity:1,total:0},[v,x]=(0,s.useState)({destinations:[],merchantsInfo:g,tradeShipsInfo:g}),[b,j]=(0,s.useState)({}),[f,y]=(0,s.useState)(oe[0]),[T,N]=(0,s.useState)(e.did??null),[C,S]=(0,s.useState)(!1),k=e.routes??[],w=k.length>1,E=Math.floor(Date.now()/1e3),R=e.hour??c.qp.timeFormat(E,re.zt.TIME_ONLY_HOURS,!1,!1),I=e.minute??c.qp.timeFormat(E,re.zt.TIME_ONLY_MINUTES,!1,!1),O=w?null:0,[_,A]=(0,s.useState)(e.resources??{[Travian.Constants.RES_LUMBER]:O,[Travian.Constants.RES_CLAY]:O,[Travian.Constants.RES_IRON]:O,[Travian.Constants.RES_CROP]:O}),D=t?1:null,[L,P]=(0,s.useState)(e.repeat??D),[B,M]=(0,s.useState)(e.repeatEvery||""),J=!w||null,[F,V]=(0,s.useState)(e.enabled??J),H=!!w&&null,[q,U]=(0,s.useState)(e.useTradeShips??H),[z,$]=(0,s.useState)(null),[W,G]=(0,s.useState)(""),[Y,K]=(0,s.useState)(0);let X=q?v.tradeShipsInfo:v.merchantsInfo;q&&!X&&(X={capacity:v.tradeShipCapacity,total:0});const Q=X.total*X.capacity,ee=(e,t,a,s)=>{N(s),r.current.dispatchEvent(new Event("change")),n.current.validate(r.current)};(0,s.useEffect)((()=>(n.current.attach(i.current.closest("form")),te(),Travian.Tip.refresh(),Travian.Game.Village.enableVillageListShortcuts(),jQuery(window).on("travian.villageList.coordinatesShortcut",ee),r.current.dispatchEvent(new Event("change")),l.current&&l.current.dispatchEvent(new Event("change")),o.current&&o.current.dispatchEvent(new Event("change")),()=>{jQuery(window).off("travian.villageList.coordinatesShortcut",ee)})),[]);const te=(e=(()=>{}))=>{u({query:le}).then((e=>{p(!1),x(e.data.ownPlayer.village.marketplace),j({isShore:e.data.ownPlayer.village.isShore,hasHarbour:e.data.ownPlayer.village.hasHarbour}),r.current.dispatchEvent(new Event("change"))})).then(e).catch(Travian.Autoreload.autoreload)};(0,s.useEffect)((()=>{if(T){const e=parseInt(T),t=v.destinations.find((t=>t.id===e));t&&(S(t.cropOnly),t.cropOnly&&(_[Travian.Constants.RES_LUMBER]>0||_[Travian.Constants.RES_CLAY]>0||_[Travian.Constants.RES_IRON]>0)&&A({..._,[Travian.Constants.RES_LUMBER]:0,[Travian.Constants.RES_CLAY]:0,[Travian.Constants.RES_IRON]:0}))}Travian.Tip.refresh()}),[v,T,_]);const[ae,de]=(0,s.useState)(!1);(0,s.useEffect)((()=>{ae?(me(),Travian.Tip.refresh()):q&&de(!0)}),[q]),(0,s.useEffect)((()=>{b&&n.current.attach(i.current.closest("form"))}),[b]);const me=()=>{if(void 0!==Object.keys(_).find((e=>null!==_[e]))){let e=null;return fe>0?F&&fe>Q&&(e=q?(0,c.Jh)("gid17.notEnoughTradeShips",{NEEDED:ye,AVAILABLE:X.total}):(0,c.Jh)("gid17.notEnoughMerchants",{MERCHANTS_NEEDED:ye,MERCHANTS_AVAILABLE:X.total})):je||(e=(0,c.Jh)("gid17.resourcesNumberInvalid")),$(e),null===e}return!0},pe=s=>{if(s.preventDefault(),s.currentTarget.classList.contains("disabled"))return!1;const r=i.current.closest("form");n.current.validateForm();const l=me();if(n.current.formValid&&!z&&l){const s=Object.fromEntries(new FormData(r).entries()),i=s.time?s.time.split(":"):null;let n,l,o,d=null;if(T){const e=v.destinations.find((e=>e.id===T));d={x:e.x,y:e.y}}switch(!0){case a&&!w:l="trade-routes/"+k[0],o="PUT",n={targetCoordinates:d,resources:{lumber:_[Travian.Constants.RES_LUMBER],clay:_[Travian.Constants.RES_CLAY],iron:_[Travian.Constants.RES_IRON],crop:_[Travian.Constants.RES_CROP]},mode:s.mode,hour:parseInt(i[0]),minute:parseInt(i[1]),deliveries:L,enabled:F,useTradeShips:q};break;case w:l="trade-routes",o="PUT";const t=void 0!==Object.keys(_).find((e=>null!==_[e])),r={};d&&(r.targetCoordinates=d),t&&(r.resources={lumber:_[Travian.Constants.RES_LUMBER],clay:_[Travian.Constants.RES_CLAY],iron:_[Travian.Constants.RES_IRON],crop:_[Travian.Constants.RES_CROP]}),null!==L&&""!==L&&(r.deliveries=L),null!==F&&(r.enabled=F),null!==q&&(r.useTradeShips=q);let c=[];k.forEach((e=>{c.push({...r,id:e})})),n={routes:c};break;default:l="trade-routes",o="POST",n={sourceVillageId:e.villageId,targetCoordinates:d,resources:{lumber:_[Travian.Constants.RES_LUMBER],clay:_[Travian.Constants.RES_CLAY],iron:_[Travian.Constants.RES_IRON],crop:_[Travian.Constants.RES_CROP]},mode:s.mode,hour:parseInt(i[0]),minute:parseInt(i[1]),deliveries:L,repeatEvery:B,enabled:F,useTradeShips:q}}p(!0);let u={data:{action:"traderoute",...n},success:a=>{if(t)G((0,c.Jh)("gid17.tradeRouteCreated")),K(Math.random()),te();else if(w){const t=a.routes.filter((e=>!1==!!e.error)).length,s=a.routes.filter((e=>!0==!!e.error)),i=s.length;if(0===i)e.closeDialogCallback();else{let e=(0,h.jsx)(h.Fragment,{});t>0&&(e=(0,h.jsxs)("p",{className:"success",children:[(0,c.Jh)("gid17.bulkUpdated"),": ",(0,h.jsx)("strong",{children:t})]})),window.Travian.React.Dialog({content:(0,h.jsxs)(h.Fragment,{children:[e,(0,h.jsxs)("p",{className:"failed",children:[(0,c.Jh)("gid17.bulkUpdateFailedRoutes"),": ",(0,h.jsx)("strong",{children:i})]}),(0,h.jsx)("ul",{children:s.map((e=>(0,h.jsx)("li",{dangerouslySetInnerHTML:{__html:e.error}},e.id)))})]}),cssClass:"plain contentV2 tradeRouteBulkUpdateSaveInfo",version:2,buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0,onClose:()=>{p(!1)}},"tradeRouteErrorDialog")}}else e.closeDialogCallback();"function"==typeof e.onSuccess&&e.onSuccess()},error:e=>{window.Travian.React.Dialog({content:e.message,cssClass:"plain contentV2",version:2,buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0},"tradeRouteErrorDialog"),p(!1)}};Travian.api(l,u,o)}},ge=v.destinations.length>0;let ve=ge?v.destinations:null,xe=!1;if(ge){const t=v.destinations.filter((t=>t.player.id!==e.playerId));xe=t.length>0,xe&&"others"===f&&(ve=t)}xe&&"only-mine"===f&&(ve=ve.filter((t=>t.player.id===e.playerId)));const be=e.mode||"send",je=Object.keys(_).some((e=>null===_[e])),fe=Object.values(_).reduce(((e,t)=>e+t),0),ye=Math.ceil(fe/X.capacity),Te=fe>Q,Ne=b.isShore&&(b.hasHarbour||a&&!0===q);return(0,h.jsxs)("div",{className:"contentV2",children:[m&&(0,h.jsx)("div",{className:"loadingIndicator",children:(0,h.jsx)("i",{className:"spinner"})}),(0,h.jsxs)("h3",{children:[t&&(0,c.Jh)("gid17.trade_route_create"),a&&!w&&(0,c.Jh)("gid17.editTradeRoute"),w&&(0,c.Jh)("gid17.editSelectedTradeRoutes")]}),(0,h.jsxs)("div",{id:"tradeRouteEditCreate",className:"formV2",ref:i,children:[(0,h.jsxs)("div",{className:"targetSelector",children:[(0,h.jsx)("div",{children:(0,h.jsxs)("label",{className:"select",children:[(0,h.jsxs)("select",{size:"1",name:"did_dest",disabled:!ge||m,onChange:e=>N(""===e.target.value?e.target.value:parseInt(e.target.value)),value:T??"",ref:r,children:[(0,h.jsx)("option",{}),ve&&ve.map(((e,t)=>(0,h.jsx)("option",{value:e.id,children:e.name+" ("+e.x+"|"+e.y+")"},t)))]}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.trade_route_destination")}),!w&&ge&&(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NOT_EMPTY,children:(0,c.Jh)("gid17.pleaseSelectTarget")}),!m&&!ge&&(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NO_CUSTOM_ERROR,children:(0,c.Jh)("gid17.trade_route_no_target_available")})]})}),(0,h.jsx)("div",{className:"destinationOptions",children:oe.map(((e,t)=>(0,h.jsxs)("label",{className:"radio",children:[(0,h.jsx)("input",{type:"radio",name:"show-destination",disabled:!xe||m,defaultChecked:f===e,onChange:t=>y(e)}),(0,h.jsx)(se.Z,{className:"radio"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.show_destination_"+t)})]},t)))})]}),(0,h.jsxs)("div",{className:"merchantCarryInfo",children:[(0,h.jsxs)("p",{children:[!q&&(0,c.Jh)("gid17.haendler_tragen_kann_x_res_tragen",{INT:(0,h.jsx)("strong",{children:X.capacity})},!0),q&&(0,c.Jh)("gid17.tradeShipsCanCarry",{INT:(0,h.jsx)("strong",{children:X.capacity})},!0)]}),b.isShore&&(0,h.jsxs)("label",{className:"switch",title:null===q?(0,c.Jh)("form.selectionIncludesMultipleValues"):Ne?"":(0,c.Jh)("gid17.buildHarbourAndTradeShipsFirst"),children:[(0,h.jsx)("input",{type:"checkbox",name:"useTradeShips",className:null===q?"indeterminate":"",value:"hide",onChange:e=>{U(e.target.checked)},checked:null!==q&&q,disabled:!Ne}),(0,h.jsx)("div",{className:"switch"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.useTradeShips")})]})]}),(0,h.jsxs)("div",{className:"resourceSelector "+(z?"invalid":""),children:[Object.entries(_).map((([e,t])=>(0,h.jsxs)("div",{className:`resource r${e}`,children:[(0,h.jsx)("i",{className:`${Travian.Constants.RESOURCE_NAME[e]}_medium`,title:(0,c.Jh)("allgemein.r"+e)}),(0,h.jsx)("label",{className:`input ${z?"invalid":""} withCustomValidationRenderElement`,children:(0,h.jsx)("input",{type:"text",name:`r${e}`,inputMode:"numeric",maxLength:"6",autoComplete:"off",value:t??"?",disabled:!ge||m||C&&parseInt(e)!==parseInt(Travian.Constants.RES_CROP),onChange:t=>{((e,t)=>{const a=Object.assign({},_);let s=parseInt(t);s=isNaN(s)?0:s,s=Math.max(0,s),a[e]=s,A(a)})(e,t.target.value)},onBlur:me})})]},e))),(0,h.jsxs)("div",{className:"summary",children:[(0,h.jsxs)("div",{children:[(0,c.Jh)("gid17.total"),": ",je?"?":(0,c.T_)(fe,Q,{useSpaces:!0,useWrapper:!0,numeralConfig:{grouping:!0}})]}),(0,h.jsxs)("div",{className:Te?"invalid":"",children:[q?(0,c.Jh)("gid49.type_"+Travian.Variables.shipIds.TRADE_SHIP+"p"):(0,c.Jh)("gid17.haendler"),": ",je?"?":(0,c.T_)(ye,X.total,{useSpaces:!0,useWrapper:!0,numeralConfig:{grouping:!0}})]})]}),(0,h.jsx)("div",{className:"customValidationRenderElement resourceError "+(z?"show":""),children:z})]}),!w&&(0,h.jsxs)("div",{className:"timeSelector",children:[(0,h.jsxs)("label",{className:"radio",children:[(0,h.jsx)("input",{type:"radio",name:"mode",value:"send",defaultChecked:"send"===be,disabled:!ge||m||w}),(0,h.jsx)(se.Z,{className:"radio"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.trade_route_sendLabel")})]}),(0,h.jsxs)("label",{className:"radio",children:[(0,h.jsx)("input",{type:"radio",name:"mode",value:"deliver",defaultChecked:"deliver"===be,disabled:!ge||m||w}),(0,h.jsx)(se.Z,{className:"radio"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.trade_route_deliverLabel")})]}),(0,h.jsx)("div",{className:"timeInput",children:(0,h.jsxs)("label",{className:"input",children:[(0,h.jsx)("input",{type:"time",name:"time",size:"2",disabled:!ge||m||w,defaultValue:w?"":R+":"+I}),(0,h.jsx)("div",{className:"label"}),!w&&(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NOT_EMPTY,"data-render-into":".timeInputValidationMessage",children:(0,c.Jh)("gid17.invalidTimeFormat")})]})}),!w&&(0,h.jsx)("div",{className:"customValidationRenderElement timeInputValidationMessage"})]}),(0,h.jsx)(d.A7,{deliveries:L,setDeliveries:P,hasPlus:!0,hasGoldClub:!0}),t&&(0,h.jsxs)("label",{className:"select every",children:[(0,h.jsxs)("select",{name:"repeatEvery",disabled:!ge||m,onChange:e=>M(""===e.target.value?e.target.value:parseInt(e.target.value)),value:B,ref:o,children:[(0,h.jsx)("option",{}),ce.map((e=>(0,h.jsx)("option",{value:e,children:e>0?(0,c.Jh)("gid17.N_hours",{NUMBER:e}):(0,c.Jh)("gid17.sendOnlyOnce")},e)))]}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.repeat_every")}),(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NOT_EMPTY,children:(0,c.Jh)("gid17.pleaseMakeASelection")})]}),(0,h.jsx)("div",{className:"deactivateTradeRoute",children:(0,h.jsxs)("label",{className:"checkbox",title:null===F?(0,c.Jh)("form.selectionIncludesMultipleValues"):"",children:[(0,h.jsx)("input",{type:"checkbox",name:"deactivate",className:null===F?"indeterminate":"",value:"true",disabled:!ge||m,checked:!1===F,onChange:e=>V(!e.target.checked)}),(0,h.jsx)(ie.Z,{className:"checkbox"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.deactivateTradeRoute")})]})}),(0,h.jsxs)("div",{className:"actionButtons "+(t?"create":"edit"),children:[(0,h.jsx)(d.zx,{appearance:"grey",className:"cancel",onClick:e.closeDialogCallback,children:(0,c.Jh)("allgemein.cancel_with_capital_c")}),a&&(0,h.jsx)(d.zx,{type:"button",iconButton:!0,className:"delete",onClick:function(){(0,d.Is)({message:(0,c.Jh)("gid17.deleteRouteConfirmation"),cancelText:(0,c.Jh)("allgemein.cancel_with_capital_c"),confirmText:(0,c.Jh)("allgemein.del"),appearanceConfirm:"red",onConfirm:function(){p(!0),Travian.api("trade-routes",{data:{action:"traderoute",routes:k},success:()=>{e.closeDialogCallback(),"function"==typeof e.onSuccess&&e.onSuccess()},error:e=>{window.Travian.React.Dialog({content:e.message,cssClass:"basic",version:2,buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0},"tradeRouteErrorDialog")}},"DELETE")}})},title:w?(0,c.Jh)("gid17.deleteRoutes"):(0,c.Jh)("gid17.deleteRoute"),children:(0,h.jsxs)("svg",{children:[(0,h.jsx)(ne.Z,{className:"outline"}),(0,h.jsx)(ne.Z,{className:"icon"})]})}),(0,h.jsxs)(d.zx,{type:"submit",className:"save",disabledClass:!ge,onSubmit:pe,onClick:pe,children:[t&&(0,c.Jh)("gid17.trade_route_create"),a&&!w&&(0,c.Jh)("gid17.saveRoute"),w&&(0,c.Jh)("gid17.saveRoutes")]})]}),W&&(0,h.jsx)(d.A9,{message:W,id:Y,stickyTo:i.current,additionalClass:"success"})]})]})};de.propTypes={playerId:o().number.isRequired,villageId:o().number.isRequired};const he="create",ue="edit",me=(e,t)=>{window.Travian.React.Dialog({content:(0,h.jsx)(de,{type:e,...t}),cssClass:"basic tradeRouteDialog",version:2,allowMobileSidebars:!0,buttonOk:!1,buttonCancel:!0,enableBackground:!1,preventFormSubmit:!0,onOpen:t.onOpen,onClose:t.onClose},"tradeRouteDialog")};var pe;function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ge.apply(this,arguments)}const ve=e=>s.createElement("svg",ge({viewBox:"0 0 20 22"},e),pe||(pe=s.createElement("path",{d:"M17.86 12.46c.07.29.62 2.82-.52 4.75-.8 1.35-2.15 2.04-4.02 2.04H3.94v1.9c0 .37-.21.7-.53.81-.08.03-.16.04-.23.04a.73.73 0 0 1-.56-.28L.19 18.68a.916.916 0 0 1 0-1.13l2.42-3.04c.2-.25.5-.34.79-.24.32.11.53.44.53.81v1.9h9.39c1.17 0 1.97-.35 2.37-1.03.6-1.01.32-2.54.26-2.83l-.02-.04v-.03c-.12-.57.16-1.15.65-1.34.24-.09.5-.08.73.04.26.14.46.4.54.72Zm1.95-9.14L17.38.28c-.2-.25-.5-.34-.79-.24-.32.11-.53.44-.53.81v1.9H6.68c-1.87 0-3.22.68-4.02 2.04-1.14 1.94-.59 4.47-.52 4.75.08.32.28.59.54.72.13.07.27.1.41.1.11 0 .21-.02.32-.06.49-.19.77-.77.65-1.34v-.04l-.02-.04c-.06-.3-.33-1.82.26-2.83.41-.69 1.21-1.03 2.37-1.03h9.38v1.9c0 .37.21.7.53.81.29.1.59 0 .79-.24l2.42-3.04c.26-.32.26-.81 0-1.13ZM10.98 7.7a.813.813 0 0 0-.9.17L8.13 9.75c-.33.32-.34.84-.02 1.17.32.33.84.34 1.17.02l.54-.52v3.27c0 .46.37.83.83.83s.83-.37.83-.83V8.47c0-.33-.2-.63-.51-.76Z"})));var xe,be=a(2637),je=a(6407);function fe(){return fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},fe.apply(this,arguments)}const ye=e=>s.createElement("svg",fe({viewBox:"0 0 48.58 50"},e),xe||(xe=s.createElement("path",{d:"M31.04 19.12c-.2 2.47-.65 4.14-1.76 5.23-.01.13-.02.27-.03.43-.22.28-.37 1.24-.49 2.07 0 0 .63 1.43 1.88 3.16-3.87 2.53-6.32 7.19-6.58 11.04-.2 2.62.39 4.84 1.76 6.62H.34S-.3 36.62.18 36.31c3.27-2.15 15.4-7.15 15.4-7.15l1.63-2.3c-.03-.99-.09-2.17-.12-2.51-1.11-1.09-1.57-2.76-1.76-5.23-2.35-1.24-2.53-5.16-2.46-7.05.07-1.89 1.61-1.89 2.27-1.31-.33-3.27-.88-5.09 1.35-8.07C17.95.74 20.32 0 23.21 0s5.24.74 6.69 2.69c2.23 2.98 1.68 4.8 1.35 8.07.65-.58 2.31-.42 2.37 1.47.06 1.89-.22 5.65-2.57 6.89Zm17.51 22.15c-.15-2.15-1.14-4.72-2.8-6.83-.59-.75-1.25-1.43-2-2.03-.93-.74-1.97-1.33-3.11-1.69 0 0 2.55-2.37 2.37-3.34-.18-.97-1.85-2.02-1.85-2.02l-.55-1.19s-.5-1.07-3.41-1.01c-2.91-.06-3.54.97-3.54.97l-.42 1.23s-1.67 1.05-1.85 2.02c-.09.52.6 1.45 1.26 2.19.57.64 1.11 1.15 1.11 1.15-4.66 1.49-7.65 6.68-7.91 10.55-.24 3.13.91 5.16 2.62 6.46 2.27 1.72 5.54 2.18 7.92 2.25h1.6c4.17-.13 11.09-1.43 10.54-8.71Z"})));var Te;function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ne.apply(this,arguments)}const Ce=e=>s.createElement("svg",Ne({viewBox:"0 0 50 50"},e),Te||(Te=s.createElement("path",{d:"M25 0C11.19 0 0 11.19 0 25s11.19 25 25 25 25-11.19 25-25S38.81 0 25 0Zm0 44.92C14 44.92 5.09 36 5.09 25S14 5.08 25 5.08 44.92 14 44.92 25 36 44.92 25 44.92Zm-1.66-33.5V8.8c0-.77.63-1.4 1.4-1.4s1.4.63 1.4 1.4v2.62c0 .77-.63 1.4-1.4 1.4s-1.4-.63-1.4-1.4Zm2.8 27.4v2.62c0 .77-.63 1.4-1.4 1.4s-1.4-.63-1.4-1.4v-2.62c0-.77.63-1.4 1.4-1.4s1.4.63 1.4 1.4Zm-15.1-12.3H8.42c-.77 0-1.4-.63-1.4-1.4s.63-1.4 1.4-1.4h2.62c.77 0 1.4.63 1.4 1.4s-.63 1.4-1.4 1.4Zm31.42-1.4c0 .77-.63 1.4-1.4 1.4h-2.62c-.77 0-1.4-.63-1.4-1.4s.63-1.4 1.4-1.4h2.62c.77 0 1.4.63 1.4 1.4ZM16.04 14.44c.54.54.54 1.44 0 1.98s-1.44.54-1.98 0l-1.85-1.85c-.54-.54-.54-1.44 0-1.98s1.44-.54 1.98 0l1.85 1.85Zm21.23 21.23c.54.54.54 1.44 0 1.98s-1.44.54-1.98 0l-1.85-1.85c-.54-.54-.54-1.44 0-1.98s1.44-.54 1.98 0l1.85 1.85Zm-21.23-1.85c.54.54.54 1.44 0 1.98l-1.85 1.85c-.54.54-1.44.54-1.98 0s-.54-1.44 0-1.98l1.85-1.85c.54-.54 1.44-.54 1.98 0Zm17.4-17.4c-.54-.54-.54-1.44 0-1.98l1.85-1.85c.54-.54 1.44-.54 1.98 0s.54 1.44 0 1.98l-1.85 1.85c-.54.54-1.44.54-1.98 0ZM24.5 27.27c-.93 0-1.7-.76-1.7-1.7v-.41c0-.07 0-.13.01-.2 0-.04-.01-.08-.01-.13v-8.44c0-.88.72-1.6 1.6-1.6h.7c.88 0 1.6.72 1.6 1.6v7.07h7.89c.93 0 1.7.76 1.7 1.7v.41c0 .93-.76 1.7-1.7 1.7H24.51Z"})));var Se=a(6358),ke=a(6546),we=a.n(ke);Se.ZP.registerPlugin(we());const Ee="activateAll",Re="deactivateAll",Ie="activateSelected",Oe=e=>{const[t,a]=(0,s.useState)(e.viewData.data.ownPlayer.village.marketplace.tradeRoutes||[]),i=(0,Z.a)(),n=(0,J.Ps)(e.gql),[r,l]=(0,s.useState)((e=>{const a={};return t.forEach((e=>{a[e.objectId]=[]})),a})),[o,u]=(0,s.useState)(!1),m=(0,s.useRef)();let p=(0,s.useRef)();const g=e=>{const a=e.target.dataset.tradeRouteCollectionId,s=parseInt(e.target.dataset.tradeRouteId),i=e.target.checked,n=e.target.dataset.checkAll,r=t.find((e=>e.objectId===a)).routes.map((({id:e})=>e));l((e=>{let t=JSON.parse(JSON.stringify(e)),l=t[a];return n?l=i?r:[]:r.includes(s)&&(-1!==l.indexOf(s)?l.splice(l.indexOf(s),1):l.push(s)),t[a]=l,t}))},v=()=>{const e=Object.assign({},r);Object.keys(e).map((a=>{"undefined"!==t.find((e=>e.objectId===a))?e[a]=[]:delete e[a]})),l(e)};(0,s.useEffect)((()=>{Travian.Tip.refresh(),p.current&&"function"==typeof p.current.refresh&&setTimeout(p.current.refresh,150)})),(0,s.useEffect)((()=>{Object.keys(e.preFillData).length>0&&me(he,{onSuccess:x,onOpen:()=>{u(!0)},onClose:()=>{u(!1)},playerId:e.viewData.data.ownPlayer.id,villageId:e.viewData.data.ownPlayer.currentVillageId,...e.preFillData})}),[]),(0,s.useEffect)((()=>{l((e=>{const a={};return t.forEach((t=>{a[t.objectId]=e[t.objectId]??[],a[t.objectId]=a[t.objectId].filter((e=>t.routes.some((t=>t.id===e))))})),a}));let e=()=>{};void 0!==m.current&&null!==m.current&&(m.current.classList.remove("pinned"),p.current=we().create({trigger:"#stickyPin",start:"top bottom",endTrigger:"#contentOuterContainer",end:"bottom up",toggleClass:{targets:m.current,className:"pinned"}}),e=p.current.refresh);const a=document.getElementsByClassName("contentContainer")[0];return a.addEventListener("scroll",e),()=>{a.removeEventListener("scroll",e)}}),[t]);const x=()=>{i({query:n}).then((({data:{ownPlayer:{village:{marketplace:e}}}})=>{a(e.tradeRoutes||[])}))};let b=[],j=[];const f={[Travian.Constants.RES_LUMBER]:0,[Travian.Constants.RES_CLAY]:0,[Travian.Constants.RES_IRON]:0,[Travian.Constants.RES_CROP]:0};let y=0,T=0;Object.keys(r).map((e=>{const a=t.find((t=>t.objectId===e));if(void 0===a)return!1;y+=a.routes.length,T+=a.routes.filter((e=>!e.enabled)).length;const s=a.routes.filter((t=>r[e].includes(t.id)));j=j.concat(s),s.forEach((e=>{b[e.id]=a.objectId,e.resources.forEach((e=>{f[e.resourceType.id]+=e.amount}))}))}));const C=j.length,S=C>0?j.filter((e=>!e.enabled)).length:0;let k;k=C>0&&y!==C?S>0?Ie:"deactivateSelected":y===C?S>0?Ee:Re:T>0?Ee:Re;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"tradeRoutesInfo",children:(0,c.Jh)(Travian.Variables.feature_flags.territory?"gid17.trade_route_description_text_aeu":"gid17.trade_route_description_text")}),(0,h.jsx)(d.zx,{className:"createNewTradeRoute",disabledClass:o,onClick:()=>me(he,{onSuccess:x,onOpen:()=>{u(!0)},onClose:()=>{u(!1)},playerId:e.viewData.data.ownPlayer.id,villageId:e.viewData.data.ownPlayer.currentVillageId}),children:(0,c.Jh)("gid17.createNewTradeRoute")}),0!==t.length&&Object.keys(r).length>0&&t.sort(((e,t)=>e.to.travelTime-t.to.travelTime)).filter((e=>r[e.objectId])).map((s=>(0,h.jsxs)("div",{className:"tradeRouteCollection",children:[(0,h.jsxs)("div",{className:"headline",children:[(0,h.jsxs)("div",{children:[(0,c.Jh)("gid17.to"),": ",(0,h.jsx)("a",{href:""+(s.to.player.id===e.viewData.data.ownPlayer.id?"/build.php?gid=17&t=3&newdid="+s.to.id:"/karte.php?d="+s.to.mapId),children:s.to.name})]}),(0,h.jsxs)("div",{children:[(0,c.Jh)("gid17.travelTime"),": ",c.qp.durationFormat(s.to.travelTime),re.J6.UNIT_HOUR]}),(0,h.jsx)("div",{className:"expandCollapse "+(s.expanded?"expanded":""),onClick:e=>(e=>{const s=t.find((t=>t.objectId===e));s.expanded=!s.expanded,a(t.map((t=>t.objectId===e?s:t))),Travian.api("trade-routes/toggle-group",{data:{sourceVillageId:s.from.id,targetVillageId:s.to.id,isExpanded:s.expanded},error:()=>{s.expanded=!s.expanded,a(t.map((t=>t.objectId===e?s:t)))}},"POST")})(s.objectId),children:(0,h.jsx)(je.Z,{})}),s.nextDelivery&&(0,h.jsxs)("div",{className:"nextDelivery",children:[(0,h.jsx)(Ce,{}),(0,h.jsx)("span",{className:"infoText",children:s.nextDelivery.useTradeShips?(0,c.Jh)("gid17.nextTradingRouteWithShips",{HOUR:(0,h.jsx)("strong",{children:c.qp.timeFormat(s.nextDelivery.departureAt,re.zt.TIME)}),SHIPS:(0,h.jsx)("strong",{children:s.nextDelivery.ships})},!0):(0,c.Jh)("gid17.nextTradingRoute",{HOUR:(0,h.jsx)("strong",{children:c.qp.timeFormat(s.nextDelivery.departureAt,re.zt.TIME)}),MERCHANTS:(0,h.jsx)("strong",{children:s.nextDelivery.merchants})},!0)})]})]}),s.expanded&&(0,h.jsx)("form",{className:"formV2",children:(0,h.jsxs)("table",{className:"routes borderGap",children:[(0,h.jsx)("thead",{className:"includedHeader",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"selection",children:(0,h.jsxs)("label",{className:"checkbox",children:[(0,h.jsx)("input",{type:"checkbox",checked:r[s.objectId].length===s.routes.length,"data-trade-route-collection-id":s.objectId,"data-check-all":!0,name:"selectAll",onChange:e=>g(e)}),(0,h.jsx)(ie.Z,{className:"checkbox"})]})}),(0,h.jsx)("th",{className:"resources",children:(0,c.Jh)("gid17.resource")}),(0,h.jsx)("th",{className:"departure",title:(0,c.Jh)("gid17.departure"),children:(0,h.jsx)(Ce,{})}),(0,h.jsx)("th",{className:"merchants",title:(0,c.Jh)("gid17.merchants"),children:(0,h.jsx)(ye,{})})]})}),(0,h.jsxs)("tbody",{children:[s.routes.sort(((e,t)=>{const a=parseInt(c.qp.timeFormat(e.departureAt,re.zt.TIME_ONLY_HOURS,!1,!1)),s=parseInt(c.qp.timeFormat(e.departureAt,re.zt.TIME_ONLY_MINUTES,!1,!1)),i=parseInt(c.qp.timeFormat(t.departureAt,re.zt.TIME_ONLY_HOURS,!1,!1)),n=parseInt(c.qp.timeFormat(t.departureAt,re.zt.TIME_ONLY_MINUTES,!1,!1));return a===i?s-n:a-i})).map((e=>{const t=e.arrivalAt-e.departureAt,a=(0,h.jsxs)("table",{className:"tradeRoutesDepartureTooltip transparent",children:[(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{children:[(0,c.Jh)("gid17.firstArrival"),":"]}),(0,h.jsx)("td",{children:c.qp.timeFormat(e.departureAt+t,re.zt.TIME_WITHOUT_SECONDS)})]}),e.repeat>1&&(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{children:[(0,c.Jh)("gid17.secondArrival"),":"]}),(0,h.jsx)("td",{children:c.qp.timeFormat(e.departureAt+3*t,re.zt.TIME_WITHOUT_SECONDS)})]}),e.repeat>2&&(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{children:[(0,c.Jh)("gid17.thirdArrival"),":"]}),(0,h.jsx)("td",{children:c.qp.timeFormat(e.departureAt+5*t,re.zt.TIME_WITHOUT_SECONDS)})]}),(0,h.jsxs)("tr",{className:"returnAt",children:[(0,h.jsxs)("td",{children:[e.useTradeShips?(0,c.Jh)("gid17.tradeShipsReturnAt"):(0,c.Jh)("gid17.returnsAt"),":"]}),(0,h.jsx)("td",{children:c.qp.timeFormat(e.departureAt+t*e.repeat*2,re.zt.TIME_WITHOUT_SECONDS)})]}),e.sendOnce&&(0,h.jsx)("tr",{className:"sendOnce",children:(0,h.jsx)("td",{colSpan:"2",children:(0,c.Jh)("gid17.onlyOnce")})})]});return(0,h.jsxs)("tr",{className:e.enabled?"":"deactivated",children:[(0,h.jsx)("td",{className:"selection",children:(0,h.jsxs)("label",{className:"checkbox",children:[(0,h.jsx)("input",{type:"checkbox",checked:r[s.objectId].includes(e.id),"data-trade-route-collection-id":s.objectId,"data-trade-route-id":e.id,name:"selectOne",onChange:e=>g(e)}),(0,h.jsx)(ie.Z,{className:"checkbox"})]})}),(0,h.jsx)("td",{className:"resources",children:(0,h.jsx)("div",{children:e.resources.map((e=>(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:`${e.resourceType.code}_small`,title:(0,c.Jh)("allgemein.r"+e.resourceType.id)}),(0,h.jsx)("span",{className:"value",children:e.amount})]},e.resourceType.id)))})}),(0,h.jsx)("td",{className:"departure",children:(0,h.jsxs)("div",{title:N.renderToString(a),children:[e.repeat>1&&(0,h.jsxs)("span",{className:"deliveries",children:[(0,c.eJ)(e.repeat,{unit:c.uo.TIMES}),(0,h.jsx)("i",{className:"delivery_small"})]}),e.sendOnce&&(0,h.jsx)(ve,{className:"sendOnce"}),(0,h.jsx)("span",{className:"departure",children:c.qp.timeFormat(e.departureAt,re.zt.TIME_WITHOUT_SECONDS)})]})}),(0,h.jsx)("td",{className:"merchants",children:e.useTradeShips?(0,c.Wb)(`unit_medium tribe${s.from.tribeId} ${Travian.Variables.shipIds.TRADE_SHIP}`,(0,c.eJ)(e.ships,{grouping:!0})):e.merchants})]},e.id)})),(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:"4",className:"addRoute",children:(0,h.jsxs)("a",{onClick:()=>me(he,{did:s.to.id,playerId:e.viewData.data.ownPlayer.id,villageId:e.viewData.data.ownPlayer.currentVillageId,onSuccess:x,onOpen:()=>{u(!0)},onClose:()=>{u(!1)}}),className:o?"disabled":"",children:[(0,c.Jh)("gid17.addRoute")," ",(0,h.jsxs)("svg",{children:[(0,h.jsx)(be.Z,{className:"outline"}),(0,h.jsx)(be.Z,{className:"icon"})]})]})})})]})]})})]},s.objectId))),0!==t.length&&(0,h.jsx)("div",{id:"stickyPin",children:(0,h.jsxs)("div",{id:"stickyWrapper",ref:m,className:"pinned",children:[(0,h.jsx)("div",{className:"selectedRoutesSummary",children:j.length>0?(0,h.jsxs)("div",{children:[(0,c.Jh)("gid17.countSelected",{COUNT:j.length}),(0,h.jsx)("span",{className:"equals",children:"="}),Object.entries(f).map((([e,t])=>(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:`${Travian.Constants.RESOURCE_NAME[e]}_small`,title:(0,c.Jh)("allgemein.r"+e)}),(0,h.jsx)("span",{className:"value",children:t})]},e)))]}):(0,c.Jh)("gid17.noTradeRoute")}),(0,h.jsxs)("div",{className:"actionButtons",children:[(0,h.jsx)(d.zx,{className:"deactivate",onClick:()=>(e=>{let a=j.map((({id:e})=>e));0===a.length&&(a=[],Object.keys(r).map((e=>{const s=t.find((t=>t.objectId===e));a=a.concat(s.routes.map((({id:e})=>e)))})));const s={enabled:e};let i=[];a.forEach((e=>{i.push({...s,id:e})})),Travian.api("trade-routes",{data:{action:"traderoute",routes:i},success:()=>{v(),x()},error:e=>{window.Travian.React.Dialog({content:e.message,cssClass:"basic",version:2,buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0},"tradeRouteErrorDialog")}},"PUT")})(k===Ee||k===Ie),disabledClass:o,children:(0,c.Jh)("gid17."+k)}),(0,h.jsx)(d.zx,{className:"edit",disabledClass:0===j.length||o,onClick:()=>{if(0===j.length||o)return!1;const a=j[0],s={did:t.find((e=>e.objectId===b[a.id])).to.id};if(1===j.length)s.repeat=a.repeat,s.hour=c.qp.timeFormat(a.departureAt,re.zt.TIME_ONLY_HOURS,!1,!1),s.minute=c.qp.timeFormat(a.departureAt,re.zt.TIME_ONLY_MINUTES,!1,!1),s.resources={},a.resources.forEach((e=>{s.resources[e.resourceType.id]=e.amount})),s.enabled=a.enabled,s.useTradeShips=a.useTradeShips;else{let e=j.filter((e=>{const s=t.find((t=>t.objectId===b[e.id])),i=t.find((e=>e.objectId===b[a.id]));return s.to.id!==i.to.id}));e.length>0&&(s.did=null),e=j.filter((e=>e.resources.find((e=>e.resourceType.id===Travian.Constants.RES_LUMBER)).amount!==a.resources.find((e=>e.resourceType.id===Travian.Constants.RES_LUMBER)).amount||e.resources.find((e=>e.resourceType.id===Travian.Constants.RES_CLAY)).amount!==a.resources.find((e=>e.resourceType.id===Travian.Constants.RES_CLAY)).amount||e.resources.find((e=>e.resourceType.id===Travian.Constants.RES_IRON)).amount!==a.resources.find((e=>e.resourceType.id===Travian.Constants.RES_IRON)).amount||e.resources.find((e=>e.resourceType.id===Travian.Constants.RES_CROP)).amount!==a.resources.find((e=>e.resourceType.id===Travian.Constants.RES_CROP)).amount)),0===e.length&&(s.resources={},a.resources.forEach((e=>{s.resources[e.resourceType.id]=e.amount}))),e=j.filter((e=>e.repeat!==a.repeat)),0===e.length&&(s.repeat=a.repeat),e=j.filter((e=>e.enabled!==a.enabled)),0===e.length&&(s.enabled=a.enabled),e=j.filter((e=>e.useTradeShips!==a.useTradeShips)),0===e.length&&(s.useTradeShips=a.useTradeShips)}me(ue,{onSuccess:()=>{v(),x()},onOpen:()=>{u(!0)},onClose:()=>{u(!1)},playerId:e.viewData.data.ownPlayer.id,villageId:e.viewData.data.ownPlayer.currentVillageId,routes:j.map((e=>e.id)),...s})},children:(0,c.Jh)("gid17.editSelected")})]})]})})]})};var _e;function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ae.apply(this,arguments)}Oe.propTypes={viewData:o().object.isRequired,gql:o().string.isRequired,preFillData:o().oneOfType([o().array,o().object]).isRequired};const De=e=>s.createElement("svg",Ae({viewBox:"0 0 50 49.98"},e),_e||(_e=s.createElement("path",{d:"M0 31.49h15.6v.76c0 4.3-3.5 7.8-7.8 7.8S0 36.55 0 32.25v-.76Zm33.36 14.22c-.29-.3-.71-.44-1.28-.44h-.28c-1.02 0-2.85-.35-3.22-.51-.1-.09-.29-.38-.42-.57-.23-.35-.49-.74-.81-1.06l-.12-.12s.05-.04.06-.04l.46-.37-.24-.54s-.36-.82-.37-2.02c.65-3.23 1-8.8.69-11.09-.25-1.89-.32-5.02-.33-5.71.34-.95.37-1.45.31-1.74.17-.08.27-.15.29-.17l.26-.19.05-.32c.24-1.55 0-2.09-.15-2.31 1.09-.62 1.21-1.59 1.21-1.98 0-.34.26-1.02.47-1.43.38-.45 1.48-1.51 2.43-1.56h.04c.3-.03.59-.05.87-.05 3.25 0 5.02 2.08 7.54 5.51.1.13.2.26.31.38l-5.86 11.13c-.12.23-.03.52.2.64a.468.468 0 0 0 .64-.19l5.73-10.88c.35.29.73.52 1.13.69l5.56 10.19a.48.48 0 0 0 .84-.46l-5.12-9.38c.19.02.38.04.57.04 1.28 0 2.57-.53 3.37-1.39.5-.53.75-1.15.7-1.74-.12-1.58-.97-2.38-2.54-2.38-.23 0-.47.01-.68.03-.71.05-1.18.42-1.46.88-3.68-5.84-5.72-6.9-6.11-7.06-1.8-.81-3.49-1.22-5-1.22-2.87 0-4.7 1.43-5.98 2.69-.08-.08-.17-.16-.26-.22.87-1.08 1.32-2.29 1.34-3.59.03-2.67-1.79-4.92-2.45-5.64V0l-.76.75-.76-.75v1.52c-.66.72-2.48 2.97-2.45 5.64.01 1.31.46 2.51 1.34 3.59-.09.07-.18.14-.26.22-1.28-1.26-3.11-2.69-5.98-2.69-1.52 0-3.2.41-5 1.22-.38.16-2.42 1.22-6.11 7.06-.29-.46-.75-.83-1.46-.88-.22-.02-.45-.03-.68-.03-1.57 0-2.42.8-2.54 2.38-.04.59.21 1.2.7 1.74.8.86 2.09 1.39 3.37 1.39.19 0 .38-.01.57-.04l-5.1 9.39a.48.48 0 0 0 .84.46l5.56-10.19c.4-.17.78-.41 1.13-.69l5.73 10.88c.09.16.25.25.42.25.07 0 .15-.02.22-.06.23-.12.32-.41.2-.64L8.87 19.39c.1-.12.21-.25.31-.38 2.52-3.43 4.29-5.51 7.54-5.51.28 0 .57.02.87.05h.04c.95.05 2.03 1.09 2.43 1.56.2.41.47 1.09.47 1.43 0 .39.12 1.36 1.21 1.98-.15.22-.39.77-.15 2.31l.05.32.26.19s.13.09.29.17c-.06.29-.03.79.31 1.74-.01.7-.08 3.83-.33 5.71-.31 2.3.04 7.86.69 11.09-.01 1.19-.37 2.01-.37 2.01l-.25.54.47.37.06.04-.12.12c-.32.32-.58.71-.81 1.06-.13.2-.33.49-.41.57-.36.16-2.2.52-3.22.52h-.28c-.58 0-1 .14-1.28.44-.23.24-.34.55-.33.92v1.48l.42.21c.14.07 3.37 1.66 6.84 1.66.49 0 .97-.03 1.43-.1.46.06.94.1 1.43.1 3.47 0 6.7-1.59 6.84-1.66l.42-.21v-1.48c.01-.37-.1-.68-.33-.92Zm1.03-14.22v.76c0 4.3 3.5 7.8 7.8 7.8s7.8-3.5 7.8-7.8v-.76h-15.6Z"})));var Le;function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Pe.apply(this,arguments)}const Be=e=>s.createElement("svg",Pe({viewBox:"0 0 20 14.2"},e),Le||(Le=s.createElement("path",{d:"M4.42 1.17 2.03 6.62c-.11.25-.41.37-.66.26L.29 6.41a.507.507 0 0 1-.26-.66L2.43.3c.11-.25.41-.37.66-.26l1.08.47c.25.11.37.41.26.66Zm15.53 4.44L17.67.53a.494.494 0 0 0-.66-.25l-.82.37c-.25.11-.37.41-.25.66l2.28 5.08c.11.25.41.37.66.25l.82-.37c.25-.11.37-.41.25-.66Zm-15.1-4.5-.36.85 3.09.22 1.07-.9-3.8-.16ZM2.69 5.86l-.45.87 1.11 1.61.52-.82L2.7 5.85Zm2.16 1.66c-.42-.19-.92 0-1.1.43l-.63 1.43c-.19.42 0 .92.43 1.1s.92 0 1.1-.43l.63-1.43c.19-.42 0-.92-.43-1.1Zm1.44 1.35c-.42-.19-.92 0-1.1.43l-.63 1.43c-.19.42 0 .92.43 1.1.42.19.92 0 1.1-.43l.63-1.43c.19-.42 0-.92-.43-1.1Zm10.68 1.41c-.18.26-.46.43-.76.48.05.29-.01.61-.19.87-.23.33-.6.51-.98.5h-.09c0 .22-.08.44-.21.63-.23.33-.6.51-.98.5-.23 0-.47-.07-.68-.21l-.11-.08c0 .24-.06.49-.21.7-.23.33-.6.51-.98.5-.23 0-.47-.07-.68-.21l-1.93-1.33c-.23.14-.51.16-.77.05a.829.829 0 0 1-.48-.93l-.16.37a.835.835 0 0 1-1.53-.67l.63-1.43c.19-.42.68-.62 1.1-.43.37.16.56.56.48.93l.16-.37c.19-.42.68-.62 1.1-.43.22.1.38.28.45.5 0 0 .01 0 .02-.01l3.24 2.24c.23.16.54.1.7-.12a.49.49 0 0 0-.01-.58l-3.22-2.23.02-.02c.14-.17.26-.35.37-.54 0 0 .01-.02.02-.03l3.16 2.19c.07.05.14.11.2.17l.1.07c.23.16.54.1.7-.12a.49.49 0 0 0 .09-.28c0-.12-.04-.23-.12-.32-.03-.02-.06-.03-.09-.06l-3.65-2.52v-.02c.07-.23.12-.46.15-.7v-.03L15.72 10a.494.494 0 0 0 .64-.47c0-.16-.07-.31-.21-.41l-4.34-3c-.03-.23-.08-.46-.15-.67l-.62-.38c-.33-.2-.61-.46-.83-.76 0 0-.94.58-1.11.64-.16.06-.65.43-1.55.43-.72 0-1.59-.47-1.69-1.18v-.05c-.11-.71.39-1.38 1.1-1.49 0 0 .91-.05 1.18-.17.75-.33 1.83-1.4 1.91-1.52.11-.17.5-.37.7-.37 1.03.03 1.45 1.21 2.74 1.21.71 0 1.37-.16 1.94-.44l2.23 4.86s-.37.97-.62 1.19c-.26.23-.67.17-1.01.17-.44 0-.88-.1-1.29-.3l1.93 1.33c.54.37.67 1.11.3 1.64Zm-4.88 2.6c0-.16-.07-.31-.21-.41l-1.89-1.31-.41.93 1.72 1.19c.23.16.54.1.7-.12a.49.49 0 0 0 .09-.28Z"})));var Me;function Je(){return Je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Je.apply(this,arguments)}const Ze=e=>s.createElement("svg",Je({viewBox:"0 0 20 16.38"},e),Me||(Me=s.createElement("path",{d:"M20 2.63 7.75 16.38 0 7.04l2.55-2.5 5.14 6.67L17.67 0 20 2.63Z"})));var Fe=a(7640);const Ve=e=>{const t=Travian.Game.Preferences.get("marketplaceOffersPerPage")||10,[a,i]=(0,s.useState)({}),[n,r]=(0,s.useState)({}),[l,o]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),[p,g]=(0,s.useState)(null),[v,x]=(0,s.useState)(null),[b,j]=(0,s.useState)(null),[f,y]=(0,s.useState)("DURATION"),[T,N]=(0,s.useState)("ASC"),[C,S]=(0,s.useState)(t),[k,w]=(0,s.useState)(0),[E,R]=(0,s.useState)(""),[I,O]=(0,s.useState)(0),_=(0,Z.a)(),A=J.Ps`query($first: Int, $filter: MarketplaceOffersFilter, $sortBy: MarketplaceOffersSortBy, $sortOrder: SortOrder) {
        ownPlayer {
            population
            noobProtection
            banInfo {
                type
            }
            alliance {
                id
            }
            village {
                resources {
                    lumberStock
                    clayStock
                    ironStock
                    cropStock
                }
                marketplace {
                    merchantsInfo {
                        total
                        offering
                        underway
                        capacity
                        available
                    }
                    offers(first: $first, filter: $filter, sortBy: $sortBy, sortOrder: $sortOrder) {
                        totalCount
                        edges {
                            node {
                                id
                                offering {
                                    resourceType {
                                        id
                                        code
                                    }
                                    amount
                                }
                                searching {
                                    resourceType {
                                        id
                                        code
                                    }
                                    amount
                                }
                                ratio
                                duration
                                sellerVillage {
                                    x
                                    y
                                    player {
                                        id
                                        tribeId
                                        name
                                        alliance {
                                            id
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }`;(0,s.useEffect)((()=>{Travian.Tip.refresh()}));const D=e=>{let a={};null!=Travian.Constants.RESOURCE_NAME[u]&&(a.offered=Travian.Constants.RESOURCE_NAME[u].toUpperCase()),null!=Travian.Constants.RESOURCE_NAME[p]&&(a.wanted=Travian.Constants.RESOURCE_NAME[p].toUpperCase()),null!=v&&(a.ratio=v?"ONE_TO_ONE":"ALL"),null!=b&&(a.ownAlliance=b),_({query:A,variables:{first:(e+1)*t,filter:a,sortOrder:T,sortBy:f}}).then((a=>{const{alliance:s,village:n,noobProtection:l,population:c,banInfo:d}=a.data.ownPlayer;i({allianceId:s?s.id:0,stock:{1:n.resources.lumberStock,2:n.resources.clayStock,3:n.resources.ironStock,4:n.resources.cropStock},noobProtection:l>0,population:c,ban:d?d.type:0}),r(n.marketplace.merchantsInfo),o(n.marketplace.offers.edges),S(n.marketplace.offers.totalCount);let h=Math.ceil(n.marketplace.offers.totalCount/t);return e>h-1?Math.max(h-1,0):e})).then((e=>{w(e)}))};(0,s.useEffect)((e=>{D(0)}),[u,p,v,b,f,T]);const L=e=>{N(f===e&&"ASC"===T?"DESC":"ASC"),y(e)},P=e=>{const{offer:t,neededMerchants:s}=e;let i=[];return a.ban&&i.push((0,c.Jh)("spieler.avatar_locked")),t.offering.amount/t.searching.amount!==Travian.Constants.TRADE_OFFER_RATIO_LIMIT&&(a.noobProtection&&i.push((0,c.Jh)("gid17.beginnersProtectionTooltip")),a.population<Travian.Constants.TRADE_POPULATION_THRESHOLD&&i.push((0,c.Jh)("gid17.populationTooltip",{NEEDED_POPULATION:Travian.Constants.TRADE_POPULATION_THRESHOLD}))),s>n.available&&i.push((0,c.Jh)("gid17.notEnoughMerchantsTooltip")),t.searching.amount>a.stock[t.searching.resourceType.id]&&i.push((0,c.Jh)("gid17.notEnoughResourcesTooltip")),(0,h.jsx)(d.zx,{iconButton:!0,onClick:e=>{return 0===i.length?(a=t.id,void Travian.api("marketplace/offers/"+a+"/accept",{data:{action:"marketPlace"},success:function(e){R((0,c.Jh)("gid17.offerAccepted")),O(Math.random()),D(k),Travian.Game.Layout.updateResources()},error:function(e,t){window.Travian.React.Dialog({content:t.responseJSON.detailedErrorMessage,cssClass:"plain contentV2",version:2,buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0,onClose:e=>D(k)},"marketplaceErrorDialog")}})):e=>{};var a},title:i.join("<br />"),className:0===i.length?"":"disabled",children:(0,h.jsxs)("svg",{children:[(0,h.jsx)(Ze,{className:"outline"}),(0,h.jsx)(Ze,{className:"icon"})]})})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.t6,{merchants:n}),(0,h.jsxs)("div",{className:"filterWrapper",children:[(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.suche")}),(0,h.jsx)("div",{className:"filterGroup",children:Object.entries(Travian.Constants.RESOURCE_NAME).map((([e,t])=>(0,h.jsx)(d.zx,{active:u===e,"data-option":e,iconButton:!0,toggleButton:!0,activeNotClickable:!1,onClick:t=>m(u===e?null:e),title:(0,c.Jh)(`allgemein.r${e}`),children:(0,h.jsx)("i",{className:`resource ${t}_small`})},e)))}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.ratio")}),(0,h.jsx)("div",{className:"filterGroup",children:(0,h.jsx)(d.zx,{active:v,iconButton:!0,toggleButton:!0,onClick:e=>x(!v),title:(0,c.Jh)("gid17.valuableTooltip"),children:(0,h.jsx)("i",{className:"oneToOneFilter"})})}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.biete")}),(0,h.jsx)("div",{className:"filterGroup",children:Object.entries(Travian.Constants.RESOURCE_NAME).map((([e,t])=>(0,h.jsx)(d.zx,{active:p===e,"data-option":e,iconButton:!0,toggleButton:!0,activeNotClickable:!1,onClick:t=>g(p===e?null:e),title:(0,c.Jh)(`allgemein.r${e}`),children:(0,h.jsx)("i",{className:`resource ${t}_small`})},e)))}),0!=a.allianceId&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.onlyAlliance")}),(0,h.jsx)("div",{className:"filterGroup",children:(0,h.jsx)(d.zx,{active:b,iconButton:!0,toggleButton:!0,onClick:e=>j(!b),title:(0,c.Jh)("gid17.onlyAllianceFilterTooltip"),children:(0,h.jsx)("i",{className:"allianceFilter"})})})]})]}),(0,h.jsx)("h3",{children:(0,c.Jh)("gid17.angebote_am_marktplatz")}),null===l?(0,h.jsx)("div",{className:"offers placeholder"}):C>0?(0,h.jsxs)("table",{className:"offers borderGap",children:[(0,h.jsx)("thead",{className:"includedHeader",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"offered sortable",onClick:e=>{L("OFFERED")},children:(0,h.jsxs)("div",{children:[(0,c.Jh)("gid17.offered"),(0,h.jsx)(Fe.Z,{className:["sortingArrow","OFFERED"===f?"":"inactive","OFFERED"===f?"ASC"===T?"up":"down":"up"].join(" ")})]})}),(0,h.jsx)("td",{className:"ratio sortable",title:(0,c.Jh)("gid17.ratioTooltip"),onClick:e=>{L("RATIO")},children:(0,h.jsxs)("div",{children:[(0,h.jsx)(De,{}),(0,h.jsx)(Fe.Z,{className:["sortingArrow","RATIO"===f?"":"inactive","RATIO"===f?"ASC"===T?"down":"up":"down"].join(" ")})]})}),(0,h.jsx)("td",{className:"wanted sortable",onClick:e=>{L("WANTED")},children:(0,h.jsxs)("div",{children:[(0,c.Jh)("gid17.wanted"),(0,h.jsx)(Fe.Z,{className:["sortingArrow","WANTED"===f?"":"inactive","WANTED"===f?"ASC"===T?"up":"down":"up"].join(" ")})]})}),(0,h.jsx)("td",{className:"merchants",title:(0,c.Jh)("gid17.merchantsRequiredTooltip"),children:(0,h.jsx)(ye,{})}),(0,h.jsx)("td",{className:"duration sortable",title:(0,c.Jh)("gid17.travelTime"),onClick:e=>{L("DURATION")},children:(0,h.jsxs)("div",{children:[(0,h.jsx)(Ce,{}),(0,h.jsx)(Fe.Z,{className:["sortingArrow","DURATION"===f?"":"inactive","DURATION"===f?"ASC"===T?"up":"down":"up"].join(" ")})]})}),(0,h.jsx)("td",{colSpan:"3"}),(0,h.jsx)("td",{})]})}),(0,h.jsx)("tbody",{children:Object.keys(l).slice(k*t).map((e=>{let t=l[e].node,s=Math.ceil(t.searching.amount/n.capacity);return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"offered",children:(0,h.jsxs)("div",{className:"inlineIcon",children:[(0,h.jsx)("i",{className:`${t.offering.resourceType.code}_small`,title:(0,c.Jh)(`allgemein.r${t.offering.resourceType.id}`)}),(0,h.jsx)("span",{children:(0,c.eJ)(t.offering.amount,{grouping:!0})})]})}),(0,h.jsx)("td",{className:"ratio",children:(0,h.jsx)(d.QF,{receive:t.offering.amount,give:t.searching.amount})}),(0,h.jsx)("td",{className:"wanted",children:(0,h.jsxs)("div",{className:"inlineIcon",children:[(0,h.jsx)("i",{className:`${t.searching.resourceType.code}_small`,title:(0,c.Jh)(`allgemein.r${t.searching.resourceType.id}`)}),(0,h.jsx)("span",{className:t.searching.amount>a.stock[t.searching.resourceType.id]?"notEnough":"",children:(0,c.eJ)(t.searching.amount,{grouping:!0})})]})}),(0,h.jsx)("td",{className:"merchants",children:(0,h.jsx)("span",{className:s>n.available?"notEnough":"",children:s})}),(0,h.jsx)("td",{className:"duration",children:c.qp.durationFormat(t.duration)}),(0,h.jsx)("td",{className:"tribe",children:(0,h.jsx)("i",{className:`tribe${t.sellerVillage.player.tribeId}_small`,title:(0,c.Jh)(`anmelden.volk${t.sellerVillage.player.tribeId}`)})}),(0,h.jsx)("td",{className:"player",children:(0,h.jsx)("a",{href:`/karte.php?x=${t.sellerVillage.x}&y=${t.sellerVillage.y}`,children:t.sellerVillage.player.name})}),(0,h.jsx)("td",{className:"alliance",children:t.sellerVillage.player.alliance&&t.sellerVillage.player.alliance.id==a.allianceId&&(0,h.jsx)(Be,{})}),(0,h.jsx)("td",{className:"accept",children:(0,h.jsx)(P,{offer:t,neededMerchants:s})})]},t.id)}))})]}):(0,h.jsx)("div",{className:"noOffers",children:(0,c.Jh)("gid17.noOffers")}),C>t&&(0,h.jsx)(d.tl,{currentPage:k,pageCount:Math.ceil(C/t),switchPage:e=>{D(e)}}),E&&(0,h.jsx)(d.A9,{message:E,id:I,additionalClass:"success"})]})},He=(e,t)=>{let a=0;const s=e=>{t(e),--a>0&&(a=0,i())},i=()=>{a++>0||e().then(s)};return i};var qe;function Ue(){return Ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ue.apply(this,arguments)}const ze=e=>s.createElement("svg",Ue({viewBox:"0 0 50 37.83"},e),qe||(qe=s.createElement("path",{d:"M49.51 6.77c-.72-.81-1.54-1.29-2.68-.99-2.65.69-5.32 1.29-7.95 2.04-1.28.37-2.44.26-3.57-.33-.28-.15-.64-.46-.65-.71 0-.25.33-.62.6-.75 1.17-.58 2.37-1.08 3.56-1.63.71-.32 1.32-.6 1.92-.89.51-1.17.33-2.09-.42-2.88-.76-.8-1.62-.71-2.53-.39-.25.09-.49.18-.73.29-2.96 1.28-5.94 2.54-8.89 3.85-.72.32-1.39.57-2.11.15C17.93 7.01 9.84 9.5 1.73 11.95c-.8.24-1.42.57-1.73 1.37v.79c.36.76.67 1.54 1.09 2.27 1.39 2.44 2.83 4.85 4.23 7.29.75 1.3 1.23 2.85 2.25 3.86 1.02 1.01 2.56 1.53 3.89 2.21 1.15.58 2.35 1.09 3.54 1.64.11-.57.18-1.02.28-1.46.47-2.04 1.87-3.51 3.78-3.75 1.91-.24 3.23.73 4.18 2.31.17.29.46.51.69.75 1.68-.53 3.26-1.03 4.84-1.54.15-.05.26-.19.38-.27.24-3.9 2.68-6.11 6.12-4.91.19-.34.49-.68.59-1.07.61-2.26 1.22-4.53 1.75-6.82.19-.84.59-1.27 1.41-1.52 3.15-.96 6.28-1.96 9.4-3 .45-.15.94-.5 1.17-.89.47-.78.62-1.65-.09-2.45Zm-15.03 3.74c-6.82 2.69-13.75 5.43-20.75 8.2-3.15-1.71-6.32-3.43-9.49-5.14.02-.1.04-.2.06-.31 7.31-2.26 14.61-4.52 22-6.8 2.5.99 5.07 2.02 7.65 3.03.39.15.74.3.53 1.02Zm-17.2 17.53c-1.59 1.88-2.37 4.06-1.66 6.56.56 1.98 2.06 3.22 3.82 3.23 1.56.09 2.6-.73 3.37-1.97 1.69-2.68.56-6.09-1.09-7.9-1.23-1.34-3.26-1.32-4.44.07Zm2.38 4.87c-.69 0-1.09-.47-1.23-1.11.78-1.16 1.65-1.17 2.43 0-.09.68-.52 1.12-1.2 1.12Zm16.4-9.2c-1.54-1.46-2.94-1.4-4.53-.06-1.12.93-1.53 2.24-1.52 3.68 0 1.14.27 2.12.82 2.97 1.37 2.09 3.99 2.32 5.55.42 1.82-2.21 1.61-5.17-.33-7.01Zm-2.64 4.91c-.63.01-1.17-.58-1.18-1.3-.02-.86.66-1.76 1.34-1.8.61-.03 1.14.63 1.17 1.43.02.84-.62 1.65-1.32 1.66ZM9.29 29.64c.76.37 1.51.74 2.27 1.11-.88 1.54-2.91 2.09-4.55 1.28-.92-.45-1.55-1.18-1.99-2.09-.73-1.5-.68-3.48.18-4.99.6 1.24 1.15 2.38 1.7 3.54.8.39 1.59.77 2.38 1.15Zm23.09-19.7.03.19c-5.98 2.36-11.97 4.71-17.96 7.07-2.53-1.17-4.95-2.3-7.38-3.42 0-.06-.01-.13-.02-.19 6.3-1.92 12.61-3.85 18.91-5.77 2.16.71 4.29 1.42 6.42 2.12Z"})));var $e=a(2011);const We=e=>{const{coordinates:t}=e,[a,i]=(0,s.useState)(0),[n,r]=(0,s.useState)(!1),[l,o]=(0,s.useState)({}),[u,m]=(0,s.useState)(null),[p,g]=(0,s.useState)(null),[v,x]=(0,s.useState)(null),[b,j]=(0,s.useState)(null),[f,y]=(0,s.useState)({incoming:!1,outgoing:!1}),[T,N]=(0,s.useState)({incoming:!1,outgoing:!1}),[C,S]=(0,s.useState)({incoming:!1,outgoing:!1}),[k,w]=(0,s.useState)({incoming:0,outgoing:0}),[E,R]=(0,s.useState)({}),I=(0,s.useRef)(null),O=(0,Z.a)(),_=(0,J.Ps)(e.gql);(0,s.useEffect)((()=>{Travian.Tip.refresh(),Travian.TimersAndCounters.initTimersInContext(I.current)})),(0,s.useEffect)((()=>{b&&window.addEventListener(Travian.TimersAndCounters.timerEndEvent+"_timer_"+b,A)}),[b]);const A=He((()=>O({query:_})),(e=>{const{village:t,banInfo:a}=e.data.ownPlayer,{marketplace:s}=t;i(e.data.bootstrapData.timestamp),r(a?a.type:0),o(s.merchantsInfo),t.isShore&&t.hasHarbour?m(s.tradeShipsInfo):t.isShore&&!t.hasHarbour&&m({available:0,total:0,capacity:s.tradeShipCapacity});let n=[],l=[],c=null,d={incoming:0,outgoing:0},h={incoming:0,outgoing:0},u={1:0,2:0,3:0,4:0},p={incoming:!1,outgoing:!1};s.merchantsMovements.edges.forEach((e=>{let a=e.node;if(a.type=a.type.toLowerCase(),a.merchantAction="incoming"===a.type&&a.to.id===t.id||"outgoing"===a.type&&a.from.id===t.id?"transport":"return","incoming"===a.type&&"return"===a.merchantAction&&1===a.runs)return!1;a.direction=a.to.id===t.id?"from":"to",a.merchantTribe="outgoing"===a.type?t.tribeId:a[a.direction].tribeId,a.otherVillage=a[a.direction],a.historyCount=a.history.length-("return"===a.merchantAction?1:0)+(a.cancelled?1:0),a.runCount=a.runs+a.historyCount,a.predictedCount=a.runCount-1-a.historyCount,h[a.type]+=("transport"===a.merchantAction?1:0)+a.predictedCount,a.show=!0,d[a.type]>=10&&(a.show=!1,p[a.type]=!0),d[a.type]+=a.historyCount+1+a.predictedCount,"incoming"===a.type?(a.resources.forEach((e=>{"transport"===a.merchantAction&&(u[e.resourceType.id]+=e.amount)})),a.predictedCount>0&&a.capacity.forEach((e=>{u[e.resourceType.id]+=a.predictedCount*e.amount})),n.push(a)):l.push(a),c=c?Math.min(c,a.arrivalAt):a.arrivalAt})),R(u),w(h),N(p),g(n),x(l),j(c),Travian.Game.Layout.updateResources()}));(0,s.useEffect)((()=>{A()}),[]);const D=e=>{const{movementKey:t,type:a,resources:i,arrivalAt:n,arrivalIn:r,merchantAction:l,useTradeShips:o,merchantTribe:d}=e;return(0,h.jsxs)("div",{className:`delivery ${a} ${l??""}`,children:[Object.entries(Travian.Constants.RESOURCE_NAME).map((([e,a])=>{let n=i.find((t=>t.resourceType.id==e));return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("i",{className:`${a}_small`,title:(0,c.Jh)(`allgemein.r${e}`)}),(0,h.jsx)("span",{className:"value",children:(0,c.eJ)(n?n.amount:0,{grouping:!0})})]},`${t}_${e}`)})),"current"===a&&(0,h.jsx)(h.Fragment,{children:o?(0,h.jsx)("i",{className:`currentDelivery unit_small t901 tribe${d}`,title:(0,c.Jh)("gid17.currentRunningDelivery")}):(0,h.jsx)(ze,{className:"currentDelivery",title:(0,c.Jh)("gid17.currentRunningDelivery")})}),(0,h.jsx)("div",{className:"arriveInAt",children:r&&n?(0,c.Jh)("gid17.arriveInAt",{DURATION:(0,h.jsx)("span",{className:"timer",counting:"down",value:r,id:`timer_${n}`,children:c.qp.durationFormat(r)}),TIME:(0,h.jsx)("span",{className:"time",children:c.qp.timeFormat(n,re.zt.TIME_WITHOUT_SECONDS)})},!0):(0,h.jsx)(Ze,{className:"completed"})})]})},L=e=>{const{deliveryDirection:t,movements:i}=e;return(0,h.jsxs)("div",{className:"group "+(C[t]?"collapsed":"expanded"),children:[(0,h.jsxs)("div",{className:"groupHeader",children:[(0,h.jsx)("div",{className:"title",children:(0,c.Jh)("gid17."+t+"Deliveries")}),(0,h.jsx)("div",{className:"totalCount",children:k[t]}),(0,h.jsx)("div",{className:"expandCollapse "+(C[t]?"collapsed":"expanded"),onClick:e=>{C[t]||y((e=>({...e,[t]:!1}))),S((e=>({...e,[t]:!e[t]})))},children:(0,h.jsx)(je.Z,{})})]}),(0,h.jsxs)("div",{className:"listHeader",children:[(0,h.jsx)("div",{className:"resources",children:(0,c.Jh)("gid17.rohstoffe")}),(0,h.jsx)("div",{className:"arrival",children:(0,c.Jh)("gid17.ankunft")})]}),null===i?(0,h.jsx)("div",{className:"routes placeholder"}):(0,h.jsxs)("div",{className:"routes",children:[0==Object.keys(i).length?(0,h.jsx)("div",{className:"noDelivery",children:(0,c.Jh)("gid17."+t+"Deliveries_no")}):(0,h.jsx)(h.Fragment,{children:i.map((e=>{const{show:s,id:i,merchantTribe:n,merchantAction:r,direction:l,otherVillage:o,runCount:u,historyCount:m,history:p,resources:g,arrivalAt:v,predictedCount:x,oneWayDuration:b,capacity:j,useTradeShips:y,cancelDeliveryUntil:T}=e;return(f[t]||s)&&(0,h.jsxs)("div",{className:"route",children:[(0,h.jsxs)("div",{className:"routeHeader",children:[(0,h.jsx)("i",{className:`tribe${n}_medium`}),(0,h.jsx)("div",{className:"otherVillage",children:(0,c.Jh)(`gid17.${r}_${l}`,{VILLAGE:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("a",{href:`/karte.php?x=${o.x}&y=${o.y}`,children:o.name})," : ",(0,h.jsx)("a",{href:`/profile/${o.player.id}`,children:o.player.name})]})},!0)}),(0,h.jsxs)("div",{className:"runs",title:(0,c.Jh)("gid17.numberOfDeliveries"),children:[(0,h.jsx)("span",{className:"value",children:(0,c.eJ)(u,{unit:c.uo.TIMES})}),(0,h.jsx)("i",{className:"delivery_small"})]}),"outgoing"===t&&null!==T&&T>a&&setTimeout((()=>{jQuery("#recall_merchants_"+i).hide()}),1e3*(T-a))&&(0,h.jsx)("div",{id:"recall_merchants_"+i,children:(0,h.jsx)(d.zx,{className:"recallMerchants",id:"recall_merchants_"+i,appearance:"red",onClick:e=>{return t=i,void Travian.api("marketplace/merchants/"+t+"/recall",{success:function(){A()},error:function(e,t){window.Travian.React.Dialog({content:t.responseJSON.detailedErrorMessage,cssClass:"plain contentV2",version:2,buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0,onClose:()=>A()},"marketplaceErrorDialog")}});var t},iconButton:!0,children:(0,h.jsxs)("svg",{children:[(0,h.jsx)($e.Z,{className:"outline"}),(0,h.jsx)($e.Z,{className:"icon"})]})})})]}),m>0&&[...Array(m)].map(((e,t)=>(0,h.jsx)(D,{type:"history",movementKey:`${i}_history_${t}`,resources:p[t].resources},`${i}_history_${t}`))),(0,h.jsx)(D,{type:"current",merchantAction:r,movementKey:i,merchantTribe:n,useTradeShips:y,resources:g,arrivalAt:v,arrivalIn:v-a}),x>0&&[...Array(x)].map(((e,t)=>{let s="transport"===r?1:0;s+=2*t+1;let n=v+s*b;return(0,h.jsx)(D,{type:"predicted",movementKey:`${i}_predicted_${t}`,resources:j,arrivalAt:n,arrivalIn:n-a},`${i}_predicted_${t}`)}))]},i)}))}),T[t]&&!f[t]&&(0,h.jsx)("div",{className:"showAll",children:(0,h.jsxs)("a",{onClick:e=>{y((e=>{let a={...e};return a[t]=!0,a}))},children:[(0,h.jsx)("span",{children:(0,c.Jh)("gid17.showAll")}),(0,h.jsxs)("svg",{children:[(0,h.jsx)(be.Z,{className:"outline"}),(0,h.jsx)(be.Z,{className:"icon"})]})]})})]}),"incoming"===t&&k.incoming>0&&(0,h.jsxs)("div",{className:"listFooter",children:[(0,h.jsx)("div",{children:(0,c.Jh)("gid17.expectedTotal")}),(0,h.jsx)("div",{className:"equals",children:"="}),Object.entries(E).map((([e,t])=>(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("i",{className:`${Travian.Constants.RESOURCE_NAME[parseInt(e)]}_small`,title:(0,c.Jh)(`allgemein.r${e}`)}),(0,h.jsx)("div",{className:"value",children:(0,c.eJ)(t,{grouping:!0})})]},`expected_${e}`))),(0,h.jsx)("div",{className:"questionMark",title:(0,c.Jh)("gid17.expectedInfo"),children:"?"})]})]})};return(0,h.jsxs)("div",{className:"deliveriesOverview",ref:I,children:[(0,h.jsx)(d.t6,{merchants:l,tradeShips:u}),(0,h.jsx)("form",{children:(0,h.jsx)(d.gu,{coordinates:t,onSuccess:A})}),(0,h.jsx)("h3",{children:(0,c.Jh)("gid17.deliveryOverview")}),(0,h.jsx)(L,{deliveryDirection:"incoming",movements:p}),(0,h.jsx)(L,{deliveryDirection:"outgoing",movements:v})]})};We.propTypes={gql:o().string.isRequired,coordinates:o().shape({x:o().number,y:o().number}).isRequired};const Ge=J.Ps`query {ownPlayer{banInfo{type} goldFeatures{travianPlus{isActive} goldClub} village{marketplace{merchantsInfo{total offering capacity underway available}} resources{lumberStock clayStock ironStock cropStock}}}}`,Ye=e=>{const t=(0,s.useRef)(),[a,i]=(0,s.useState)(!0),[n,r]=(0,s.useState)(null),[l,o]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[p,g]=(0,s.useState)(!1),[v,x]=(0,s.useState)(!1),[b,j]=(0,s.useState)(0),[f,y]=(0,s.useState)({merchantsInfo:{total:0,capacity:1,underway:0,offering:0,available:0}}),[T,N]=(0,s.useState)({lumberStock:0,clayStock:0,ironStock:0,cropStock:0}),[C,S]=(0,s.useState)(!1),[k,w]=(0,s.useState)({resource:Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_LUMBER],amount:0}),[E,R]=(0,s.useState)({resource:Travian.Constants.RESOURCE_NAME[Travian.Constants.RES_CLAY],amount:0}),[I,O]=(0,s.useState)(null),[_,A]=(0,s.useState)(!1),D=(0,Z.a)();let L=(0,s.useRef)(new c.w3);(0,s.useEffect)((()=>{(new c.w3).attach(t.current.closest("form")),P(),Travian.Tip.refresh()}),[]);const P=(e=(()=>{}))=>{D({query:Ge}).then((e=>{i(!1),y(e.data.ownPlayer.village.marketplace),N(e.data.ownPlayer.village.resources),S(!!e.data.ownPlayer.banInfo&&e.data.ownPlayer.banInfo.type),r(null)})).then(e).catch(Travian.Autoreload.autoreload)},B=a=>{if(a.preventDefault(),a.currentTarget.classList.contains("disabled"))return!1;const s=t.current.closest("form");L.current.attach(s),L.current.validateForm(),L.current.formValid&&Travian.api("marketplace/offers",{data:{offering:k,searching:E,maxTime:I,ownAllianceOnly:_,action:Travian.Constants.ACTION.marketPlace},success:t=>{i(!0),P(),o((0,c.Jh)("gid17.createdOffer")),m(Math.random()),Travian.Game.Layout.updateResources(),"function"==typeof e.onSuccess&&e.onSuccess()},error:e=>{r(e.message)}})},M=e=>{let t=isNaN(parseInt(e))?0:parseInt(e);t=Math.max(0,t),t=Math.min(t,Math.min(V,F)),w({...k,amount:t}),R({...E,amount:Math.min(E.amount,2*t)}),g(!1)};(0,s.useEffect)((()=>{M(k.amount)}),[k.resource,E.resource]),(0,s.useEffect)((()=>{j(Math.ceil(k.amount/f.merchantsInfo.capacity))}),[k,f]),(0,s.useEffect)((()=>{x(k.amount>=1&&E.amount>=1&&k.resource!==E.resource&&!C)}),[k,E,C]),(0,s.useEffect)((()=>{(k.amount>T[k.resource+"Stock"]||b>J)&&(M(T[k.resource+"Stock"]),g(!0))}),[f,T]);const J=f.merchantsInfo.available,F=J*f.merchantsInfo.capacity,V=parseInt(T[k.resource+"Stock"]);return(0,h.jsxs)("div",{className:"contentV2",children:[a&&(0,h.jsx)("div",{className:"loadingIndicator",children:(0,h.jsx)("i",{className:"spinner"})}),(0,h.jsx)("h3",{children:(0,c.Jh)("gid17.createOffer")}),(0,h.jsxs)("div",{id:"createOfferForm",className:"formV2",ref:t,children:[(0,h.jsx)("h4",{children:(0,c.Jh)("gid17.biete")}),(0,h.jsx)("div",{className:"merchantCarryInfo",children:(0,c.Jh)("gid17.haendler_tragen_kann_x_res_tragen",{INT:(0,h.jsx)("strong",{children:f.merchantsInfo.capacity})},!0)}),(0,h.jsx)(d.EA,{data:k,setAmount:M,setResource:e=>w({...k,resource:e}),stock:V,capacity:f.merchantsInfo.capacity,totalCapacity:F}),(0,h.jsxs)("div",{className:"summary",children:[(0,c.Jh)("gid17.haendler"),":  ",(0,c.T_)(b,J,{useSpaces:!0,useWrapper:!0,numeralConfig:{grouping:!0}})]}),(0,h.jsx)(d.QF,{receive:E.amount,give:k.amount}),(0,h.jsx)("h4",{children:(0,c.Jh)("gid17.suche")}),(0,h.jsx)(d.EA,{data:E,setAmount:e=>{e=isNaN(parseInt(e))?0:parseInt(e),e=Math.max(0,e),e=Math.min(e,2*k.amount),R({...E,amount:e}),g(!1)},setResource:e=>R({...E,resource:e}),stock:2*k.amount,capacity:f.merchantsInfo.capacity,totalCapacity:2*k.amount}),(0,h.jsxs)("div",{className:"maxTransportTime",children:[(0,h.jsxs)("label",{className:"switch",children:[(0,h.jsx)("input",{type:"checkbox",name:"maxTime",value:"enabled",onChange:e=>{O(e.target.checked?I||1:null)},checked:null!==I}),(0,h.jsx)("div",{className:"switch"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.maxTransportTime")})]}),(0,h.jsx)("label",{className:"input fixed",children:(0,h.jsx)("input",{type:"text",disabled:null===I,inputMode:"numeric",value:null!==I?I:1,onChange:e=>{O(e.target.value)},onBlur:()=>{let e=I;null!==e&&(e=isNaN(parseInt(e))?1:parseInt(e),e=Math.max(1,e),e=Math.min(99,e),e!==I&&O(e))}})})]}),(0,h.jsx)("div",{className:"ownAlliance",children:(0,h.jsxs)("label",{className:"switch",children:[(0,h.jsx)("input",{type:"checkbox",name:"ownAlliance",value:"enabled",onChange:e=>{A(e.target.checked)},checked:_}),(0,h.jsx)("div",{className:"switch"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("gid17.onlyAlliance")})]})}),n&&(0,h.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:n}}),k.resource===E.resource&&(0,h.jsx)("div",{className:"error",children:(0,c.Jh)("gid17.invalidOfferByResourceType")}),p&&(0,h.jsx)("div",{className:"error",children:(0,c.Jh)("gid17.resourcesAdjusted")}),(0,h.jsxs)("div",{className:"actionButtons",children:[(0,h.jsx)(d.zx,{appearance:"grey",className:"cancel",onClick:e.closeDialogCallback,children:(0,c.Jh)("allgemein.cancel_with_capital_c")}),(0,h.jsx)(d.zx,{type:"submit",className:"create",disabledClass:!v,title:C?(0,c.Jh)("spieler.avatar_locked"):"",onSubmit:B,onClick:B,children:(0,c.Jh)("gid17.createOffer")})]})]}),l&&(0,h.jsx)(d.A9,{message:l,id:u,stickyTo:t.current,additionalClass:"success"})]})},Ke=e=>{const[t,a]=(0,s.useState)({}),[i,n]=(0,s.useState)({}),[r,l]=(0,s.useState)(null),[o,u]=(0,s.useState)(""),[m,p]=(0,s.useState)(""),g=(0,s.useRef)(),v=(0,Z.a)(),x=J.Ps`query {
        ownPlayer {
            banInfo {
                type
            }
            village {
                marketplace {
                    merchantsInfo {
                        total
                        capacity
                        offering
                        underway
                        available
                    }
                    ownOffers {
                        id
                        offering {
                            resourceType {
                                id
                                code
                            }
                            amount
                        }
                        searching {
                            resourceType {
                                id
                                code
                            }
                            amount
                        }
                        ratio
                        merchants
                        ownAllianceOnly
                        maxDuration
                    }
                }
            }
        }
    }`,b=()=>{v({query:x}).then((e=>{const{village:t,banInfo:s}=e.data.ownPlayer;a({ban:s?s.type:0}),n(t.marketplace.merchantsInfo),l(t.marketplace.ownOffers)}))};(0,s.useEffect)((e=>{b()}),[]),(0,s.useEffect)((e=>{Travian.Tip.refresh()}));let j,f;switch(!0){case t.ban:j=!0,f=(0,c.Jh)("spieler.avatar_locked");break;case void 0===i.available:case i.available<=0:j=!0,f=(0,c.Jh)("gid17.zu_wenig_haendler");break;default:j=!1,f="",g.current&&Travian.Tip.clearOnElement(g.current)}return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.t6,{merchants:i}),(0,h.jsxs)("div",{className:"headerWrapper",children:[(0,h.jsx)("h3",{children:(0,c.Jh)("gid17.ownOffers")}),(0,h.jsx)(d.zx,{onClick:j?e=>{}:e=>{return t={onSuccess:b},void window.Travian.React.Dialog({content:(0,h.jsx)(Ye,{...t}),cssClass:"basic createOfferDialog",version:2,buttonOk:!1,buttonCancel:!0,enableBackground:!1,preventFormSubmit:!0,relativeTo:{element:"#stockBar",position:"below",offset:Travian.Game.Layout.MobileOptimizations.enabled?20:5}},"createOfferDialog");var t},disabledClass:j,title:f,forwardRef:g,children:(0,c.Jh)("gid17.createOffer")})]}),null===r?(0,h.jsx)("div",{className:"offers placeholder"}):r.length>0&&(0,h.jsxs)("table",{className:"offers borderGap",children:[(0,h.jsx)("thead",{className:"includedHeader",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"wanted",children:(0,c.Jh)("gid17.wanted")}),(0,h.jsx)("td",{className:"ratio",title:(0,c.Jh)("gid17.ratioTooltip"),children:(0,h.jsx)(De,{})}),(0,h.jsx)("td",{className:"offered",children:(0,c.Jh)("gid17.offered")}),(0,h.jsx)("td",{className:"merchants",title:(0,c.Jh)("gid17.merchantsUsedTooltip"),children:(0,h.jsx)(ye,{})}),(0,h.jsx)("td",{className:"duration",title:(0,c.Jh)("gid17.maximumTravelTimeTooltip"),children:(0,h.jsx)(Ce,{})}),(0,h.jsx)("td",{className:"alliance",title:(0,c.Jh)("gid17.onlyAllianceTooltip"),children:(0,h.jsx)(Be,{})}),(0,h.jsx)("td",{})]})}),(0,h.jsx)("tbody",{children:r.map((e=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"wanted",children:(0,h.jsxs)("div",{className:"inlineIcon",children:[(0,h.jsx)("i",{className:`${e.searching.resourceType.code}_small`,title:(0,c.Jh)(`allgemein.r${e.searching.resourceType.id}`)}),(0,h.jsx)("span",{children:(0,c.eJ)(e.searching.amount,{grouping:!0})})]})}),(0,h.jsx)("td",{className:"ratio",children:(0,h.jsx)(d.QF,{receive:e.searching.amount,give:e.offering.amount})}),(0,h.jsx)("td",{className:"offered",children:(0,h.jsxs)("div",{className:"inlineIcon",children:[(0,h.jsx)("i",{className:`${e.offering.resourceType.code}_small`,title:(0,c.Jh)(`allgemein.r${e.offering.resourceType.id}`)}),(0,h.jsx)("span",{children:(0,c.eJ)(e.offering.amount,{grouping:!0})})]})}),(0,h.jsx)("td",{className:"merchants",children:e.merchants}),(0,h.jsx)("td",{className:"duration",children:e.maxDuration>0?e.maxDuration+re.J6.UNIT_HOUR:"-"}),(0,h.jsx)("td",{className:"alliance",children:e.ownAllianceOnly?(0,h.jsx)(Ze,{}):"-"}),(0,h.jsx)("td",{className:"cancel",children:(0,h.jsx)(d.zx,{iconButton:!0,onClick:t=>{return a=e.id,void Travian.api("marketplace/offers/"+a,{data:{action:"marketPlace"},success:function(e){u((0,c.Jh)("gid17.offerCanceled")),p(Math.random()),b(),Travian.Game.Layout.updateResources()},error:function(e,t){window.Travian.React.Dialog({content:t.responseJSON.detailedErrorMessage,cssClass:"plain contentV2",version:2,buttonOk:!0,buttonCloseOnClickOk:!0,buttonCancel:!1,enableBackground:!0,preventFormSubmit:!0,onClose:e=>b()},"marketplaceErrorDialog")}},"DELETE");var a},title:(0,c.Jh)("gid17.cancelOffer"),appearance:"red",children:(0,h.jsxs)("svg",{children:[(0,h.jsx)(ne.Z,{className:"outline"}),(0,h.jsx)(ne.Z,{className:"icon"})]})})})]},e.id)))})]}),o&&(0,h.jsx)(d.A9,{message:o,id:m,additionalClass:"success"})]})},Xe=e=>{const t=e.type===Qe,a=e.type===et,i=e.abandoned||!1,n=(0,s.useRef)();let r=(0,s.useRef)(new c.w3);const l=(0,s.useRef)(),[o,u]=(0,s.useState)(!0),[m,p]=(0,s.useState)([]),[g,v]=(0,s.useState)([]),[x,b]=(0,s.useState)(null),[j,f]=(0,s.useState)({}),[y,T]=(0,s.useState)(!1),[N,C]=(0,s.useState)(e.listName??""),[S,k]=(0,s.useState)(null),[w,E]=(0,s.useState)((t=>{let a=e.listDefaultTroop??{};return 0===Object.keys(a).length&&Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).forEach((e=>{a[e]=""})),a})),R=(0,Z.a)(),I=J.Ps`query {
        ownPlayer {
            currentVillageId
            villages {
                id
                sortIndex
                name
                tribeId 
            }
            farmLists {
                name
                ownerVillage {
                    id
                }
            }
        }
    }`;(0,s.useEffect)((()=>{n.current&&r.current.attach(n.current.closest("form"))}),[n.current]),(0,s.useEffect)((()=>{R({query:I}).then((t=>{const{villages:a,farmLists:s,currentVillageId:i}=t.data.ownPlayer,n=a.reduce(((e,t)=>(e[t.id]=t,e)),{});p(n),v(s),k(n[e.villageId??i]),u(!1)})),Travian.Tip.refresh()}),[]);(0,s.useEffect)((()=>{Travian.Tip.refresh(),a&&S&&T(S.id!==e.villageId&&S.tribeId!==m[e.villageId].tribeId),l.current.dispatchEvent(new Event("change"))}),[S]),(0,s.useEffect)((()=>{(()=>{let t={};a&&N===e.listName||g.some((e=>e.ownerVillage.id===S.id&&e.name===N))&&(t.listName=(0,c.Jh)("raidList.farmListNameExistsForVillage")),f(t)})()}),[N,S]);const O=a=>{if(a.preventDefault(),a.currentTarget.classList.contains("disabled"))return!1;const s=n.current.closest("form");if(r.current.validateForm(),r.current.formValid&&0===Object.keys(j).length){const a=Object.fromEntries(new FormData(s).entries());let n={};Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).forEach((e=>{n[e]=a[e]?parseInt(a[e]):0}));const r=t?"farm-list":"farm-list/"+e.listId,l=t?"POST":"PUT",o={villageId:S.id,name:a.listName,defaultUnits:n};t||(o.abandoned=i),Travian.api(r,{action:Travian.Constants.ACTION.farmList,data:o,success:t=>{"function"==typeof e.onSaveSuccess&&e.onSaveSuccess(t.id),e.closeDialogCallback()},error:e=>{b(e.message)}},l)}};return(0,h.jsxs)("div",{className:"contentV2",children:[o&&(0,h.jsx)("div",{className:"contentLoadingIndicator",children:(0,h.jsx)("i",{className:"spinner"})}),(0,h.jsxs)("h3",{children:[t&&(0,c.Jh)("raidList.createFarmList"),a&&(0,c.Jh)("raidList.editFarmlist")]}),(0,h.jsxs)("div",{id:"createFarmListForm",className:"formV2",ref:n,children:[(0,h.jsxs)("label",{className:"input",children:[(0,h.jsx)("input",{type:"text",name:"listName",onChange:e=>C(e.target.value),maxLength:"30",value:N}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("raidList.listName")}),(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NOT_EMPTY,children:(0,c.Jh)("raidList.nameNotEmpty")}),j&&j.listName&&(0,h.jsx)("div",{className:"validation custom","data-rule":c.w3.NO_CUSTOM_ERROR,"data-name":"listName",children:j.listName})]}),(0,h.jsxs)("label",{className:"select",children:[(0,h.jsxs)("select",{size:"1",name:"villageId",value:S?S.id:"",onChange:e=>k(m[e.target.value]),ref:l,children:[(0,h.jsx)("option",{}),Object.values(m).sort(((e,t)=>e.sortIndex-t.sortIndex)).map((e=>(0,h.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("raidList.selectVillage")}),(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NOT_EMPTY,children:(0,c.Jh)("raidList.villageNotEmpty")})]}),(0,h.jsx)("h4",{className:"troopsHeader",children:(0,c.Jh)("raidList.setDefaultTroops")}),(0,h.jsx)("div",{className:"troopsDescription",children:(0,c.Jh)("raidList.newEntryPrefilled")}),(0,h.jsx)("div",{className:"troopSelection",children:Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).map((e=>(0,h.jsxs)("label",{className:"input fixed",children:[(0,h.jsx)("i",{className:`unit_medium tribe${S?S.tribeId:0} ${e}`,title:S?(0,c.Jh)(`truppen.tid${10*(S.tribeId-1)+parseInt(e.slice(1))}`):""}),(0,h.jsx)("input",{type:"text",className:"unitAmount",name:e,autoComplete:"off",value:w[e],onChange:t=>{var a,s;a=e,s=t.target.value,s=isNaN(parseInt(s))?0:parseInt(s),s=Math.max(0,s),E({...w,[a]:s})},inputMode:"numeric"})]},e)))}),y&&(0,h.jsx)("p",{className:"error",children:(0,c.Jh)("raidList.tribeWarningForSourceVillage")}),null!==x&&(0,h.jsx)("p",{className:"error",children:x}),(0,h.jsxs)("div",{className:"actionButtons",children:[(0,h.jsx)(d.zx,{appearance:"grey",className:"cancel",onClick:e.closeDialogCallback,children:(0,c.Jh)("allgemein.cancel_with_capital_c")}),a&&(0,h.jsx)(d.zx,{type:"button",iconButton:!0,className:"delete",onClick:()=>{(0,d.Is)({message:(0,c.Jh)("raidList.farmListDeleteConfirmation"),cancelText:(0,c.Jh)("allgemein.cancel_with_capital_c"),confirmText:(0,c.Jh)("raidList.delete"),appearanceConfirm:"red",onConfirm:()=>{Travian.api("farm-list/"+e.listId,{data:{abandoned:i},success:t=>{e.closeDialogCallback(),"function"==typeof e.onDeleteSuccess&&e.onDeleteSuccess()},error:e=>{b(e.message??(0,c.Jh)("raidList.error_delete"))}},"DELETE")}})},title:(0,c.Jh)("raidList.delete"),children:(0,h.jsxs)("svg",{children:[(0,h.jsx)(ne.Z,{className:"outline"}),(0,h.jsx)(ne.Z,{className:"icon"})]})}),(0,h.jsxs)(d.zx,{type:"submit",className:"save",disabledClass:Object.keys(j).length>0||i&&g.length>=Travian.Variables.FarmList.limit,title:i&&g.length>=Travian.Variables.FarmList.limit?(0,c.Jh)("raidList.error_limitReached"):"",onSubmit:O,onClick:O,children:[t&&(0,c.Jh)("raidList.create"),a&&(0,c.Jh)("raidList.save")]})]})]})]})},Qe="create",et="edit",tt=(e,t)=>{window.Travian.React.Dialog({content:(0,h.jsx)(Xe,{type:e,...t}),cssClass:"basic farmListDialog",version:2,buttonOk:!1,buttonCancel:!0,enableBackground:!0,preventFormSubmit:!0},"farmListDialog")};var at,st,it,nt,rt,lt,ot=a(7581);function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},ct.apply(this,arguments)}const dt=e=>s.createElement("svg",ct({viewBox:"0 0 7 13"},e),at||(at=s.createElement("circle",{cx:1.5,cy:1.5,r:1.5})),st||(st=s.createElement("circle",{cx:5.5,cy:1.5,r:1.5})),it||(it=s.createElement("circle",{cx:1.5,cy:6.5,r:1.5})),nt||(nt=s.createElement("circle",{cx:5.5,cy:6.5,r:1.5})),rt||(rt=s.createElement("circle",{cx:1.5,cy:11.5,r:1.5})),lt||(lt=s.createElement("circle",{cx:5.5,cy:11.5,r:1.5})));var ht,ut=a(5429),mt=a(7757);function pt(){return pt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},pt.apply(this,arguments)}const gt=e=>s.createElement("svg",pt({viewBox:"0 0 20 20",preserveAspectRatio:"none"},e),ht||(ht=s.createElement("path",{d:"M10 5a1 1 0 011 1v4a1 1 0 01-2 0V6a1 1 0 011-1zm0-5a10 10 0 1010 10A10 10 0 0010 0zm0 18a8 8 0 118-8 8 8 0 01-8 8zm1-3H9v-2h2z"}))),vt=e=>{const{player:t,village:a,slotsToStart:s,selectedSlots:i,lastStartedTime:n,startButtonsDisabled:r,startFarmListCallback:l}=e;let o,u;switch(!0){case t.ban:o=!0,u=(0,c.Jh)("spieler.avatar_locked");break;case!t.accessRights.sendRaids:o=!0,u=(0,c.Jh)("spieler.sitter_not_allowed_only_with_right");break;case t.isInVacationMode:o=!0,u=(0,c.Jh)("raidList.sendingNotAllowedOnVacationMode");break;case!a.hasRallyPoint:o=!0,u=(0,c.Jh)("raidList.noRallyPoint",{NAME:a.name});break;case 0===s.length:o=!0,u=i.length>0?(0,c.Jh)("raidList.noActiveSelected"):(0,c.Jh)("raidList.hasNoActive");break;default:o=!1,u=(0,h.jsx)(h.Fragment,{children:i.length>0?(0,c.Jh)("raidList.startSelectedActive"):(0,c.Jh)("raidList.startAllActive")})}return u=n?N.renderToString(u)+N.renderToString((0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("br",{}),(0,c.Jh)("raidList.lastStartOfFarmList"),":  ",c.qp.timeFormat(n,re.zt.DATETIME)]})):N.renderToString(u),(0,h.jsxs)(d.zx,{className:"startFarmList",title:u,disabledClass:o||r,onClick:o||r?e=>{}:l,children:[(0,c.Jh)("raidList.startRaidList"),s.length>0&&(0,h.jsxs)(h.Fragment,{children:[" (",s.length,")"]})]})};var xt;function bt(){return bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},bt.apply(this,arguments)}const jt=e=>s.createElement("svg",bt({viewBox:"0 0 16 20"},e),xt||(xt=s.createElement("path",{d:"M8 4h3v15h2V4h3l-4-4zM8 16H5V1H3v15H0l4 4z"})));var ft=a(6346),yt=a(7175);const Tt=e=>{const t=e.type===Nt,a=e.type===Ct,i=e.type===St,n=e.abandoned||!1,{coordinates:r,selectedList:l,editSlotIds:o,selectedTarget:u,selectedTroop:m,selectedActive:p}=e,g=a&&o.length>1,v=i&&o.length>1,x=(0,s.useRef)(),b=(0,s.useRef)(),[j,f]=(0,s.useState)(!0),[y,T]=(0,s.useState)(null),[N,C]=(0,s.useState)({}),[S,k]=(0,s.useState)(null),[w,E]=(0,s.useState)([]),[R,I]=(0,s.useState)(null),[O,_]=(0,s.useState)({id:null,tribeId:1}),[A,D]=(0,s.useState)(null),[L,P]=(0,s.useState)(!1),[B,M]=(0,s.useState)(""),[F,V]=(0,s.useState)(""),[H,q]=(0,s.useState)(!1),[U,z]=(0,s.useState)(null),[$,W]=(0,s.useState)({x:null,y:null,mapId:null}),[G,Y]=(0,s.useState)(null),[K,X]=(0,s.useState)(null),Q=!g&&!v||null,[ee,te]=(0,s.useState)(p??Q),[ae,se]=(0,s.useState)((e=>{let t={};return Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).forEach((e=>{t[e]=""})),t})),re=(0,Z.a)(),le=n?"($id: ID!)":"",oe=n?"abandonedFarmList(id: $id) {\n        slots(onlyExpanded: false) {\n            target {\n                id\n            }\n        }\n    }":"",ce=J.Ps`query${le} {
        ownPlayer {
            currentVillageId
            villages {
                id
                name
                tribeId
            }
            farmLists {
                id
                name
                ownerVillage {
                    id
                    tribeId
                    mapId
                    name
                }
                slots {
                    id
                    isActive
                    target {
                        id
                        x
                        y
                        ownerVillage {
                            id
                        }
                    }
                    troop {
                        t1 t2 t3 t4 t5 t6 t7 t8 t9 t10
                    }
                }
                slotsAmount
                defaultTroop {
                    t1
                    t2
                    t3
                    t4
                    t5
                    t6
                    t7
                    t8
                    t9
                    t10
                }
            }
        }
        ${oe}
    }`;let de=(0,s.useRef)(new c.w3);(0,s.useEffect)((()=>{(new c.w3).attach(x.current.closest("form")),he(),Travian.Tip.refresh()}),[]),(0,s.useEffect)((()=>{Travian.Tip.refresh()}),[U,O]),(0,s.useEffect)((()=>{const e=w.find((e=>e.id===U));if(e){if(a||i){const t=w.find((e=>e.id===l));t&&q(t.ownerVillage.tribeId!==e.ownerVillage.tribeId)}else{const t=e.defaultTroop;se(t),M(jQuery.md5(JSON.stringify(t)))}if(T(!1),P(!0),b.current.dispatchEvent(new Event("change")),de.current.validate(b.current),t&&e.slotsAmount>=Travian.Variables.FarmList.limit)C({...N,list:(0,c.Jh)("raidList.errorRaidListSlotLimit")});else if((a||i)&&e.slotsAmount+o.length>Travian.Variables.FarmList.limit){const t=n?R.slots:w.find((e=>e.id===l)).slots,a=e.slots.filter((e=>void 0!==t.find((t=>t.target.id===e.target.id)))).length,s=o.length-a;e.slotsAmount+s>Travian.Variables.FarmList.limit?C({...N,list:(0,c.Jh)("raidList.errorRaidListSlotLimitBulk",{LIMIT:Travian.Variables.FarmList.limit})}):C({})}else C({})}}),[U]),(0,s.useEffect)((()=>{if(A)z(A),D(null),k(!1);else if(!i&&null===U)if(void 0!==l&&w.some((e=>e.id===l)))z(l);else if(w.length>0){const e=w.filter((e=>e.ownerVillage.id===O.id&&e.slotsAmount<Travian.Variables.FarmList.limit));e.length>0&&z(e[0].id)}}),[w,O]),(0,s.useEffect)((()=>{const e=ue(B===F),t=U||(a?l:null);if((L||B!==F)&&e&&null!==t&&null!==$.x&&null!==$.y&&null!==$.mapId){P(!1),V(B);const e=w.find((e=>e.id===t));Travian.api("troop/distanceSpeedAndDuration",{data:{origin:e.ownerVillage.id,from:e.ownerVillage.mapId,to:$.mapId,troops:ae},success:e=>{const t=e.data;Y(c.qp.durationFormat(t.duration)),X(Math.round(10*(t.distance+Number.EPSILON))/10)},error:()=>{Y(null),X(null)}})}}),[L,B,$]);const he=()=>{f(!0);re({query:ce,variables:n?{id:l}:{}}).then((e=>{if(f(!1),E(e.data.ownPlayer.farmLists),_(e.data.ownPlayer.villages.find((t=>t.id===e.data.ownPlayer.currentVillageId))),e.data.abandonedFarmList&&I(e.data.abandonedFarmList),a||i){let e={};m?e=m:Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).forEach((t=>{e[t]=null})),se(e),M(jQuery.md5(JSON.stringify(e))),1===o.length&&u&&(W({x:u.x,y:u.y,mapId:u.mapId}),P(!0))}}))},ue=e=>{(e=e??!1)||T(!1);let t=0;Object.values(ae).forEach((e=>{isNaN(e)||(t+=e)}));const a=t>0||ve;return e||k(!a),a},me=s=>{if(s.preventDefault(),s.currentTarget.classList.contains("disabled"))return!1;const r=x.current.closest("form");de.current.attach(r),de.current.validateForm();const h=ue(!1);if(de.current.formValid&&h){const s=[],r={listId:U,x:$.x,y:$.y,units:ae,active:ee};if(t&&s.push(r),a&&(r.abandoned=n,o.forEach((e=>{const t=Object.assign({},r,{id:e});s.push(t)}))),i){const e=w.find((e=>e.id===l));o.forEach((t=>{const a=e.slots.find((e=>e.id===t)),i={listId:U??a.id,x:$.x??a.target.x,y:$.y??a.target.y,active:null===ee?a.isActive:ee,units:{}};Object.keys(ae).forEach((e=>{i.units[e]=null===ae[e]?a.troop[e]:ae[e]})),s.push(i)}))}const h=a?"PUT":"POST";Travian.api("farm-list/slot",{data:{slots:s},success:t=>{e.closeDialogCallback(),"function"==typeof e.onSuccess&&e.onSuccess()},error:t=>{"raidList.targetExists"===t.error?(0,d.Is)({message:(0,c.Jh)("raidList.errorVillageAlreadyInRaidListQuestion"),cancelText:(0,c.Jh)("allgemein.cancel_with_capital_c"),confirmText:(0,c.Jh)("allgemein.ok"),appearanceConfirm:"green",onConfirm:()=>{Travian.api("farm-list/slot?force",{data:{slots:s},success:t=>{e.closeDialogCallback(),"function"==typeof e.onSuccess&&e.onSuccess()},error:e=>{T(e.message)}},h)}}):T(t.message)}},h)}},pe=null!==U?w.find((e=>e.id===U)).ownerVillage:O,ge=w.length>=Travian.Variables.FarmList.limit,ve=Object.keys(ae).filter((e=>null===ae[e])).length>0,xe=null!==U&&0===Object.keys(N).length&&(a||i||null!==$.x&&null!==$.y&&ue(!0));return(0,h.jsxs)("div",{className:"contentV2",children:[j&&(0,h.jsx)("div",{className:"contentLoadingIndicator",children:(0,h.jsx)("i",{className:"spinner"})}),(0,h.jsxs)("h3",{children:[t&&(0,c.Jh)("raidList.addTarget"),a&&!g&&(0,c.Jh)("raidList.editSlot"),g&&(0,c.Jh)("raidList.editSlots"),i&&!v&&(0,c.Jh)("raidList.duplicateSlot"),v&&(0,c.Jh)("raidList.duplicateSelectedSlots")]}),(0,h.jsxs)("div",{id:"farmListTargetForm",className:"formV2",ref:x,children:[(0,h.jsxs)("div",{className:"listSelector",children:[(0,h.jsxs)("label",{className:"select",children:[(0,h.jsxs)("select",{size:"1",name:"listId",disabled:j||0===w.length,className:i&&U===l?"optionDisabled":"",onChange:e=>z(""===e.target.value?null:parseInt(e.target.value)),value:U??"",ref:b,children:[(0,h.jsx)("option",{}),w&&w.map(((e,s)=>{const n=e.slotsAmount>=Travian.Variables.FarmList.limit&&(t||a&&e.id!==l||i&&e.id!==l);return(0,h.jsx)("option",{value:e.id,disabled:n,children:`${e.ownerVillage.name} - ${e.name}${n?" "+(0,c.Jh)("raidList.full"):""}`},s)}))]}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("raidList.selectFarmList")}),(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NOT_EMPTY,children:(0,c.Jh)("raidList.errorNoListSelected")}),N&&N.list&&(0,h.jsx)("div",{className:"validation","data-rule":c.w3.NO_CUSTOM_ERROR,children:N.list}),0===w.length&&(0,h.jsx)("div",{className:"validation show","data-rule":c.w3.NO_CUSTOM_ERROR,children:(0,c.Jh)("raidList.noFarmList")})]}),(0,h.jsx)(d.zx,{type:"button",title:ge?(0,c.Jh)("raidList.error_limitReached"):(0,c.Jh)("raidList.create_list"),iconButton:!0,disabledClass:ge,onClick:()=>{ge||tt(Qe,{onSaveSuccess:t=>{D(t),he(),"function"==typeof e.onSuccess&&e.onSuccess()}})},children:(0,h.jsxs)("svg",{children:[(0,h.jsx)(be.Z,{className:"outline"}),(0,h.jsx)(be.Z,{className:"icon"})]})})]}),!g&&!v&&(0,h.jsx)(ot.WM,{formHandler:de,disabled:a||i,onSelect:e=>{void 0!==e.x&&void 0!==e.y?(W({x:e.x,y:e.y,mapId:e.mapId}),T(!1),P(!0)):(W({x:null,y:null}),X(null),Y(null))},duration:G,distance:K,coordinates:r,sourceVillageId:pe.id,resultsWrapperRef:x}),H&&(0,h.jsx)("div",{className:"noticeBox tribeChangeNotice",children:(0,c.Jh)("raidList.tribeChangeNotice")}),ve&&(0,h.jsx)("div",{className:"noticeBox indeterminateTroopsNotice",children:(0,c.Jh)("raidList.indeterminateTroopsNotice")}),(0,h.jsxs)("h4",{className:"troopsHeader",children:[(0,c.Jh)("raidList.setTroops"),":"]}),(0,h.jsxs)("div",{className:"troopSelection",children:[Object.values(Travian.Constants.TROOP_NUMBER_TYPES.allWithoutHero).map((e=>(0,h.jsxs)("label",{className:"input fixed "+(S?"invalid":""),children:[(0,h.jsx)("i",{className:`unit_medium tribe${pe.tribeId} ${e}`,title:(0,c.Jh)(`truppen.tid${10*(pe.tribeId-1)+parseInt(e.slice(1))}`)}),(0,h.jsx)("input",{type:"text",className:"unitAmount",name:e,inputMode:"numeric",autoComplete:"off",value:ae[e]??"?",onChange:t=>{((e,t)=>{t=isNaN(parseInt(t))?0:parseInt(t),t=Math.max(0,t);const a={...ae,[e]:t};se(a),M(jQuery.md5(JSON.stringify(a)))})(e,t.target.value)},onBlur:()=>{P(!0)}})]},e))),(0,h.jsx)("div",{className:"customValidationRenderElement troopError "+(S?"show":""),children:(0,c.Jh)("raidList.error_no_troops")})]}),(0,h.jsx)("div",{className:"deactivateSlot",children:(0,h.jsxs)("label",{className:"checkbox",children:[(0,h.jsx)("input",{type:"checkbox",name:"isActive",value:"true",className:null===ee?"indeterminate":"",disabled:j,checked:!1===ee,onChange:e=>{te(!e.target.checked)}}),(0,h.jsx)(ie.Z,{className:"checkbox"}),(0,h.jsx)("div",{className:"label",children:(0,c.Jh)("raidList.deactivateSlot")})]})}),"string"==typeof y&&(0,h.jsx)("div",{className:"error",dangerouslySetInnerHTML:{__html:y}}),(0,h.jsxs)("div",{className:"actionButtons",children:[(0,h.jsx)(d.zx,{appearance:"grey",className:"cancel",onClick:e.closeDialogCallback,children:(0,c.Jh)("allgemein.cancel_with_capital_c")}),a&&(0,h.jsx)(d.zx,{type:"button",iconButton:!0,className:"delete",onClick:t=>wt(o,n,(t=>{e.closeDialogCallback(),"function"==typeof e.onSuccess&&e.onSuccess()})),children:(0,h.jsxs)("svg",{children:[(0,h.jsx)(ne.Z,{className:"outline"}),(0,h.jsx)(ne.Z,{className:"icon"})]})}),(0,h.jsx)(d.zx,{type:"submit",className:"save",disabledAttribute:!xe||S,onSubmit:me,onClick:me,children:(0,c.Jh)("raidList.save")})]})]})]})},Nt="create",Ct="edit",St="duplicate",kt=(e,t)=>{window.Travian.React.Dialog({content:(0,h.jsx)(Tt,{type:e,...t}),cssClass:"basic slotDialog",version:2,buttonOk:!1,buttonCancel:!0,enableBackground:!1,preventFormSubmit:!0},"slotDialog",["allgemein","raidList","truppen","spieler","a2b"])},wt=(e,t,a)=>{(0,d.Is)({message:(0,c.Jh)("raidList.deleteSlotsConfirmation"),cancelText:(0,c.Jh)("allgemein.cancel_with_capital_c"),confirmText:(0,c.Jh)("raidList.delete"),appearanceConfirm:"red",onConfirm:()=>{Travian.api("farm-list/slot",{data:{slots:e,abandoned:t},success:a,error:e=>{Travian.defaultErrorFunction(e)}},"DELETE")}})};var Et;function Rt(){return Rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Rt.apply(this,arguments)}const It=e=>s.createElement("svg",Rt({viewBox:"0 0 46 50"},e),Et||(Et=s.createElement("path",{d:"M34.36 14.93c-.43-.44-.43-1.11 0-1.55L45.67 1.93c.73-.74.15-1.93-.94-1.93H0v50h7V28.32h37.73c1.1 0 1.68-1.18.94-1.93L34.36 14.93Z"})));var Ot;function _t(){return _t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},_t.apply(this,arguments)}const At=e=>s.createElement("svg",_t({viewBox:"0 0 46.4 50"},e),Ot||(Ot=s.createElement("path",{d:"M36.56 18.61a.888.888 0 0 1 0-1.29l9.57-9.58c.62-.62.13-1.61-.8-1.61H13.42l19 21.15 2.27 2.52h10.64c.93 0 1.42-.99.8-1.61l-9.57-9.58ZM8.32 6.13 2.92.12 2.82 0 0 2.53l7.49 8.33v37.06h5.52V29.8H24.5L42.65 50l1.52-1.37 1.29-1.16L29.59 29.8 8.32 6.13z"})));var Dt=a(1053);const Lt=e=>{const{farmListId:t,handleSlotSelection:a,village:i,slots:n,updateSingleFarmList:r,updateAllFarmLists:l,selectedSlots:o,currentTimestamp:u,startErrors:m,handleActivationDeactivation:p,handleDeletion:g,sortField:v,sortDirection:x,abandoned:b,availableTroops:j}=e,f=(0,s.useRef)(),[y,T]=(0,s.useState)({}),C=(a,s)=>{let i=v===a?"asc"===x?"desc":"asc":s;Travian.api("farm-list/"+t+"/change-sorting",{action:Travian.Constants.ACTION.farmList,data:{sortField:a,sortDirection:i,abandoned:b},success:a=>{r(t,{onExpand:!0},e.abandoned)}},"PUT")};(0,s.useEffect)((e=>{let t={};n.filter((e=>o.includes(e.id))).forEach((e=>{Object.entries(e.troop).filter((([e,t])=>t>0)).forEach((([e,a])=>{t[e]=t[e]?t[e]+a:a}))})),T(t)}),[e.selectedSlots,e.slots]);const[S,k]=(0,s.useState)(null);let w=(0,s.useRef)(null);const E=(e,t)=>{k(t),w.current=e.target},R=(e,a)=>{const s=n.find((e=>e.id===a));if(s){const a={x:s.target.x,y:s.target.y},i=[s.id],n=s.target,r=s.troop,o=s.isActive;kt(e,{editSlotIds:i,coordinates:a,selectedList:t,selectedTarget:n,selectedTroop:r,selectedActive:o,abandoned:b,onSuccess:l})}},I=e=>{let t=[];return t.push({icon:(0,h.jsx)(ut.Z,{}),additionalClass:"edit",text:(0,c.Jh)("raidList.edit"),disabled:!1,title:(0,c.Jh)("raidList.editSlot"),onClick:t=>{R(Ct,e.id),k(null)}}),b||t.push({icon:e.isActive?(0,h.jsx)(At,{}):(0,h.jsx)(It,{}),additionalClass:e.isActive?"deactivate":"activate",text:(0,c.Jh)(e.isActive?"raidList.deactivate":"raidList.activate"),disabled:!1,title:(0,c.Jh)(e.isActive?"raidList.deactivateSlot":"raidList.activateSlot"),onClick:t=>{p([e.id]),k(null)}},{icon:(0,h.jsx)(Dt.Z,{}),additionalClass:"duplicate",text:(0,c.Jh)("raidList.duplicate"),disabled:!1,title:(0,c.Jh)("raidList.duplicateSelectedSlots"),onClick:t=>{R(St,e.id),k(null)}}),t.push({icon:(0,h.jsx)(ne.Z,{}),additionalClass:"delete",text:(0,c.Jh)("raidList.delete"),disabled:!1,title:(0,c.Jh)("raidList.deleteSlot"),onClick:t=>{g([e.id]),k(null)}}),t};return(0,h.jsxs)("table",{className:"slots borderGap "+(n&&0===n.length?"noSlots":""),children:[(0,h.jsx)("thead",{className:"includedHeader",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"selection",children:(0,h.jsxs)("label",{className:"checkbox",children:[(0,h.jsx)("input",{type:"checkbox",checked:!!o&&o.length===n.length,"data-farm-list-id":t,"data-check-all":!0,name:"selectAll",onChange:e=>a(e,b)}),(0,h.jsx)(ie.Z,{className:"checkbox"})]})}),(0,h.jsx)("th",{className:"state"}),(0,h.jsx)("th",{className:"target sortable",title:(0,c.Jh)("raidList.village"),onClick:e=>{C("village","asc")},children:(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:"village_medium"}),(0,h.jsx)(Fe.Z,{className:["sortingArrow","village"===v?"":"inactive","village"===v?"asc"===x?"up":"down":"up"].join(" ")})]})}),(0,h.jsx)("th",{className:"population sortable",title:(0,c.Jh)("allgemein.population"),onClick:e=>{C("ew","asc")},children:(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:"population_medium"}),(0,h.jsx)(Fe.Z,{className:["sortingArrow","ew"===v?"":"inactive","ew"===v?"asc"===x?"up":"down":"up"].join(" ")})]})}),(0,h.jsx)("th",{className:"distance sortable",title:(0,c.Jh)("raidList.distance"),onClick:e=>{C("distance","asc")},children:(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:"distance_medium"}),(0,h.jsx)(Fe.Z,{className:["sortingArrow","distance"===v?"":"inactive","distance"===v?"asc"===x?"up":"down":"up"].join(" ")})]})}),(0,h.jsx)("th",{className:"troops sortable",title:(0,c.Jh)("raidList.troops"),onClick:e=>{C("troops","asc")},children:(0,h.jsxs)("div",{children:[(0,h.jsx)("i",{className:"troops_medium"}),(0,h.jsx)(Fe.Z,{className:["sortingArrow","troops"===v?"":"inactive","troops"===v?"asc"===x?"up":"down":"up"].join(" ")})]})}),(0,h.jsxs)("th",{className:"lastRaid",children:[(0,h.jsxs)("div",{className:"headWrapper",children:[(0,h.jsx)("span",{children:(0,c.Jh)("raidList.lastRaid")}),(0,h.jsx)("a",{className:"sorting",onClick:e=>E(e,"sorting"+t),children:(0,h.jsx)(jt,{})})]}),S==="sorting"+t&&(0,h.jsx)(d.xV,{contextParent:w.current,appearance:"sorting",onClose:e=>{k(null)},description:(0,c.Jh)("raidList.sortBy"),content:[{icon:(0,h.jsx)("i",{className:"attack_lost_small"}),additionalClass:"combatResult",text:(0,c.Jh)("raidList.combatResult"),disabled:!1,onClick:e=>{C("combatResult","asc"),k(null)},sortingArrow:(0,h.jsx)(Fe.Z,{className:["sortingArrow","combatResult"===v?"":"inactive","combatResult"===v?"asc"===x?"up":"down":"up"].join(" ")})},{icon:(0,h.jsx)("i",{className:"clock_small"}),additionalClass:"lastRaid",text:(0,c.Jh)("raidList.lastRaid"),disabled:!1,onClick:e=>{C("lastRaid","asc"),k(null)},sortingArrow:(0,h.jsx)(Fe.Z,{className:["sortingArrow","lastRaid"===v?"":"inactive","lastRaid"===v?"asc"===x?"up":"down":"up"].join(" ")})},{icon:(0,h.jsx)("i",{className:"bounty_full_small"}),additionalClass:"bounty",text:(0,c.Jh)("raidList.bounty"),disabled:!1,onClick:e=>{C("bounty","desc"),k(null)},sortingArrow:(0,h.jsx)(Fe.Z,{className:["sortingArrow","bounty"===v?"":"inactive","bounty"===v&&"asc"===x?"up":"down"].join(" ")})},{icon:(0,h.jsx)(ft.Z,{}),additionalClass:"totalBounty",text:(0,c.Jh)("raidList.totalBounty"),disabled:!1,onClick:e=>{C("totalBounty","desc"),k(null)},sortingArrow:(0,h.jsx)(Fe.Z,{className:["sortingArrow","totalBounty"===v?"":"inactive","totalBounty"===v&&"asc"===x?"up":"down"].join(" ")})},{icon:(0,h.jsx)("i",{className:"nextAttack_small"}),additionalClass:"nextAttack",text:(0,c.Jh)("raidList.nextAttack"),disabled:!1,onClick:e=>{C("nextAttack","asc"),k(null)},sortingArrow:(0,h.jsx)(Fe.Z,{className:["sortingArrow","nextAttack"===v?"":"inactive","nextAttack"===v?"asc"===x?"up":"down":"up"].join(" ")})}]})]}),(0,h.jsx)("th",{className:"contextMenu"})]})}),(0,h.jsxs)("tbody",{children:[n&&n.map((e=>{const n=e.lastRaid?e.lastRaid.booty.reduce(((e,t)=>e+t.amount),0):0;return(0,h.jsxs)("tr",{className:["slot",S==="buttons"+e.id?"highlighted":"",e.isActive?"":"disabled"].join(" "),children:[(0,h.jsx)("td",{className:"selection",children:(0,h.jsxs)("label",{className:"checkbox",children:[(0,h.jsx)("input",{type:"checkbox",checked:!!o&&o.includes(e.id),"data-farm-list-id":t,"data-slot-id":e.id,name:"selectOne",onChange:e=>a(e,b)}),(0,h.jsx)(ie.Z,{className:"checkbox"})]})}),(0,h.jsxs)("td",{className:"state",children:[e.isRunning&&(0,h.jsx)("i",{className:"attack_small",title:N.renderToString((0,h.jsxs)(h.Fragment,{children:[(0,c.Jh)("raidList.attacksOnTheWay"),": ",e.runningAttacks,(0,h.jsx)("br",{}),(0,c.Jh)("raidList.nextArrivalIn"),": ",(0,h.jsx)("span",{className:"timer",counting:"down",value:e.nextAttackAt-u,id:`timer_${t}_${e.id}_${e.nextAttackAt}`,children:c.qp.durationFormat(e.nextAttackAt-u)})]}))}),m&&m[e.id]&&(0,h.jsx)(gt,{className:"error",title:m[e.id]})]}),(0,h.jsx)("td",{className:"target",children:(0,h.jsx)(ot.tk,{x:e.target.x,y:e.target.y,type:e.target.type,mapId:e.target.mapId,name:e.target.name})}),(0,h.jsx)("td",{className:"population",children:(0,h.jsx)("span",{children:e.target.population})}),(0,h.jsx)("td",{className:"distance",children:(0,h.jsx)("span",{children:b?"-":Math.round(10*(e.distance+Number.EPSILON))/10})}),(0,h.jsx)("td",{className:"troops",children:(0,h.jsx)("div",{children:Object.entries(e.troop).map((([t,a])=>a>0&&(0,h.jsxs)("span",{children:[(0,h.jsx)("i",{className:`unit_small tribe${i.tribeId} ${t}`,title:(0,c.Jh)(`truppen.tid${10*(i.tribeId-1)+parseInt(t.slice(1))}`)}),(0,h.jsx)("span",{className:"value",children:a})]},`troop_${e.id}_${t}`)))})}),(0,h.jsx)("td",{className:"lastRaid",children:e.lastRaid&&(0,h.jsxs)("div",{className:"lastRaidWrapper",children:[(0,h.jsxs)("a",{className:"lastRaidReport "+(e.lastRaid.reportId&&e.lastRaid.authKey?"":"disabled"),href:e.lastRaid.reportId&&e.lastRaid.authKey?`/report?id=${e.lastRaid.reportId}${e.lastRaid.authKey}`:null,title:c.qp.timeFormat(e.lastRaid.time,re.zt.DATETIME,!1,!1),children:[(0,h.jsx)("i",{className:`lastRaidState ${{1:"attack_won_withoutLosses_small",2:"attack_won_withLosses_small",3:"attack_lost_small"}[e.lastRaid.icon]}`,title:(0,c.Jh)(`berichte.report_icon_${e.lastRaid.icon}`)}),(0,h.jsx)("span",{className:"value",children:c.qp.timeFormat(e.lastRaid.time,re.zt.DYNAMIC_DATETIME)})]}),(0,h.jsxs)("div",{className:"lastRaidBounty",children:[(0,h.jsx)("i",{className:`bounty_${0===n?"empty":n===e.lastRaid.bootyMax?"full":"half"}_small`,title:N.renderToString((0,h.jsxs)("div",{className:"farmListSlotBootyTooltip",children:[Object.entries(Travian.Constants.RESOURCE_NAME).map((([t,a])=>{let i=e.lastRaid.booty.find((e=>e.resourceType.id==t));return(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("i",{className:`${a}_tiny`}),(0,h.jsx)("span",{className:"value",children:(0,c.eJ)(i.amount,{grouping:!0,fraction:0})})]},`${t}`)})),(0,h.jsxs)("span",{className:"maximumCapacity",children:[(0,c.Jh)("raidList.maximumCapacity"),": ",(0,c.eJ)(e.lastRaid.bootyMax,{grouping:!0,fraction:0})]})]}))}),(0,h.jsx)("span",{className:"value",children:(0,c.eJ)(n,{grouping:!0,fraction:0})})]}),(0,h.jsxs)("div",{className:"averageRaidBounty",children:[(0,h.jsx)(ft.Z,{}),(0,h.jsx)("span",{className:"value",children:e.totalBooty?(0,c.eJ)(e.totalBooty.booty,{grouping:!0,fraction:0}):0})]})]})}),(0,h.jsxs)("td",{className:"openContextMenu",children:[(0,h.jsx)("a",{onClick:t=>E(t,"buttons"+e.id),children:(0,h.jsx)(yt.Z,{})}),S==="buttons"+e.id&&(0,h.jsx)(d.xV,{contextParent:w.current,appearance:"defaultButtons",onClose:e=>{k(null)},content:I(e)})]})]},`slot_${e.id}`)})),(0,h.jsx)("tr",{className:n&&0===n.length?"noGapTop":"",children:(0,h.jsxs)("td",{colSpan:"8",className:"addTarget",children:[!b&&(0,h.jsxs)("a",{ref:f,className:n.length>=Travian.Variables.FarmList.limit?"disabled":"",onClick:n.length>=Travian.Variables.FarmList.limit?e=>{}:e=>kt(Nt,{coordinates:{x:null,y:null},selectedList:t,onSuccess:l}),children:[(0,c.Jh)("raidList.addTarget")," ",(0,h.jsxs)("svg",{children:[(0,h.jsx)(be.Z,{className:"outline"}),(0,h.jsx)(be.Z,{className:"icon"})]})]}),(0,c.T_)(n.length,Travian.Variables.FarmList.limit)]})})]}),(0,h.jsx)("tfoot",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"selection",children:(0,h.jsxs)("label",{className:"checkbox",children:[(0,h.jsx)("input",{type:"checkbox",checked:!!o&&o.length===n.length,"data-farm-list-id":t,"data-check-all":!0,name:"selectAll",onChange:e=>a(e,b)}),(0,h.jsx)(ie.Z,{className:"checkbox"})]})}),(0,h.jsx)("td",{colSpan:"7",children:0===o.length?(0,h.jsx)(h.Fragment,{children:(0,c.Jh)("raidList.noTargetSelected")}):(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"selected",children:(0,c.Jh)("raidList.selected",{COUNT:o.length})}),(0,h.jsx)("span",{className:"equals",children:"="}),(0,h.jsx)("div",{className:"summedTroops",children:Object.entries(y).map((([e,a])=>a>0&&(0,h.jsxs)("span",{children:[(0,h.jsx)("i",{className:`unit_small tribe${i.tribeId} ${e}`,title:(0,c.Jh)(`truppen.tid${10*(i.tribeId-1)+parseInt(e.slice(1))}`)}),b?(0,h.jsx)("span",{className:"value",children:a}):(0,h.jsx)("span",{className:"value "+(j[e]<a?"notEnough":""),children:(0,c.T_)(a,j[e],{useWrapper:!0})})]},`selectedTroop_${t}_${e}`)))})]})})]})})]})},Pt=e=>{const{abandoned:t,farmList:a,isClosestDropContainer:i,dropDirection:n,isDragged:r,isDropping:l,dragState:o,dragRefs:u,player:m,village:p,startButtonsDisabled:g,updateSingleFarmList:v,reloadViewData:x,serverProps:b,ownPlayer:j,setFarmLists:f,isRaidBeingSent:y,setStartButtonsDisabled:T,listToStart:C,cancelStartAll:S,resetStartResults:k}=e,[w,E]=(0,s.useState)([]),[R,I]=(0,s.useState)([{}]),[O,_]=(0,s.useState)(!1);let A=(0,s.useRef)(null);const D=void 0!==R.farmListStartResults?R.farmListStartResults:null,L=void 0!==R.slotsStartErrors?R.slotsStartErrors:null,P=a.slotStates.filter((e=>e.isActive)).map((e=>e.id)),B=w.length>0?w.filter((e=>P.includes(e))):P,M=a.slots?Object.values(a.slots).map((e=>e.id)):[],J=M.some((e=>!P.includes(e))),Z=w.length>0,F=Z?w.filter((e=>!P.includes(e))):[],V=F.length>0,H=Z?w:M;(0,s.useEffect)((()=>{r&&a.isExpanded&&$()}),[a.isExpanded,r]),(0,s.useEffect)((()=>{C.id===a.id&&G()}),[C]),(0,s.useEffect)((()=>{k&&I({})}),[k]),(0,s.useEffect)((()=>{w.length>1&&E((e=>a.slots.filter((t=>-1!==e.indexOf(t.id))).map((e=>e.id))))}),[w]);const q=e=>{e=void 0!==e?e:H;const t=a.slotStates.filter((e=>!e.isActive)).some((t=>e.includes(t.id))),s=a.slots.filter((t=>e.includes(t.id))).map((e=>({id:e.id,listId:a.id,x:e.target.x,y:e.target.y,units:{...e.troop},active:t})));Travian.api("farm-list/slot?force",{data:{slots:s},success:()=>{E([]),v(a.id)},error:e=>{Travian.defaultErrorFunction(e)}},"PUT")},U=e=>{wt(e=void 0!==e?e:H,t,(()=>{E([]);const e=t?{onExpand:!0}:{};v(a.id,e,t)}))},z=()=>{f((e=>{let t=JSON.parse(JSON.stringify(e)),s=t.findIndex((e=>e.id===a.id));return t.splice(s,1),t}))},$=()=>{let e=!a.isExpanded;t||Travian.api("farm-list/change-expanded-state",{action:Travian.Constants.ACTION.farmList,data:{farmLists:[a.id],isExpanded:e}}),e?v(a.id,{onExpand:!0},t):f((e=>{let t=JSON.parse(JSON.stringify(e)),s=t.find((e=>e.id===a.id));return delete s.slots,s.isExpanded=!1,E([]),t}))},W=e=>{const s=a.slots.find((e=>e.id===H[0])),i={selectedList:a.id,editSlotIds:H,selectedTroop:{},abandoned:t};if(1===H.length)i.coordinates={x:s.target.x,y:s.target.y},i.selectedTarget=s.target,i.selectedTroop=s.troop,i.selectedActive=s.isActive;else{let e=a.slots.filter((e=>H.indexOf(e.id)>-1&&e.isActive!==s.isActive));0===e.length&&(i.selectedActive=s.isActive);for(let t=1;t<=10;t++){const n="t"+t;e=a.slots.filter((e=>e.troop[n]!==s.troop[n])),i.selectedTroop[n]=0===e.length?s.troop[n]:null}}kt(e,{onSuccess:()=>{E([]),x()},...i})},G=(e=null)=>{const t=a.id;null!==e&&0!==e.length||(e=a.slotStates.map((e=>e.id))),e=e.filter((e=>a.slotStates.some((t=>t.id===e&&t.isActive)))),I({}),T(!0),y.current=!0;const s=void 0!==C.startData?C.startData:{};Travian.api("farm-list/send",{data:{action:Travian.Constants.ACTION.farmList,lists:[{id:t,targets:e}],...s},success:e=>{s.triggeredBySendAll||s.startedAll||v(t),E([]),I((t=>{const a=JSON.parse(JSON.stringify(t));if(e.lists[0].targets.length>0){const t={success:0,errors:{}},s={};e.lists[0].targets.forEach((e=>{if(e.error){const a=JSON.stringify(e.error);t.errors[a]=t.errors[a]||{message:e.error,count:0},t.errors[a].count=t.errors[a].count+1,s[e.id]=e.error}else t.success+=1})),a.farmListStartResults=t,a.slotsStartErrors=s}return a})),y.current=!1},error:e=>{Travian.defaultErrorFunction(e),T(!1),y.current=!1,S()}})},Y=()=>{G(w)};return(0,h.jsx)("div",{className:`dropContainer\n                    ${i&&a.sortIndex!==o.sortIndex?"highlightDropSection":""}\n                    ${i?n:""}\n                `,"data-sortindex":a.sortIndex,children:(0,h.jsxs)("div",{className:["farmListWrapper",a.isExpanded?"expanded":"collapsed",r?"dragged":"",l?"hidden":""].join(" "),ref:e=>u.current.listElements[a.id]=e,children:[(0,h.jsxs)("div",{className:"farmListHeader",children:[(0,h.jsx)("div",{className:"dragAndDrop preventMobileSwipeNavigation","data-list":a.id,ref:e=>u.current.dragHandles[a.id]=e,children:(0,h.jsx)(dt,{})}),(0,h.jsxs)("div",{className:"farmListName",children:[(0,h.jsx)("div",{className:"name",children:a.name}),(0,h.jsx)("div",{className:"editFarmListName",onClick:()=>{const e={};e.listId=a.id,e.listName=a.name,e.villageId=a.ownerVillage&&a.ownerVillage.id||j.village.id,e.listDefaultTroop=a.defaultTroop,e.abandoned=t,tt(et,{onSaveSuccess:()=>t?x():v(a.id),onDeleteSuccess:z,...e})},children:(0,h.jsx)(ut.Z,{})})]}),(0,h.jsxs)("div",{className:"farmListStatus",children:[(0,h.jsx)("i",{className:"attack_small"}),D&&D.success>0&&(0,h.jsx)(mt.Z,{className:"success",title:`${(0,c.Jh)("raidList.startSuccess")}:&nbsp;${D.success}`}),D&&Object.values(D.errors).length>0&&(0,h.jsx)(gt,{className:"error",title:N.renderToString((0,h.jsxs)(h.Fragment,{children:[(0,c.Jh)("raidList.startWarning"),":",Object.entries(D.errors).map((([e,t])=>(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)("br",{}),t.count," ",(0,h.jsx)("span",{dangerouslySetInnerHTML:{__html:t.message}})]},e)))]}))}),(0,h.jsx)("span",{children:t?a.slotsAmount:(0,h.jsxs)(h.Fragment,{children:[(0,c.T_)(a.runningRaidsAmount,a.slotsAmount,{useWrapper:!0})," ",(0,c.Jh)("raidList.beingRaided")]})})]}),!t&&(0,h.jsx)(vt,{player:m,village:p,slotsToStart:B,selectedSlots:w,lastStartedTime:a.lastStartedTime,startButtonsDisabled:g,startFarmListCallback:Y}),(0,h.jsxs)("a",{className:"expandCollapse",onClick:$,children:[a.isLoading&&(0,h.jsx)("div",{className:"singleLoadingIndicator",children:(0,h.jsx)("i",{className:"spinner"})}),(0,h.jsx)(je.Z,{})]})]}),(0,h.jsxs)("div",{className:"slotsWrapper formV2",children:[(0,h.jsx)(Lt,{abandoned:t,slots:a.slots||[],farmListId:a.id,handleSlotSelection:e=>{const t=parseInt(e.target.dataset.slotId),s=e.target.dataset.checkAll,i=e.target.checked;E((e=>{let n=JSON.parse(JSON.stringify(e));return s?n=i?a.slots.map((e=>e.id)):[]:i?n.push(t):n.splice(n.indexOf(t),1),n}))},village:p,updateSingleFarmList:v,updateAllFarmLists:x,currentTimestamp:b.serverTime,startErrors:L,selectedSlots:w,availableTroops:t?null:a.ownerVillage.troops.ownTroopsAtTown.units,startButtonsDisabled:g,handleActivationDeactivation:q,handleDeletion:U,sortField:a.sortField,sortDirection:a.sortDirection}),a.slots&&a.slots.length>0&&(0,h.jsxs)("div",{className:"farmListFooter",children:[(0,h.jsx)(d.zx,{className:"openContextMenu",iconButton:!0,onClick:()=>_(!0),forwardRef:A,children:(0,h.jsxs)("svg",{children:[(0,h.jsx)(yt.Z,{className:"outline"}),(0,h.jsx)(yt.Z,{className:"icon"})]})}),O&&!t&&(0,h.jsx)(d.xV,{contextParent:A.current,appearance:"defaultButtons",onClose:()=>{_(!1)},content:[{icon:(0,h.jsx)(ut.Z,{}),additionalClass:"edit",text:(0,c.Jh)("raidList.edit")+" ("+H.length+")",title:(0,c.Jh)(Z?"raidList.editSelectedSlots":"raidList.editAllSlots"),onClick:()=>{W(Ct),_(null)}},{icon:V?(0,h.jsx)(It,{}):(0,h.jsx)(At,{}),additionalClass:V?"activate":"deactivate",text:(0,c.Jh)(Z?V?"raidList.activate":"raidList.deactivate":J?"raidList.activate":"raidList.deactivate")+" ("+(Z?V?F.length:w.length:J?M.length-P.length:M.length)+")",title:(0,c.Jh)(Z?V?"raidList.activateSelectedSlots":"raidList.deactivateSelectedSlots":J?"raidList.activateAllSlots":"raidList.deactivateAllSlots"),onClick:()=>{q(),_(null)}},{icon:(0,h.jsx)(Dt.Z,{}),additionalClass:"duplicate",text:(0,c.Jh)("raidList.duplicate")+" ("+H.length+")",title:(0,c.Jh)(Z?"raidList.duplicateSelectedSlots":"raidList.duplicateAllSlots"),onClick:()=>{W(St),_(null)}},{icon:(0,h.jsx)(ne.Z,{}),additionalClass:"delete",text:(0,c.Jh)("raidList.delete")+" ("+H.length+")",title:(0,c.Jh)(Z?"raidList.deleteSelectedSlots":"raidList.deleteAllSlots"),onClick:()=>{U(),_(null)}}]}),O&&t&&(0,h.jsx)(d.xV,{contextParent:A.current,appearance:"defaultButtons",onClose:()=>{_(null)},content:[{icon:(0,h.jsx)(ut.Z,{}),additionalClass:"edit",text:(0,c.Jh)("raidList.edit")+" ("+H.length+")",title:(0,c.Jh)(Z?"raidList.editSelectedSlots":"raidList.editAllSlots"),onClick:()=>{W(Ct),_(null)}},{icon:(0,h.jsx)(ne.Z,{}),additionalClass:"delete",text:(0,c.Jh)("raidList.delete")+" ("+H.length+")",title:(0,c.Jh)(Z?"raidList.deleteSelectedSlots":"raidList.deleteAllSlots"),onClick:()=>{U(),_(null)}}]}),!t&&(0,h.jsx)(vt,{player:m,village:p,slotsToStart:B,selectedSlots:w,lastStartedTime:a.lastStartedTime,startButtonsDisabled:g,startFarmListCallback:Y})]})]})]})})};Se.ZP.registerPlugin(we());const Bt=e=>{const[t,a]=(0,s.useState)({farmListId:null,slotId:null,nextAttackAt:null}),[i,n]=(0,s.useState)({ban:e.viewData.ownPlayer.banInfo?e.viewData.ownPlayer.banInfo.type:0,noobProtection:e.viewData.ownPlayer.noobProtection,isSitter:e.viewData.ownPlayer.isSitter,accessRights:e.viewData.ownPlayer.accessRights,isInVacationMode:e.viewData.ownPlayer.isInVacationMode}),[r,l]=(0,s.useState)({serverTime:e.viewData.bootstrapData.timestamp,isNightTruce:e.viewData.weekendWarrior.isNightTruce}),[o,u]=(0,s.useState)(e.viewData.ownPlayer.farmLists.length),[m,p]=(0,s.useState)(e.viewData.ownPlayer.deactivatedFarmListTargets),[g,v]=(0,s.useState)(e.viewData.ownPlayer.farmLists),[x,b]=(0,s.useState)(e.viewData.ownPlayer.abandonedFarmLists),[j,f]=(0,s.useState)(100),[y,T]=(0,s.useState)(!1),[N,C]=(0,s.useState)(!1),[S,k]=(0,s.useState)({id:null,startData:{}}),[w,E]=(0,s.useState)({disabledClass:!0,title:""}),[R,I]=(0,s.useState)([]),[O,_]=(0,s.useState)({}),A=(0,Z.a)(),D=(0,J.Ps)(e.gql),L=(0,s.useRef)(),P=(0,s.useRef)();let B=(0,s.useRef)(),M=null;const F=(0,s.useRef)((()=>{let e;const t={},a=()=>{const s=Object.keys(t)[0];void 0!==s&&(e=t[s].query().then(t[s].onComplete).catch().finally((()=>{delete t[s],e=void 0,a()})))};return(s,i,n)=>{t[s]||(t[s]={query:i,onComplete:n},void 0===e&&a())}})()),V="\n        id\n        name\n        slotsAmount\n        runningRaidsAmount\n        isExpanded\n        sortIndex\n        lastStartedTime\n        sortField\n        sortDirection\n        ownerVillage {\n            id\n            troops {\n                ownTroopsAtTown {\n                    units {\n                        t1 t2 t3 t4 t5 t6 t7 t8 t9 t10\n                    }\n                }\n            }\n        }\n        defaultTroop {\n            t1 t2 t3 t4 t5 t6 t7 t8 t9 t10\n        }\n        slotStates: slots {\n            id\n            isActive\n        }\n        slots(onlyExpanded: $onlyExpanded) {\n            id\n            target {\n                id\n                mapId\n                x\n                y\n                name\n                type\n                population\n            }\n            troop {\n                t1 t2 t3 t4 t5 t6 t7 t8 t9 t10\n            }\n            distance\n            isActive\n            isRunning\n            runningAttacks\n            nextAttackAt\n            lastRaid {\n                reportId\n                authKey\n                time\n                booty {\n                    resourceType {\n                        id\n                        code\n                    }\n                    amount\n                }\n                bootyMax\n                icon\n            }\n            totalBooty {\n                booty\n                raids\n            }\n        }";(0,s.useEffect)((()=>{let e=()=>{};void 0!==P.current&&null!==P.current&&(P.current.classList.remove("pinned"),requestAnimationFrame((()=>{B.current=we().create({trigger:"#stickyPin",start:"top bottom",endTrigger:"#contentOuterContainer",end:"bottom up",toggleClass:{targets:P.current,className:"pinned"}})})),e=()=>{B.current.refresh(!0)});const t=document.getElementsByClassName("contentContainer")[0];return t.addEventListener("scroll",e),()=>{t.removeEventListener("scroll",e),clearInterval(ae.current)}}),[]),(0,s.useEffect)((()=>{clearTimeout(M),M=setTimeout((()=>{Travian.Tip.refresh(),B.current&&"function"==typeof B.current.refresh&&B.current.refresh(!0)}),250),Travian.TimersAndCounters.initTimersInContext(document.getElementById("content"))})),(0,s.useEffect)((()=>{switch(!0){case i&&i.ban:E({disabledClass:!0,title:(0,c.Jh)("spieler.avatar_locked")});break;case o>=Travian.Variables.FarmList.limit:E({disabledClass:!0,title:(0,c.Jh)("raidList.error_limitReached")});break;default:E({disabledClass:!1,title:""}),L.current&&Travian.Tip.clearOnElement(L.current)}}),[i,o]),(0,s.useEffect)((()=>{L.current&&Travian.Tip.updateAllInElement(L.current)}),[w]),(0,s.useEffect)((()=>{let s=e.viewData.ownPlayer.villages.filter((e=>g.some((t=>t.ownerVillage.id===e.id))));I((e=>(s.forEach((t=>{let a=e.find((e=>e.id===t.id));void 0!==a&&void 0!==a.isLoading&&(t.isLoading=a.isLoading)})),s)));let i={farmListId:null,slotId:null,nextAttackAt:null};Object.values(g).filter((e=>!0===e.isExpanded&&e.runningRaidsAmount>0)).forEach((e=>{e.slots.forEach((t=>{t.nextAttackAt&&(!i.nextAttackAt||t.nextAttackAt<i.nextAttackAt)&&(i={farmListId:e.id,slotId:t.id,nextAttackAt:t.nextAttackAt})}))})),JSON.stringify(i)!==JSON.stringify(t)&&(t&&t.nextAttackAt&&window.removeEventListener(`${Travian.TimersAndCounters.timerEndEvent}_timer_${t.farmListId}_${t.slotId}_${t.nextAttackAt}`,(()=>$(t.farmListId))),i.nextAttackAt&&window.addEventListener(`${Travian.TimersAndCounters.timerEndEvent}_timer_${i.farmListId}_${i.slotId}_${i.nextAttackAt}`,(()=>$(i.farmListId))),a(i));const n=g.map((e=>({id:e.id,targets:e.slotStates.filter((e=>e.isActive)).map((e=>e.id))}))).filter((e=>e.targets.length>0));oe(n),!y||se||q.current||T(!1),g.length!==o&&u(g.length)}),[g]);const H=()=>{A({query:D,variables:{onlyExpanded:!0}}).then((e=>{const{noobProtection:t,accessRights:a,banInfo:s,isSitter:i,isInVacationMode:r,farmLists:o,deactivatedFarmListTargets:c,abandonedFarmLists:d}=e.data.ownPlayer;n({ban:s?s.type:0,noobProtection:t,isSitter:i,accessRights:a,isInVacationMode:r}),u(o.length),p(c),v(o),l({serverTime:e.data.bootstrapData.timestamp,isNightTruce:e.data.weekendWarrior.isNightTruce}),z(d)}))},q=(0,s.useRef)(!1),U=(e,t,a)=>{b((s=>{const i=s.slice(),n=i.findIndex((t=>t.id===e));return i[n]=a.data.abandonedFarmList,i[n].isExpanded=!!t||i[n].isExpanded,i}))},z=e=>{const t=x.filter((e=>e.isExpanded)).map((e=>e.id)),a=e.filter((e=>t.includes(e.id))).map((e=>new Promise((t=>{F.current(e.id,(()=>A({query:J.Ps`query($id: ID!, $onlyExpanded: Boolean) { abandonedFarmList(id: $id) { ${V} } }`,variables:{id:e.id,onlyExpanded:!1}})),t)}))));Promise.all(a).then((t=>{b(e),t.forEach((e=>{U(e.data.abandonedFarmList.id,!0,e)}))}))},$=(e,t={},a=!1)=>{const{onExpand:s=!1}=t;a?F.current(e,(()=>A({query:J.Ps`query($id: ID!, $onlyExpanded: Boolean) { abandonedFarmList(id: $id) { ${V} } }`,variables:{id:e,onlyExpanded:!x&&!s}})),(t=>U(e,s,t))):F.current(e,(()=>A({query:J.Ps`query($id: ID!, $onlyExpanded: Boolean) { bootstrapData { timestamp } weekendWarrior { isNightTruce } farmList(id: $id) { ${V} } }`,variables:{id:e,onlyExpanded:!x&&!s}})),(t=>((e,t,a)=>{l({serverTime:a.data.bootstrapData.timestamp,isNightTruce:a.data.weekendWarrior.isNightTruce}),v((s=>{const i=s.slice(),n=i.findIndex((t=>t.id===e));return i[n]=a.data.farmList,i[n].isExpanded=!!t||i[n].isExpanded,i}))})(e,s,t)))},[W,G]=(0,s.useState)({x:0,y:0}),[Y,K]=(0,s.useState)({list:null,sortIndex:null,villageGroup:null,dragObjectShadowHTML:null,closestDropContainer:null,isDropping:!1}),X=(0,s.useRef)(Y),Q=e=>{X.current=e,K(e)},ee=(0,s.useRef)({dragHandles:{},listElements:{}});(0,s.useEffect)((()=>{let e=[];const t=t=>{if(!t.target.classList.contains("dragAndDrop"))return!0;if("0"===window.getComputedStyle(t.target).getPropertyValue("opacity"))return!0;const i=parseInt(t.target.dataset.list);let n=g.find((e=>e.id===i));t.preventDefault(),e=Array.from(ee.current.listElements[i].parentNode.parentNode.querySelectorAll(".dropContainer")),Q({list:i,sortIndex:n.sortIndex,villageGroup:n.ownerVillage.id,dragObjectShadowHTML:ee.current.listElements[i].outerHTML,closestDropContainer:parseInt(ee.current.listElements[i].parentNode.dataset.sortindex),isDropping:!1});let r=Travian.getCursorPosition(t);r.x-=window.scrollX,r.y-=window.scrollY,G(r),["mousemove","touchmove"].forEach((e=>window.addEventListener(e,a))),["mouseup","touchend"].forEach((e=>window.addEventListener(e,s)))},a=t=>{let a=Travian.getCursorPosition(t);a.x-=window.scrollX,a.y-=window.scrollY;let s=null;e.reduce(((e,t)=>{const i=t.querySelector(".farmListHeader").getBoundingClientRect();let n=Math.abs(a.y-i.height/2-i.top);return(null===e||n<e)&&(e=n,s=parseInt(t.dataset.sortindex)),e}),null),Q({...X.current,closestDropContainer:s}),G(a)},s=()=>{if(X.current.list){const e=X.current.sortIndex,t=X.current.closestDropContainer,i=g.map((a=>{if(a.ownerVillage.id===X.current.villageGroup)if(a.id===X.current.list)a.sortIndex=t;else{const s=a.sortIndex;t>e?s>e&&s<=t&&(a.sortIndex-=1):s<e&&s>=t&&(a.sortIndex+=1)}return a}));v(i),Q({...X.current,isDropping:!0}),Travian.api("farm-list/"+X.current.list+"/change-sort-index",{data:{newIndex:t}}),setTimeout((()=>{Q({list:null,sortIndex:null,villageGroup:null,dragObjectShadowHTML:null,closestDropContainer:null,isDropping:!1})}),300),["mousemove","touchmove"].forEach((e=>window.removeEventListener(e,a))),["mouseup","touchend"].forEach((e=>window.removeEventListener(e,s)))}};return["mousedown","touchstart"].forEach((e=>{window.addEventListener(e,t)})),()=>{["mousedown","touchstart"].forEach((e=>{window.removeEventListener(e,t)}))}}),[g]);const te={};if(null!==Y.list){const e=W;if(Y.isDropping){const e=ee.current.listElements[Y.list].getBoundingClientRect();te.left=e.left,te.top=e.top,te.animation="dragObjectDropping 300ms ease-in-out forwards",te.transitionDuration="300ms"}else{const t=ee.current.dragHandles[Y.list],a=t.getBoundingClientRect(),s=t.parentNode.getBoundingClientRect();let i=s.left-a.left+a.width/2;"rtl"===Travian.Game.getDirection()&&(i=-1*i+a.width);const n=a.top-s.top+a.height/2;te.left=e.x-i,te.top=e.y-n}}const ae=(0,s.useRef)(),[se,ie]=(0,s.useState)(!1),[ne,re]=(0,s.useState)(0),[le,oe]=(0,s.useState)([]),ce=()=>{clearInterval(ae.current),k({id:null,startData:{}}),ie(!1),H()};return(0,h.jsxs)(h.Fragment,{children:[i.noobProtection&&(0,h.jsx)("div",{className:"noticeBox noobProtection",children:(0,c.Jh)("raidList.noobProtectionDescriptionShort")}),m.length>0&&(0,h.jsxs)("div",{className:"noticeBox deactivatedTargets",children:[(0,h.jsx)($e.Z,{className:"close",onClick:()=>{Travian.api("farm-list/close-inbox",{action:Travian.Constants.ACTION.farmList,success:()=>{p([])}})}}),(0,h.jsx)("div",{className:"description",children:(0,c.Jh)("raidList.deactivatedTargets")}),Object.values(e.viewData.ownPlayer.deactivatedFarmListTargets).map(((e,t)=>(0,h.jsxs)(s.Fragment,{children:[t>0&&(0,h.jsx)(h.Fragment,{children:", "}),(0,h.jsx)(ot.tk,{x:e.x,y:e.y,mapId:e.mapId,type:e.type,name:e.name})]},e.mapId)))]}),Object.values(R).map((t=>{const a=Object.values(g).some((e=>e.ownerVillage.id===t.id&&e.isExpanded));return(0,h.jsxs)("div",{className:"villageWrapper "+(null!==Y.villageGroup&&Y.villageGroup!==t.id?"inactive":""),children:[(0,h.jsxs)("div",{className:["villageHeader",a?"expanded":"collapsed"].join(" "),children:[(0,h.jsx)("div",{className:"villageName",children:t.name}),(0,h.jsxs)("a",{className:"expandCollapse",onClick:()=>{return!!a&&(e=t.id,void v((t=>{let a=JSON.parse(JSON.stringify(t)),s=[];return Object.values(a).filter((t=>t.ownerVillage.id===e)).forEach((e=>{if(s.push(e.id),delete e.slots,e.isExpanded=!1,O[e.id]){const t=Object.assign({},O);delete t[e.id],_(t)}})),Travian.api("farm-list/change-expanded-state",{action:Travian.Constants.ACTION.farmList,data:{farmLists:s,isExpanded:!1}}),a})));var e},children:[t.isLoading&&(0,h.jsx)("div",{className:"singleLoadingIndicator",children:(0,h.jsx)("i",{className:"spinner"})}),(0,h.jsx)(je.Z,{})]})]}),null!==Y.dragObjectShadowHTML&&Y.villageGroup===t.id&&(0,h.jsx)("div",{className:"dragObject",dangerouslySetInnerHTML:{__html:Y.dragObjectShadowHTML},style:te}),g.filter((e=>e.ownerVillage.id===t.id)).sort(((e,t)=>e.sortIndex-t.sortIndex)).map((a=>{const s=a.ownerVillage.id===Y.villageGroup&&Y.closestDropContainer===a.sortIndex,n=s&&a.sortIndex>Y.sortIndex?"down":"up",l=Y.list===a.id,o=l&&Y.isDropping;return(0,h.jsx)(Pt,{abandoned:!1,farmList:a,isClosestDropContainer:s,dropDirection:n,isDragged:l,isDropping:o,dragState:Y,dragRefs:ee,player:i,village:t,startButtonsDisabled:y,updateSingleFarmList:$,reloadViewData:H,serverProps:r,ownPlayer:e.viewData.ownPlayer,setFarmLists:v,isRaidBeingSent:q,setStartButtonsDisabled:T,listToStart:S,cancelStartAll:ce,resetStartResults:N},a.id)}))]},t.id)})),Object.values(x).length>0&&(0,h.jsxs)("div",{className:"villageWrapper abandonedFarmLists",children:[(0,h.jsx)("div",{className:["villageHeader",Object.values(x).some((e=>e.isExpanded))?"expanded":"collapsed"].join(" "),children:(0,h.jsx)("div",{className:"villageName",children:(0,c.Jh)("raidList.abandonedFarmLists")})}),x.slice(0,j).map((t=>(0,h.jsx)(Pt,{abandoned:!0,farmList:t,isClosestDropContainer:!1,isDragged:!1,isDropping:!1,dragState:Y,dragRefs:ee,player:i,village:e.viewData.ownPlayer.village,startButtonsDisabled:y,updateSingleFarmList:$,reloadViewData:H,serverProps:r,ownPlayer:e.viewData.ownPlayer,setFarmLists:b,isRaidBeingSent:q,setStartButtonsDisabled:T,listToStart:S,cancelStartAll:ce,resetStartResults:N},t.id))),Object.values(x).length>j&&(0,h.jsx)("a",{className:"showMore",onClick:()=>f((e=>e+100)),children:(0,c.Jh)("raidList.showMore")})]}),(0,h.jsx)("div",{id:"stickyPin",children:(0,h.jsxs)("div",{id:"stickyWrapper",ref:P,className:"pinned",children:[(0,h.jsxs)("div",{className:"farmListCount",children:[(0,c.Jh)("raidList.farmLists"),": ",(0,c.T_)(o,Travian.Variables.FarmList.limit,{useWrapper:!0})]}),(0,h.jsx)("div",{className:"runningFarmLists",children:se?(0,h.jsxs)("div",{className:"farmListCount",children:[(0,c.Jh)("raidList.startingFarmLists"),": ",(0,c.T_)(ne,o,{useWrapper:!0})]}):(0,c.Jh)("raidList.startFromAllVillages")}),(0,h.jsx)(d.zx,{className:"createFarmList",...w,forwardRef:L,onClick:w.disabledClass?()=>{}:()=>tt(Qe,{onSaveSuccess:H}),children:(0,c.Jh)("raidList.createFarmList")}),se?(0,h.jsx)(d.zx,{className:"cancelStartAllFarmLists",appearance:"red",title:(0,c.Jh)("raidList.cancelStarting"),onClick:ce,children:(0,c.Jh)("allgemein.cancel_with_capital_c")}):(0,h.jsx)(Mt,{startAll:()=>{if(!se){ie(!0),re(0),C(!0);const e=le.slice();ae.current=setInterval((function(){if(C(!1),0!==e.length||q.current){if(!q.current){const t=e.shift(),a={};e.length===le.length-1?a.startedAll=!0:a.triggeredBySendAll=!0,k({id:t.id,startData:a}),re((e=>e+1))}}else ce()}),100)}},dispatchableLists:le,player:i})]})})]})};Bt.propTypes={viewData:o().object.isRequired,gql:o().string.isRequired};const Mt=e=>{const{dispatchableLists:t,startAll:a,player:s}=e;let i,n=!0,r=()=>{};switch(!0){case 0===t.length:i=(0,c.Jh)("raidList.noTargetsFound");break;case s&&0!==s.ban:i=(0,c.Jh)("spieler.account_locked");break;case s&&s.isSitter&&!s.accessRights.sendRaids:i=(0,c.Jh)("spieler.sitter_not_allowed_only_with_right");break;default:i=(0,c.Jh)("raidList.startFromAllVillages"),r=a,n=!1}return(0,h.jsx)(d.zx,{className:"startAllFarmLists",title:i,disabledClass:n,onClick:r,children:(0,c.Jh)("raidList.startAllFarmLists")})};var Jt;function Zt(){return Zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Zt.apply(this,arguments)}Mt.propTypes={dispatchableLists:o().array.isRequired,startAll:o().func.isRequired,player:o().object.isRequired};const Ft=e=>s.createElement("svg",Zt({viewBox:"0 0 20 20"},e),Jt||(Jt=s.createElement("path",{d:"M16.29 2.23a4.4 4.4 0 0 0-.41-.31A9.9 9.9 0 0 0 10 0a10 10 0 1 0 6.29 2.23zm-.53 14a8.37 8.37 0 0 1-3.55 2 7.14 7.14 0 0 0 1.06-1.71 11.16 11.16 0 0 0 .56-1.54c1.27.38 1.93.9 1.93 1.24zm-11.52 0c0-.32.6-.81 1.76-1.19a11.83 11.83 0 0 0 .55 1.49 6.94 6.94 0 0 0 1 1.64 8.44 8.44 0 0 1-3.31-1.91zm7.92-.2c-.63 1.4-1.45 2.2-2.25 2.2s-1.62-.8-2.26-2.2a9.31 9.31 0 0 1-.47-1.29A14.26 14.26 0 0 1 10 14.4a14.52 14.52 0 0 1 2.65.23 9.76 9.76 0 0 1-.49 1.37zM10 12.8a16.35 16.35 0 0 0-3.14.29 16.28 16.28 0 0 1-.3-2.7h6.7a16.15 16.15 0 0 1-.3 2.67A16.72 16.72 0 0 0 10 12.8zM6.56 9.39a17.66 17.66 0 0 1 .32-2.7A16.52 16.52 0 0 0 10 7a17.16 17.16 0 0 0 3-.27 17 17 0 0 1 .31 2.66zM10 5.52a15 15 0 0 1-2.8-.25 9.36 9.36 0 0 1 .45-1.2c.64-1.41 1.46-2.21 2.26-2.21s1.62.8 2.25 2.21a9.84 9.84 0 0 1 .47 1.23 14.44 14.44 0 0 1-2.63.22zM6 5c-1.1-.39-1.71-.86-1.76-1.18A8.42 8.42 0 0 1 7.57 1.9a7 7 0 0 0-1 1.67A12 12 0 0 0 6 5zm7.25-1.4a7.23 7.23 0 0 0-1.05-1.76 8.4 8.4 0 0 1 3.56 2c-.06.34-.72.83-1.95 1.2a13.66 13.66 0 0 0-.54-1.47zM5.7 6.4a16.77 16.77 0 0 0-.35 3H1.58A8.48 8.48 0 0 1 3.3 5a4.86 4.86 0 0 0 2.4 1.4zm-.36 4a18.84 18.84 0 0 0 .34 3l-.46.16a4.21 4.21 0 0 0-1.95 1.28 8.51 8.51 0 0 1-1.7-4.44zm8.81 2.95a19.57 19.57 0 0 0 .33-2.95h3.95a8.51 8.51 0 0 1-1.7 4.44 4.92 4.92 0 0 0-2.58-1.5zm.32-3.95a18.21 18.21 0 0 0-.34-2.94l.65-.21A4.24 4.24 0 0 0 16.7 5a8.4 8.4 0 0 1 1.72 4.4z"})));var Vt;function Ht(){return Ht=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},Ht.apply(this,arguments)}const qt=e=>s.createElement("svg",Ht({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 127.14 96.36"},e),Vt||(Vt=s.createElement("path",{fill:"#fff",d:"M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"}))),Ut=e=>{const t=(0,Z.a)(),a=J.Ps`query($ids: [String]) {
        externalURLs {
            knowledgeBaseArticles(ids: $ids) {
                id
                url
            }
            createTicket
            blog
            gameRules
            discord
        }
        ownPlayer {
            isSitter
        }
    }`,[i,n]=(0,s.useState)({}),[r,l]=(0,s.useState)(null),[o,u]=(0,s.useState)(null),[m,p]=(0,s.useState)(null),[g,v]=(0,s.useState)(!1),x=!m||g;return(0,s.useEffect)((()=>{t({query:a,variables:{ids:["introduction","paymentSupport"]}}).then((e=>{const t=e.data.externalURLs;n(t);const a=t.knowledgeBaseArticles,s=a.findIndex((e=>"introduction"===e.id)),i=a.findIndex((e=>"paymentSupport"===e.id));l(a[s].url),u(a[i].url),p(t.createTicket),v(e.data.ownPlayer.isSitter)}))}),[]),(0,s.useEffect)((()=>{Travian.Tip.refresh()})),(0,h.jsxs)("div",{className:"contentV2 helpDialog",children:[(0,h.jsx)("h1",{className:"titleInHeader",children:(0,c.Jh)("help.helpMenu")}),(0,h.jsxs)("div",{className:"content",children:[(0,h.jsx)("div",{className:"supportCharacter"}),(0,h.jsxs)("div",{className:"helpSections",children:[(0,h.jsxs)("div",{className:"support",children:[(0,h.jsx)("h3",{children:(0,c.Jh)("allgemein.hilfe")}),(0,h.jsx)("p",{children:(0,c.Jh)("help.helpDescription")}),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:(0,h.jsxs)("a",{onClick:Travian.Game.Manual.open,children:[(0,h.jsx)("span",{className:"listIcon"}),(0,h.jsx)("span",{children:(0,c.Jh)("help.buildingsAndTroops")})]})}),(0,h.jsx)("li",{children:(0,h.jsxs)("a",{className:r?"":"disabled",target:"_blank",href:r,children:[(0,h.jsx)("span",{className:"listIcon"}),(0,h.jsx)("span",{children:(0,c.Jh)("help.newPlayers")})]})}),(0,h.jsx)("li",{children:(0,h.jsxs)("a",{className:o?"":"disabled",target:"_blank",href:o,children:[(0,h.jsx)("span",{className:"listIcon"}),(0,h.jsx)("span",{children:(0,c.Jh)("help.paymentSupport")})]})})]})]}),(0,h.jsx)("div",{className:"helpBox customerService",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("h3",{children:(0,c.Jh)("help.customerServerAndKnowledgeBase")}),(0,h.jsx)(Ft,{}),(0,h.jsx)(d.zx,{target:"_blank",disabledClass:x,title:g?(0,c.Jh)("nachrichten.ticketSystem_sitterNotAllowed"):(0,c.Jh)("help.createTicket"),href:m,children:(0,c.Jh)("help.createTicket")})]})}),(0,h.jsxs)("div",{className:"information",children:[(0,h.jsx)("h3",{children:(0,c.Jh)("help.information")}),(0,h.jsx)("p",{children:(0,c.Jh)("help.informationDescription")}),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:(0,h.jsxs)("a",{className:i.blog?"":"disabled",target:"_blank",href:i.blog,children:[(0,h.jsx)("span",{className:"listIcon"}),(0,h.jsx)("span",{children:(0,c.Jh)("allgemein.blog")})]})}),(0,h.jsx)("li",{children:(0,h.jsxs)("a",{className:i.blog?"":"disabled",target:"_blank",href:i.blog?i.blog+"/category/news/changelogs-game-updates/":null,children:[(0,h.jsx)("span",{className:"listIcon"}),(0,h.jsx)("span",{children:(0,c.Jh)("help.changelogsAndUpdates")})]})}),(0,h.jsx)("li",{children:(0,h.jsxs)("a",{className:i.gameRules?"":"disabled",target:"_blank",href:i.gameRules,children:[(0,h.jsx)("span",{className:"listIcon"}),(0,h.jsx)("span",{children:(0,c.Jh)("help.game_rules")})]})})]})]}),(0,h.jsx)("div",{className:"helpBox discord",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("h3",{children:(0,c.Jh)("help.bePartOfCommunity")}),(0,h.jsx)(qt,{}),(0,h.jsx)(d.zx,{disabledClass:!i.discord,target:"_blank",href:i.discord,children:(0,c.Jh)("help.openDiscord")})]})})]})]})]})},zt=e=>{const t={relativeTo:{element:"#loginScene",position:"below",offset:80},overlayCancel:!1,buttonCancel:!1,buttonOk:!1,preventFormSubmit:!0,darkOverlay:!0,useEscKey:!1,content:(0,h.jsx)(d.U0,{...e})};return(0,s.useEffect)((()=>{const e=document.getElementById("logo");e&&e.classList.add("light")}),[]),(0,h.jsx)(d.WV,{options:t,closeCallback:()=>{}})},$t=e=>(0,h.jsx)(d.gu,{source:"dialog",...e});class Wt extends s.Component{i=0;state={dialogs:[]};addDialog=(e,t)=>{const a={context:e,isClosing:!1,ref:null,component:null},s=this.state.dialogs.find((t=>t.context===e&&!t.isClosing));s&&(s.isClosing=!0,s.ref.closeDialog());const i=()=>{t.afterClose&&t.afterClose();const e=this.state.dialogs.filter((e=>e!==a));this.setState({dialogs:e})};i.bind(this),a.component=(0,h.jsx)(d.WV,{options:t,closeCallback:i,ref:e=>{a.ref=e}},this.i++);const n=this.state.dialogs.concat([a]);this.setState({dialogs:n})};render=()=>this.state.dialogs.map((e=>e.component))}window.Travian.React=window.Travian.React||{},window.Travian.React.nodes={};const Gt=e=>{if(!window.Travian.React.nodes[e]){const t=document.getElementById(e);window.Travian.React.nodes[e]=t?(0,i.s)(t):void 0}return window.Travian.React.nodes[e]},Yt=function(e,t,a,i,l){(0,r.vV)(i).then((function(){const i=s.createElement(e,{...t,...a});Gt(l).render((0,h.jsx)(n.k,{contexts:a,children:i})),window.Travian.Tip.refresh()}))};window.Travian.React.dialogs=void 0,window.Travian.React.Dialog=function(e,t="dialog",a=[]){window.Travian.React.dialogs||Gt("reactDialogWrapper").render((0,h.jsx)(Wt,{ref:e=>{window.Travian.React.dialogs=e}}));const s=()=>{(0,r.vV)(a).then((()=>window.Travian.React.dialogs.addDialog(t,e)))};"requestIdleCallback"in window?requestIdleCallback(s,{timeout:50}):setTimeout(s,50)},window.Travian.React.Tasks={render:function(e,t={},a=[]){Yt(v,e,t,a,"tasks")}},window.Travian.React.ProductionOverview={render:function(e,t={},a=[]){Yt(g,e,t,a,"productionOverview")}},window.Travian.React.RallyPointSimulators={render:function(e,t={},a=[]){Yt(u,e,t,a,"rallyPointSimulators")}},window.Travian.React.Statistics={render:function(e,t={},a=[]){Yt(p,e,t,a,"statisticsV2")}},window.Travian.React.HeroAuction={render:function(e,t={},a=[]){Yt(z,e,t,a,"heroAuction")}},window.Travian.React.ReferAFriend={render:function(e,t={},a=[]){Yt($,e,t,a,"referAFriend")}},window.Travian.React.StyleguideReact={render:function(e,t={},a=[]){Yt(G,e,t,a,"styleguideReact")}},window.Travian.React.AllianceBanner={render:function(e,t={},a=[]){Yt(Y,e,t,a,"allianceBanner")}},window.Travian.React.HeroV2={render:function(e,t={},a=[]){Yt(K,e,t,a,"heroV2")}},window.Travian.React.PlayerProfile={render:function(e,t={},a=[]){Yt(Q,e,t,a,"playerProfile")}},window.Travian.React.HeroAdventure={render:function(e,t={},a=[]){Yt(ae,e,t,a,"heroAdventure")}},window.Travian.React.HeroAdventureStarted={render:function(e,t={},a=[]){Yt(d.Jd,e,t,a,"heroAdventure")}},window.Travian.React.TradeRoutes={render:function(e,t={},a=[]){Yt(Oe,e,t,a,"tradeRoutes")}},window.Travian.React.Buy={render:function(e,t={},a=[]){Yt(Ve,e,t,a,"marketplaceBuy")}},window.Travian.React.Offer={render:function(e,t={},a=[]){Yt(Ke,e,t,a,"marketplaceOffer")}},window.Travian.React.SendResources={render:function(e,t={},a=[]){Yt(We,e,t,a,"marketplaceSendResources")},openSendResourceDialog:e=>{window.Travian.React.Dialog({content:(0,h.jsx)($t,{...e}),cssClass:"basic sendResourcesDialog",version:2,allowMobileSidebars:!0,buttonOk:!1,buttonCancel:!0,enableBackground:!1,preventFormSubmit:!0,relativeTo:{element:"#stockBar",position:"below",offset:Travian.Game.Layout.MobileOptimizations.enabled?20:5}},"sendResourcesDialog",["allgemein","gid17","gid49","anmelden","a2b","spieler","plus"])}},window.Travian.React.FarmList={render:function(e,t={},a=[]){Yt(Bt,e,t,a,"rallyPointFarmList")},openSlotDialog:kt,SLOT_DIALOG_TYPE_CREATE:Nt,SLOT_DIALOG_TYPE_EDIT:Ct},window.Travian.React.Login={render:function(e,t={},a=[]){Yt(zt,e,t,a,"loginScene")}},window.Travian.React.openHelpDialog=e=>{window.Travian.React.Dialog({content:(0,h.jsx)(Ut,{...e}),cssClass:"helpDialog",version:2,buttonOk:!1,buttonCancel:!0,enableBackground:!0},"helpDialog",["allgemein","help","nachrichten"])}},6700:(e,t,a)=>{var s={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":2088,"./es-do.js":2088,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5606,"./ss.js":5606,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function i(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=n,e.exports=i,i.id=6700}},e=>{e.O(0,[736],(()=>{return t=5386,e(e.s=t);var t}));e.O()}]);